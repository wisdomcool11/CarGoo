!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="85eced4b-2357-4e38-8867-0f72d7a0a2d9",e._sentryDebugIdIdentifier="sentry-dbid-85eced4b-2357-4e38-8867-0f72d7a0a2d9")}catch(e){}}(),("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"9f3dcec"};export const id=38792;export const ids=[38792];export const modules={45622:(e,t,r)=>{var i={"./af-ZA/translation.json":[258126,48067],"./am-ET/translation.json":[758681,19218],"./ar-SA/translation.json":[548315,30440],"./as-IN/translation.json":[151773,79530],"./az-Latn-AZ/translation.json":[94566,83481],"./bg-BG/translation.json":[902444,9013],"./bn-IN/translation.json":[709573,80782],"./bs-Latn-BA/translation.json":[39304,78759],"./ca-ES/translation.json":[869270,48835],"./ca-Es-VALENCIA/translation.json":[925214,52709],"./cs-CZ/translation.json":[830601,51434],"./cy-GB/translation.json":[958335,47156],"./da-DK/translation.json":[613414,15055],"./de-DE/translation.json":[388340,49661],"./el-GR/translation.json":[664716,99905],"./en-GB/translation.json":[12014,74351],"./en-US/translation.json":[686487],"./es-ES/translation.json":[683126,26167],"./es-MX/translation.json":[331327,55388],"./et-EE/translation.json":[515151,86108],"./eu-ES/translation.json":[37612,98121],"./fa-IR/translation.json":[589918,67179],"./fi-FI/translation.json":[380952,38277],"./fil-PH/translation.json":[269817,37176],"./fr-CA/translation.json":[393886,59015],"./fr-FR/translation.json":[173546,53783],"./ga-IE/translation.json":[888976,9693],"./gd-gb/translation.json":[338554,38554],"./gl-ES/translation.json":[822295,27716],"./gu-IN/translation.json":[515361,13306],"./he-IL/translation.json":[363506,94215],"./hi-IN/translation.json":[144020,34993],"./hr-HR/translation.json":[645830,56551],"./hu-HU/translation.json":[872940,78045],"./hy-AM/translation.json":[320809,78626],"./id-ID/translation.json":[542892,77093],"./is-IS/translation.json":[337182,51383],"./it-IT/translation.json":[570124,12357],"./ja-JP/translation.json":[286627,92684],"./ka-GE/translation.json":[184874,83387],"./kk-KZ/translation.json":[966753,23938],"./km-KH/translation.json":[118145,26934],"./kn-IN/translation.json":[737794,62687],"./ko-KR/translation.json":[331157,85270],"./kok-IN/translation.json":[618714,79601],"./lb-LU/translation.json":[383803,9256],"./lo-LA/translation.json":[292622,80515],"./lt-LT/translation.json":[985670,45323],"./lv-LV/translation.json":[553270,70863],"./mi-NZ/translation.json":[707380,26633],"./mk-MK/translation.json":[573334,66679],"./ml-IN/translation.json":[828466,91835],"./mr-IN/translation.json":[182180,60737],"./ms-MY/translation.json":[877708,26093],"./mt-MT/translation.json":[489316,1125],"./nb-NO/translation.json":[203897,91234],"./ne-NP/translation.json":[738143,95432],"./nl-NL/translation.json":[754274,33787],"./nn-NO/translation.json":[310821,94014],"./or-IN/translation.json":[869874,46959],"./pa-IN/translation.json":[652228,2865],"./pl-PL/translation.json":[171702,59331],"./pt-BR/translation.json":[468750,98943],"./pt-PT/translation.json":[946326,60771],"./quz-PE/translation.json":[964619,50630],"./ro-RO/translation.json":[320396,50213],"./ru-RU/translation.json":[377400,97573],"./sk-SK/translation.json":[765782,79563],"./sl-SI/translation.json":[585723,93948],"./sq-AL/translation.json":[352655,51496],"./sr-Cyrl-BA/translation.json":[913779,36842],"./sr-Cyrl-RS/translation.json":[670133,70133],"./sr-Latn-RS/translation.json":[377224,42423],"./sv-SE/translation.json":[574401,88958],"./ta-IN/translation.json":[574832,42189],"./te-IN/translation.json":[733276,3489],"./th-TH/translation.json":[274814,21723],"./tr-TR/translation.json":[337278,66295],"./tt-RU/translation.json":[259039,96948],"./ug-CN/translation.json":[155611,55611],"./uk-UA/translation.json":[380108,90797],"./ur-PK/translation.json":[249958,49958],"./uz-Latn-UZ/translation.json":[228582,5977],"./vi-VN/translation.json":[858641,72330],"./zh-CN/translation.json":[141,31854],"./zh-TW/translation.json":[376609,99330]};function n(e){if(!r.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],n=t[0];return Promise.all(t.slice(1).map(r.e)).then((()=>r.t(n,19)))}n.keys=()=>Object.keys(i),n.id=45622,e.exports=n},911442:(e,t,r)=>{var i={"./af-ZA/shared.json":[732022,48067],"./am-ET/shared.json":[50991,19218],"./ar-SA/shared.json":[993153,30440],"./as-IN/shared.json":[791051,79530],"./az-Latn-AZ/shared.json":[583630,83481],"./bg-BG/shared.json":[318500,9013],"./bn-IN/shared.json":[617203,80782],"./bs-Latn-BA/shared.json":[664344,78759],"./ca-ES/shared.json":[602686,48835],"./ca-Es-VALENCIA/shared.json":[176326,52709],"./cs-CZ/shared.json":[680095,51434],"./cy-GB/shared.json":[203021,47156],"./da-DK/shared.json":[171134,15055],"./de-DE/shared.json":[97596,49661],"./el-GR/shared.json":[672148,99905],"./en-GB/shared.json":[206582,74351],"./en-US/shared.json":[397117,8844],"./es-ES/shared.json":[881246,26167],"./es-MX/shared.json":[623229,55388],"./et-EE/shared.json":[641133,86108],"./eu-ES/shared.json":[950468,98121],"./fa-IR/shared.json":[875078,67179],"./fi-FI/shared.json":[710536,38277],"./fil-PH/shared.json":[639487,37176],"./fr-CA/shared.json":[933942,59015],"./fr-FR/shared.json":[884874,53783],"./ga-IE/shared.json":[343328,9693],"./gd-gb/shared.json":[768666,68666],"./gl-ES/shared.json":[750645,27716],"./gu-IN/shared.json":[546519,13306],"./he-IL/shared.json":[491058,94215],"./hi-IN/shared.json":[762332,34993],"./hr-HR/shared.json":[611886,56551],"./hu-HU/shared.json":[912708,78045],"./hy-AM/shared.json":[185791,78626],"./id-ID/shared.json":[469188,77093],"./is-IS/shared.json":[494198,51383],"./it-IT/shared.json":[826532,12357],"./ja-JP/shared.json":[467353,92684],"./ka-GE/shared.json":[274938,83387],"./kk-KZ/shared.json":[883223,23938],"./km-KH/shared.json":[3575,26934],"./kn-IN/shared.json":[519986,62687],"./ko-KR/shared.json":[802243,85270],"./kok-IN/shared.json":[672666,79601],"./lb-LU/shared.json":[326017,9256],"./lo-LA/shared.json":[220342,80515],"./lt-LT/shared.json":[285102,45323],"./lv-LV/shared.json":[811806,70863],"./mi-NZ/shared.json":[159164,26633],"./mk-MK/shared.json":[233694,66679],"./ml-IN/shared.json":[983234,91835],"./mr-IN/shared.json":[305884,60737],"./ms-MY/shared.json":[972308,26093],"./mt-MT/shared.json":[612172,1125],"./nb-NO/shared.json":[389647,91234],"./ne-NP/shared.json":[595005,95432],"./nl-NL/shared.json":[849810,33787],"./nn-NO/shared.json":[526947,94014],"./or-IN/shared.json":[118290,46959],"./pa-IN/shared.json":[584140,2865],"./pl-PL/shared.json":[717470,59331],"./pt-BR/shared.json":[197158,98943],"./pt-PT/shared.json":[827262,60771],"./quz-PE/shared.json":[881,50630],"./ro-RO/shared.json":[945028,50213],"./ru-RU/shared.json":[188872,97573],"./sk-SK/shared.json":[441726,79563],"./sl-SI/shared.json":[245441,93948],"./sq-AL/shared.json":[994077,51496],"./sr-Cyrl-BA/shared.json":[598697,36842],"./sr-Cyrl-RS/shared.json":[658963,58963],"./sr-Latn-RS/shared.json":[858360,42423],"./sv-SE/shared.json":[695895,88958],"./ta-IN/shared.json":[252880,42189],"./te-IN/shared.json":[399252,3489],"./th-TH/shared.json":[623702,21723],"./tr-TR/shared.json":[62486,66295],"./tt-RU/shared.json":[647197,96948],"./ug-CN/shared.json":[603953,3953],"./uk-UA/shared.json":[174164,90797],"./ur-PK/shared.json":[803678,3678],"./uz-Latn-UZ/shared.json":[74478,5977],"./vi-VN/shared.json":[764167,72330],"./zh-CN/shared.json":[209387,31854],"./zh-TW/shared.json":[360279,99330]};function n(e){if(!r.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],n=t[0];return r.e(t[1]).then((()=>r.t(n,19)))}n.keys=()=>Object.keys(i),n.id=911442,e.exports=n},767716:(e,t,r)=>{r.d(t,{s:()=>x,z:()=>w}),r(379321);var i=r(565282),n=r(97475),o=r(620486),s=r(26985),a=r(221318),c=r(562229),l=r(410040),d=r(529527),u=r(138615),h=r(225304),p=r(667641),m=r(650882),f=r(615101),g=r(901948),A=r(277277);function v({}){function e(){window.location.reload()}return(0,A.jsx)(p.lG,{open:!0,onClose:e,children:(0,A.jsx)(l.Q,{onClose:e})})}function y({error:e,children:t}){const r=function(){const e=(0,s.useRef)([]);return(0,s.useCallback)(((t,r)=>{let s;if(t?.rejection){const{rejection:e}=t;(0,m.A3)(e)&&(e.context&&(0,i.cx)(e.context),s=`Uncaught (in promise): Error: ${e.message}`),t.rejection.message&&(s=`Uncaught (in promise): Error: ${t.rejection.message}`)}const a=(0,f.aK)(s||t?.message||String(t));if(a){if(e.current.includes(a))return;e.current.push(a)}(0,m.A3)(t)&&t.context&&(0,i.cx)(t.context),console.error("Uncaught error on top level",t),(0,n.Z)({message:"Error - Dialog Shown",level:"fatal"}),(0,o.v4)((e=>{e.setTag("snap","true"),e.setLevel("fatal"),(0,i.Cp)(t)}));const l=(0,m.A3)(t)?t.toEventProperties():{},d=(0,m.A3)(t)?t.stack:void 0;if(c.z.logEvent("Error - Dialog Shown",{...l,error:a,location:location.pathname,isOnline:navigator.onLine}),(0,u.G7)("multi__consumer_1ds")){let e="Unknown";t.errorCode?e=t.errorCode:t instanceof h.Dr?e="Network":t instanceof h.j$?e=t.status.toString():t?.constructor?.name&&"Error"!==t.constructor.name&&(e=t.constructor.name),c.z.logErrorEvent("UnhandledError",{errorAlertType:"Unhandled",errorCode:e,stack:r||d,isOnline:navigator.onLine})}}),[])}();return(0,s.useEffect)((()=>{r(e)}),[e,r]),(0,A.jsx)(A.Fragment,{children:t})}function b({error:e,children:t}){const r=(0,s.useCallback)((e=>{console.error("Error: ",e)}),[]);return(0,s.useEffect)((()=>{r(e)}),[e,r]),(0,A.jsx)(A.Fragment,{children:t})}function w({children:e,...t}){return(0,g.g)(d.T.sentryEnvironment)?(0,A.jsx)(y,{...t,children:e}):(0,A.jsx)(b,{...t,children:e})}function x({children:e}){return(0,A.jsx)(a.tH,{fallbackRender:e=>(0,A.jsx)(w,{...e,children:(0,A.jsx)(v,{...e})}),children:e})}},178249:(e,t,r)=>{r.d(t,{$X:()=>n,$d:()=>o,AH:()=>s});const i="authRedirect",n=e=>{sessionStorage.setItem(i,e)},o=()=>sessionStorage.getItem(i),s=()=>sessionStorage.removeItem(i)},18829:(e,t,r)=>{r.d(t,{QG:()=>s,XB:()=>o,pq:()=>n,rn:()=>i});const i="https://go.microsoft.com/fwlink/?linkid=2259814",n="https://www.microsoft.com/servicesagreement",o="https://go.microsoft.com/fwlink/?LinkId=521839",s="https://go.microsoft.com/fwlink/?linkid=2242659"},511329:(e,t,r)=>{r.d(t,{P:()=>u,V:()=>d}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(584570),r(82265),r(988124);var i=r(573340);const n={"web-app":"webApp","windows-twa":"webApp","chrome-os-twa":"webApp","windows-native":"windowsNative",m365createblank:"m365CreateBlank",m365consumerheader:"m365ConsumerHeader",m365officeapps:"m365OfficeApps",m365edge:"m365Edge",learningshelfcard:"learningShelfCard",m365:"m365",microsoftcreateweb:"microsoftCreateWeb",gdriveEditWith:"gdriveEditWith","open-with":"fileExplorerOpenWith","edit-with":"fileExplorerEditWith",photosuwp:"photosEditWith",mediaplayeruwp:"mediaPlayerEditWith",snippingtool:"snippingToolEditWith",legacy:"legacyOpenWith","pricing/":"marketingSitePricing","features/ai-voice-over-generator/":"marketingSiteFeaturesAiVoiceOverGenerator","features/green-screen-video-editor/":"marketingSiteFeaturesGreenScreenVideoEditor","features/online-video-resizer/":"marketingSiteFeaturesOnlineVideoResizer","webcam-recorder/":"marketingSiteFeaturesWebcamRecorder","screen-recorder/":"marketingSiteFeaturesScreenRecorder","brand-kit/":"marketingSiteFeaturesBrandKit","video-overlay/":"marketingSiteFeaturesVideoOverlay","video-trimmer/":"marketingSiteFeaturesVideoTrimmer","loop-video/":"marketingSiteFeaturesLoopVideo","crop-video/":"marketingSiteFeaturesCropVideo","ai-video-editing-clipchamp/":"marketingSiteFeaturesAiVideoEditing","subtitle-generator/":"marketingSiteFeatureSubtitleGenerator","make-youtube-videos/":"marketingSiteCreateYouTubeVideos","tiktok/":"marketingSiteCreateTikTok","instagram-videos/":"marketingSiteCreateInstagram","pinterest/":"marketingSiteCreatePinterest","promo-video/":"marketingSiteCreatePromoVideo","gaming-video-editor/":"marketingSiteCreateGamingVideoEditor","video-meme-generator/":"marketingSiteCreateVideoMemeGenerator","make-slideshow-videos/":"marketingSiteCreateMakeSlideshowVideos","video-templates/":"marketingSiteCreateVideoTemplates","clipchamp-for-work/":"marketingSiteClipchampForWork","stock/":"marketingSiteCreateStock","behind-your-scenes/":"marketingSiteCampaignDiverseDesigners"},o=new Set(["26pYrQ","SP6rDe"]),s="launchSource",a=(e,t)=>new URLSearchParams(e).get(t),c=e=>{const t=new URL(e),r=new URLSearchParams(t.search),i={};for(const e of r)e[0].startsWith("utm_")&&(i[e[0].replaceAll(/(_\w)/g,(function(e){return e[1].toUpperCase()}))]=e[1]);return i},l=e=>{const t=new URL(e),r=new URLSearchParams(t.search);for(const e of r)if("ocid"===e[0]&&o.has(e[1]))return e[1]},d=e=>{const t=a(window.location.search,"utm_source"),r=a(window.location.search,"state"),o=a(window.location.search,"content"),d=(()=>{if(document.referrer.startsWith("https://clipchamp.com/")){const e=document.referrer.replaceAll(/\?.*$/g,""),t=document.referrer.startsWith("https://clipchamp.com/collection")?3:4,r=e.split("/").slice(t).join("/"),i=""===r?"/":r,{utmSource:n,utmMedium:o,utmCampaign:s,utmContent:a}=c(document.referrer);return{pagePath:i,utmSource:n,utmMedium:o,utmCampaign:s,utmContent:a,ocid:l(document.referrer)}}})();let u;if(e?.referrer&&e.referrer in n)u={launchSource:n[e.referrer]};else if(t&&t in n)u={launchSource:n[t],utmSource:t};else if(r)try{void 0!==JSON.parse(r).action&&(u={launchSource:"gdriveEditWith"})}catch(e){i.Vy.log("unparseable launch source state")}else if(o)u={launchSource:"content"};else if(d){document.referrer.startsWith("https://clipchamp.com/collection")?u={launchSource:"marketingSiteCollections"}:"pagePath"in d&&(u={launchSource:n[d.pagePath]}),u?.launchSource||(u={launchSource:"marketingSite"});const e=c(document.referrer),t=l(document.referrer);u={...u,...e,ocid:t,marketingSiteReferrerPath:d.pagePath}}u&&sessionStorage.setItem(s,JSON.stringify(u))},u=e=>{const t=sessionStorage.getItem(s);return t&&0!==Object.keys(t).length?JSON.parse(t):{launchSource:n[e.current.type]}}},945897:(e,t,r)=>{r.d(t,{Z:()=>F,o:()=>L});var i,n=r(324586),o=r(217563),s=r(811438),a=r(720291),c=r(954251),l=r(825702),d=r(562229),u=r(685944),h=r(138615),p=r(739367),m=r(573340),f=r(941604),g=r(274095),A=r(656717),v=r(225304),y=r(597906),b=r(769159),w=r(842880),x=r(345153),S=r(7089),T=r(847269),C=r(163708),_=r(716887),k=r(33493),E=r(995895),I=r(82575),R=r(843875);let F=(0,l.Gr)()(i=function(e){return(0,l.WQ)(b.X)(e,void 0,0)}(i=function(e){return(0,l.WQ)(y.ug)(e,void 0,1)}(i=function(e){return(0,l.WQ)(g.C)(e,void 0,2)}(i=function(e){return(0,l.WQ)(A.a8)(e,void 0,3)}((P=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[void 0===b.P?Object:b.P,void 0===u.E?Object:u.E,void 0===g.Q?Object:g.Q,void 0===A.a8?Object:A.a8,void 0===_.I?Object:_.I])(i=class{constructor(e,t,r,i,s){(0,n.A)(this,"onCloneFinished",new o.B),(0,n.A)(this,"cloneFinished$",this.onCloneFinished.asObservable()),this.projectBackend=e,this.assetCollect=t,this.projectListeners=r,this.projectSchemaService=i,this.projectUtilsService=s}async createProject(e,t,r){const i=(0,f.lE)(),n=r||await this.getDefaultWorkspace(),o=(0,S.u)();d.z.incrementUserProperty("projects"),this.assetCollect.loadIfNecessary(),await this.generateAndPersistProject(o,e,t,n);const s=(0,f.GU)(i);return(0,h.G7)("editor__consumer_1ds_events")&&d.z.logUserActionEvent("ProjectCreated",{actionType:"Unknown",duration:s.duration}),o}async cloneProject(e,t){const{projectState:r}=await this.projectBackend.fetchProject(e),i={...(0,k.I)(r),name:t??r.name},n=i.id;return(0,h.Us)("ks_pst__load_project_on_copy")?await this.createProjectForState(i):await this.createProjectForState(i,void 0,!1),this.onCloneFinished.next(n),n}async createProjectForState(e,t,r=!0){const i=(0,f.lE)(),n=t||await this.getDefaultWorkspace(),{totalProjectsCreated:o}=this.getUser();d.z.incrementUserProperty("projects"),this.assetCollect.loadIfNecessary();const s={workspace:n};await this.persistAndLoadProject(e,s,o+1,r);const a=(0,f.GU)(i);return(0,h.G7)("editor__consumer_1ds_events")&&d.z.logUserActionEvent("ProjectCreated",{actionType:"Unknown",duration:a.duration}),e.id}createProjectAndLoadContent$(e,t,r){return(r?(0,s.of)(r):(0,a.H)(this.getDefaultWorkspace())).pipe((0,c.Z)((r=>(0,a.H)(this.createProjectAndLoadContentBase$(e,t,r)))))}getUser(){return(0,T.sw)((0,I.wz)(),"User must be defined when creating a project.")}async getDefaultWorkspace(){try{return(0,R.uA)()}catch(e){throw e instanceof Error&&m.Vy.error(`Cannot resolve default workspace, received error: ${e.toString()}`),e}}async generateProject(e,t,r){return await this.projectSchemaService.createEmptyProjectSchema(t,{id:e,aspectRatio:r})}createProjectAndLoadContentBase$(e,t,r){const i=(0,S.u)();return d.z.incrementUserProperty("projects"),this.assetCollect.loadIfNecessary().then((()=>this.generateAndPersistProject(i,e,t,r))).then((()=>i))}async generateAndPersistProject(e,t,r,i){try{const{apiKey:n,totalProjectsCreated:o}=this.getUser(),s=o+1,a={workspace:i,ownerId:n,userId:n},c=await this.generateProject(e,t,r);await this.persistAndLoadProject(c,a,s),(0,w.tu)().navigate((0,E.v)({pathname:(0,C._G)(e)}))}catch(e){throw e instanceof Error&&m.Vy.error(`Cannot create project in workspace, received error: ${e.toString()}`),e}}async persistAndLoadProject(e,t,r,i=!0){try{await this.projectBackend.createProject({projectState:e,storageOptions:t}),i&&await this.loadProject(e,t,r)}catch(e){throw e instanceof Error&&this.handleCreateError(e),e}}async loadProject(e,t,r){await this.projectListeners.closeProject(!1),(0,x.eU)(),(0,x.od)({...e,projectNumber:r}),void 0===t.workspace&&m.Vy.error(new Error("Workspace is undefined on persist")),(0,I.o3)(t.workspace),(0,x.I8)("overwrite")}handleCreateError(e){if(e instanceof v.j$){let t=e.message;void 0!==e.context&&"string"==typeof e.context["body.error_code"]&&(t=e.context["body.error_code"]),d.z.logEvent("Sync - Project Create Error",{error:t,reason:e.response.statusText,statusCode:e.response.status,errorType:"HTTP"})}else e instanceof v.Dr?d.z.logEvent("Sync - Project Create Error",{error:e.message,reason:e?.context?.reason,errorType:"Network"}):d.z.logEvent("Sync - Project Create Error",{error:e.message,errorType:"Catch"})}})||i)||i,i=(0,l.WQ)(_.I)(P,void 0,4)||i))||i)||i)||i)||i)||i;var P;function L(){return(0,p.l)(F)}},236229:(e,t,r)=>{r.d(t,{b:()=>a}),r(379321);var i=r(20431);const n="https://api.dropboxapi.com",o="https://content.dropboxapi.com",s=157286400;class a extends i.n{constructor(e){super(e,"dropbox")}async fetchUserInfo(){const e=await this.requestWithRetry({endpoint:`${n}/2/users/get_current_account`,options:{method:"POST"}});return[{email:e.email,profilePicSrc:e.profile_photo_url}]}async listFolderOnly(e){return this.listFolder(e,(e=>e.filter((e=>"folder"===e[".tag"]))))}async listFolderAndFile(e,t){return this.listFolder(e,(e=>t?e.filter((e=>{if("folder"===e[".tag"])return e;{const r=e.name.toLowerCase().split(".").pop();return t.includes(r)}})):e))}async getThumbnails(e){const t=Array.from({length:Math.ceil(e.length/25)},(()=>[]));e.forEach(((e,r)=>{const i=Math.floor(r/25);t[i].push(e)}));const r=t.map((e=>this.post({endpoint:`${o}/2/files/get_thumbnail_batch`,options:{body:JSON.stringify({entries:e.map((e=>({path:e})))})}})));return(await Promise.all(r)).reduce(((e,{entries:t})=>(t.forEach((t=>{"success"===t[".tag"]&&(e[t.metadata.id]=t.thumbnail)})),e)),{})}async uploadFile(e,t,r){const i=`${t}/${e}`;let n;return n=r.size>s?await this.uploadLargeFile(i,r):await this.uploadSmallFile(i,r),n}async createSharedLink(e){return this.post({endpoint:`${n}/2/sharing/create_shared_link_with_settings`,options:{body:JSON.stringify({path:e,settings:{requested_visibility:"public",audience:"no_one",access:"viewer"}})}})}fetchFileDetails(e){return this.post({endpoint:`${n}/2/files/get_metadata`,options:{headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e})}})}async listFolder(e="",t=e=>e){let{entries:r,cursor:i,has_more:o}=await this.post({endpoint:`${n}/2/files/list_folder`,options:{body:JSON.stringify({path:e,include_non_downloadable_files:!1})}});for(;o;){const e=await this.post({endpoint:`${n}/2/files/list_folder/continue`,options:{body:JSON.stringify({cursor:i})}});r=r.concat(e.entries),i=e.cursor,o=e.has_more}const s=t(r),a=s.filter((({".tag":e})=>"file"===e)).map((({id:e})=>e)),c=await this.getThumbnails(a);return s.map((e=>"folder"===e[".tag"]?e:{...e,thumbnailUrl:c[e.id]})).sort(((e,t)=>t[".tag"].localeCompare(e[".tag"])||e.name.localeCompare(t.name)))}async uploadSmallFile(e,t){return this.post({endpoint:`${o}/2/files/upload`,options:{headers:{"Dropbox-API-Arg":JSON.stringify({path:e,mode:"add",autorename:!0}),"Content-Type":"application/octet-stream"},body:t}})}async uploadLargeFile(e,t){const{session_id:r}=await this.post({endpoint:`${o}/2/files/upload_session/start`,options:{headers:{"Dropbox-API-Arg":JSON.stringify({close:!1}),"Content-Type":"application/octet-stream"}}});for(let e=0;e<t.size;e+=s){const i=t.slice(e,e+s);await this.post({endpoint:`${o}/2/files/upload_session/append_v2`,options:{headers:{"Dropbox-API-Arg":JSON.stringify({cursor:{session_id:r,offset:e},close:!1}),"Content-Type":"application/octet-stream"},body:i}})}return this.post({endpoint:`${o}/2/files/upload_session/finish`,options:{headers:{"Dropbox-API-Arg":JSON.stringify({cursor:{session_id:r,offset:t.size},commit:{path:e,mode:"add",autorename:!0}}),"Content-Type":"application/octet-stream"}}})}async post({endpoint:e,options:{headers:t,...r}={}}){return this.requestWithRetry({endpoint:e,options:{...r,method:"POST",headers:{"Content-Type":"application/json",...t}}})}async request({endpoint:e,retried:t,options:{headers:r={},...i}={}}){return"Dropbox-API-Arg"in r&&(r["Dropbox-API-Arg"]=r["Dropbox-API-Arg"].replaceAll(/[\u007f-\uffff]/g,(e=>String.raw`\u`+("000"+e.charCodeAt(0).toString(16)).slice(-4)))),super.request({endpoint:e,retried:t,options:{...i,headers:r}})}}},902131:(e,t,r)=>{r.d(t,{N:()=>o});var i=r(384259);const n="https://photoslibrary.googleapis.com";class o extends i.e{constructor(e){super(e,"google_photos")}async listAlbums({paginationToken:e}){const t={pageSize:"25"};return e&&(t.pageToken=e),this.get({endpoint:`${n}/v1/albums`,options:{params:t}})}async listMediaItems(e){let t={albumId:void 0,filters:void 0};const r={pageSize:"25"};if(e.paginationToken&&(r.pageToken=e.paginationToken),e.albumId)t={...t,albumId:e.albumId};else{if(!e.filters)return this.get({endpoint:`${n}/v1/mediaItems`,options:{params:r}});t={...t,filters:{}},e.filters.mediaTypes&&(t.filters.mediaTypeFilter={mediaTypes:e.filters.mediaTypes}),e.filters.dateRange&&(t.filters.dateFilter={ranges:[{startDate:e.filters.dateRange[0],endDate:e.filters.dateRange[1]}]})}return this.post({endpoint:`${n}/v1/mediaItems:search`,options:{body:JSON.stringify(t),params:r}})}async getMediaItem(e){return this.get({endpoint:`${n}/v1/mediaItems/${e}`})}async get({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"GET"}})}async post({endpoint:e,options:t}){let r=t?.headers??{};return r={"Content-Type":"application/json",...r},this.requestWithRetry({endpoint:e,options:{...t,headers:r,method:"POST"}})}}},384259:(e,t,r)=>{r.d(t,{e:()=>n});var i=r(20431);class n extends i.n{async fetchUserInfo(){const e=await this.requestWithRetry({endpoint:"https://www.googleapis.com/oauth2/v2/userinfo?fields=id,email,name,picture",options:{method:"GET"}});return[{email:e.email,profilePicSrc:e.picture}]}}},271498:(e,t,r)=>{r.d(t,{P:()=>x});var i=r(742683),n=r.n(i),o=r(559755),s=r(20431),a=r(488630),c=r(122294),l=r(917218),d=r(256660),u=r(175358);class h extends Error{}class p extends h{constructor(e,t){super((0,u.mj)("export.tiktok.unknownTikTokError","TikTok is currently experiencing an error.")),this.detail=e,this.subject=t}}class m extends c.aW{constructor(e,t){super(e,{reason:t,message:e}),this.reason=t}}class f extends c.aW{constructor(e){super((0,u.mj)("export.tiktok.unknownTikTokError","TikTok is currently experiencing an error."),e)}}var g=r(776016);const A=Object.values({ACCESS_TOKEN_INVALID:"access_token_invalid",INTERNAL_ERROR:"internal_error",INVALID_FILE_UPLOAD:"invalid_file_upload",INVALID_PARAMS:"invalid_params",RATE_LIMIT_EXCEEDED:"rate_limit_exceeded",SCOPE_NOT_AUTHORIZED:"scope_not_authorized",SCOPE_PERMISSION_MISSED:"scope_permission_missed",SPAM_RISK_TOO_MANY_PENDING_SHARE:"spam_risk_too_many_pending_share",INVALID_PARAM:"invalid_param",URL_OWNERSHIP_UNVERIFIED:"url_ownership_unverified"}),v=(0,g.u)(...A),y=(0,g.t9)({code:v,message:g.Kg,log_id:g.Kg}),b=(0,g.t9)({data:g.Gv,error:y}),w=5242880;class x extends s.n{constructor(e){super(e,"tiktok")}async fetchUserInfo(){return(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:e})=>{try{const t=await this.request({endpoint:"user/info/?fields=avatar_large_url,avatar_url,display_name,display_name",options:{method:"GET"},retried:e});return b(t)?this.handleFailedResponse(t):[{email:t.data.user.display_name,profilePicSrc:t.data.user.avatar_large_url}]}catch(e){return this.handleUserInfoError(e,b,this.handleFailedResponse)}}))()}async fetchUploadUrl(e,t,r){try{return await(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({file:e,retried:i})=>{const n=await this.request({endpoint:"post/publish/inbox/video/init/",retried:i,options:{method:"POST",body:JSON.stringify({source_info:{source:"FILE_UPLOAD",video_size:e.size,chunk_size:t,total_chunk_count:r}})}});return b(n)?this.handleFailedResponse(n):n.data}))({file:e})}catch(e){throw await this.handleTikTokUploadError(e)}}async uploadSmallFile(e){const{upload_url:t}=await this.fetchUploadUrl(e,e.size,1);try{await(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({file:e,retried:r})=>{const i=await this.getIntegration(r),n=o.j.getToken();return super.request({endpoint:`${d.s}/${t}`,retried:r,options:{method:"PUT",headers:{"x-clipchamp-authorization":`Bearer ${n}`,Authorization:`Bearer ${i.accessToken}`,"Content-Type":"video/mp4","Content-Range":`bytes 0-${e.size-1}/${e.size}`},body:e}})}))({file:e,upload_url:t})}catch(e){throw await this.handleTikTokUploadError(e)}}async uploadLargeFile(e){const t=Math.floor(e.size/w),{upload_url:r}=await this.fetchUploadUrl(e,w,t);try{await(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({file:e,retried:i})=>{const n=o.j.getToken(),s=await this.getIntegration(i);let a;for(let o=0;o<t;o++){const c=o*w,l=t-1===o||1===t?e.size:Math.min((o+1)*w,e.size),u=e.slice(c,l);a=await super.request({endpoint:`${d.s}/${r}`,retried:i,options:{method:"PUT",headers:{"x-clipchamp-authorization":`Bearer ${n}`,Authorization:`Bearer ${s.accessToken}`,"Content-Type":"video/mp4","Content-Range":`bytes ${c}-${l-1}/${e.size}`},body:u}})}return a}))({file:e,upload_url:r})}catch(e){throw await this.handleTikTokUploadError(e)}}async uploadFile(e){return e.size>10485760?await this.uploadLargeFile(e):await this.uploadSmallFile(e)}async request({endpoint:e,options:t,retried:r}){e.startsWith("/")||(e=`/${e}`);const i=await this.getIntegration(r),n=o.j.getToken(),{params:s={},...a}=t??{},c={...s};return super.request({endpoint:`${d.s}/https://open.tiktokapis.com/v2${e}`,options:{...a,params:c,headers:{"x-clipchamp-authorization":`Bearer ${n}`,Authorization:`Bearer ${i.accessToken}`}},retried:r})}async handleTikTokUploadError(e){if(!(e instanceof Error))return new f({reason:typeof e,message:"Error of unknown type was captured"});if(!(e instanceof a.f))return"AbortError"===e.name?new c.UE("tiktok"):new f({reason:"UNKNOWN_TIKTOK_ERROR",message:"Error response is not a failed TikTok response"});try{const t=await e.response.json();if(b(t)){const{error:{code:r,message:i}}=t;return new f({httpResponseCode:e.response.status,reason:r,message:i})}return new f({reason:t.error?.code??e.response.statusText,httpResponseCode:e.response.status,message:t.message??JSON.stringify(t)})}catch{return new f({httpResponseCode:e.response.status,reason:e.response.statusText,message:"Could not convert Tiktok upload response to json"})}}async handleUserInfoError(e,t,r){if(e instanceof h)throw e;if(!(e instanceof Error))throw new p("Error of unknown type was captured",{payload:n()(e),type:typeof e,context:e});if(!(e instanceof a.f))throw new p("An error other than FetchError was captured",{payload:e.message,type:e.name,context:e});return this.deserializeErrorResponse(e,t,r)}async deserializeErrorResponse(e,t,r){try{const i=await e.response.json();if(!t(i))throw new p("Error response is not a failed TikTok response",{payload:JSON.stringify(i),context:i});return r(i)}catch(t){if(t instanceof h)throw t;throw new p("Failed to parse error response, response is not a valid JSON",{payload:await e.response.text(),type:e.response.headers.get("Content-Type")??void 0,context:e.response})}}handleFailedResponse(e){throw new m(e.error.message,e.error.code)}}},435715:(e,t,r)=>{r.d(t,{Z:()=>v,O:()=>b}),r(379321);var i=r(969442),n=r(197761),o=r(515956),s=r(825702),a=r(594012),c=r(138615),l=r(739367),d=r(700227),u=r(474107),h=r(345153);const p=["audio","video","title","logo","watermark","caption"];var m,f=r(776016),g=r(484331),A=r(945897);let v=(0,s.Gr)()(m=function(e){return(0,s.WQ)(a.x)(e,void 0,0)}(m=function(e){return(0,s.WQ)(A.Z)(e,void 0,1)}((y=m=Reflect.metadata("design:type",Function)(m=Reflect.metadata("design:paramtypes",[void 0===a.x?Object:a.x,void 0===A.Z?Object:A.Z,void 0===u.T?Object:u.T])(m=class{constructor(e,t,r){this.remoteAssetImport=e,this.projectCreator=t,this.project=r}async createBootstrappedProjectWithLazyAssets(e){this.toggleLoading(!0);const t=await e;this.toggleLoading(!1),await this.createBootstrappedProjectWithAssets(t)}async createBootstrappedProjectWithAssets(e,t=!0){const r=i.Ay.t(g.u),s=!0===(0,c.gZ)("editor__edit_with_behaviour",f.Lm);return new Promise(((i,a)=>{this.projectCreator.createProject(r,g.X).then((r=>{(0,h.sl)((e=>e?.id)).pipe((0,n.p)((e=>e===r)),(0,n.p)(f.O9),(0,o.s)(1)).subscribe((async r=>{const n=await this.fetchAssets(r,e);s&&!t||this.addAssetsToTimeline(n),i()}))})).catch(a)}))}async fetchAssets(e,t){return new Promise((r=>{if(1===t.length){const i=t[0];return void this.remoteAssetImport.importRemoteAsset(e,i).then((e=>{r(e?[e]:[])})).catch((()=>{r([])}))}r([]);const i=t.map((t=>this.remoteAssetImport.importRemoteAsset(e,t)));Promise.all(i).catch((()=>{}))}))}addAssetsToTimeline(e){0!==e.length&&this.project.update((t=>{const r=e.reduce(((e,r)=>{const i=t.getAssetUnchecked(r.id);return i.trackType?(e[i.trackType]||(e[i.trackType]=[]),e[i.trackType].push(i),e):e}),{});Object.entries(r).forEach((([e,r])=>{if(!(e=>{for(const t of p)if(e===t)return!0;return!1})(e))return;if(!r?.length)return;const i=t.createTrack(e);r.forEach((e=>{i.createItem(e,t.aspectRatio)}))}))}))}toggleLoading(e){e?(0,d.S)({status:"show"}):(0,d.S)({status:"hide"})}})||m)||m,m=(0,s.WQ)(u.T)(y,void 0,2)||m))||m)||m)||m;var y;function b(){return(0,l.l)(v)}},212984:(e,t,r)=>{r.d(t,{Pk:()=>h,G5:()=>p,LO:()=>u}),r(584570),r(82265),r(988124);var i=r(959763),n=r(831123),o=r(842880),s=r(515207),a=r(673101),c=r(396159);const l=["content","state","file_id"],d=(0,n.vt)((e=>({queryParams:new Map,setQueryParams:t=>e({queryParams:t}),deleteQueryParam:t=>e((0,i.jM)((e=>{e.queryParams.delete(t)})))}))),u=()=>{const e=(0,o.tu)().state.location,t=new URLSearchParams(e.search),r=new Map;for(const e of l){const i=t.get(e);i&&r.set(e,i)}void 0!==r.keys().next().value&&d.getState().setQueryParams(r)},h=e=>{d.getState().deleteQueryParam(e)},p=e=>(t=>new s.c((e=>{e.next(t.getState());const r=t.subscribe((t=>e.next(t)));return()=>r()})).pipe((0,a.T)((t=>{if(t.queryParams.has(e)){const t=(0,o.tu)(),r=new URLSearchParams(t.state.location.search);r.has(e)&&r.delete(e),t.navigate({search:r.toString()})}return t.queryParams.get(e)})),(0,c.F)()))(d)},981680:(e,t,r)=>{r.d(t,{H:()=>i,v:()=>n});const i="projectResolutionStrategy";class n{}},540636:(e,t,r)=>{r.d(t,{MZ:()=>p,Sq:()=>h,yC:()=>d}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(596254),n=r(529527),o=r(751108),s=r(776016);const a="US",c=(0,s.t9)({country_code:(0,s.H7)((0,s.gH)(s.Kg))}),l=new Set(["AX","AL","AD","AT","BY","BE","BA","BG","HR","CZ","DK","EE","FO","FI","FR","DE","GI","GR","GG","VA","HU","IS","IE","IM","IT","JE","LV","LI","LT","LU","MT","MD","MC","ME","NL","MK","NO","PL","PT","RO","RU","SM","RS","SK","SI","ES","SJ","SE","CH","UA","GB"]);function d(e){return l.has(e)}async function u(){const e=await fetch(`${n.T.apiBaseUrl}/location`,{headers:{"Content-Type":"application/json"},credentials:"same-origin"}),t=await e.json();if(c(t))return{countryCode:t.country_code??a};throw new Error("Cannot fetch location")}function h(){return(0,o.SX)().ensureQueryData(["location"],u)}function p(){return(0,i.I)(["location"],u)}},163708:(e,t,r)=>{function i(){return"/editor"}function n(e){return`/editor/${e}`}function o(){return"/editor/new"}r.d(t,{Bs:()=>o,_G:()=>n,bB:()=>s,pF:()=>i});const s={getProjectUrl:e=>n(e),getExportUrl:e=>function(e){return`/editor/${e}/export`}(e),getNewUrl:o}},981131:(e,t,r)=>{r.d(t,{G:()=>o}),r(379321),r(584570),r(82265),r(988124);var i=r(20431),n=r(175358);class o extends i.n{constructor(e){super(e,"box")}async fetchUserInfo(){const e=await this.get({endpoint:"/users/me"});return[{email:e.login,profilePicSrc:e.avatar_url}]}async listFolders(e){try{return(await this.get({endpoint:`/folders/${e}/items?fields=id,name,type,size,extension,representations`})).entries.filter((e=>"folder"===e.type)).map((({name:e,id:t,type:r})=>({type:r,id:t,name:e,selectable:!1})))}catch(e){throw new Error((0,n.mj)("export.box.listFoldersError","Failed to list Box folders"))}}async listFilesAndFolders(e,t){try{const r=[],i=[],n=[];(await this.get({endpoint:`/folders/${e}/items?fields=id,name,type,size,extension,representations`,options:{headers:{"x-rep-hints":"[jpg?dimensions=94x94]"}}})).entries.forEach((e=>{const{type:o,id:s,name:a,size:c,representations:l,extension:d}=e;"folder"===o&&r.push({type:o,id:s,name:a,selectable:!1}),"file"===o&&t.includes(d)&&c>0&&(l?n.push(this.enrichFileInfoWithThumbnail(e)):i.push({type:o,id:s,name:a,size:c,selectable:!0}))}));const o=await Promise.all(n);return[...r,...i,...o]}catch(e){throw new Error((0,n.mj)("export.box.listFilesAndFoldersError","Failed to list Box files and folders"))}}async enrichFileInfoWithThumbnail(e){let t;try{const r=await this.requestWithRetryReturnRaw({endpoint:e.representations.entries[0].content.url_template.replace("{+asset_path}","")}),i=await r.blob();t=URL.createObjectURL(i)}catch(e){}return{type:e.type,id:e.id,name:e.name,size:e.size,selectable:"file"===e.type,thumbnailUrl:t||void 0}}async get({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"GET"}})}async request({endpoint:e,options:t,retried:r}){return e.startsWith("https")||(e=`https://api.box.com/2.0${e}`),super.request({endpoint:e,options:t,retried:r})}}},28593:(e,t,r)=>{r.d(t,{l:()=>R});var i=r(811438),n=r(954251),o=r(549281),s=r(686808),a=r(20431),c=r(488630),l=r(917218),d=r(175358);class u extends Error{}const h=(0,d.mj)("export.instagram.unknownInstagramError","Instagram is currently experiencing an unexpected error.");class p extends u{constructor(){super((0,d.mj)("export.instagram.fetchInstaAccountsError","Unable to fetch any user accounts for Instagram."))}}class m extends u{constructor(){super((0,d.mj)("export.instagram.fetchInstaAccountsInfoError","Unable to fetch any profile information for Instagram accounts."))}}class f extends u{constructor(){super((0,d.mj)("export.instagram.createMediaError","Unable to create media for Instagram."))}}class g extends u{constructor(){super((0,d.mj)("export.instagram.fetchQuotaError","Unable to fetch user publish quota for Instagram."))}}class A extends u{constructor(){super((0,d.mj)("export.instagram.publishError","An error occured while publishing to Instagram."))}}var v=r(122294),y=r(776016);const b=(0,y.t9)({name:y.Kg,id:y.Kg}),w=(0,y.t9)({data:(0,y._j)(b)}),x=(0,y.t9)({instagram_business_account:(0,y.t9)({id:y.Kg}),id:y.Kg}),S=(0,y.t9)({username:y.Kg,profile_picture_url:y.Kg,id:y.Kg}),T=(0,y.t9)({id:y.Kg}),C=(0,y.t9)({config:(0,y.t9)({quota_total:y.Et}),quota_usage:y.Et}),_=(0,y.t9)({data:(0,y._j)(C)}),k=(0,y.t9)({permalink:y.Kg,id:y.Kg}),E=(0,y.t9)({error:(0,y.t9)({message:y.Kg,type:y.Kg,code:y.Et,error_subcode:y.Et,is_transient:y.Lm,error_user_title:y.Kg,error_user_msg:y.Kg,fbtrace_id:y.Kg})});class I{async parseError(e,t){if(e instanceof v.QV)return e;if(e instanceof c.f)try{const r=await e.response.json();return E(r)?new v.QV(h,{reason:r.error.error_subcode,httpResponseCode:e.response.status,message:r.error.message,statusText:e.response.statusText,...t}):new v.QV(h,{reason:v.ng.ComplianceOmitted,httpResponseCode:e.response.status,message:"There was a json error present on the response, but cannot be logged for compliance reasons",statusText:e.response.statusText,...t})}catch{try{return await e.response.text(),new v.QV(h,{reason:v.ng.ComplianceOmitted,httpResponseCode:e.response.status,message:"There was a text error present on the response, but cannot be logged for compliance reasons",statusText:e.response.statusText,...t})}catch{return new v.QV(h,{reason:v.ng.ComplianceOmitted,httpResponseCode:e.response.status,message:`Response body is neither text or json, content type: ${e.response.headers.get("Content-Type")??void 0}`,statusText:e.response.statusText,...t})}}return e instanceof u?new v.QV(h,{reason:v.ng.GeneralError,message:e.message,...t}):e instanceof Error?new v.QV(h,{reason:v.ng.GeneralError,message:"Error is an error object but cannot be logged for compliance reasons",...t}):new v.QV(h,{reason:v.ng.GeneralError,message:"Error is neither a response or error object, error object: "+typeof e,...t})}}class R extends a.n{async fetchUserInfo(){return(await this.fetchInstagramAccounts()).map((e=>({email:e.username,profilePicSrc:e.profile_picture_url,extras:{id:e.id}})))}constructor(e){super(e,"instagram",new I)}async fetchInstagramAccounts(){const e=await this.fetchMetaAccounts(),t=(await Promise.all(e.data.map((e=>this.fetchInstagramBusinessAccountId(e.id))))).filter(x);return(await Promise.all(t.map((e=>this.fetchIGUserAccountInfo(e.instagram_business_account.id))))).filter(S)}async createMediaContainer(e,t,r,i){return(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:n})=>{const o=new FormData;o.append("media_type",i),o.append("video_url",r),o.append("caption",t);try{const t=await this.request({endpoint:`${e}/media`,retried:n,options:{method:"POST",body:o}});if(!T(t))throw await this.handleExportError(new f,{endpoint:"create_media_container"});return t}catch(e){throw await this.handleExportError(e,{endpoint:"create_media_container"})}}))({igUserId:e,caption:t,videoUrl:r})}async publishMediaContainer(e,t){return(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:r})=>{try{const i=await this.request({endpoint:`${e}/media_publish`,retried:r,options:{method:"POST",params:{creation_id:t}}});if(!T(i))throw await this.handleExportError(new A,{endpoint:"publish_media_container"});return i}catch(e){throw await this.handleExportError(e,{endpoint:"publish_media_container"})}}))({igUserId:e,creationId:t})}async getPemalinkForPost(e){return(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:t})=>{try{const r=await this.request({endpoint:e,retried:t,options:{method:"GET",params:{fields:"permalink"}}});if(!k(r))throw await this.handleExportError(new A,{endpoint:"get_perma_link"});return r}catch(e){throw await this.handleExportError(e,{endpoint:"get_perma_link"})}}))({postId:e})}async checkUserPublishLimit(e){return(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:t})=>{try{const r=await this.request({endpoint:`${e}/content_publishing_limit`,retried:t,options:{method:"GET",params:{fields:"config,quota_usage"}}});if(!_(r))throw await this.handleExportError(new g,{endpoint:"content_publish_limit"});return r}catch(e){throw await this.handleExportError(e,{endpoint:"content_publish_limit"})}}))({igUserId:e})}async getMediaContainerStatus(e){return await this.request({endpoint:`${e}`,retried:!1,options:{method:"GET",params:{fields:"status_code"}}})}async pollUploadStatus(e){const t=(0,i.of)({}).pipe((0,n.Z)((()=>this.getMediaContainerStatus(e))),(0,o.c)(5e3),(0,s.u)());return await new Promise((e=>{const r=t.subscribe((t=>{"FINISHED"!==t.status_code&&"ERROR"!==t.status_code||(r.unsubscribe(),e(t.status_code))}))}))}async fetchIGUserAccountInfo(e){return(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:t})=>{try{const r=await this.request({endpoint:e,retried:t,options:{method:"GET",params:{fields:"username,profile_picture_url"}}});if(!S(r))throw await this.handleExportError(new m,{endpoint:"fetch_ig_account_info"});return r}catch(e){throw await this.handleExportError(e,{endpoint:"fetch_ig_account_info"})}}))({igUserId:e})}async fetchInstagramBusinessAccountId(e){return(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:t})=>{try{const r=await this.request({endpoint:e,retried:t,options:{method:"GET",params:{fields:"instagram_business_account"}}});if(!x(r))return;return r}catch(e){throw await this.handleExportError(e,{endpoint:"fetch_ig_account_id"})}}))({pageId:e})}async fetchMetaAccounts(){return(0,l.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:e})=>{try{const t=await this.request({endpoint:"me/accounts",retried:e,options:{method:"GET",params:{fields:"name,id"}}});if(!w(t))throw await this.handleExportError(new p,{endpoint:"fetch_meta_accounts"});return t}catch(e){throw await this.handleExportError(e,{endpoint:"fetch_meta_accounts"})}}))()}async request({endpoint:e,retried:t,options:{params:r,...i}={}}){const n=await this.getIntegration(t),o=this.constructQuery({...r,access_token:n.accessToken.token});return this.fetch(`https://graph.facebook.com/v17.0//${e}${o}`,{...i,signal:this.abortController.signal})}fetch(e,t,r){return fetch(e,{...t,headers:{...t?.headers}}).then((e=>e.status>=400?Promise.reject(new c.f((0,d.mj)("export.pickerTable.generalError","Bad response from server"),e)):204!==e.status?r?e:e.json():void 0))}}},962097:(e,t,r)=>{r.d(t,{B:()=>y});var i,n,o,s,a=r(836936),c=(r(379321),r(811438)),l=r(954251),d=r(549281),u=r(686808),h=r(559755),p=r(20431),m=r(488630),f=r(720315),g=r(175358),A=r(256660);const v="https://api.linkedin.com/v2";let y=(i=(0,f.P)({maxAttempts:3,backOffPolicy:"exponential"}),n=Reflect.metadata("design:type",Function),o=Reflect.metadata("design:paramtypes",[String,"undefined"==typeof LinkedinRequestInit?Object:LinkedinRequestInit,void 0]),s=class extends p.n{constructor(e){super(e,"linkedin")}async fetchUserInfo(){const e=await this.getProfile();return[{email:e.name,profilePicSrc:e.picture}]}async getProfile(){const e=await this.get({endpoint:"/me?projection=(id,firstName,lastName,profilePicture(displayImage~digitalmediaAsset:playableStreams))"});return{name:`${e.firstName.localized.en_US} ${e.lastName.localized.en_US}`,picture:e.profilePicture?e.profilePicture["displayImage~"].elements[0].identifiers[0].identifier:void 0}}async getId(){return(await this.get({endpoint:"/me?projection=(id)"})).id}async getUploadUrl(e,t){const r=t<10485760?{registerUploadRequest:{owner:`${this.getOrgUrnFromId(e)}`,recipes:["urn:li:digitalmediaRecipe:feedshare-video"],serviceRelationships:[{identifier:"urn:li:userGeneratedContent",relationshipType:"OWNER"}],supportedUploadMechanism:["SINGLE_REQUEST_UPLOAD"]}}:{registerUploadRequest:{owner:`${this.getOrgUrnFromId(e)}`,recipes:["urn:li:digitalmediaRecipe:feedshare-video"],serviceRelationships:[{identifier:"urn:li:userGeneratedContent",relationshipType:"OWNER"}],supportedUploadMechanism:["MULTIPART_UPLOAD"],fileSize:t}};return this.post({endpoint:"/assets?action=registerUpload",options:{body:JSON.stringify(r)}})}getUrlForPost(e){return`https://www.linkedin.com/feed/update/${e}`}async uploadFile(e,t){if(t.value.uploadMechanism["com.linkedin.digitalmedia.uploading.MediaUploadHttpRequest"])return this.authlessPut(t.value.uploadMechanism["com.linkedin.digitalmedia.uploading.MediaUploadHttpRequest"].uploadUrl,e,t.value.uploadMechanism["com.linkedin.digitalmedia.uploading.MediaUploadHttpRequest"].headers);if(t.value.uploadMechanism["com.linkedin.digitalmedia.uploading.MultipartUpload"]){const r=t.value.uploadMechanism["com.linkedin.digitalmedia.uploading.MultipartUpload"].partUploadRequests,i=t.value.uploadMechanism["com.linkedin.digitalmedia.uploading.MultipartUpload"].metadata,n=await this.uploadChunk(r,e);return this.completeLargeFileUpload({completeMultipartUploadRequest:{mediaArtifact:t.value.mediaArtifact,metadata:i,partUploadResponses:n}})}}async completeLargeFileUpload(e){await this.requestWithRetryReturnRaw({endpoint:"/assets?action=completeMultiPartUpload",options:{body:JSON.stringify(e),method:"POST"}})}async uploadChunk(e,t,r=[]){if(1===e.length){const i=e[0],n=await this.authlessPut(i.url,t.slice(i.byteRange.firstByte,t.size-1),i.headers,!0);return r.push({headers:{ETag:n.headers.get("ETag")||""},httpStatusCode:n.status}),e.shift(),r}{const i=e[0],n=await this.authlessPut(i.url,t.slice(i.byteRange.firstByte,i.byteRange.lastByte+1),i.headers,!0);return r.push({headers:{ETag:n.headers.get("ETag")||""},httpStatusCode:n.status}),e.shift(),this.uploadChunk(e,t,r)}}async getUploadStatus(e){const t=e.split(":").pop();if(void 0!==t)return this.get({endpoint:`/assets/${t}`});throw new Error((0,g.mj)("export.onedrive.noAssetIdError","Get upload status error, no asset ID"))}async pollUploadStatus(e){const t=(0,c.of)({}).pipe((0,l.Z)((()=>this.getUploadStatus(e))),(0,d.c)(5e3),(0,u.u)());return await new Promise(((e,r)=>{const i=t.subscribe((t=>{"AVAILABLE"===t.recipes[0].status&&(i.unsubscribe(),e(t.recipes[0].status)),"SERVER_ERROR"!==t.recipes[0].status&&"CLIENT_ERROR"!==t.recipes[0].status||(i.unsubscribe(),r(t))}))}))}async getPostableUserOrgs(){const e=await this.get({endpoint:"/organizationalEntityAcls?q=roleAssignee&state=APPROVED&projection=(elements*(role,organizationalTarget~(id,localizedName,logoV2(original~:playableStreams))))",options:{headers:{"X-Restli-Protocol-Version":"2.0.0"}}}),t=[];return e.elements.forEach((e=>{"RECRUITING_POSTER"!==e.role&&"ADMINISTRATOR"!==e.role||t.push({id:e["organizationalTarget~"].id,name:e["organizationalTarget~"].localizedName,logo:e["organizationalTarget~"].logoV2["original~"].elements[0].identifiers[0].identifier})})),t}async createPost(e,t,r,i,n){const o={author:`${this.getOrgUrnFromId(n)}`,lifecycleState:"PUBLISHED",specificContent:{"com.linkedin.ugc.ShareContent":{media:[{media:i,status:"READY",title:{attributes:[],text:e}}],shareCommentary:{attributes:[],text:t},shareMediaCategory:"VIDEO"}},visibility:{"com.linkedin.ugc.MemberNetworkVisibility":r.toUpperCase()}};return this.post({endpoint:"/ugcPosts",options:{body:JSON.stringify(o)}})}async post({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"POST"}})}async get({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"GET"}})}async authlessPut(e,t,r={},i){return this.authlessRequest(e,{method:"PUT",headers:r,body:t},i)}async authlessRequest(e,t,r=!1){const i={...t?.headers};return i["x-clipchamp-authorization"]=`Bearer ${h.j.getToken()}`,fetch(`${A.s}/${e}`,{...t,headers:i,signal:this.abortController.signal}).then((e=>{if(e.status>=400)throw new m.f((0,g.mj)("export.pickerTable.generalError","Bad response from server"),e);if(204!==e.status&&201!==e.status)return r?e:e.json()}))}async requestReturnRaw({endpoint:e,retried:t,options:{headers:r={},...i}={}}){return r["x-clipchamp-authorization"]=`Bearer ${h.j.getToken()}`,super.requestReturnRaw({endpoint:`${A.s}/${v}${e}`,retried:t,options:{...i,headers:r}})}async request({endpoint:e,retried:t,options:{headers:r={},...i}={}}){return r["x-clipchamp-authorization"]=`Bearer ${h.j.getToken()}`,super.request({endpoint:`${A.s}/${v}${e}`,retried:t,options:{...i,headers:r}})}getUrnFromId(e){return`urn:li:person:${e}`}getOrgUrnFromId(e){return`urn:li:organization:${e}`}},(0,a.A)(s.prototype,"authlessRequest",[i,n,o],Object.getOwnPropertyDescriptor(s.prototype,"authlessRequest"),s.prototype),s)},880560:(e,t,r)=>{r.d(t,{Q:()=>m});var i=r(559755),n=r(20431),o=r(122294),s=r(488630),a=r(917218),c=r(175358),l=r(256660),d=r(548837);const u=(0,c.mj)("export.xbox.unknownXboxError","Xbox is currently experiencing an unexpected error.");class h{async parseError(e){if(e instanceof o.QV)return e;if(e instanceof s.f)try{return await e.response.json(),new o.QV(u,{reason:o.ng.ComplianceOmitted,httpResponseCode:e.response.status,message:"There was a json error present on the response, but cannot be logged for compliance reasons",statusText:e.response.statusText})}catch{try{return await e.response.text(),new o.QV(u,{reason:o.ng.ComplianceOmitted,httpResponseCode:e.response.status,message:"There was a text error present on the response, but cannot be logged for compliance reasons",statusText:e.response.statusText})}catch{return new o.QV(u,{reason:o.ng.ComplianceOmitted,httpResponseCode:e.response.status,message:`Response body is neither text or json, content type: ${e.response.headers.get("Content-Type")??void 0}`,statusText:e.response.statusText})}}return e instanceof Error?new o.QV(u,{reason:o.ng.GeneralError,message:"Error is an error object but cannot be logged for compliance reasons"}):new o.QV(u,{reason:o.ng.GeneralError,message:"Error is neither a response or error object, error object: "+typeof e})}}var p=r(64406);class m extends n.n{constructor(e){super(e,"xbox",new h)}async fetchUserInfo(){const e=await this.getProfile();return[{email:e.gamertag,profilePicSrc:e.profilePicture}]}async getTokenClaims(e){let t;if(void 0!==e)return t=await this.getIntegration(e),(0,d.PN)(t.accessToken.token);try{t=await this.getIntegration(!1)}catch{t=await this.getIntegration(!0)}return(0,d.PN)(t.accessToken.token)}async getProfile(){const{xid:e,gamertag:t}=await this.getTokenClaims(),r=await(0,a.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:t})=>{try{return await this.request({endpoint:`${l.s}/https://profile.xboxlive.com/users/xuid(${e})/profile/settings?settings=GameDisplayPicRaw,Gamertag`,options:{method:"GET"},retried:t})}catch(e){throw await this.handleImportError(e)}}))({xid:e});if(!(0,p.Nt)(r))throw await this.handleImportError(new o.QV((0,c.mj)("export.xbox.profileRetrieveError","We were not able to successfully retrieve your Xbox network profile"),{reason:"Xbox profile request response did not match the expected schema",message:"Xbox network did not return a user profile"}));const{profileUsers:i}=r,{settings:n}=i[0],s={};return n.forEach((e=>{s[e.id]=e.value})),{gamertag:s.Gamertag||t,profilePicture:s.GameDisplayPicRaw&&(0,d.No)(s.GameDisplayPicRaw)}}async getClipDownloadUri(e){const{xid:t}=await this.getTokenClaims(),r=await(0,a.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:r})=>{try{return await this.request({endpoint:`${l.s}/https://mediahub.xboxlive.com/gameclips/batch`,options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`OwnerXuid eq ${t}`,contentIds:[e]})},retried:r})}catch(e){throw await this.handleImportError(e)}}))({xid:t});if(0===r.values.length)throw await this.handleImportError(new o.QV((0,c.mj)("export.xbox.profileRetrieveClips","We were not able to successfully retrieve your video clips from the Xbox network."),{reason:"No xbox clip locator values were returned",message:"Xbox network did not return any locator values for any clips"}));return r.values[0].contentLocators[0].uri}async downloadClip(e){return await(0,a.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:t})=>{try{return await this.request({endpoint:`${l.s}/${e}`,options:{method:"GET"},retried:t})}catch(e){throw await this.handleImportError(e)}}))()}async getClips(e){const{xid:t}=await this.getTokenClaims(),r=await(0,a.b)({maxAttempts:3,backOffPolicy:"exponential"})((async({retried:r})=>{try{return await this.request({endpoint:`${l.s}/https://mediahub.xboxlive.com/gameclips/search`,options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`OwnerXuid eq ${t}`,skip:0,maxPageSize:20,orderBy:[{}],continuationToken:e})},retried:r})}catch(e){throw await this.handleImportError(e)}}))({xid:t});if(0===r.values.length)return{clips:[]};const i=r.values.map((({contentId:e,contentLocators:t,titleName:r,uploadDate:i,durationInSeconds:n})=>{const o={contentId:e,titleName:r,uploadDate:new Date(i),durationInSeconds:n};return t.forEach((e=>{"Download"!==e.locatorType?"Thumbnail_Small"!==e.locatorType?"Thumbnail_Large"===e.locatorType&&(o.thumbnailLarge=e.uri):o.thumbnailSmall=e.uri:o.downloadUrl=e.uri})),o}));return{continuationToken:r.continuationToken,clips:i}}async request({endpoint:e,retried:t,options:{params:r,...n}={}}){const o=this.constructQuery(r),s=i.j.getToken(),{accessToken:a,uhs:c}=await this.getTokenClaims(t);return this.fetch(`${e}${o}`,{...n,headers:{...n.headers,"x-clipchamp-authorization":`Bearer ${s}`,Authorization:`XBL3.0 x=${c};${a}`,"x-xbl-contract-version":"3"},signal:this.abortController.signal})}fetch(e,t,r){return fetch(e,{...t,headers:{...t?.headers}}).then((e=>e.status>=400?Promise.reject(new s.f((0,c.mj)("export.pickerTable.generalError","Bad response from server"),e)):204!==e.status?r?e:e.json():void 0))}}},64406:(e,t,r)=>{r.d(t,{Mi:()=>a,Nt:()=>d});var i=r(776016);const n=(0,i.t9)({gtg:i.Kg,xid:i.Kg,uhs:i.Kg}),o=(0,i.t9)({xui:(0,i._j)(n)}),s=(0,i.t9)({Item1:i.Kg,Item2:(0,i.t9)({DisplayClaims:o,Token:i.Kg})}),a=(0,i._j)(s),c=(0,i.t9)({id:(0,i.u)("GameDisplayPicRaw","Gamertag"),value:i.Kg}),l=(0,i.t9)({id:i.Kg,hostId:i.Kg,settings:(0,i._j)(c),isSponsoredUser:i.Lm}),d=(0,i.t9)({profileUsers:(0,i._j)(l)}),u=(0,i.u)("Download","Thumbnail_Small","Thumbnail_Large"),h=(0,i.t9)({expiration:(0,i.H7)(i.Kg),fileSize:(0,i.H7)(i.Et),locatorType:u,uri:i.Kg}),p=(0,i.t9)({recordDate:i.Kg,durationInSeconds:i.Et,secondaryTitleId:(0,i.H7)(i.Kg)}),m=(0,i.t9)({contentId:i.Kg,contentLocators:(0,i._j)(h),contentSegments:(0,i._j)(p),durationInSeconds:i.Et,frameRate:i.Et,resolutionHeight:i.Et,resolutionWidth:i.Et,titleName:i.Kg,titleId:i.Et,uploadDate:i.Kg});(0,i.t9)({continuationToken:(0,i.H7)(i.Kg),values:(0,i._j)(m)})},548837:(e,t,r)=>{r.d(t,{No:()=>o,PN:()=>n,wk:()=>s}),r(95732),r(584570),r(82265),r(988124);var i=r(64406);const n=e=>{const t=(e=>{try{const t=atob(e),r=JSON.parse(t);if(!(0,i.Mi)(r))throw new Error("claims do match the expected pattern");return r}catch{throw new Error("Error occured while deserializing claims")}})(e);if(0===t.length||void 0===t[0].Item2)throw new Error("No Display Claims on token");if(!t[0].Item2.Token)throw new Error("Could not get access token from Display Claims");if(0===t[0].Item2.DisplayClaims.xui.length)throw new Error("No xui data in display claim");const{gtg:r,xid:n,uhs:o}=t[0].Item2.DisplayClaims.xui[0];if(!r||!n||!o)throw new Error(`Missing xui vaules gtg: ${r}, xid: ${n}, uhs: ${o}`);return{accessToken:t[0].Item2.Token,gamertag:r,xid:n,uhs:o}},o=e=>{const t=new URL(e);return t.searchParams.delete("background"),t.searchParams.delete("mode"),t.toString()},s=e=>e?e.clips.map((e=>({id:e.contentId,name:e.titleName,type:"VIDEO",thumbnailUrl:e.thumbnailSmall??"",date:e.uploadDate,duration:e.durationInSeconds,previewUrl:e.downloadUrl,height:e.resolutionHeight,width:e.resolutionWidth}))):[]},159614:(e,t,r)=>{r.d(t,{bg:()=>y,Ns:()=>A}),r(379321);var i=r(562229),n=r(488630),o=r(20431),s=r(776016),a=r(122294),c=r(175358);r(650882).g9;const l=(0,s.t9)({code:s.Kg,message:s.Kg}),d=(0,s.t9)({error:l}),u=(0,c.mj)("export.onedrive.unknownOneDriveError","Failed to upload to OneDrive"),h="A fetch error occurred with OneDrive",p="OTHER_ERR",m="PARSE_JSON_ERR";class f{async parseError(e){if(e instanceof a.QV)return e;if(e instanceof n.f)try{const t=await e.response.json(),r=e.response.url.includes("createUploadSession")?"createUploadSession":"upload";if(d(t)){const i=t.error.code,n=t.error.innererror?.code??h;return new a.aW(u,{httpResponseCode:e.response.status,message:n,reason:i,endpoint:r,statusText:e.response.statusText})}return new a.aW(u,{httpResponseCode:e.response.status,message:h,reason:t.error?.code??"UNKNOWN_ONEDRIVE_ERROR",endpoint:r,statusText:e.response.statusText})}catch{try{return await e.response.text(),new a.aW(u,{reason:m,httpResponseCode:e.response.status,message:"There was a text based response present on the error response, but cannot be logged for compliance reasons",statusText:e.response.statusText})}catch{return new a.aW(u,{reason:m,httpResponseCode:e.response.status,message:`Response body is neither text or json, content type: ${e.response.headers.get("Content-Type")??void 0}`,statusText:e.response.statusText})}}return e instanceof Error?"AbortError"===e.name?new a.UE("onedrive1p"):e instanceof TypeError?new a.aW(u,{reason:"TYPE_ERR",message:"Error is a TypeError"}):new a.aW(u,{reason:p,message:"Error is an error object but cannot be logged for compliance reasons"}):new a.aW(u,{reason:p,message:"Error is neither a response or error object, error object: "+typeof e})}}const g=(0,s.t9)({code:s.Kg,message:s.Kg,innererror:(0,s.t9)({code:s.Kg}),details:(0,s._j)(s.Kg)}),A=(0,s.t9)({error:g}),v=5242880;class y extends o.n{constructor(e,t){super(t,e,new f)}async fetchUserInfo(){const e=await this.get({endpoint:"/me"});return[{email:e.userPrincipalName,profilePicSrc:e.photo}]}async listFilesAndFolders(e,t){return this.listDriveItems(`/me/drive/items/${e}/children?select=id,name,size,folder,file&expand=thumbnails`,(e=>t?e.filter((e=>{if(t)return"folder"===e.type?e:t.includes(e.name.toLowerCase().split(".").pop())})):e))}async listFolders(e){const t="root"===e?"/me/drive/root/children":`/me/drive/items/${e}/children`;return this.listDriveItems(t,(e=>e.filter((e=>{if("file"!==e.type)return e}))))}async listDriveItems(e="",t=e=>e){return t(await this.getDriveItems(e)).sort(((e,t)=>"file"===e.type&&"file"!==t.type?1:"file"===t.type&&"file"!==e.type?-1:0))}async getDriveItems(e,t){try{t||(t=[]);const r=await this.get({endpoint:e});return t=t.concat(r.value.reduce(((e,t)=>{const r=this.constructEntryMeta(t);return r&&e.push(r),e}),[])),r["@odata.nextLink"]?this.getDriveItems(r["@odata.nextLink"],t):t}catch(e){throw await(async e=>{try{if(e instanceof n.f){const t=await e.response.json();if(A(t))return i.z.logEvent("ThirdPartyImportListError",{providerId:"onedrive1p",message:t.error.message,code:t.error.code,httpResponseCode:e.response.status}),void i.z.logErrorEvent("ThirdPartyImportListError",{providerId:"onedrive1p",message:t.error.message,code:t.error.code,httpResponseCode:e.response.status});i.z.logEvent("ThirdPartyImportListError",{providerId:"onedrive1p",message:t,httpResponseCode:e.response.status}),i.z.logErrorEvent("ThirdPartyImportListError",{providerId:"onedrive1p",message:t,httpResponseCode:e.response.status})}}catch{i.z.logEvent("ThirdPartyImportListError",{providerId:"onedrive1p",httpResponseCode:0,message:e instanceof Error?e.message:void 0,reason:e instanceof Error?e.name:typeof e}),i.z.logErrorEvent("ThirdPartyImportListError",{providerId:"onedrive1p",httpResponseCode:0,message:e instanceof Error?e.message:void 0,reason:e instanceof Error?e.name:typeof e})}})(e),e}}constructEntryMeta(e){const t={id:e.id,name:e.name,thumbnails:e.thumbnails?e.thumbnails[0]:void 0,selectable:!0};return"file"in e&&e.file?{...t,type:"file",size:e.size}:"folder"in e&&e.folder?{...t,type:"folder"}:null}async uploadFile(e,t,r){const i=encodeURIComponent(e),n=r.size>4194304;try{return n?await this.uploadLargeFile(i,r,t):await this.uploadSmallFile(i,r,t)}catch(e){throw await this.handleExportError(e)}}async createUploadSession(e,t){const r=t&&"0"!==t?`/me/drive/items/${t}:/${e}:/createUploadSession`:`/me/drive/root:/${e}:/createUploadSession`;return this.post({endpoint:r,options:{headers:{"Content-Type":"application/json"},body:JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"rename"}})}})}async createSharedLink(e){return(await this.post({endpoint:`/me/drive/items/${e}/createLink`,options:{headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"view",scope:"anonymous"})}})).link.webUrl}async uploadLargeFile(e,t,r){const i=await this.createUploadSession(e,r);if(t.size<v){const e=await this.uploadLargeFileChunk(i.uploadUrl,{headers:{"Content-Range":`bytes 0-${t.size-1}/${t.size}`},body:t});return await e.json()}{let e=0,r=v,n=await this.uploadLargeFileChunk(i.uploadUrl,{headers:{"Content-Range":`bytes ${e}-${r-1}/${t.size}`},body:t.slice(e,r)});for(;202===n.status;)e=r,r+v>t.size?r=t.size:r+=v,n=await this.uploadLargeFileChunk(i.uploadUrl,{headers:{"Content-Range":`bytes ${e}-${r-1}/${t.size}`},body:t.slice(e,r)});return await n.json()}}async uploadLargeFileChunk(e,t){return await this.requestWithRetryReturnRaw({endpoint:e,options:{...t,headers:{...t.headers},method:"PUT",bypassAuth:!0}})}async uploadSmallFile(e,t,r){const i=r&&"0"!==r?`/me/drive/items/${r}:/${e}:/content`:`/me/drive/root:/${e}:/content`;return this.put({endpoint:i,options:{headers:{"Content-Type":"application/octet-stream"},body:t}})}async put({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"PUT"}})}async post({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"POST"}})}async get({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"GET"}})}async requestReturnRaw({endpoint:e,retried:t,options:r}){return e.startsWith("https")||(e=`https://graph.microsoft.com/v1.0${e}`),super.requestReturnRaw({endpoint:e,retried:t,options:r})}async request({endpoint:e,retried:t,options:r}){return e.startsWith("https")||(e=`https://graph.microsoft.com/v1.0${e}`),super.request({endpoint:e,retried:t,options:r})}}},404918:(e,t,r)=>{r.d(t,{N:()=>h});var i=r(811438),n=r(954251),o=r(549281),s=r(686808),a=r(559755),c=r(20431),l=r(488630),d=r(175358),u=r(256660);class h extends c.n{constructor(e){super(e,"pinterest")}async fetchUserInfo(){const e=await this.getUser();return[{email:e.full_name,profilePicSrc:e.image_small_url}]}async getUser(){return(await this.get({endpoint:"/users/me"})).data}async listBoards(){return await(await this.get({endpoint:"/users/me/boards/feed"})).data}async registerMedia(){return this.post({endpoint:"/media/uploads/register",options:{params:{type:"video"}}})}async uploadToPinterest(e,t){const r=new FormData,i=e.upload_parameters;for(const e in i)r.set(e,i[e]);r.set("file",t),await this.post({endpoint:e.upload_url,options:{body:r}})}async getUploadStatus(e){return(await this.get({endpoint:"/media/uploads",options:{params:{upload_ids:e}}})).data[e].status}async pinToPinterest(e,t,r,i,n){const o=new FormData;return o.set("media_upload_id",r),o.set("board_id",t),o.set("title",e),o.set("description",i),o.set("image_base64",n),(await this.put({endpoint:"/pins",options:{body:o}})).data.shareable_url}async pollUploadStatus(e){const t=(0,i.of)({}).pipe((0,n.Z)((()=>this.getUploadStatus(e))),(0,o.c)(5e3),(0,s.u)());return await new Promise((e=>{const r=t.subscribe((t=>{"failed"!==t&&"succeeded"!==t||(r.unsubscribe(),e(t))}))}))}async uploadFile(e,t,r,i,n){const o=await this.registerMedia();return await this.uploadToPinterest(o.data,i),this.pinToPinterest(e,r,o.data.upload_id,t,n)}async put({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"PUT"}})}async post({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"POST"}})}async get({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"GET"}})}async request({endpoint:e,retried:t,options:{params:r={},headers:i={},...n}={}}){if(!e.startsWith("https")){const i=await this.getIntegration(t),n=this.constructQuery({...r,access_token:i.accessToken.token});e=`${u.s}/https://api.pinterest.com/v3${e}${n}`}e.includes("amazonaws")||(i["x-clipchamp-authorization"]=`Bearer ${a.j.getToken()}`);const o=await fetch(e,{...n,headers:i});if(o.status>=400)throw new l.f((0,d.mj)("export.pickerTable.generalError","Bad response from server"),o);if(204!==o.status)return o.json()}}},256660:(e,t,r)=>{r.d(t,{s:()=>n});const i=window.location.hostname,n=i.includes("local")?"https://app.local.clipchamp.dev/proxy":/.+\.appspot\.com$/.test(i)?`https://${i.replace("supercut-webapp","proxy")}/proxy`:`https://${i}/proxy`},132702:(e,t,r)=>{r.d(t,{q:()=>a}),r(584570),r(82265),r(988124);var i=r(559755),n=r(20431),o=r(256660),s=r(986236);class a extends n.n{constructor(e){super(e,"zoom")}async fetchUserInfo(){return[{email:(await this.getUser()).email}]}get zoomAPIurl(){return`${o.s}/${s.p}`}createFromAndToDates(e,t){return new URLSearchParams({from:e.toISOString().split("T")[0],to:t.toISOString().split("T")[0]})}async request({endpoint:e,retried:t}){return super.request({endpoint:`${this.zoomAPIurl}${e}`,retried:t,options:{headers:{"x-clipchamp-authorization":i.j.getToken()??""}}})}getUser(){return this.requestWithRetry({endpoint:"/users/me"})}async getRecordingsList(e,t){const r=new Date;r.setMonth(r.getMonth()-1);const i=e&&t?this.createFromAndToDates(e,t):new URLSearchParams({from:r.toISOString().split("T")[0],to:(new Date).toISOString().split("T")[0]});return(await this.requestWithRetry({endpoint:`/users/me/recordings?${i}`})).meetings.filter((e=>e.recording_count>0))}listRecordings(e){const t=encodeURIComponent(encodeURIComponent(e));return this.requestWithRetry({endpoint:`/meetings/${t}/recordings`})}}},986236:(e,t,r)=>{r.d(t,{R:()=>s,p:()=>o});var i=r(720291),n=r(197761);const o="https://api.zoom.us/v2",s=e=>(0,i.H)(e).pipe((0,n.p)((e=>["MP4","M4A"].includes(e.file_type)&&"completed"===e.status)))},129328:(e,t,r)=>{r.d(t,{g:()=>f});var i=r(324586),n=r(972070),o=r(21442);class s{constructor(){(0,i.A)(this,"importLogoToProject",!1),(0,i.A)(this,"importMusicToProject",!1),(0,i.A)(this,"importVideoToProject",!1)}}var a=r(182073),c=r(786731),l=r(272885),d=r(776016),u=r(843875);function h(e){if(e)return l.Jq.getState().byId[e]}const p=(m=o.xD,e=>{const t=Array.isArray(e)?e.filter((e=>{const t=m(e);return t||console.error(`Brand resource ${e.id} is not a valid resource.`),t})):e;return Array.isArray(t)&&t.every(m)});var m;const f=new class extends s{constructor(){super(),(0,i.A)(this,"cachedWorkspaceId",void 0)}async getWorkspaceId(){if(this.cachedWorkspaceId)return this.cachedWorkspaceId;try{const e=await(0,u.uA)();return this.cachedWorkspaceId=e.id,e.id}catch{return}}async getBrandResources(){const e=await this.getWorkspaceId();return e?n.E.get(`/workspace/${e}/brands/default/resources`).json(p).then((e=>e.filter(o.xD))):[]}async createBrandResource({resource:e}){const t=await this.getWorkspaceId();return t?n.E.post(`/workspace/${t}/brands/default/resources`,{body:e}).json(o.xD):Promise.reject(new Error("No default workspace for user"))}async updateBrandResource({resource:e}){const t=await this.getWorkspaceId();return t?n.E.put(`/workspace/${t}/brands/default/resources/${e.id}`,{body:e}).json(o.xD):Promise.reject(new Error("No default workspace for user"))}async deleteBrandResource({resource:e}){const t=await this.getWorkspaceId();return t?n.E.delete(`/workspace/${t}/brands/default/resources/${e.id}`).json(o.xD):Promise.reject(new Error("No default workspace for user"))}createBrandImageTypeAsset(e,t,r,i){const n=`brand-asset-${i.file.id}`,o=h(n);if(o&&"image"===o.type)return o;const s=(0,d._j)(a.J)(i.metadata.raw.streams)?i.metadata.raw.streams:[],c={id:n,type:"image",appearAsType:"logo",name:t,hidden:!1,metadata:{...i.metadata,raw:{...i.metadata.raw,streams:s}},cloud:i.file};return(0,l.v2)(c),c}createBrandAudioAsset(e,t,r){const i=`brand-asset-${r.file.id}`,n=h(i);if(n&&"audio"===n.type)return n;const o=(0,d._j)(a.J)(r.metadata.raw.streams)?r.metadata.raw.streams:[];return{id:i,type:"audio",appearAsType:"audio",name:t,hidden:!1,metadata:{...r.metadata,raw:{...r.metadata.raw,streams:o}},fileHashes:r.fileHashes,cloud:r.file}}createBrandVideoAsset(e,t,r){const i=`brand-asset-${e}`,n=h(i);if(n&&"video"===n.type)return n;const o=(0,d._j)(c.Q)(r.metadata.raw.streams)?r.metadata.raw.streams:[];return{id:i,type:"video",appearAsType:"video",name:t,hidden:!1,metadata:{...r.metadata,raw:{...r.metadata.raw,streams:o}},fileHashes:r.fileHashes,cloud:{...r.file,provider:"onedrive"}}}}},624646:(e,t,r)=>{r.d(t,{g:()=>m}),r(379321);var i=r(488630),n=r(122294),o=r(384259),s=r(175358),a=r(776016);class c extends n.aW{constructor(e){super((0,s.mj)("export.gdrive.uploadError","Google Drive is currently experiencing an error."),e)}}const l=(0,a.t9)({reason:a.Kg,message:a.Kg}),d=(0,a.t9)({status:a.Kg,message:a.Kg,code:a.Et,errors:(0,a._j)(l)}),u=(0,a.t9)({error:d}),h="https://www.googleapis.com/drive/v3/files?includeItemsFromAllDrives=true&supportsAllDrives=true",p="application/vnd.google-apps.folder";class m extends o.e{constructor(e){super(e,"gdrive")}async uploadFile(e,t,r){let i={name:e,mimeType:r.type};"0"!==t&&(i={...i,parents:[t]});const n=new FormData;n.append("metadata",new Blob([JSON.stringify(i)],{type:"application/json"})),n.append("file",r);try{return(await this.post({endpoint:"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=webContentLink",options:{body:n}})).webContentLink}catch(e){throw await this.handleUploadError(e)}}async handleUploadError(e){if(!(e instanceof Error))return new c({reason:typeof e,message:"Error of unknown type was captured"});if(!(e instanceof i.f))return"AbortError"===e.name?new n.UE("gdrive"):new c({reason:e.name,message:e.message??"An error other than FetchError was captured"});try{const t=await e.response.json();if(u(t)){const{error:{message:r,errors:i=[]}}=t;return new c({httpResponseCode:e.response.status,message:r,reason:i.map((e=>e.reason)).join(", ")??"UNKNOWN_GDRIVE_ERROR"})}return new c({reason:e.response.statusText,httpResponseCode:e.response.status,message:t.error?.message??JSON.stringify(t)})}catch{return new c({reason:"PARSE_JSON_FAILED",httpResponseCode:e.response.status,message:"Could not convert GDrive upload response to json",statusText:e.response.statusText})}}fetchFileDetails(e){return this.get({endpoint:`https://www.googleapis.com/drive/v3/files/${e}`})}async getPaginatedList(e,t,r){if(!t){const i=await this.get({endpoint:`${h}&q=${e}`});r=i.nextPageToken,t=i.files}if(!r)return t;const i=await this.get({endpoint:`${h}&pageToken=${r}&q=${e}`});return r=i.nextPageToken,t.push(...i.files),this.getPaginatedList(e,t,r)}queryBuilder(e,t){return`"${e}" ${t}`}async listFilesAndFolders(e,t="root"){const r=(await this.getPaginatedList(this.queryBuilder(t,"in parents&fields=kind,incompleteSearch,nextPageToken,files(kind, id, name, mimeType, thumbnailLink, size)"))).filter((t=>t.mimeType===p||e.includes(t.name.toLowerCase().split(".").pop()))).sort((e=>e.mimeType===p?-1:1)).map((e=>e.mimeType===p?{type:"folder",id:e.id,name:e.name}:{type:"file",id:e.id,name:e.name,thumbnail:e.thumbnailLink,size:e.size}));return Promise.resolve(r)}async listFolders(e="root"){return(await this.getPaginatedList(this.queryBuilder(e,'in parents and mimeType = "application/vnd.google-apps.folder"'))).map((e=>({type:"folder",id:e.id,name:e.name})))}async get({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"GET"}})}async post({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"POST"}})}}},706361:(e,t,r)=>{r.d(t,{Q:()=>h});var i=r(562229),n=r(488630),o=r(384259),s=r(540636),a=r(115324);const c="https://www.googleapis.com/youtube/v3";var l=r(122294);const d=(0,r(175358).mj)("export.youtube.unknownYouTubeError","Failed to upload to YouTube.");class u{async parseError(e){return e instanceof l.QV?e:e instanceof n.f?await this.handleFetchError(e):e instanceof Error?"AbortError"===e.name?new l.UE("youtube"):e instanceof TypeError?new l.aW(d,{reason:l.ng.TypeError,message:"Error is a TypeError"}):new l.aW(d,{reason:l.ng.ComplianceOmitted,message:"Error is an error object but cannot be logged for compliance reasons"}):new l.aW(d,{reason:l.ng.GeneralError,message:"Error is neither a response or error object, error object: "+typeof e})}async handleFetchError(e){try{const t=await e.response.json(),{status:r}=e.response;if((0,a.pN)(t)){const{error:{errors:e=[],message:i="YouTube is currently experiencing an error."}={}}=t,{reason:n,message:o}=e[0]??{};switch(n){case void 0:return new a.pZ(i,r);case"quotaExceeded":return new a.e2(i,r);case"invalidTitle":return new a.j1(i,r);case"invalidDescription":return new a.Jk(i,r);case"channelClosed":case"channelNotFound":case"channelSuspended":case"youtubeSignupRequired":return new a.eU(i,r);case"uploadLimitExceeded":return new a.Uu(i,r);case"invalidTags":return new a.wL(i,r);default:return new a.mI(n,r,o)}}return new a.Ih(r)}catch{try{return await e.response.text(),new l.aW(d,{reason:l.ng.ParseText,httpResponseCode:e.response.status,message:"There was a text based response present on the error response, but cannot be logged for compliance reasons",statusText:e.response.statusText})}catch{return new l.aW(d,{reason:l.ng.ParseJSON,httpResponseCode:e.response.status,message:`Response body is neither text or json, content type: ${e.response.headers.get("Content-Type")??void 0}`,statusText:e.response.statusText})}}}}class h extends o.e{constructor(e){super(e,"youtube",new u)}async getUploadCatagories(e){const t=await(0,s.Sq)();try{return await this.get({endpoint:`${c}/videoCategories?part=snippet&regionCode=${t?.countryCode??"US"}&hl=${e}`})}catch(e){throw await this.processCategoriesError(e)}}async processCategoriesError(e){if(!(e instanceof n.f&&e instanceof Error))return new a.jM;try{const t=await e.response.json();throw new a.jM(t.message,e.response.status)}catch{return new a.jM("Could not convert YouTube categories response to json",e.response.status)}}async uploadFile(e,t,r,n,o,s,a,c){i.z.logEvent("Usage - Youtube upload start");try{const i=await this.initUploadProcess(e,t,r,n,s,a);return await this.upload(i,o,c)}catch(e){throw await this.handleExportError(e)}}fetchFileDetails(e){return this.get({endpoint:`${c}/files/${e}`})}initUploadProcess(e,t,r,i,n,o){return this.requestWithRetryReturnRaw({endpoint:"https://www.googleapis.com/upload/youtube/v3/videos?uploadType=resumable&part=snippet,status",options:{headers:{"Content-Type":"application/json"},body:JSON.stringify({snippet:{title:e,description:t,tags:i.split(","),categoryId:n},status:{privacyStatus:r.toLocaleLowerCase(),madeForKids:o}}),method:"POST"}})}async upload(e,t,r){const n=e.headers.get("Location");if(!n)throw new a.lq;const o=await this.put({endpoint:n,options:{headers:{"Content-Type":t.type},body:t.slice()}});return i.z.logEvent("Usage - Youtube upload finished",{projectId:r,youTubeId:o.id}),`https://www.youtube.com/watch?v=${o.id}`}async get({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"GET"}})}async put({endpoint:e,options:t}){let r=t?.headers??{};return r={"Content-Type":"application/json",...r},this.requestWithRetry({endpoint:e,options:{...t,headers:r,method:"PUT"}})}}},115324:(e,t,r)=>{r.d(t,{Ih:()=>h,Jk:()=>v,Uu:()=>f,e2:()=>m,eU:()=>g,j1:()=>A,jM:()=>u,lq:()=>d,mI:()=>b,pN:()=>c,pZ:()=>p,wL:()=>y,zK:()=>l});var i=r(122294),n=r(175358),o=r(776016);const s=(0,o.t9)({message:o.Kg,reason:o.Kg}),a=(0,o.t9)({message:o.Kg,code:o.Et,errors:(0,o._j)(s)}),c=(0,o.t9)({error:a});class l extends i.aW{constructor(e,t){super(e,t)}}class d extends l{constructor(){super((0,n.mj)("export.youtube.missingUploadLocation","Failed to retrieve upload location."),{message:"Failed to retrieve upload location",reason:"MISSING_UPLOAD_LOCATION"})}}class u extends l{constructor(e,t){super((0,n.mj)("export.youtube.fetchCategoriesError","Unable to retrieve YouTube categories"),{message:e??"Unable to retrieve YouTube categories",reason:"FETCH_YOUTUBE_CATEGORIES_ERROR",httpResponseCode:t})}}class h extends l{constructor(e){super((0,n.mj)("export.youtube.unknownYouTubeError","Failed to upload to YouTube."),{message:"An unknown error occurred with YouTube",reason:"UNKNOWN_YOUTUBE_ERROR",httpResponseCode:e})}}class p extends l{constructor(e,t){super((0,n.mj)("export.youtube.unknownYouTubeError","Failed to upload to YouTube."),{httpResponseCode:t,message:e,reason:"EMPTY_YOUTUBE_ERROR"})}}class m extends l{constructor(e,t){super((0,n.mj)("export.youtube.quotaExceeded","We’ve temporarily reached our YouTube upload limit."),{httpResponseCode:t,message:e,reason:"YOUTUBE_QUOTA_EXCEEDED"})}}class f extends l{constructor(e,t){super((0,n.mj)("export.youtube.uploadLimitExceeded","You’ve exceeded the number of videos you may upload."),{httpResponseCode:t,message:e,reason:"UPLOAD_LIMIT_EXCEEDED"})}}class g extends l{constructor(e,t){super((0,n.mj)("export.youtube.invalidYouTubeChannel","You need a valid YouTube channel. <2>Click here to create one.</2>"),{httpResponseCode:t,message:e,reason:"INVALID_YOUTUBE_CHANNEL"})}}class A extends l{constructor(e,t){super((0,n.mj)("export.youtube.invalidTitle","The video title is invalid or empty."),{httpResponseCode:t,message:e,reason:"INVALID_TITLE"})}}class v extends l{constructor(e,t){super((0,n.mj)("export.youtube.invalidDescription","The video description is invalid or empty."),{httpResponseCode:t,message:e,reason:"INVALID_DESCRIPTION"})}}class y extends l{constructor(e,t){super((0,n.mj)("export.youtube.invalidYouTubeTags","The video contains invalid keywords."),{httpResponseCode:t,message:e,reason:"INVALID_TAGS"})}}class b extends i.aW{constructor(e,t,r){super((0,n.mj)("export.youtube.unknownYouTubeError","Failed to upload to YouTube."),{message:r,reason:e,httpResponseCode:t})}}},484331:(e,t,r)=>{r.d(t,{X:()=>n,u:()=>o});var i=r(175358);const n="16:9",o=(0,i.mj)("home.projects.defaultProjectName","Untitled video")},238865:(e,t,r)=>{r.d(t,{xr:()=>p,sm:()=>d,KT:()=>h,a4:()=>m}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(287386),n=r(261946),o=r(268861),s=r(277277);function a(e){return(0,s.jsx)("svg",{viewBox:"0 0 20 20",fill:"none",...e,children:(0,s.jsx)("path",{transform:"translate(0, 2)",d:"M3.25 0H16.75C18.483 0 19.8992 1.35645 19.9949 3.06558L20 3.25V12.75C20 14.483 18.6435 15.8992 16.9344 15.9949L16.75 16H3.25C1.51697 16 0.100754 14.6435 0.00514483 12.9344L0 12.75V3.25C0 1.51697 1.35645 0.100754 3.06558 0.0051446L3.25 0H16.75H3.25ZM18.5 5.373L10.3493 9.66369C10.1619 9.76233 9.94313 9.77642 9.74676 9.70596L9.65069 9.66369L1.5 5.374V12.75C1.5 13.6682 2.20711 14.4212 3.10647 14.4942L3.25 14.5H16.75C17.6682 14.5 18.4212 13.7929 18.4942 12.8935L18.5 12.75V5.373ZM16.75 1.5H3.25C2.33183 1.5 1.57881 2.20711 1.5058 3.10647L1.5 3.25V3.679L10 8.15246L18.5 3.678V3.25C18.5 2.33183 17.7929 1.57881 16.8935 1.5058L16.75 1.5Z",fill:"#212121"})})}var c=r(776016);const l=["GOOGLE","APPLE","MAGIC_LINK","EMAIL_PASSWORD","MICROSOFT1P","MICROSOFT"],d=(0,c.u)(...l),u=new Set(l.filter((e=>"MICROSOFT1P"!==e))),h=e=>["MICROSOFT1P","MICROSOFT"].includes(e.toUpperCase()),p=((0,c.u)("MICROSOFT1P"),(0,c.u)(...u),e=>"MICROSOFT1P"===e?"Microsoft":e[0].toUpperCase()+e.slice(1).toLowerCase()),m={MICROSOFT:(0,s.jsx)(n.Y,{"data-testid":"microsoft-icon"}),MICROSOFT1P:(0,s.jsx)(n.Y,{"data-testid":"microsoft-icon"}),GOOGLE:(0,s.jsx)(o.z,{"data-testid":"google-icon"}),MAGIC_LINK:(0,s.jsx)(a,{"data-testid":"mail-icon"}),EMAIL_PASSWORD:(0,s.jsx)(a,{"data-testid":"mail-icon"}),APPLE:(0,s.jsx)(i.ZrY,{"data-testid":"question-icon"})}},155089:(e,t,r)=>{r.d(t,{GO:()=>L,AH:()=>F,Gm:()=>R,Xz:()=>E,TD:()=>P});var i,n,o,s=r(972070),a=r(776016),c=r(238865),l=r(482682),d=r(175358),u=r(650882),h=r(324586),p=r(397814);class m extends p.L{constructor(e,t){super(),(0,h.A)(this,"payload",void 0),this.payload={code:e,jwt:t}}}i=m,(0,h.A)(m,"type","[Auth] Link with Google"),(0,h.A)(m,"isInstance",(0,a.t9)({type:(0,a.u)(i.type),payload:(0,a.t9)({code:a.Kg,jwt:a.Kg})}));class f extends p.L{constructor(e){super(),(0,h.A)(this,"payload",void 0),this.payload={error:e}}}n=f,(0,h.A)(f,"type","[Auth] Link with Google Failed"),(0,h.A)(f,"isInstance",(0,a.t9)({type:(0,a.u)(n.type),payload:(0,a.t9)({error:a.Kg})}));class g extends p.L{constructor(e,t){super(),(0,h.A)(this,"payload",void 0),this.payload={code:e,jwt:t}}}o=g,(0,h.A)(g,"type","[Auth] Linked with Google"),(0,h.A)(g,"isInstance",(0,a.t9)({type:(0,a.u)(o.type),payload:(0,a.t9)({code:a.Kg,jwt:a.Kg})}));class A extends u.g9{}class v extends Error{constructor(){super((0,d.mj)("home.account.failedToOpenOAuthPrompt","Could not show authentication popup window"))}}class y extends A{constructor(e,t){super(t=t??(0,d.mj)("home.account.failedToConnectTo","Failed to connect to {{ provider }}"))}}class b extends A{constructor(){super("Connect to integration cancelled")}}const w=(0,a.t9)({links:(0,a.t9)({redirect:a.Kg})}),x=async(e,t)=>{const{links:{redirect:r}}=await(async(e,t)=>(0,s.E)(`/link/${e.toLowerCase()}/connect?code=${t}`,{method:"POST"}).json(w))(e,t),i={targetUrl:r,provider:e},n=(o=i,window.open(o.targetUrl,"_blank","width=600,height=800,centerscreen,menubar=0,toolbar=0,location=0,status=0,personalbar=0,dialog=1"));var o;if(!n)throw new v;return function(e,{provider:t}){return new Promise(((r,i)=>{const n=function(e,t){const r=setInterval((()=>{t.closed&&(clearInterval(r),e(new b))}),500);return r}(i,e),o=s=>{const a=s.data;s.source===e&&s.origin===window.location.origin&&a&&(self.removeEventListener("message",o),e.close(),clearInterval(n),a.success?r(a.payload):i(new y(t.toLowerCase(),a.message)))};self.addEventListener("message",o)}))}(n,i)},S=async(e,t,r)=>{const{code:i}=await(0,l.bR)();return new Promise(((n,o)=>{let s=()=>{},a=()=>{};s=t.listen(g,(t=>{s(),a(),n({provider:e,code:t.payload.code,jwt:t.payload.jwt})})),a=t.listen(f,(t=>{s(),a(),o(new y(e,t.payload.error))})),t.send(new m(i,r))}))},T=(0,a.t9)({jwt:a.Kg}),C=(0,a.t9)({oid:a.Kg,puid:a.Kg}),_=(0,a.t9)({provider:c.sm,email:a.Kg,active:a.Lm,is_primary:a.Lm,user_claims:(0,a.T)(C)}),k=(0,a.t9)({providers:(0,a._j)(_)}),E=(0,a.t9)({puid:a.Kg}),I=(0,a.t9)({token:a.Kg}),R=async()=>({providers:(await(0,s.E)("/user/credential").json(k)).providers.map((e=>({provider:e.provider,email:e.email,active:e.active,isPrimary:e.is_primary,userClaims:e.user_claims?{oid:e.user_claims.oid,puid:e.user_claims.puid}:null})))}),F=async()=>await(0,s.E)("user/link").json(T);async function P(e,t,r,i){const n=await F(),o={provider:e,error:"Failed to fetch response"};if(r.satisfies("windows-native")&&"GOOGLE"===e)return await S(e,t,n.jwt)||o;if("MICROSOFT1P"===e){const{session:t}=await i.login({tokenType:"graph",forceSelectAccount:!0,usePopupLogin:!0,skipActiveUser:!!r.satisfies("windows-native"),scopes:["email"]});return t?{provider:e,idToken:t.idToken,accessToken:t.accessToken,jwt:n.jwt}:o}return await x(e,n.jwt).catch((()=>({provider:e,error:"Authentication cancelled"})))||o}const L=async e=>{const{provider:t,code:r,jwt:i,accessToken:n,idToken:o}=e,a=await(0,s.E)("user/credential",{method:"POST",body:{provider:t,code:r,jwt:i,accessToken:n,idToken:o}});return a.status>=400?Promise.reject(a):(await a.json(I)).token}},140296:(e,t,r)=>{r.d(t,{AX:()=>v,Br:()=>f,T:()=>x,VX:()=>g,W7:()=>w,il:()=>y,lB:()=>b,qE:()=>m,y:()=>A});var i=r(596254),n=r(26985),o=r(562229),s=r(559755),a=r(382684),c=r(170553),l=r(847269),d=r(776016),u=r(82575),h=r(238865),p=r(155089);const m=e=>["fetch_user_credential",{apiKey:e}],f=()=>{const[e,t]=(0,n.useState)(s.j.getClaim("provider")),[r,i]=(0,n.useState)(s.j.getClaim("email"));s.j.registerForChanges(((e,r)=>{t((0,a.D)(r,"provider")),i((0,a.D)(r,"provider"))}));const o=(0,h.sm)(e)?e:void 0;if(o&&r)return{provider:o,email:r}},g=()=>{const e=(0,u.Jd)();return(0,l.iY)(e,"User must be defined."),(0,i.I)(m(e.apiKey),(()=>(0,p.Gm)()))},A=()=>{const e=(0,u.Jd)();(0,l.iY)(e,"User must be defined.");const t=f(),{data:r}=g();return(0,n.useEffect)((()=>{r&&(r.providers.filter((e=>(0,h.KT)(e.provider))).length>0?(0,d.O9)(e?.preferences.MSAConnected)&&!1!==e?.preferences.MSAConnected||((0,c.Q_)("MSAConnected",!0),o.z.setUserProperties({MSAConnected:!0})):(0,d.O9)(e?.preferences.MSAConnected)&&!0!==e?.preferences.MSAConnected||((0,c.Q_)("MSAConnected",!1),o.z.setUserProperties({MSAConnected:!1})))}),[r,e?.preferences.MSAConnected]),(0,n.useMemo)((()=>r?{providers:r.providers.map((e=>{const r=t&&e.provider===t.provider&&e.email===t.email;return{...e,current:r??!1}}))}:r),[r,t])},v=e=>{const t=A();return t&&function(e,t){return e.providers.some((e=>t.includes(e.provider)))}(t,e)},y=["MICROSOFT","MICROSOFT1P"],b=()=>v(y)??!1,w=()=>{const e=A();if(e)return e.providers.filter((e=>(0,h.KT)(e.provider)))},x=()=>{const e=(0,u.Jd)();return e?.primaryCredential}},865669:(e,t,r)=>{r.d(t,{d:()=>p});var i=r(324586),n=r(26985),o=r(175358),s=r(293688),a=r(277277);const c=e=>{const t=(0,n.useCallback)((()=>{e.onClose?.()}),[e]);return(0,a.jsx)(s.h,{container:"generic-error",title:(0,a.jsx)(o.x6,{i18nKey:"home.genericError.somethingWentWrong",children:"Something went wrong"}),message:(0,a.jsx)(o.x6,{i18nKey:"home.genericError.stoppedWorking",children:"Clipchamp stopped working unexpectedly. Try refreshing your browser to resolve the issue, or if the problem persists, restart your machine."}),showClose:!1,confirmText:(0,a.jsx)(o.x6,{i18nKey:"home.genericError.refresh",children:"Refresh"}),onClose:t,...e})};var l=r(626443);const d=(0,a.jsx)(o.x6,{i18nKey:"home.accountErrors.general"}),u={general:d,http:(0,a.jsx)(o.x6,{i18nKey:"home.accountErrors.http"}),invalidRequest:d,notAuthenticated:(0,a.jsx)(o.x6,{i18nKey:"home.accountErrors.notAuthenticated"}),notAuthorised:(0,a.jsx)(o.x6,{i18nKey:"home.accountErrors.notAuthorised"}),notFound:(0,a.jsx)(o.x6,{i18nKey:"home.accountErrors.notFound"})},h=(0,n.createContext)({errorCode:void 0,errorMessage:void 0,raiseError:()=>{},clearError:()=>{}});class p extends n.Component{constructor(e){super(e),(0,i.A)(this,"setErrorCode",(e=>{this.setState({errorCode:e})})),(0,i.A)(this,"setErrorMessage",(e=>{this.setState({errorMessage:e})})),(0,i.A)(this,"raiseError",((e,t)=>{"number"==typeof e&&(e=(e=>{switch(e){case l.v.BAD_REQUEST:return"invalidRequest";case l.v.UNAUTHORIZED:return"notAuthenticated";case l.v.FORBIDDEN:return"notAuthorised";case l.v.NOT_FOUND:return"notFound";default:return"http"}})(e)),this.setErrorMessage(t||u[e]),this.setErrorCode(e)})),(0,i.A)(this,"clearError",(()=>{this.setErrorCode(void 0),this.setErrorMessage(void 0)})),(0,i.A)(this,"handleCloseGeneralError",(()=>{this.clearError(),window.location.reload()})),this.state={}}static getDerivedStateFromError(){return{errorCode:"general"}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t,errorCode:"general"}),console.error(`Encountered error: ${e.message} in ${t.componentStack}`)}render(){return(0,a.jsxs)(h.Provider,{value:{errorCode:this.state.errorCode,errorMessage:this.state.errorMessage,raiseError:this.raiseError,clearError:this.clearError,...this.props.value},children:[this.props.children,!1!==this.props.handleReactErrors&&(0,a.jsx)(c,{open:"general"===this.state.errorCode,onClose:this.handleCloseGeneralError})]})}}},293688:(e,t,r)=>{r.d(t,{h:()=>y});var i=r(26985),n=r(247498),o=r(175358),s=r(140169),a=r(999657),c=r(809202),l=r(14332),d=r(301557),u=r(145481),h=r(682523),p=r(356735),m=r(109492),f=r(277277);const g=(0,s.I)(a.$)`
    padding: 0 2rem;
`,A=(0,s.I)(c.Cf)`
    width: 550px;
`,v={enter:l.j,exit:l.h},y=({title:e,message:t,errorCode:r,showClose:s,showConfirm:a,confirmText:c,onClose:l,...y})=>{const{t:b}=(0,n.Bd)(),[w,x]=(0,i.useState)(void 0),[S,T]=(0,i.useState)(void 0);return(0,i.useEffect)((()=>{y.open&&x(e)}),[e,y.open]),(0,i.useEffect)((()=>{y.open&&T(t)}),[t,y.open]),(0,f.jsxs)(d.l,{container:"access-denied",transition:v,content:A,...y,children:[!1!==s&&(0,f.jsx)(u.H,{"aria-label":b("home.account.modalCloseAria","Close dialog"),onClose:l}),(0,f.jsx)(h.L,{children:w}),(0,f.jsx)(p.o,{variant:"body",children:S}),r&&(0,f.jsx)(p.o,{variant:"body",children:r}),(0,f.jsx)(m.i,{children:!1!==a&&(0,f.jsx)(g,{onClick:l,children:c||(0,f.jsx)(o.x6,{i18nKey:"global.gotIt",children:"Got it"})})})]})}},993494:(e,t,r)=>{r.d(t,{J:()=>o});const i=new Promise((e=>{window.addEventListener("load",(()=>{"/"===location.pathname&&e()}))}));let n=!1;async function o(e){n||(n=!0,i.then((()=>{e()})).catch((()=>{})))}},716854:(e,t,r)=>{r.d(t,{f:()=>i,t:()=>n});const i="/folder/:folderId",n="/search"},596076:(e,t,r)=>{r.d(t,{S:()=>a,u:()=>c});var i=r(179315),n=r(457965),o=r(82575),s=r(140296);function a(e){const t=(0,o.Jd)(),r=(0,s.y)(),a=e??t;return(0,i.iT)("dem__elevate_to_power_user")||n.S.isPowerUser(a,r)}function c(){return{useIsPowerUser:a}}},768870:(e,t,r)=>{r.d(t,{p:()=>C}),r(379321);var i=r(26985),n=r(562229),o=r(99129),s=r(908860),a=r(615535),c=r(677252),l=r(879181),d=r(399079),u=r(247498),h=r(175358),p=r(140169),m=r(571531),f=r(380467),g=r(7089),A=r(881956),v=r(277277);const y="https://support.microsoft.com/topic/how-to-access-microsoft-clipchamp-with-your-work-account-8122e9d2-b517-4230-8398-64cdaca9bef2",b=p.I.div`
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    margin-top: 23px;
`,w=p.I.h3`
    font-size: 1.75rem;
    line-height: 120%;
    font-weight: 600;
    text-transform: none;
    margin-top: 23px;
    text-align: center;
`,x=p.I.p`
    margin-top: 1rem;
    font-size: 14px;
    font-style: normal;
    font-weight: 400;
    line-height: 130%;
    text-align: center;
`,S="temp_device_id";let T=window.localStorage.getItem(S);T||(T=(0,g.u)(),window.localStorage.setItem(S,T));const C=({force:e=!1})=>{const{t}=(0,u.Bd)(),r=(0,o.v)(),p=(0,d.$)(),g=(0,i.useCallback)(((e,t,i)=>{const n=[];n.push(r.listen(s.p,(e=>{n.forEach((e=>e())),i(e)})),r.listen(a.B,(e=>{n.forEach((e=>e())),t(e)}))),r.send(new c.Q(e))}),[r]),S=(0,i.useCallback)((()=>{n.z.logEvent("Usage - Launching Commercial Web App",{deviceId:T}),g("https://www.microsoft365.com/launch/clipchamp?from=ClipchampWindowsApp&auth=2",(t=>{n.z.logEvent("Usage - Launch Commercial Web App Succeeded",{deviceId:T}),e&&r.send(new l.P)}),(e=>{n.z.logEvent("Usage - Launch Commercial Web App Failed",{...e.payload,deviceId:T})}))}),[g,e,r]),C=(0,i.useCallback)((()=>{n.z.logEvent("Usage - Launching Commercial Learn More Link",{deviceId:T}),g(y,(e=>n.z.logEvent("Usage - Launch Commercial Learn More Link Succeeded",{deviceId:T})),(e=>{n.z.logEvent("Usage - Launch Commercial Learn More Link Failed",{...e.payload,deviceId:T}),window.open(y)}))}),[g]),_=(0,i.useCallback)((()=>{window.sessionStorage.setItem("isLaunchCommercialShown","true"),n.z.logEvent("Usage - Launch Commercial Web App Page is rejected",{force:e,deviceId:T}),p("/login")}),[p,e]),k=(0,i.useCallback)((()=>{n.z.logEvent("Usage - Launch Commercial Web App Page is rejected",{force:e,deviceId:T}),r.send(new l.P)}),[r,e]);return(0,i.useEffect)((()=>{n.z.logEvent("Usage - Launch Commercial Web App Page is shown",{force:e,deviceId:T})}),[e]),(0,v.jsxs)(A.g,{children:[(0,v.jsx)(w,{children:t("native.commercialPrompt.title","You're signed in to Windows with a work account. Please access Clipchamp for work with your web browser.")}),(0,v.jsxs)(b,{children:[(0,v.jsx)(f.$,{appearance:"primary",onClick:S,children:t("native.commercialPrompt.launchCommercialButton","Launch Clipchamp for work")}),e?(0,v.jsx)(f.$,{onClick:k,style:{marginLeft:"16px"},children:t("native.commercialPrompt.closeButton","Close")}):(0,v.jsx)(f.$,{onClick:_,style:{marginLeft:"16px"},children:t("native.commercialPrompt.useDifferentAccountButton","Use a different account")})]}),(0,v.jsx)(x,{children:(0,v.jsxs)(h.x6,{i18nKey:"native.commercialPrompt.description",children:["Did you know Clipchamp for work accounts is now available with some Microsoft 365 subscriptions?"," ",(0,v.jsx)(m.A,{onClick:C,children:"Learn more"})]})})]})}},881956:(e,t,r)=>{r.d(t,{g:()=>l});var i=r(140169),n=r(588215),o=r(277277);const s=i.I.div`
    width: 100%;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
`,a=(0,i.I)(n.j)`
    width: 48px;
    height: 48px;
`,c=(0,i.I)((e=>(0,o.jsxs)("svg",{width:"160",height:"72",viewBox:"0 0 160 72",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,o.jsxs)("g",{clipPath:"url(#clip0_104_545)",children:[(0,o.jsx)("path",{d:"M70.7833 28.8V43.2H68.2833V31.9134H68.2433L63.7733 43.2H62.1167L57.5367 31.9134H57.5067V43.2H55.1967V28.8H58.78L62.9167 39.4734H62.9767L67.3433 28.8H70.7767H70.7833ZM72.8733 29.8934C72.8733 29.49 73.02 29.1567 73.31 28.8834C73.6 28.61 73.9467 28.4767 74.35 28.4767C74.78 28.4767 75.1333 28.6167 75.4133 28.8934C75.6933 29.17 75.8367 29.5034 75.8367 29.8934C75.8367 30.2834 75.6933 30.62 75.4033 30.8867C75.1167 31.1534 74.7633 31.29 74.35 31.29C73.9367 31.29 73.5867 31.1534 73.3 30.8834C73.0167 30.6134 72.8733 30.2834 72.8733 29.8934V29.8934ZM75.5533 32.8767V43.2H73.1233V32.8767H75.5533ZM82.9233 41.4334C83.2833 41.4334 83.6833 41.35 84.1167 41.1834C84.5533 41.0167 84.9533 40.7967 85.3233 40.52V42.78C84.9367 43 84.4933 43.17 84.0033 43.2834C83.51 43.3967 82.97 43.4534 82.38 43.4534C80.86 43.4534 79.6267 42.9734 78.6733 42.0134C77.7233 41.0534 77.2467 39.8267 77.2467 38.3334C77.2467 36.6734 77.7333 35.3067 78.7033 34.23C79.6733 33.1567 81.05 32.62 82.83 32.62C83.2867 32.62 83.7467 32.68 84.21 32.7967C84.6767 32.9134 85.0433 33.05 85.32 33.2034V35.5334C84.9433 35.26 84.5633 35.0467 84.17 34.8967C83.78 34.7467 83.3767 34.67 82.97 34.67C82.0133 34.67 81.24 34.98 80.65 35.6034C80.06 36.2267 79.7667 37.0667 79.7667 38.1234C79.7667 39.18 80.05 39.98 80.6167 40.5634C81.1833 41.1467 81.95 41.4367 82.92 41.4367L82.9233 41.4334ZM92.2433 32.7067C92.4367 32.7067 92.61 32.72 92.7667 32.7467C92.9233 32.7734 93.05 32.8067 93.16 32.8467V35.3067C93.0333 35.2134 92.8467 35.1234 92.6033 35.04C92.36 34.9567 92.0633 34.9134 91.7133 34.9134C91.1167 34.9134 90.6133 35.1634 90.2033 35.6667C89.7933 36.17 89.5867 36.9434 89.5867 37.9867V43.2H87.1567V32.8767H89.5867V34.5034H89.6267C89.8467 33.94 90.1833 33.5 90.63 33.1834C91.08 32.8667 91.6167 32.7067 92.2467 32.7067H92.2433ZM93.29 38.19C93.29 36.4834 93.7733 35.13 94.7367 34.1334C95.7 33.1367 97.04 32.6367 98.7533 32.6367C100.367 32.6367 101.627 33.1167 102.533 34.0767C103.44 35.0367 103.893 36.3334 103.893 37.9667C103.893 39.6 103.41 40.9734 102.447 41.9634C101.483 42.9534 100.17 43.45 98.51 43.45C96.85 43.45 95.64 42.98 94.7 42.04C93.76 41.1 93.29 39.8167 93.29 38.19V38.19ZM95.82 38.11C95.82 39.1867 96.0633 40.01 96.5533 40.58C97.0433 41.15 97.74 41.4334 98.6533 41.4334C99.5667 41.4334 100.21 41.15 100.673 40.58C101.137 40.01 101.367 39.1667 101.367 38.05C101.367 36.9334 101.127 36.1 100.65 35.5334C100.17 34.9667 99.5 34.6834 98.6367 34.6834C97.7733 34.6834 97.0567 34.98 96.5633 35.5734C96.07 36.1667 95.8267 37.01 95.8267 38.11H95.82ZM107.51 35.59C107.51 35.9367 107.62 36.21 107.84 36.41C108.06 36.6067 108.55 36.8567 109.307 37.1567C110.277 37.5467 110.96 37.9834 111.35 38.4667C111.743 38.9534 111.937 39.54 111.937 40.23C111.937 41.2 111.563 41.98 110.817 42.57C110.07 43.16 109.06 43.4534 107.79 43.4534C107.36 43.4534 106.887 43.4 106.37 43.2967C105.85 43.1934 105.41 43.06 105.05 42.9V40.51C105.493 40.8167 105.967 41.0634 106.477 41.2434C106.987 41.4234 107.447 41.5134 107.863 41.5134C108.413 41.5134 108.817 41.4367 109.08 41.2834C109.343 41.13 109.47 40.87 109.47 40.51C109.47 40.1767 109.333 39.8934 109.063 39.66C108.793 39.4267 108.277 39.1634 107.523 38.86C106.627 38.4867 105.99 38.0634 105.617 37.5934C105.24 37.1234 105.053 36.53 105.053 35.8067C105.053 34.8767 105.423 34.11 106.163 33.5134C106.903 32.9134 107.863 32.6134 109.04 32.6134C109.4 32.6134 109.807 32.6534 110.253 32.7334C110.703 32.8134 111.077 32.9167 111.377 33.0434V35.3534C111.057 35.14 110.68 34.9567 110.253 34.8C109.823 34.6467 109.4 34.57 108.977 34.57C108.513 34.57 108.153 34.66 107.897 34.84C107.64 35.02 107.51 35.27 107.51 35.5834V35.59ZM112.983 38.19C112.983 36.4834 113.467 35.13 114.43 34.1334C115.393 33.1367 116.733 32.6367 118.447 32.6367C120.06 32.6367 121.32 33.1167 122.227 34.0767C123.133 35.0367 123.587 36.3334 123.587 37.9667C123.587 39.6 123.103 40.9734 122.14 41.9634C121.177 42.9534 119.863 43.45 118.203 43.45C116.543 43.45 115.333 42.98 114.393 42.04C113.453 41.1 112.983 39.8167 112.983 38.19V38.19ZM115.513 38.11C115.513 39.1867 115.757 40.01 116.247 40.58C116.737 41.15 117.433 41.4334 118.347 41.4334C119.26 41.4334 119.903 41.15 120.367 40.58C120.83 40.01 121.06 39.1667 121.06 38.05C121.06 36.9334 120.82 36.1 120.343 35.5334C119.863 34.9667 119.193 34.6834 118.33 34.6834C117.467 34.6834 116.75 34.98 116.257 35.5734C115.763 36.1667 115.52 37.01 115.52 38.11H115.513ZM131.65 34.8667H128.03V43.2H125.57V34.8667H123.843V32.88H125.57V31.4434C125.57 30.36 125.923 29.47 126.63 28.7767C127.337 28.0834 128.24 27.7367 129.347 27.7367C129.64 27.7367 129.903 27.7534 130.13 27.7834C130.357 27.8134 130.56 27.86 130.733 27.92V30.02C130.653 29.9734 130.513 29.9167 130.31 29.85C130.11 29.7834 129.877 29.75 129.617 29.75C129.107 29.75 128.717 29.91 128.44 30.2267C128.163 30.5434 128.03 31.0134 128.03 31.6367V32.8834H131.65V30.5634L134.09 29.82V32.8834H136.55V34.87H134.09V39.7C134.09 40.3367 134.207 40.7834 134.437 41.0467C134.667 41.3067 135.03 41.44 135.527 41.44C135.667 41.44 135.837 41.4067 136.033 41.34C136.23 41.2734 136.403 41.1934 136.55 41.1V43.11C136.397 43.1967 136.14 43.2767 135.783 43.35C135.427 43.4234 135.073 43.46 134.723 43.46C133.7 43.46 132.93 43.1867 132.42 42.6434C131.907 42.0967 131.653 41.2767 131.653 40.1767V34.8734L131.65 34.8667Z",fill:"#737373"}),(0,o.jsx)("path",{d:"M35.4067 24H24V35.4067H35.4067V24Z",fill:"#F25022"}),(0,o.jsx)("path",{d:"M48 24H36.5933V35.4067H48V24Z",fill:"#7FBA00"}),(0,o.jsx)("path",{d:"M35.4067 36.5934H24V48.0001H35.4067V36.5934Z",fill:"#00A4EF"}),(0,o.jsx)("path",{d:"M48 36.5934H36.5933V48.0001H48V36.5934Z",fill:"#FFB900"})]}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_104_545",children:(0,o.jsx)("rect",{width:"112.55",height:"24",fill:"white",transform:"translate(24 24)"})})})]})))`
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    bottom: 0;
    width: 160px;
    height: 72px;
`,l=({children:e,showClipchampIcon:t=!0})=>(0,o.jsxs)(s,{children:[t&&(0,o.jsx)(a,{}),e,(0,o.jsx)(c,{})]})},561626:(e,t,r)=>{r.d(t,{C:()=>C}),r(379321);var i=r(850341),n=r.n(i),o=r(26985),s=r(562229),a=r(552740),c=r(99129),l=r(272908),d=r(908860),u=r(615535),h=r(677252),p=r(879181),m=r(247498),f=r(140169),g=r(380467),A=r(881956),v=r(277277);const y=f.I.div`
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    margin-top: 23px;
`,b=f.I.h3`
    font-size: 1.75rem;
    line-height: 120%;
    font-weight: 600;
    text-transform: none;
    margin-top: 23px;
`,w=f.I.h4`
    font-size: 1.125rem;
    font-weight: 600;
    line-height: 25px;
    margin-top: 15px;
`,x=f.I.p`
    font-size: 1.125rem;
    font-weight: 400;
    line-height: 22px;
    margin-top: 23px;
`,S=(0,f.I)(g.$)`
    margin-left: 16px;
`,T="ms-windows-store://downloadsandupdates",C=()=>{const{t:e}=(0,m.Bd)(),t=(0,a.L)(),r=(0,c.v)(),i=(0,l.M)(),[f,C]=(0,o.useState)("unknown"),_=!0===i?.gwy__launch_uri,k=(0,o.useCallback)((()=>{if(s.z.logEvent("Event - Native update button clicked"),!_)return void n()(T,(()=>C("not-installed")),(()=>C("installed")),2e3,(()=>C("unknown")));const e=[];e.push(r.listen(d.p,(t=>{e.forEach((e=>e())),C("not-installed")})),r.listen(u.B,(()=>{e.forEach((e=>e())),C("installed")}))),r.send(new h.Q(T,"Microsoft.WindowsStore_8wekyb3d8bbwe"))}),[_,r]),E=(0,o.useCallback)((()=>{if(!_)return void window.open("/");const e=[];e.push(r.listen(d.p,(t=>{e.forEach((e=>e())),s.z.logEvent("Usage - Failed to launch web app",{context:"native-update-page",...t.payload}),window.open("/")}))),r.send(new h.Q(window.location.origin))}),[_,r]),I=t.satisfies(["windows-native",">=2.5.3"]);(0,o.useEffect)((()=>{s.z.logEvent("Usage - Native update page is shown")}),[]);const R=I&&(0,v.jsx)(S,{onClick:()=>{s.z.logEvent("Event - Native update page closed"),r.send(new p.P)},children:e("native.versionEnforcer.closeButton","Close")});return"not-installed"===f?(0,v.jsxs)(A.g,{children:[(0,v.jsx)(b,{children:e("native.versionEnforcer.titleWhenNoStore","We couldn’t update Clipchamp on this device")}),(0,v.jsx)(w,{children:e("native.versionEnforcer.subtitle","It looks like you can’t access the Microsoft Store.")}),(0,v.jsx)(x,{children:e("native.versionEnforcer.description","What would you like to do?")}),(0,v.jsxs)(y,{children:[(0,v.jsx)(g.$,{appearance:"primary",onClick:E,children:e("native.versionEnforcer.goToWebVersion","Go to web version")}),R]})]}):(0,v.jsxs)(A.g,{children:[(0,v.jsx)(b,{children:e("native.versionEnforcer.updateTitle","Update your version of Clipchamp to see us at our best.")}),(0,v.jsx)(x,{children:e("native.versionEnforcer.description","What would you like to do?")}),(0,v.jsxs)(y,{children:[(0,v.jsx)(g.$,{appearance:"primary",onClick:k,children:e("native.versionEnforcer.updateButton","Update")}),R]})]})}},910997:(e,t,r)=>{r.d(t,{T:()=>a,e:()=>c});var i,n=r(324586),o=r(825702),s=r(739367);let a=(0,o.Gr)()(i=class{constructor(){(0,n.A)(this,"editWithLaunchMethod","open_with"),(0,n.A)(this,"launchInfoStorageKey","launchInfo"),(0,n.A)(this,"_launchInfo",void 0)}get launchInfo(){if(void 0!==this._launchInfo)return this._launchInfo;const e=sessionStorage.getItem(this.launchInfoStorageKey);if(e){try{const t=JSON.parse(e);this._launchInfo=t}catch{return}return this._launchInfo}}set launchInfo(e){sessionStorage.setItem(this.launchInfoStorageKey,JSON.stringify(e))}get isLaunchedByEditWith(){return this.launchInfo?.method===this.editWithLaunchMethod}})||i;function c(){return(0,s.l)(a)}},241289:(e,t,r)=>{r.d(t,{gH:()=>a,r4:()=>s,wR:()=>o}),r(584570),r(82265),r(988124);const i=/^\/remix\/([^/]+)\/?$/,n="remix_id";function o(){const e=i.exec(location.pathname),t=e?e[1]:void 0,r=new URLSearchParams(self.location.search).get("remix")||t;r&&self.localStorage.setItem(n,r)}function s(){return localStorage.getItem(n)}function a(){localStorage.removeItem(n)}},716887:(e,t,r)=>{r.d(t,{I:()=>P,L:()=>N});var i=r(324586),n=(r(379321),r(217563)),o=r(825702),s=r(562229),a=r(891697),c=r(413497),l=r(591652),d=r(903277),u=r(685944),h=r(138615),p=r(739367),m=r(941604),f=r(474107);function g(e,t){const r=[];for(const i of Object.values(e.items.byId)){const e=i.filters?.filter((e=>"normal"!==e.filterId&&v(e.filterId,t))).map((e=>e.filterId))??[];r.push(...e),i.assetId.startsWith("cc_")&&v(i.assetId,t)&&r.push(i.assetId)}return r}function A(e,t){const r=[];for(const i of Object.values(e.items.transitions))v(i.asset,t)&&r.push(i.asset);return r}function v(e,t){return!t.byId[e]}var y,b=r(767983),w=r(597906),x=r(769159),S=r(842880),T=r(2857),C=r(272885),_=r(847269),k=r(650882),E=r(163708),I=r(744448),R=r(995895),F=r(82575);let P=(0,o.Gr)()(y=function(e){return(0,o.WQ)(w.ug)(e,void 0,0)}(y=function(e){return(0,o.WQ)(f.T)(e,void 0,1)}((L=y=Reflect.metadata("design:type",Function)(y=Reflect.metadata("design:paramtypes",[void 0===u.E?Object:u.E,void 0===f.T?Object:f.T,void 0===I.G?Object:I.G])(y=class{constructor(e,t,r){(0,i.A)(this,"onAssetRecovery",new n.B),(0,i.A)(this,"assetRecovery$",this.onAssetRecovery.asObservable()),this.assetCollect=e,this.projectService=t,this.projectBackend=r}async openProject(e){const t=(0,m.lE)();try{const t=await(0,d.x)();s.z.logEvent("Usage - Import Project",{projectId:e,cacheStorageUsedGB:(0,a.c)(t.usage),cacheStorageUsedToAvailableRatio:(0,a.y)(t.usage,t.quota)});const r=await this.projectBackend.fetchProject(e);(0,_.iY)(r,"fetchProject completed without a value");const i=r.storageOptions.workspace;return this.checkForVersionMismatch(e,r.projectState.version),void await this.importProjectState({project:r.projectState,workspace:i})}catch(e){if(!(0,h.Us)("ks_pst__log_import_project_state_error")){const t=e instanceof k.g9?e.context:{};s.z.logEvent("Error - Import Project State",{error:e instanceof Error?e.stack??e:e,...t})}throw(0,S.tu)().navigate("/"),e}finally{const e=(0,m.GU)(t);(0,h.G7)("editor__consumer_1ds_events")&&s.z.logUserActionEvent("ProjectEdited",{actionType:"Unknown",duration:e.duration})}}async loadProjectAssets(e){const t={allIds:[],byId:{}},r=[];for(const i of e.assets.allIds){const n=e.assets.byId[i];(0,T.F)(n)?r.push(n):(t.allIds.push(i),t.byId[i]=n)}e={...e,assets:t};let i="Unknown";try{i=await this.assetCollect.loadIfNecessary()??"Unknown",(0,C.AH)([c.d,...r,...l.P]);const t=function(e,t){return[...A(e,t),...g(e,t)]}(e,(0,C.eS)());(!(0,h.Us)("ks_pst__load_project_content_once")&&t.length>0||(0,h.Us)("ks_pst__load_project_content_once")&&t)&&await this.assetCollect.loadContent(t);const n=this.findMissingAssets(e,(0,C.eS)());if(n.length>0){if(s.z.logEvent("Error - Import Project State Missing Assets",{missingAssets:n.sort(),contentIds:t.sort()}),!(0,h.G7)("pst__project_asset_recovery"))throw new Error("missing assets when loading project state");{const t=(0,C.eS)();if(this.fixMissingAssets(e,t),this.findMissingAssets(e,t).length>0)throw new Error("missing assets when loading project state");this.onAssetRecovery.next()}}}catch(t){throw s.z.logEvent("Error - Load Project Assets",{error:t instanceof Error?t.stack??t:t,projectId:e.id,projectVersion:e.version,contentLang:i}),t}return e}findMissingAssets(e,t){const r=[];for(const i of Object.values(e.items.byId))e.assets.byId[i.assetId]||t.byId[i.assetId]||r.push(i.assetId);return r}fixMissingAssets(e,t){for(const[r,i]of Object.entries(e.items.byId))e.assets.byId[i.assetId]||t.byId[i.assetId]||delete e.items.byId[r];e.items.allIds=Object.keys(e.items.byId)}async importProjectState({project:e,workspace:t}){try{return this.loadProject({project:await this.loadProjectAssets(e),workspace:t})}catch(t){if(!(0,h.Us)("ks_pst__log_import_project_state_error"))throw new k.g9("Error importing project state",{error:t instanceof Error?t.stack??t:t,projectId:e.id,projectVersion:e.version});if(!(t instanceof Error))return;s.z.logEvent("Error - Import Project State",{error:t.stack||t,projectId:e.id,projectVersion:e.version})}}loadProject({project:e,workspace:t}){this.projectService.ingestProject(e),(0,F.o3)(t),(0,S.tu)().navigate((0,R.v)({pathname:(0,E._G)(e.id)}))}checkForVersionMismatch(e,t){if((0,h.G7)("pst__project_sync_version_mismatch")&&e){const r=(0,b.h)(e);r&&Number(r)>t&&((0,b.j)(e,t.toString()),s.z.logEvent("Error - Project Version Mismatch",{projectId:e,localVersion:r,remoteVersion:t}))}}})||y)||y,y=(0,o.WQ)(x.X)(L,void 0,2)||y))||y)||y)||y;var L;const N=()=>(0,p.l)(P)},779779:(e,t,r)=>{r.d(t,{H:()=>n,l:()=>i});const i="authStoreActions";class n{}},457965:(e,t,r)=>{r.d(t,{S:()=>n});var i=r(324586);class n{static isPowerUser(e,t){const r=e=>{for(const t of n.POWER_USER_PATTERN_WHITELIST)if(t.test(e))return!0;return!1};return!!/^https?:\/\/(localhost|app\.(test|local)\.clipchamp\.(com|dev))/.test(location.origin)||(!(!t||!t.providers.find((e=>r(e.email))))||!!e?.email&&r(e.email))}}(0,i.A)(n,"POWER_USER_PATTERN_WHITELIST",[/@clipchamp.com$/,/@contoso.com$/,/@zfaas.com$/,/@microsoft.com$/,/^mstest_cc_money([1-9]|1[0-5])@outlook\.com$/,/^playstoretest.cc.money1@gmail.com$/])},575465:(e,t,r)=>{r.d(t,{hY:()=>s,mQ:()=>a,yy:()=>o,zC:()=>n});var i=r(959763);const n="use_auto_windows_authentication",o="blockUnderageUser";class s extends Error{constructor(){super("Expired or invalid authorization token")}}const a=e=>({loginMethod:"default",loading:!1,underageUserBlocked:!1,updateAuthState:t=>{e((0,i.jM)((e=>{t(e)})))}})},537250:(e,t,r)=>{r.d(t,{d:()=>i});const i={GetToken:"/auth/token",ExchangeMicrosoftToken:"/auth/microsoft1p/token",EmailPassword:"/auth/email-password",EmailPasswordReset:"/auth/email-password/reset",Email:"/auth/email",VerifyDeactivateAccount:"/user/deactivate/verify",DeactivateAccount:"/user/deactivate",GetWorkspace:"/workspace"}},484204:(e,t,r)=>{r.d(t,{M:()=>c});var i=r(972070),n=r(288660),o=r(776016),s=r(537250);const a=(0,o.t9)({token:(0,o.H7)(o.Kg),email:(0,o.H7)(o.Kg)});async function c(e,t,r){try{return await i.E.post(s.d.EmailPassword,{body:{email:e,password:t,intent:r}}).json(a)}catch(e){throw(0,n.H)(e,"UNEXPECTED_LOGIN_ERROR","Unexpected error during login request")}}},888313:(e,t,r)=>{r.d(t,{r:()=>c});var i=r(972070),n=r(288660),o=r(776016),s=r(537250);const a=(0,o.t9)({email:o.Kg,token:(0,o.H7)(o.Kg)});async function c(e,t,r,o,c,l){try{return await i.E.post(s.d.Email,{body:{email:e,locale:t,redirectParameters:r,firstName:o,lastName:c,region:l}}).json(a)}catch(e){throw(0,n.H)(e,"UNEXPECTED_MAGIC_LINK_LOGIN_ERROR","Unexpected error during login request")}}},891094:(e,t,r)=>{r.d(t,{W:()=>o});var i=r(225304),n=r(776016);const o=e=>{if(e instanceof i.j$&&(0,n.Gv)(e.body)){const t=e.body.error_code??"UNKNOWN";return{statusCode:e.status.toString(),errorCode:t}}return e instanceof i.Dr?{statusCode:"500",errorCode:"NETWORK_ERROR"}:{statusCode:"500",errorCode:"UNKNOWN"}}},467555:(e,t,r)=>{r.d(t,{U:()=>o}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(626443),n=function(e){return e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.UNKNOWN_SERVER_RESPONSE=520]="UNKNOWN_SERVER_RESPONSE",e[e.SERVER_CONNECT_TIMEOUT=522]="SERVER_CONNECT_TIMEOUT",e[e.SERVER_RESPONSE_TIMEOUT=524]="SERVER_RESPONSE_TIMEOUT",e[e.SSL_HANDSHAKE_FAILED=525]="SSL_HANDSHAKE_FAILED",e}(n||{});const o=new Set([i.v.BAD_GATEWAY,i.v.GATEWAY_TIMEOUT,i.v.SERVICE_UNAVAILABLE,i.v.REQUEST_TIMEOUT,i.v.INTERNAL_SERVER_ERROR,n.UNKNOWN_ERROR,n.UNKNOWN_SERVER_RESPONSE,n.SERVER_CONNECT_TIMEOUT,n.SERVER_RESPONSE_TIMEOUT,n.SSL_HANDSHAKE_FAILED])},744448:(e,t,r)=>{r.d(t,{G:()=>N,z:()=>M});var i,n,o,s,a,c,l,d,u,h,p,m,f=r(324586),g=r(836936),A=r(626443),v=r(825702),y=r(225304),b=r(972070),w=r(138615),x=r(739367),S=r(656717),T=r(529743),C=r(720315),_=r(298060),k=r(769159),E=r(937111),I=r(776016),R=r(650882),F=r(843875),P=r(467555);function L(e){return!(e instanceof y.j$)||e.status!==A.v.BAD_REQUEST&&e.status!==A.v.CONFLICT&&e.status!==A.v.GONE}let N=(i=(0,v.Gr)(),n=function(e,t){return(0,v.WQ)(S.a8)(e,void 0,0)},o=Reflect.metadata("design:type",Function),s=Reflect.metadata("design:paramtypes",[void 0===S.a8?Object:S.a8]),a=(0,C.P)({maxAttempts:6,backOffPolicy:"exponential",doRetry:L}),c=Reflect.metadata("design:type",Function),l=Reflect.metadata("design:paramtypes",["undefined"==typeof GCPProjectMetadata?Object:GCPProjectMetadata]),d=(0,C.P)({maxAttempts:6,backOffPolicy:"exponential",doRetry:L}),u=Reflect.metadata("design:type",Function),h=Reflect.metadata("design:paramtypes",["undefined"==typeof GCPProjectMetadata?Object:GCPProjectMetadata]),i(p=n(p=o(p=s((m=class extends k.P{constructor(e){super(),(0,f.A)(this,"currentlyFetchingProjectId",void 0),(0,f.A)(this,"requestOptions",{retryableHttpCodes:[...P.U]}),this.projectSchemaService=e}async createProject(e){return this.createProjectInner(e)}async createProjectInner(e){try{const t=await b.E.post(`/workspace/${e.storageOptions.workspace.id}/projects/create`,{body:{projectState:e.projectState}});return{projectState:await t.json(E.$),storageOptions:e.storageOptions}}catch(t){if(t instanceof y.j$&&t.status===A.v.CONFLICT)return this.updateProjectInner(e);throw t}}async updateProject(e){return(0,w.G7)("pst__sync_with_retry")?this.updateProjectWithRetry(e):this.updateProjectWithDecorator(e)}async updateProjectWithDecorator(e){return this.updateProjectInner(e)}async updateProjectWithRetry(e){return this.updateProjectInner(e,{doRetry:_.S,maxAttempts:6,backOffPolicy:"fixed"})}async updateProjectInner(e,t){try{const r=await b.E.put(`/projects/${e.projectState.id}`,{body:{projectState:e.projectState},retryPolicy:t,...this.requestOptions});return{projectState:await r.json(E.$),storageOptions:e.storageOptions}}catch(t){if(t instanceof y.j$&&t.status===A.v.NOT_FOUND)return this.createProjectInner(e);throw t}}async fetchProject(e){const t=await b.E.get(`/projects/${e}?metadata=1`,{retryableHttpCodes:[...P.U],retryPolicy:{doRetry:y.PL,maxAttempts:6,backOffPolicy:"exponential"}});let r;try{const e=(0,I.t9)({projectState:await this.projectSchemaService.getUnknownProjectGuard(),workspaceId:I.Kg}),i=await t.json(e);r=i.projectState.schemaVersion;const n=await(0,F.H6)(i.workspaceId);return{projectState:await this.projectSchemaService.migrate(i.projectState),storageOptions:{workspace:n}}}catch(t){if((0,T.x)(t))throw t;throw new R.g9("Project body invalid for project",{projectId:e,originalError:t instanceof Error?t.message:"unknown",originalContext:t instanceof R.g9?t.context:{},schema:{clientVersion:await this.projectSchemaService.getVersion(),ingestedVersion:r??"unknown"}})}}},(0,g.A)(m.prototype,"createProject",[a,c,l],Object.getOwnPropertyDescriptor(m.prototype,"createProject"),m.prototype),(0,g.A)(m.prototype,"updateProjectWithDecorator",[d,u,h],Object.getOwnPropertyDescriptor(m.prototype,"updateProjectWithDecorator"),m.prototype),p=m))||p)||p)||p)||p);function M(){return(0,x.l)(k.X)}},33493:(e,t,r)=>{r.d(t,{I:()=>n});var i=r(7089);function n(e){return{...e,id:(0,i.u)(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),version:0}}},995895:(e,t,r)=>{r.d(t,{v:()=>s,y:()=>o});var i=r(399079),n=r(716854);const o={[n.t]:["q"]};function s(e){return(0,i.v)(e,o)}},82575:(e,t,r)=>{r.d(t,{nE:()=>A,Mg:()=>P,IM:()=>T,wz:()=>x,K4:()=>S,CJ:()=>E,Qp:()=>I,o3:()=>C,tR:()=>y,LY:()=>_,hD:()=>v,w2:()=>b,Jd:()=>w}),r(584570),r(82265),r(988124);var i=r(289111),n=r.n(i),o=r(515207),s=r(415004),a=r(412746),c=r(559755),l=r(560494),d=r(170553),u=r(178249),h=r(575465),p=r(972070);const m=(0,a.y)(((...e)=>({...(0,h.mQ)(...e)})));function f(e,t){return(0,s.n)(m,e,t)}const g=(e,t)=>e===t;class A extends d.HK{init(){}getUserPreferences(){return m.getState().user?.preferences}async updateUserPreferences(e,t){const r=T().user;if(!r)return;const i=r.preferences[e],o="function"==typeof t?t(i):t,s={...r.preferences,[e]:o};if(y((e=>{e.user&&(e.user.preferences=s)})),!n()(i,o))try{await function(e){return p.E.put("/user/preferences",{body:e})}(s)}catch(t){const n={...r.preferences,[e]:i};y((e=>{e.user&&(e.user.preferences=n)}))}}}function v(e,t){return f((t=>e(t)),t)}function y(e){m.getState().updateAuthState(e)}function b(){return f((e=>function(e){return(e?.underageUserBlocked??!1)||"true"===sessionStorage.getItem(h.yy)}(e)))}function w(){return f((e=>e.user))}function x(){return m.getState().user}function S(){return m.getState().workspace}function T(){return m.getState()}function C(e){y((t=>{t.error=void 0,t.workspace=e}))}const _=e=>{T().user&&y((t=>{t.user&&(t.user.primaryCredential=e,t.user.email=e.email)}))};function k(e){return m.subscribe(((t,r)=>e(t,r)))}function E(e,t=g){return new o.c((r=>{const i=m.getState();r.next(e(i));const n=k(((i,n)=>{const o=e(i),s=e(n);((void 0===o||void 0===s)&&o!==s||void 0!==o&&void 0!==s&&!t(o,s))&&r.next(o)}));r.add(n)}))}function I(e,t=g){return new o.c((r=>{const i=m.getState().user;r.next(e(i));const n=k(((i,n)=>{const o=e(i?.user),s=e(n?.user);((void 0===o||void 0===s)&&o!==s||void 0!==o&&void 0!==s&&!t(o,s))&&r.next(o)}));r.add(n)}))}function R(e,t){const r=new URL(e.url),i=t??("microsoft"===(n=r).searchParams.get("context")?"/login/microsoft":"/"===n.pathname?"/signup":"/login");var n;return function(e){e.pathname.includes("remix")||(0,u.$X)("m365createblank"===e.searchParams.get("utm_source")?"editor/new":e.toString())}(r),(0,l.V2)(`${i}${r.search}`,void 0,e)}const F=new Promise((e=>{k(((t,r)=>{!1===t.loading&&!0===r.loading&&e()}))}));async function P(e,t){const r=c.j.getToken();if(!r)throw R(e,t);await F;const i=x();if(!i)throw R(e,t);return{user:i,token:r}}},771482:(e,t,r)=>{r.d(t,{G:()=>s,z:()=>a});var i=r(739367),n=r(889688),o=r(779779);const s=()=>(0,i.l)(o.l),a=()=>(0,n.W)(o.l)},843875:(e,t,r)=>{r.d(t,{uA:()=>A,H6:()=>v,U5:()=>y,yW:()=>b,Si:()=>T,Fd:()=>_,iw:()=>x,nv:()=>w,HP:()=>C});var i=r(596254),n=r(275221),o=r(689223),s=r(26985),a=r(562229),c=r(972070),l=r(751108),d=r(776016),u=r(82575),h=r(738586);const p=(0,d.t9)({workspaces:(0,d._j)(h.Iy)}),m=()=>(0,c.E)("/user/workspaces").json(p).then((e=>e.workspaces)),f=(0,d.t9)({count:d.Et});async function g(){return(0,l.SX)().fetchQuery((0,h.Du)(),(()=>m()),{retry:6})}async function A(){const e=(await g()).find((e=>e.isDefault));if(!e)throw new Error("No default workspace for user");return e}async function v(e){const t=(await g()).find((t=>t.id===e));if(!t)throw new Error("No folder found for user");return t}async function y(){return(0,u.K4)()||A()}const b=()=>(0,i.I)((0,h.Du)(),(()=>m()),{select:e=>(0,h.GE)(e)}),w=()=>{const e=b(),t=(0,s.useMemo)((()=>(e.data??[]).filter((e=>!e.isDefault))),[e]);return{...e,data:t}},x=(e,t=!0)=>{const{data:r,status:n,error:o}=(0,i.I)((0,h.Wt)(e),(()=>(e=>(0,c.E)(`/workspace/${e}/projects/count`).json(f).then((e=>e.count)))(e)),{staleTime:5e3,enabled:t});return"loading"===n?[void 0,!1]:o||"success"!==n?[void 0,!0]:[r,!1]},S=(0,d.t9)({id:d.Kg,name:d.Kg}),T=()=>{const e=(0,n.jE)(),{mutateAsync:t,isLoading:r,error:i}=(0,o.n)((async e=>await(0,c.E)("workspace",{method:"POST",body:e}).json(S)),{onSuccess:async(t,r)=>{a.z.logEvent("Project page - New Folder Created",{folderName:r.name}),await e.invalidateQueries((0,h.Du)())}});return{createFolder:t,isLoading:r,error:i}},C=()=>{const e=(0,n.jE)(),{mutateAsync:t,isLoading:r,error:i}=(0,o.n)((async({workspaceId:e,...t})=>{await c.E.put(`workspace/${e}`,{body:t})}),{onMutate:({workspaceId:t,...r})=>{const i=(0,h.Du)(),n=e.getQueryData(i);if(n){const o=n.map((e=>e.id===t?{...e,...r}:e));e.setQueryData(i,o)}return n},onSuccess:async()=>{await e.invalidateQueries((0,h.Du)()),a.z.logEvent("Project page - Renamed Folder")},onError:(t,r,i)=>{e.setQueryData((0,h.Du)(),i)}});return{updateFolder:t,isLoading:r,error:i}},_=()=>{const e=(0,n.jE)(),{mutateAsync:t,isLoading:r,error:i}=(0,o.n)((async({workspaceId:e,...t})=>await(0,c.E)(`workspace/${e}`,{method:"DELETE",body:t})),{onSuccess:async()=>{await e.invalidateQueries((0,h.Du)()),a.z.logEvent("Project page - Deleted Folder")}});return{deleteFolder:t,isLoading:r,error:i}}},738586:(e,t,r)=>{r.d(t,{Du:()=>s,GE:()=>c,Iy:()=>o,Wt:()=>a,yE:()=>n});var i=r(776016);const n=255,o=(0,i.t9)({id:i.Kg,name:(0,i.H7)(i.Kg),isDefault:i.Lm}),s=()=>["folders"],a=e=>["folder_project_count",e],c=(e,t=!0)=>e.sort(((e,r)=>e.isDefault?-1:r.isDefault?1:(e?.name??"")<(r?.name??"")?t?-1:1:(e?.name??"")>(r?.name??"")?t?1:-1:0))},529527:(e,t,r)=>{r.d(t,{$:()=>h,T:()=>m});var i=r(324586),n=r(290243),o=r(158393),s=r(255443),a=r(965579),c=r(809200),l=r(31964),d=r(896369),u=r(68111);function h(){const e=location.hostname;return e.includes("app.clipchamp.com")?"production":e.includes("beta")?"beta":e.includes("usertest")?"usertest":e.includes("test")?"test":e.includes("smoke")?"smoke":e.includes("local")?"local":e.includes("app.clipchamp-dev-")||e.includes("app.clipdev-")?"custom":"dev"}const p={local:n.c,dev:o.c,custom:s.c,smoke:a.c,test:c.c,beta:l.c,production:d.c,usertest:u.c},m=(new class{constructor(){(0,i.A)(this,"environmentConfig",void 0);const e=h();this.environmentConfig=p[e]||p.local}}).environmentConfig},195918:(e,t,r)=>{var i={};r.r(i);var n={};r.r(n);var o={};r.r(o),r(892543);var s=r(257587);SVGAnimatedString.prototype.indexOf=function(){return this.baseVal.indexOf.apply(this.baseVal,arguments)},window.process=s,window.global=window,window.Buffer=window.Buffer||r(693896).Buffer;var a=r(971617),c=r(667017),l=r(573340),d=r(842880),u=r(650882),h=(r(993494),r(959763)),p=r(562229),m=r(719587),f=r(692701),g=r(133217),A=r(776016),v=r(415208),y=r(762857);const b={rookie:{unlimitedImportSize:"none"},essentials:{unlimitedImportSize:"available"},ms365_classic:{unlimitedImportSize:"available"},ms365:{unlimitedImportSize:"available"}};var w=r(907057);var x=r(969956),S=r(944865),T=r(401834),C=r(138615);function _(){return new Worker(new URL(r.p+r.u(33498),r.b),{type:"module"})}r(584570),r(82265),r(988124);var k=r(529527),E=r(889688),I=r(368288),R=r(700227),F=r(964469),P=r(508302),L=r(274095),N=r(549443),M=(r(379321),r(272885)),B=r(668388),D=r(26985);var O=r(847269),j=r(511329),U=r(540023),z=r(212984),W=r(97475),V=r(731663),H=r(620486),G=r(565282),q=r(566573),Q=r(901948);function K(e,t,...r){(0,W.Z)({category:"console",message:String(t),data:{...r},level:e})}class X{constructor(){(0,Q.i)({integrations:[(0,V.L)({onunhandledrejection:!1,onerror:!1})],enabled:(0,q.hl)(),beforeSend:e=>(0,q.hl)()?e:null}),(0,H.o5)().setTag("snap","false")}error(e,...t){(0,G.l7)("errorObject",e),t&&(0,G.cx)({...t}),e instanceof u.g9?(e.context&&((0,G.Wt)(e.context),(0,G.cx)(e.context)),(0,G.Cp)(e)):e instanceof Error?(0,G.Cp)(e):"string"==typeof e?(0,G.Cp)(new Error(`${e}`)):(0,A.Gv)(e)&&e.error?(0,G.Cp)(e.error):(0,A.Gv)(e)&&"string"==typeof e.message?(0,G.Cp)(new Error(e.message)):(0,G.Cp)(e)}log(e,...t){K("log",e,...t)}debug(e,...t){K("debug",e,...t)}info(e,...t){K("info",e,...t)}warn(e,...t){K("warning",e,...t)}setExtraContext(e){(0,G.cx)(e)}}function Y(){setTimeout((()=>{window.dataLayer&&window.dataLayer.push({event:"optimize.activate"}),Y()}),300)}var Z=r(241289),J=r(674871),$=r(515207),ee=r(584571),te=r(36185),re=r(197761),ie=r(673101),ne=r(515956),oe=r(241472),se=r(324586),ae=r(715375),ce=r(464692),le=r(259777),de=r(143880),ue=r(235867),he=r(957038),pe=r(703337),me=r(844172),fe=r(286337),ge=r(484378),Ae=r(665688),ve=r(570716),ye=r(232739),be=r(561979),we=r(960648),xe=r(782949),Se=r(219629),Te=r(114971),Ce=r(895126),_e=r(809810),ke=r(825702);const Ee=["AutocaptionToggleInteracted","AutocaptionDownloadInteracted","AutocaptionVisiblilityToggleInteracted","SilenceRemoved","SilenceLoaded","Editor - Clicked Property Panel","Editor - Enabled PIP","Error - Checkout Error","Error - Export Failed","Error - Log in/Sign up","Linking - Cancelled","Linking - Failed","Linking - Failed Reason","Linking - Started Link Process","Linking - Success","Logging - Import Success","Onboarding - Clicked Guest Account Button","Onboarding - Skipped","Onboarding - User Function Completed","Onboarding - User Name Completed","Onboarding - User Type Completed","Page - Exit Intent","Project page - Clicked Create Folder","Project page - Deleted Folder","Project page - Home","Project page - New Folder Created","Project page - Renamed Folder ","Project page - Template Collection","Revenue - Options Served","Revenue - Ready to Pay","Revenue - Subscription Chosen","Share Video - Share Page Created","Store Review - Leave Review Cicked","Store Review - Dialog Closed","Upload - Upload Complete","Upload - Upload Error","Usage - Added Asset","Usage - Change Email Start","Usage - Clicked All Templates","Usage - Clicked brand kit add palette","Usage - Clicked Brand","Usage - Clicked Upgrade Plan","Usage - Cloud Backend Deletion Scheduled [IAM]","Usage - cloud backup clicked by non-paid user","Usage - Cloud Backup Enabled","Usage - Content Added","Usage - Create video","Usage - Started Export","Usage - Export Successful","Usage - First clicked Item","Usage - Mobile Upload Completed","Usage - Onboarding Survey Completed","Usage - PWA installed","Usage - PWA Leave Store Review Clicked","Usage - screen recording added to project","Usage - Show More Features","Usage - Started Export","Usage - Stock Added","Usage - Template used","Usage - Homepage template search field opened","Usage - Uploaded logo","Usage - Use default template","Usage - Video Moved","Usage - web+screen opened","Usage - web+screen recording finished","Usage - webcam recording added to project","Text to speech - Clicked add to media","Usage - Satisfaction Survey Response","AutoCompWizardOpened","AutoCompWizardClosed","Usage - Clicked Export","Usage - Started Import","Usage - Add text to speech","Usage - Click text to speech","Editor - Speaker Coach On","Editor - Review Speech","Usage - DFC Chat Started","Usage - Help and Learning Opened","Usage - Request Mobile Upload Link","Third Party Import - file selected","Editor - Trim","Usage - split","Editor - Applied Filter","BackgroundRemovalInteracted","BackgroundRemovalCompleted","Usage - Product tour completed","Usage - Product tour dismissed","Usage - Product tour next step","Usage - Product tour started","Usage - Clicked record & create sidebar tab","Usage - Clicked Discover"],Ie=["Revenue - Checkout Finished"],Re=["exports","is_pwa","plan","projects","resolutionTokens","userType","userFunction","businessType","userVideoEditingFrequency","userVideoKind","userVideoKindV2","accountCreationDate","teamId","teamName","teamPlan","teamSize","teamType","role","appLanguage","feature.editor__performance_metrics","hasGoogleCred","hasAppleCred","hasMagicLinkCred","hasEmailPasswordCred","hasMicrosoftCred","targetProvider","reason","MSAConnected","isChromeOSTWA","paypal_token","isWindowsNative"];var Fe;const Pe="brazeConfig";let Le=(0,ke.Gr)()((Ne=Fe=Reflect.metadata("design:type",Function)(Fe=Reflect.metadata("design:paramtypes",["undefined"==typeof IBrazeConfig?Object:IBrazeConfig])(Fe=class{constructor(e){(0,se.A)(this,"enabled",!1),(0,se.A)(this,"apiKey",void 0),(0,se.A)(this,"endpoint",void 0),(0,se.A)(this,"userId",void 0),(0,se.A)(this,"userProps",{}),(0,se.A)(this,"emailStatus",void 0),(0,se.A)(this,"events",[]),(0,se.A)(this,"essential",!0),(0,se.A)(this,"notificationCards",null),(0,se.A)(this,"bannerCards",null),this.config=e,this.apiKey=this.config.brazeApiKey,this.endpoint=this.config.brazeSdkEndpoint,"undefined"==typeof window||window.braze||(window.braze=ae)}boot(){ce.n(this.apiKey,{baseUrl:this.endpoint,openInAppMessagesInNewTab:!0,allowUserSuppliedJavascript:!0,manageServiceWorkerExternally:!0}),le.F(),de.O((()=>{})),ue.f(),this.enabled=!0,this.userId&&(this.setUserId(this.userId),this.userId=void 0),this.setUserProperties(this.userProps),this.userProps={},this.emailStatus&&(this.setEmailStatus(this.emailStatus),this.emailStatus=void 0);for(const[e,t]of this.events)this.logEvent(e,t);this.events=[]}incrementUserProperty(e){this.enabled&&he.w()?.incrementCustomUserAttribute(e,1)}isGDPRCompliant(){return!0}shouldSendPII(){return!0}logEvent(e,t,r){this.enabled?(Ee.includes(e)||Ie.includes(e))&&(pe.logCustomEvent(e,function(e){if(!e)return e;const t={};for(const r in e){const i=e[r];(["string","number","boolean","bigint"].includes(typeof i)||"object"==typeof i&&i instanceof Date)&&(t[r]=i)}return t}({...t,eventName:e})),r&&r()):this.events.push([e,t])}logout(){}page(){}setOptOut(){}setUserId(e){this.enabled?me.changeUser(e):this.userId=e}setUserProperties(e){if(this.enabled)for(const t in e)"email"!==t?"first_name"!==t?"last_name"!==t?Re.includes(t)&&he.w()?.setCustomUserAttribute(t,e[t]):he.w()?.setLastName(e[t]):he.w()?.setFirstName(e[t]):he.w()?.setEmail(e[t]);else this.userProps={...this.userProps,...e}}setEmailStatus(e){if(!this.enabled)return void(this.emailStatus=e);let t;switch(e){case"notSubscribed":case"subscribed":default:t=fe.A.NotificationSubscriptionTypes.SUBSCRIBED;break;case"unsubscribed":t=fe.A.NotificationSubscriptionTypes.UNSUBSCRIBED}he.w()?.setEmailNotificationSubscriptionType(t)}refreshNotifications(){ge.J();const e=Ae.H();return this.notificationCards=new ve.A(e.cards.filter(this.getNotificationCards),e.lastUpdated),this.bannerCards=new ve.A(e.cards.filter(this.getBannerCards),e.lastUpdated),this.logControlImpressions(e.cards),Promise.resolve()}mapToNotificationCard(e){return e.map((e=>Object.assign(e,{provider:"Braze",type:e.extras?.feed_type,id:e.id,imageUrl:e.imageUrl||"",linkText:e.linkText||"",url:e.url||"",title:e.title||"",description:e.description||"",viewed:e.viewed,pinned:e.pinned})))}getNotificationCards(e){return(e instanceof ye.A||e instanceof be.A)&&("marketing"===e.extras?.feed_type||"service"===e.extras?.feed_type)}getBannerCards(e){return(e instanceof we.A||e instanceof ye.A||e instanceof be.A)&&!!e.extras?.page}getNotifications(){return new Promise((e=>{if(null!==this.notificationCards?.lastUpdated&&this.notificationCards)return e(this.mapToNotificationCard(this.notificationCards.cards));e([])}))}mapToBannerCards(e){return e.map((e=>Object.assign(e,{provider:"Braze",page:e.extras?.page,id:e.id,imageUrl:e.imageUrl||"",linkText:e.extras?.ariaLabel||e.linkText||"",url:e.url||"",viewed:e.viewed,pinned:e.pinned,bgGradientFrom:e.extras?.bgGradientFrom?.trim()||"",bgGradientTo:e.extras?.bgGradientTo?.trim()||"",buttonColor:e.extras?.buttonColor?.trim()||"",buttonTextColor:e.extras?.buttonTextColor?.trim()||"",title:e instanceof ye.A||e instanceof be.A?e.title:"",description:e instanceof ye.A||e instanceof be.A?e.description:""})))}getBanners(){return this.bannerCards&&null!==this.bannerCards?.lastUpdated?Promise.resolve(this.mapToBannerCards(this.bannerCards.cards)):Promise.resolve([])}getUnreadCount(){return(0,C.Us)("ks_tra__notification_unread_count")?this.notificationCards?.getUnviewedCardCount()||0:this.notificationCards?.lastUpdated&&this.notificationCards?.getUnviewedCardCount()||0}onContentCardsShown(e){xe.j(e,!0)}logControlImpressions(e=[]){if((0,C.G7)("gwy__log_braze_control_impressions"))try{const t=e.filter((e=>e.isControl&&!e.viewed));Se.a(t)}catch(e){l.Vy.log("Unable to log impression for braze control card",e)}}onContentCardClicked(e){Te.x(e,!0)}onContentCardDismissed(e){Ce.a(e)}handleURLAction(e,t){_e.V(e,t)}})||Fe)||Fe,Fe=(0,ke.WQ)(Pe)(Ne,void 0,0)||Fe))||Fe;var Ne,Me=r(205606),Be=r(980493),De=r(552740),Oe=r(823518),je=r(345153),Ue=r(533921),ze=r(172530),We=r(7089);const Ve=()=>{const e=(0,C.yk)();return{getUsedFlights:()=>e.getFeatureIds(),getFlightOverrideOccurred:()=>{const t=e.getAllOverrides();return Object.keys(t)}}};var He=r(553191),Ge=(r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(585026)),qe=r(688518),Qe=r(825855);class Ke{constructor(){(0,se.A)(this,"essential",!0),(0,se.A)(this,"trackingFeatures",new Set)}boot(){Ge.Ts(k.T.amplitudeApiKey,void 0,{useBatch:!0,defaultTracking:{attribution:{excludeReferrers:[location.hostname]},fileDownloads:!1,formInteractions:!1,pageViews:!1,sessions:!1}}),(0,Qe.cr)({"x-amplitude-session-id":()=>Ge.u0()?.toString(),"x-amplitude-device-id":()=>Ge.IP()?.toString()})}getIdentify(){return new qe.T}setEmailStatus(e){this.setUserProperties({emailSubscriptionStatus:e})}incrementUserProperty(e){this.setIdentify(this.getIdentify().add(e,1))}isGDPRCompliant(){return!0}shouldSendPII(){return!1}logEvent(e,t,r){Ge.u4(e,t).promise.then((e=>{r?.(e.code,e.message)})).catch((()=>{}))}logout(){Ge.do(void 0)}page(){}setGroup(e,t){Ge.sI(e,t)}setIdentify(e,t){this.handlePromise(Ge.ls(e).promise,t)}setOptOut(e){Ge.oH(e)}setUserId(e){Ge.do(e)}setOnce(e,t){this.setIdentify(this.getIdentify().setOnce(e,t))}setUserProperties(e){e&&Ge.ls(this.prepareUserProperties(e))}prepareUserProperties(e){const t=new qe.T,r=new Set;for(const[i,n]of Object.entries(e))i.startsWith("feature.")&&r.add(i),t.set(i,n);if(r.size>0){for(const e of this.trackingFeatures)r.has(e)||t.unset(e);this.trackingFeatures=r}return t}handlePromise(e,t){e.then((e=>{200!==e.code&&t?.(e.code,e.message)})).catch((()=>{}))}}var Xe=r(296610),Ye=r(731890);class Ze{get environment(){return(0,k.$)()}get logsInstance(){return Xe.yf}get rumInstance(){return Ye.L}constructor(){(0,se.A)(this,"userId",void 0),(0,se.A)(this,"userProperties",{}),(0,se.A)(this,"currentPage",void 0),(0,se.A)(this,"enabled",!1),(0,se.A)(this,"datadogClientToken",void 0),(0,se.A)(this,"datadogRumApplicationId",void 0),(0,se.A)(this,"logFilterCallback",(e=>(e.view.url=e.view.url.replace(/code=[^&]+/,"code=REDACTED"),e.view.url=e.view.url.replace(/client_info=[^&]+/,"client_info=REDACTED"),e.view.url=e.view.url.replace(/state=[^&]+/,"state=REDACTED"),e.referrer=e.view.referrer?.replace(/code=[^&]+/,"code=REDACTED"),!0))),(0,se.A)(this,"essential",!0),this.datadogClientToken=k.T.datadogClientToken,this.datadogRumApplicationId=k.T.datadogRumApplicationId}boot(){try{this.logsInstance.init({clientToken:this.datadogClientToken,site:"datadoghq.com",service:"create",env:this.environment,forwardErrorsToLogs:!0,sessionSampleRate:100,beforeSend:this.logFilterCallback}),this.rumInstance.init({applicationId:this.datadogRumApplicationId,clientToken:this.datadogClientToken,site:"datadoghq.com",service:"create",env:this.environment,sessionSampleRate:.25,trackResources:!0,trackLongTasks:!0,trackUserInteractions:!0,enablePrivacyForActionName:!0}),this.enabled=!0}catch(e){l.Vy.error(new u.g9("Failed to boot datadog service",{error:e}))}}incrementUserProperty(e){this.userProperties[e]++}isGDPRCompliant(){return!0}shouldSendPII(){return!0}logEvent(e,t){if(this.enabled){const r={eventName:e,userId:this.userId,page:this.currentPage,...this.userProperties,...t};this.logsInstance.logger.info(`::logEvent::${e}`,r),this.rumInstance.addAction(e,r)}}logout(){this.userId=void 0}page(e){this.currentPage=e}setOptOut(){}setUserId(e){this.userId=e}setUserProperties(e){const t={};for(const[r,i]of Object.entries(e))r.startsWith("feature.")&&(t[r.slice(8)]=i,delete e[r]);this.userProperties={...this.userProperties,...e},Object.keys(t).length>0&&(this.userProperties.feature=t)}setEmailStatus(){}}const Je={essential:!1,boot:()=>{(0,U.bp)("setIdentity",{consent:!0})},incrementUserProperty:()=>{},isGDPRCompliant:()=>!0,shouldSendPII:()=>!1,logEvent:(e,t)=>{if(e.startsWith("Braze - ")||e.startsWith("Warning - ")||e.startsWith("Logging - ")||e.startsWith("Performance - "))return;const r=t?Object.fromEntries(Object.entries(t).filter((([,e])=>null!=e))):{emptyProperties:!0};(0,U.bp)("trackEvent",{name:e,properties:r})},logout:()=>{(0,U.bp)("setIdentity",{anonymous:!0})},page:()=>{},setOptOut:()=>{},setUserId:e=>{(0,U.bp)("setIdentity",{uid:e})},setUserProperties:e=>{if(Object.keys(e).length>0&&Object.keys(e)[0].startsWith("feature.")){const t=Object.entries(e).map((([e,t])=>`${e}: ${JSON.stringify(t)}`));(0,U.bp)("setProperties",{type:"user",properties:t})}else(0,U.bp)("setProperties",{type:"user",properties:e})},setEmailStatus:()=>{}},$e=new Map([["Usage - Added Asset",{category:"Usage",action:"added_asset"}],["Usage - Clicked Add Media - File selected",{category:"Usage",action:"added",label:"file"}],["Usage - Clicked Export",{category:"Usage",action:"clicked",label:"export_file"}],["Usage - Clicked Pause",{category:"Usage",action:"clicked",label:"pause"}],["Usage - Clicked Play",{category:"Usage",action:"clicked",label:"play"}],["Usage - Cloud Backup Enabled",{category:"Usage",action:"cloud_backup_enabled"}],["Usage - Create dialogue shown",{category:"Usage",action:"create_dialogue_shown"}],["Usage - Create video",{category:"Usage",action:"new_video",label:"create_new_video"}],["Usage - Export Successful",{category:"Usage",action:"export_successful"}],["Usage - First clicked Item",{category:"Usage",action:"clicked",label:"item"}],["Usage - Freehand action performed",{category:"Usage",action:"freehand_action_performed"}],["Usage - Started Export",{category:"Usage",action:"started_export"}],["Usage - Content Added",{category:"Usage",action:"added",label:"stock"}],["Usage - Stock Added",{category:"Usage",action:"added",label:"stock"}],["Usage - User registered",{category:"Usage",action:"user_registered"}],["Usage - Template used",{category:"Usage",action:"template_used"}],["Onboarding - User Type Completed",{category:"Onboarding",action:"type",label:e=>e.userType}],["Onboarding - User Function Completed",{category:"Onboarding",action:"function",label:e=>e.userFunction}],["Revenue - Checkout Finished",{category:"Revenue",action:"paid"}],["Revenue - Options Served",{category:"Revenue",action:"options_served"}],["Usage - Logged In",{category:"Retention",action:"login"}]]);class et{constructor(){(0,se.A)(this,"essential",!1)}get ga(){return window[et.GA_NAMESPACE]?window[et.GA_NAMESPACE]:()=>{}}boot(){!function(e,t,r,i,n){let o,s;e.GoogleAnalyticsObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*Date.now(),o=t.createElement(r),s=t.getElementsByTagName(r)[0],o.async=1,o.src=i,s.parentNode.insertBefore(o,s)}(window,document,"script",et.ANALYTICS_URL,et.GA_NAMESPACE),this.ga("create",k.T.googleAnalyticsProperty,"auto",{allowLinker:!0}),this.ga("require","linker"),this.ga("linker:autoLink",["util.clipchamp.com","clipchamp.com"]),this.ga("require",k.T.googleOptimizeContainer),this.ga((e=>{document.cookie=`ccGaClientId=${e?.get("clientId")}`}))}incrementUserProperty(){}setEmailStatus(){}isGDPRCompliant(){return!1}shouldSendPII(){return!1}logEvent(e,t){if($e.has(e)){const r=$e.get(e);this.ga("send","event",r.category,r.action,"function"==typeof r.label?r.label(t):r.label,"function"==typeof r.value?r.value(t):r.value,void 0)}}logout(){}page(e){this.ga("set","page",e),this.ga("send","pageview",void 0)}setOptOut(e){window["ga-disable-"+k.T.googleAnalyticsProperty]=e}setUserId(e){this.ga("set","userId",e)}setUserProperties(){}}(0,se.A)(et,"ANALYTICS_URL","https://www.google-analytics.com/analytics.js"),(0,se.A)(et,"GA_ASYNC_CLASS","async-hide"),(0,se.A)(et,"GA_DATA_LAYER","dataLayer"),(0,se.A)(et,"GA_NAMESPACE","ga"),(0,se.A)(et,"GA_OPTIMIZE_TIMEOUT_MS",4e3);class tt{constructor(){(0,se.A)(this,"userScope",{}),(0,se.A)(this,"tags",{})}appendToUserScope(e){this.userScope={...this.userScope,...e};for(const[t,r]of Object.entries(e))t.startsWith("feature.")&&!0===r&&(this.tags[t.slice(8)]="true")}boot(){}incrementUserProperty(){}setEmailStatus(){}isGDPRCompliant(){return!0}shouldSendPII(){return!0}logEvent(e,t){(0,W.Z)({category:"Analytics",message:e,data:t,level:"info"})}logout(){(0,H.o5)().setUser({})}page(){}setOptOut(){}setUserId(e){this.appendToUserScope({id:e}),this.updateUserScope()}setUserProperties(e){this.appendToUserScope(e),this.updateUserScope()}updateUserScope(){const e=(0,H.o5)();e.setUser({...this.userScope}),e.setTags(this.tags)}}const rt=()=>{const e=[new Ke,new tt,new Ze];return(0,C.G7)("tra__disable_google_analytics")||e.push(new et),(0,C.G7)("multi__consumer_1ds")&&e.push((({ring:e,environment:t,ingestionKey:r,defaultLang:i,mediaService:n})=>{const o=window.clipchampWindowsNativeApp?.sessionId||(0,We.u)(),s=o,a=(e=>({version:"1",appName:"Microsoft.Clipchamp",ingestionKey:"",overrideEndpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0/",...e}))({version:"9f3dcec",ingestionKey:r,includeTimingFields:!0}),c={sessionId:o,version:"9f3dcec",puid:void 0,tenantId:void 0,userId:void 0,language:i,environment:t,workload:"External",accountType:"ConsumerAnonymous",mediaService:n},l=(0,C.yk)(),d={sessionId:s,ring:e,getProviders:()=>l.getProviderNames(),...Ve()};return new ze.b(a,c,d)})({ring:k.T.oneDsRing,environment:k.T.oneDsEnvironment,ingestionKey:k.T.oneDsIngestionKey,defaultLang:He.xN,mediaService:"GCP"})),(0,C.G7)("editor__fullstory_enabled")&&e.push(Je),e};var it=r(540636);function nt(e){return{email:e.email,first_name:e.firstName,last_name:e.lastName,accountCreationDate:e.createdAt}}var ot=r(82575),st=r(558899),at=r(559755),ct=r(249023);const lt=location.origin,dt=location.hostname.toLowerCase().startsWith("localhost");function ut(e,t){}class ht extends Error{constructor(){super("Msal Auth state is not initalized")}}let pt;const mt=(e,t,r)=>{r||(e===ct.$.Error?l.Vy.error(t):l.Vy.log(t))};var ft=r(272908),gt=r(779779),At=r(126968),vt=r(831123);class yt{constructor(e){(0,se.A)(this,"_store",void 0),this._store=e||(0,vt.vt)((()=>({})))}initialize(){return Promise.resolve()}isEnabled(e){const t=this._store.getState()[e];if(void 0!==t)return"boolean"==typeof t&&t}getValue(e){const t=this._store.getState()[e];if(void 0!==t)return t}getAll(){return this._store.getState()}useStore(e){return e?this._store((t=>t[e])):this._store()}setFeatures(e){(0,At.unstable_batchedUpdates)((()=>{this._store.setState(e,!0)}))}setFeature(e,t){(0,At.unstable_batchedUpdates)((()=>{this._store.setState({[e]:t})}))}onFeaturesChanged(e){return this._store.subscribe((t=>e(t)))}__reset(){this._store.setState({},!0)}}class bt extends yt{constructor(e){super(),(0,se.A)(this,"featureIds",void 0),(0,se.A)(this,"name",void 0),this.client=e,this.name=e.name}async initialize(e,t){let r,i;await this.client.initialize(),({featureIds:r,features:i}=e?await this.client.loadUserFeatures(e,t):await this.client.attemptHydrateUserFeatures()),this.setFeatures(i),this.featureIds=r}getFeatureIds(){return this.featureIds}}var wt=r(784603),xt=r(854392);class St{constructor(e){this.providers=e}getProviderNames(){return this.providers.map((e=>e.name))}isEnabled(e){let t;for(let r=this.providers.length-1;r>=0;r--)if(t=this.providers[r].isEnabled(e),void 0!==t)return t;return!1}getValue(e){let t;for(let r=this.providers.length-1;r>=0;r--)if(t=this.providers[r].getValue(e),void 0!==t)return t}__internalGetValueForAllProviders(e){const t={};let r="";for(let i=0;i<this.providers.length;i++){const n=this.providers[i].getValue(e);void 0!==n&&(t[this.providers[i].name]=n,r=this.providers[i].name)}return{values:t,winner:r}}getAll(){return this.providers.reduce(((e,t)=>({...e,...t.getAll()})),{})}getAllOverrides(){return this.providers.reduce(((e,t)=>t.isTestSource?{...e,...t.getAll()}:e),{})}getFeatureIds(){for(let e=this.providers.length-1;e>=0;e--){const t=this.providers[e].getFeatureIds?.();if(t)return t}return[]}setDebugFeatures(){if("ClipchampDebugFlightProvider"!==this.providers.at(-1)?.name)return;const e=this.getAll(),t={};for(const r of[...wt.Gv,...xt.yP])void 0===e[r]&&(t[r]=!1);this.setFeatures(t)}useStore(e){this.providers.forEach((t=>t.useStore?.(e)))}onFeaturesChanged(e,t){t&&e(this.getAll());const r=t=>{e({...this.getAll(),...t})},i=this.providers.map((e=>e.onFeaturesChanged?.(r)));return()=>{i.forEach((e=>e?.()))}}setFeatures(e){for(let t=this.providers.length-1;t>=0;t--){const r=this.providers[t];if(r.setFeatures)return void r.setFeatures(e)}}setFeature(e,t){for(let r=this.providers.length-1;r>=0;r--){const i=this.providers[r];if(i.setFeature)return void i.setFeature(e,t)}}initialize(e,t){return Promise.all(this.providers.map((r=>r.initialize(e,t))))}__reset(){this.providers.forEach((e=>e.__reset?.()))}}var Tt=r(92940);class Ct extends yt{constructor(...e){super(...e),(0,se.A)(this,"name","ClipchampDebugFlightProvider"),(0,se.A)(this,"isTestSource",!0)}}var _t=r(202828),kt=r(766589);const Et=(0,A.t9)({apiKey:A.Kg,email:A.Kg,userType:(0,A.H7)(A.Kg)}),It="cc_user_data";function Rt(){localStorage.removeItem(It)}class Ft{constructor(e){(0,se.A)(this,"client",void 0),(0,se.A)(this,"baseConfig",void 0),(0,se.A)(this,"baseParameters",void 0),(0,se.A)(this,"timeoutLimit",3e3),(0,se.A)(this,"getRolloutEnvironment",void 0),(0,se.A)(this,"getSubscriptionStatePlan",void 0),(0,se.A)(this,"extractFeatureIds",void 0),(0,se.A)(this,"extractFeatures",void 0),(0,se.A)(this,"name","ClipchampECSProvider");const{hosts:t,clientName:r,clientVersion:i,agents:n,cloud:o}=e;this.getRolloutEnvironment=e.getRolloutEnvironment,this.getSubscriptionStatePlan=e.getSubscriptionStatePlan,this.extractFeatureIds=e.extractFeatureIds,this.extractFeatures=e.extractFeatures,this.baseConfig={hosts:t,clientName:r,clientVersion:i,configsToFetch:[_t.Bj.EcsConfigType.Default],getEcsParameters:()=>(0,kt.Resolved)({}),initialAppActiveState:!0},this.baseParameters={agents:n,cloud:o,rolloutEnvironment:this.getRolloutEnvironment()}}async initialize(){return Promise.resolve()}loadFeaturesAnonymous(e){return this.loadFeatures(this.getLoggedOutUserParameters(e))}loadUserFeatures(e,t){return this.loadFeatures(this.getUserParameters(e,t))}attemptHydrateUserFeatures(){const e=function(){const e=localStorage.getItem(It);if(null===e)return;let t;try{t=JSON.parse(e)}catch(e){return console.error(e),void Rt()}return Et(t)?t:(console.error("Unknown data received for user storage, cannot hydrate"),void Rt())}();return e?this.loadFeatures(this.getHydratedUserParameters(e)):this.loadFeaturesAnonymous()}getUserParameters(e,t){return{...this.baseParameters,rolloutEnvironment:this.getRolloutEnvironment(e.email),userId:e.apiKey,userType:e.preferences.userType,plan:this.getSubscriptionStatePlan()||"rookie",country:t?.country,os:t?.os}}getLoggedOutUserParameters(e){const t=localStorage.getItem("cc_logged_out_id")||(0,We.u)();return localStorage.setItem("cc_logged_out_id",t),{...this.baseParameters,userId:t,country:e?.country,os:e?.os}}getHydratedUserParameters(e){return{...this.baseParameters,rolloutEnvironment:this.getRolloutEnvironment(e.email),userId:e.apiKey,userType:e.userType}}async loadFeatures(e){const t=this.client=new _t.Ay;for(const t of Object.keys(e))void 0===e[t]&&delete e[t];let r;await this.client.initialize({...this.baseConfig,getEcsParameters:()=>(0,kt.Resolved)(e)});const i=new Promise((e=>{r=setTimeout((()=>{t.dispose(),e({featureIds:[],features:{}})}),this.timeoutLimit)})),n=new Promise((e=>{const i=()=>{clearTimeout(r),t.configUpdated.unsubscribe(i);const n=t.getConfig();(0,O.iY)(n,"EcsClient.getConfig() returned undefined");const o=this.extractFeatureIds(n.config),s=this.extractFeatures(n.config),a=Object.entries(wt.Ix).reduce(((e,[t,r])=>({...e,[t]:r(s,s[t])})),{});e({featureIds:o,features:{...s,...a}})};t.configUpdated.subscribe(i)}));return Promise.race([n,i])}}const Pt=new Set(["clipchamp.com","microsoft.com"]),Lt={local:"Dev",dev:"Dev",custom:"Test",test:"Test",beta:"Beta",production:"Prod",smoke:"Test",usertest:"Test"};function Nt(e){let t=Lt[(0,k.$)()];if("Prod"===t&&e){const r=e.split("@").at(-1);r&&Pt.has(r)&&(t="PublicPreview")}return t}function Mt(){return(0,v.uV)()?.plan.id}var Bt=r(211762),Dt=r.n(Bt),Ot=r(347653),jt=r(969442),Ut=r(373384),zt=r(247498);const Wt={...Object.fromEntries(He.Up.map((e=>[e.split("-")[0],e]))),no:"nb-NO",nn:"nb-NO",en:"en-US",es:"es-ES",fr:"fr-FR",pt:"pt-BR",zh:"zh-CN"},Vt=(e,t)=>{if(!t)return;if((0,He.e7)(t)&&e.includes(t))return t;const[r]=t.split("-");if(r in Wt){const t=Wt[r];if(e.includes(t))return t}},Ht=e=>(0,Ue.Tv)(e,(e=>e.replaceAll("&amp;","&").replaceAll("&lt;","<").replaceAll("&gt;",">")));var Gt=r(540076),qt=r(667596);const Qt=(0,A.u)("en-US","zz-ZZ","zz-ZZZZ","zz-RTL");var Kt=r(686487);const Xt="lang";var Yt=r(325065);const Zt=(e,t,r=!1)=>{const i=t.split("-")[0],n=document.createElement("link"),o=r?`?${Xt}=${t}`:"";n.rel=r?"alternate":"canonical",n.href=e+o,r&&(n.hreflang=i),document.getElementsByTagName("head")[0].appendChild(n)},Jt=()=>{const{t:e}=jt.Ay,t=document.documentElement.lang||He.xN,r=t.split("-")[0],i={content:e(Yt.k,{lng:t}),lang:r};document.title=i.content;const n={content:e(Yt.G,{lng:t}),lang:r},o=document.querySelector('meta[name="description"]');o&&(o.content=n.content,o.lang=n.lang)};var $t=r(457965),er=r(972070),tr=r(414966),rr=r(891094),ir=r(771482);const nr=(0,A.t9)({locale:He.e7}),or=new tr.T;async function sr(e){return or.queuePromise((async()=>{const t=(0,ot.wz)(),r=t?.locale,i=(0,A.O9)(t);if(r===e)return;if((0,He.MI)(e))return;if(!i)return;const n={locale:e};try{await er.E.put("user/locale",{body:n}).json(nr),await(0,ir.z)().loadUser();const t=r||He.xN;p.z.logEvent("Usage - Changed Language",{page:"account",old:t,new:e}),p.z.logUserActionEvent("LanguageUpdateSucceeded",{actionType:"Unknown",previousLanguage:t,currentLanguage:e,context:"personalProfile"})}catch(t){const{statusCode:r,errorCode:i}=(0,rr.W)(t);p.z.logErrorEvent("LanguageUpdateFailedError",{errorCode:r,failedLanguage:e,internalApiErrorCode:i})}}))}async function ar(){const e=new Ut.A,t=(0,ot.wz)(),i=$t.S.isPowerUser(t)?He.Up:(0,qt.DQ)();var n;e.addDetector({name:"custom-url",lookup:()=>((e,t)=>{const r=new URLSearchParams(location.search).get(Xt);if(r){const i=Vt(e,r);if(i)return t?.logEvent("Usage - Language Detected",{method:"url",lang:i}),i}})(i,p.z)}),e.addDetector({name:"custom-user",lookup:()=>(e=>{const t=(0,ot.wz)()?.locale;return Vt(e,t)})(i)}),e.addDetector({name:"custom-referrer",lookup:()=>((e,t)=>{const r=Vt(e,(i=document.referrer,i.match(/https:\/\/clipchamp.com\/([a-z]{2,3}(?:-[a-z]{2,8}){0,2})\//i)?.[1]));var i;if(r)return t?.logEvent("Usage - Language Detected",{method:"referrer",lang:r}),r})(i,p.z)}),e.addDetector({name:"custom-native-app",lookup:()=>((e,t)=>{const r=Vt(e,window.clipchampWindowsNativeApp?.languageCode??void 0);return r&&t?.logEvent("Usage - Language Detected",{method:"native-wrapper",lang:r}),r})(i,p.z)}),e.addDetector({name:"custom-navigator",lookup:()=>((e,t)=>{if("undefined"!=typeof navigator)for(const r of navigator.languages){const i=Vt(e,r);if(i)return t?.logEvent("Usage - Language Detected",{method:"navigator",lang:i}),i}})(i,p.z)}),jt.Ay.on("languageChanged",(e=>{document.documentElement.lang=e,Jt(),p.z.setUserProperties({appLanguage:e}),sr(e).catch((e=>console.error(e)))})),(0,ot.Qp)((e=>e)).pipe((0,re.p)(A.O9),(0,re.p)((e=>!(0,A.O9)(e.locale)))).subscribe((()=>{sr((0,Ue.Z0)()).catch((()=>console.error("Could not backfill user language")))})),await jt.Ay.use((n=()=>$t.S.isPowerUser((0,ot.wz)()),function({defaultResourceEnUs:e,languageResource:t,checkIfElevatedSession:i}){return{type:"backend",init(){},read(n,o,s){const a=i();if(!Qt(n)&&!(0,qt.ES)(n)&&!a)return s(new qt.bb(n),null);if("shared"===o&&"en-US"===n)return r.e(8844).then(r.t.bind(r,397117,19)).then((e=>s(null,Ht(e.default)))).catch((e=>s(e,null)));if("shared"===o)return r(911442)(`./${n}/shared.json`).then((e=>s(null,Ht(e)))).catch((e=>s(e,null)));if(Qt(n)){const t=Ht(e);switch(n){case"en-US":case"zz-RTL":return s(null,t);case"zz-ZZ":return s(null,(0,Ue.z1)(t,Ue.W6));case"zz-ZZZZ":return s(null,(0,Ue.z1)(t,Ue._8));default:return(0,Gt.xb)(n,"Language escaped isBuiltInLanguage guard")}}t(n).then((e=>s(null,Ht(e)))).catch((e=>s(e,null)))}}}({defaultResourceEnUs:Kt,languageResource:e=>r(45622)(`./${e}/translation.json`),checkIfElevatedSession:n}))).use(e).use(zt.r9).init({ns:["create","shared"],defaultNS:"create",fallbackNS:"shared",react:{transWrapTextNodes:"span"},fallbackLng:He.xN,interpolation:{escapeValue:!1},detection:{order:["custom-url","custom-user","custom-referrer","localStorage","custom-native-app","custom-navigator"]}}),Jt(),(()=>{const e=location.origin+location.pathname;Zt(e,He.xN),(0,qt.DQ)().filter((e=>e!==He.xN)).forEach((t=>Zt(e,t,!0)))})()}var cr,lr=r(99129);let dr=(0,ke.Gr)()(cr=class{declare(e){(0,O.iY)(window.clipchampWebApp,"Expected Clipchamp native web client to be initialized"),window.clipchampWebApp.capabilities=e}})||cr;var ur,hr,pr,mr,fr,gr,Ar,vr=r(289111),yr=r.n(vr),br=r(635536),wr=r(396159),xr=r(954251),Sr=r(155089),Tr=r(397814);class Cr extends Tr.L{}ur=Cr,(0,se.A)(Cr,"type","[Infrastructure] Web App Initialized"),(0,se.A)(Cr,"isInstance",(0,A.t9)({type:(0,A.u)(ur.type)}));class _r extends Tr.L{constructor(e){super(),(0,se.A)(this,"payload",void 0),this.payload=e}}hr=_r,(0,se.A)(_r,"type","[Infrastructure] Web App Session Established"),(0,se.A)(_r,"isInstance",(0,A.t9)({type:(0,A.u)(hr.type),payload:(0,A.t9)({apiKey:A.Kg,email:A.Kg,name:(0,A.H7)(A.Kg),firstName:(0,A.H7)(A.Kg),lastName:(0,A.H7)(A.Kg),nickname:(0,A.H7)(A.Kg),aadAccount:(0,A.H7)((0,A.t9)({oid:A.Kg,puid:A.Kg,tid:A.Kg}))})}));class kr extends Tr.L{}pr=kr,(0,se.A)(kr,"type","[Infrastructure] Web App Session Terminated"),(0,se.A)(kr,"isInstance",(0,A.t9)({type:(0,A.u)(pr.type)}));let Er=function(e){return e[e.NotInitialized=0]="NotInitialized",e[e.Initialized=1]="Initialized",e[e.SessionEstablished=2]="SessionEstablished",e}({});const Ir=Object.keys(Er).map(Number).filter(Number.isNaN).length;let Rr=(0,ke.Gr)()((fr=class e{get current(){let t=Er.NotInitialized;for(let r=t+1;r<e.state.length;r++){if(!e.state[r].forward)return t;t=r}return t}progress(t){const r={...e.state[t]};return r.forward=!0,this.update(r,t),this.current}regress(t){const r={...e.state[t]};return r.backward=!0,this.update(r,t),this.current}update(t,r){e.state=[...e.state.slice(0,r),t,...e.state.slice(r+1)],this.resetCurrentIfEligible()}resetCurrentIfEligible(){const t=e.state[this.current];t.forward&&t.backward&&this.update({forward:!1,backward:!1},this.current)}},(0,se.A)(fr,"state",new Array(Ir).fill(null).map(((e,t)=>({forward:t===Er.NotInitialized,backward:!1})))),mr=fr))||mr,Fr=(0,ke.Gr)()(gr=function(e){return(0,ke.WQ)(De.T)(e,void 0,0)}(gr=function(e){return(0,ke.WQ)(lr.j)(e,void 0,1)}(gr=function(e){return(0,ke.WQ)(gt.l)(e,void 0,2)}(gr=function(e){return(0,ke.WQ)(Rr)(e,void 0,3)}(gr=Reflect.metadata("design:type",Function)(gr=Reflect.metadata("design:paramtypes",[void 0===De.T?Object:De.T,void 0===lr.j?Object:lr.j,void 0===gt.H?Object:gt.H,void 0===Rr?Object:Rr])((Ar=class e{constructor(e,t,r,i){this.appVariantCheckerService=e,this.nativeMessagingService=t,this.authStoreActions=r,this.appStatusManager=i}init(){e.registered||this.appVariantCheckerService.outside("windows-native")||(e.registered=!0,this.onLogin(),this.onLogout())}onInitialized(){this.updateStatus("progress",Er.Initialized),this.nativeMessagingService.send(new Cr)}onLogin(){this.authStoreActions.loggedIn$.pipe((0,br.K)((0,ot.Qp)((e=>e))),(0,re.p)(A.O9),(0,ie.T)((e=>({apiKey:e.apiKey,email:e.email,firstName:e.firstName,lastName:e.lastName,name:e.name,nickname:e.nickname}))),(0,wr.F)(yr()),(0,xr.Z)((async e=>{let t=null;const r=(await(0,Sr.Gm)()).providers.filter((e=>"MICROSOFT1P"===e.provider));if(1===r.length){const e=r[0].userClaims;e&&(t={oid:e.oid,puid:e.puid,tid:"9188040d-6c67-4c5b-b112-36a304b66dad"})}return{...e,aadAccount:t}})),(0,wr.F)(yr())).subscribe((e=>{this.updateStatus("progress",Er.SessionEstablished),this.nativeMessagingService.send(new _r(e))}))}onLogout(){this.authStoreActions.loggedOut$.subscribe((()=>{this.updateStatus("regress",Er.Initialized),this.nativeMessagingService.send(new kr)}))}updateStatus(e,t){(0,O.iY)(window.clipchampWebApp,"Expected Clipchamp native web client to be initialized");const r=this.appStatusManager[e](t);window.clipchampWebApp.status=Er[r]}},(0,se.A)(Ar,"registered",!1),gr=Ar))||gr)||gr)||gr)||gr)||gr)||gr)||gr;var Pr,Lr=r(26141),Nr=r(971280),Mr=r(217563);let Br=(0,ke.Gr)()(Pr=Reflect.metadata("design:type",Function)(Pr=Reflect.metadata("design:paramtypes",[])(Pr=class{constructor(){(0,se.A)(this,"toast$",void 0),(0,se.A)(this,"onToast",new Mr.B),this.toast$=this.onToast.asObservable()}})||Pr)||Pr)||Pr;var Dr=r(347262),Or=r(625927),jr=r(597808),Ur=r(441910);const zr=(0,A.t9)({type:(0,A.u)("Local File Info"),name:A.Kg,path:A.Kg}),Wr=(0,A.t9)({type:(0,A.u)("Network File Info"),name:A.Kg,path:A.Kg}),Vr=(0,A.t9)({type:(0,A.u)("File Info"),path:A.Kg}),Hr=(0,A.ey)(zr,Wr,Vr),Gr=((0,A.ey)(zr,Wr),(0,A.t9)({alias:(0,A.H7)((0,A.gH)(A.Kg)),correlationId:(0,A.H7)((0,A.gH)(A.Kg)),sessionId:(0,A.H7)((0,A.gH)(A.Kg))}));var qr;class Qr extends Tr.L{constructor(e){super(),(0,se.A)(this,"referrer",void 0),(0,se.A)(this,"payload",void 0),this.payload={fileInfos:e}}}qr=Qr,(0,se.A)(Qr,"type","[Project] Files Selected to Edit"),(0,se.A)(Qr,"isInstance",(0,A.t9)({type:(0,A.u)(qr.type),referrer:(0,A.H7)((0,A.gH)(Gr)),payload:(0,A.t9)({fileInfos:(0,A._j)(Hr)})}));class Kr extends Ur.r{static get messageType(){return Qr}constructor(e,t){super(),this.filesSelectedToEditRepository=e,this.projectStateService=t}async handle(e){this.onMessageReceived(e);const t=this.getAssets(e.payload.fileInfos);if(0!==t.length){if(this.shouldCreateProject(e))return await this.createProject(t),void jr.B.getState().setHandled();this.filesSelectedToEditRepository.postAssets(t),jr.B.getState().setHandled()}else jr.B.getState().setHandled()}getAssets(e){const t=[];return e.forEach((e=>{const r=this.getAsset(e);r?t.push(r):this.onAssetError()})),t}getAsset(e){if("File Info"===e.type){if(!this.isURL(e.path))return null;const t=new URL(e.path).pathname.split("/"),r=t.pop()||t.pop()||e.path;return(0,Or.u)(r,{provider:"url",id:e.path})}return(0,Or.u)(e.name,{provider:"windows_native",id:e.path})}isURL(e){try{return new URL(e),!0}catch(e){return!1}}}var Xr,Yr=r(649079),Zr=r(435715),Jr=r(163708);const[$r,ei]=Nr.F.FAILED_TO_LOAD;let ti=(0,ke.Gr)()(Xr=function(e){return(0,ke.WQ)(Zr.Z)(e,void 0,0)}(Xr=function(e){return(0,ke.WQ)(Br)(e,void 0,1)}(Xr=function(e){return(0,ke.WQ)(Dr.i)(e,void 0,2)}(Xr=function(e){return(0,ke.WQ)(Yr.M)(e,void 0,3)}(Xr=Reflect.metadata("design:type",Function)(Xr=Reflect.metadata("design:paramtypes",[void 0===Zr.Z?Object:Zr.Z,void 0===Br?Object:Br,void 0===Dr.i?Object:Dr.i,void 0===Yr.M?Object:Yr.M])(Xr=class extends Kr{constructor(e,t,r,i){super(r,i),this.contentProjectCreatorService=e,this.toastService=t}onMessageReceived(e){const t=this.projectStateService.isLoaded();p.z.logEvent("Usage - Edit with Clipchamp",{referrer:e.referrer?.alias??"legacy",numFiles:e.payload.fileInfos.length,isProjectOpened:t,currentRoute:this.currentRoute()}),sessionStorage.setItem("referral",e.referrer?.alias??"legacy")}shouldCreateProject(e){const t=this.projectStateService.isLoaded(),r="photosuwp"===e.referrer?.alias&&!0===(0,C.gZ)("gwy__photos_auto_comp",A.Lm),i=null!==(0,Lr.B6)(`${(0,Jr.pF)()}/:projectId`,window.location.pathname);return!(r||i&&t)}async createProject(e){if(await this.contentProjectCreatorService.createBootstrappedProjectWithAssets(e,!1),!0===(0,C.gZ)("editor__edit_with_behaviour",A.Lm)){const e=new URL(window.location.href);e.searchParams.append("editWith","true"),window.history.replaceState({},"",e.toString())}p.z.logEvent("Usage - Create video",{context:"edit-with"})}onAssetError(){this.toastService.onToast.next({category:"error",timeout:5e3,title:$r,message:ei})}currentRoute(){const e=(0,Lr.B6)(`${(0,Jr.pF)()}/:projectId?/:export?`,window.location.pathname);return e?e.params?.export?e.params?.export:"editor":"other"}})||Xr)||Xr)||Xr)||Xr)||Xr)||Xr)||Xr;var ri,ii,ni=r(910997);class oi extends Tr.L{constructor(e){super(),(0,se.A)(this,"payload",void 0),this.payload={launchInfo:e}}}ri=oi,(0,se.A)(oi,"type","[Infrastructure] Launch Source Detected"),(0,se.A)(oi,"isInstance",(0,A.t9)({type:(0,A.u)(ri.type),payload:(0,A.t9)({launchInfo:(0,A.t9)({method:(0,A.gH)(A.Kg),referrer:(0,A.H7)((0,A.gH)(A.Kg))})})}));let si=(0,ke.Gr)()(ii=function(e){return(0,ke.WQ)(ni.T)(e,void 0,0)}(ii=Reflect.metadata("design:type",Function)(ii=Reflect.metadata("design:paramtypes",[void 0===ni.T?Object:ni.T])(ii=class extends Ur.r{static get messageType(){return oi}constructor(e){super(),this.nativeAppLaunchInfoService=e}handle(e){p.z.logEvent("Usage - Native app launched",{...e.payload.launchInfo}),this.nativeAppLaunchInfoService.launchInfo=e.payload.launchInfo,(0,j.V)(this.nativeAppLaunchInfoService.launchInfo),jr.B.getState().setEditWithLaunchSource(e.payload.launchInfo.method)}})||ii)||ii)||ii)||ii;var ai;class ci extends Tr.L{constructor(...e){super(...e),(0,se.A)(this,"referrer",void 0)}}ai=ci,(0,se.A)(ci,"type","[Activation] New video Activated"),(0,se.A)(ci,"isInstance",(0,A.t9)({type:(0,A.u)(ai.type),referrer:(0,A.H7)((0,A.gH)(Gr))}));var li,di=r(399079);let ui=(0,ke.Gr)()(li=Reflect.metadata("design:type",Function)(li=Reflect.metadata("design:paramtypes",[])(li=class extends Ur.r{static get messageType(){return ci}constructor(){super()}async handle(e){const t=(0,di.v)("/editor/new"),r=(0,d.tu)();await r.navigate(t)}})||li)||li)||li;var hi,pi,mi,fi,gi,Ai,vi,yi,bi,wi,xi,Si,Ti,Ci,_i=r(739367);class ki extends Tr.L{}hi=ki,(0,se.A)(ki,"type","[Infrastructure] Cancel Update"),(0,se.A)(ki,"isInstance",(0,A.t9)({type:(0,A.u)(hi.type)}));class Ei extends Tr.L{constructor(e){super(),(0,se.A)(this,"payload",void 0),this.payload={reason:e}}}pi=Ei,(0,se.A)(Ei,"type","[Infrastructure] Cancel Update Failed"),(0,se.A)(Ei,"isInstance",(0,A.t9)({type:(0,A.u)(pi.type),payload:(0,A.t9)({reason:A.Kg})}));class Ii extends Tr.L{constructor(){super()}}mi=Ii,(0,se.A)(Ii,"type","[Infrastructure] Check Update"),(0,se.A)(Ii,"isInstance",(0,A.t9)({type:(0,A.u)(mi.type)}));class Ri extends Tr.L{constructor(e){super(),(0,se.A)(this,"payload",void 0),this.payload={reason:e}}}fi=Ri,(0,se.A)(Ri,"type","[Infrastructure] Check Update Failed"),(0,se.A)(Ri,"isInstance",(0,A.t9)({type:(0,A.u)(fi.type),payload:(0,A.t9)({reason:A.Kg})}));class Fi extends Tr.L{constructor(){super()}}gi=Fi,(0,se.A)(Fi,"type","[Infrastructure] Install Update"),(0,se.A)(Fi,"isInstance",(0,A.t9)({type:(0,A.u)(gi.type)}));class Pi extends Tr.L{constructor(e){super(),(0,se.A)(this,"payload",void 0),this.payload={reason:e}}}Ai=Pi,(0,se.A)(Pi,"type","[Infrastructure] Install Update Failed"),(0,se.A)(Pi,"isInstance",(0,A.t9)({type:(0,A.u)(Ai.type),payload:(0,A.t9)({reason:A.Kg})}));class Li extends Tr.L{constructor(){super()}}vi=Li,(0,se.A)(Li,"type","[Infrastructure] Update Cancelled"),(0,se.A)(Li,"isInstance",(0,A.t9)({type:(0,A.u)(vi.type)}));class Ni extends Tr.L{constructor(e){super(),(0,se.A)(this,"payload",void 0),this.payload={mandatory:e}}}yi=Ni,(0,se.A)(Ni,"type","[Infrastructure] Update Detected"),(0,se.A)(Ni,"isInstance",(0,A.t9)({type:(0,A.u)(yi.type),payload:(0,A.t9)({mandatory:A.Lm})}));class Mi extends Tr.L{constructor(){super()}}bi=Mi,(0,se.A)(Mi,"type","[Infrastructure] Update Installed"),(0,se.A)(Mi,"isInstance",(0,A.t9)({type:(0,A.u)(bi.type)}));class Bi extends Tr.L{constructor(){super()}}wi=Bi,(0,se.A)(Bi,"type","[Infrastructure] Update Not Found"),(0,se.A)(Bi,"isInstance",(0,A.t9)({type:(0,A.u)(wi.type)}));class Di extends Tr.L{constructor(e,t){super(),(0,se.A)(this,"payload",void 0),this.payload={status:e,progress:t}}}xi=Di,(0,se.A)(Di,"type","[Infrastructure] Update Progress Changed"),(0,se.A)(Di,"isInstance",(0,A.t9)({type:(0,A.u)(xi.type),payload:(0,A.t9)({status:A.Kg,progress:A.Et})}));const Oi="windows-app-update";let ji=(0,ke.Gr)()(Si=function(e){return(0,ke.WQ)(De.T)(e,void 0,0)}(Si=Reflect.metadata("design:type",Function)(Si=Reflect.metadata("design:paramtypes",[void 0===De.T?Object:De.T])(Si=class{constructor(e){(0,se.A)(this,"_30Days",2592e6),(0,se.A)(this,"_24Hours",864e5),(0,se.A)(this,"_state",void 0),this.appVariantChecker=e}set state(e){this.appVariantChecker.outside("windows-native")||null===this.appVariantChecker.current.version||(this._state={...e,version:this.appVariantChecker.current.version.raw},localStorage.setItem(Oi,JSON.stringify(this._state)))}get state(){if(void 0!==this._state)return this._state;const e=localStorage.getItem(Oi);if(e)try{this._state=JSON.parse(e)}catch{}return void 0===this._state&&(this._state={version:"0.0.0",updateAvailable:!1}),this._state}shouldCheckForUpdate(){return!this.appVariantChecker.outside("windows-native")&&null!==this.appVariantChecker.current.version&&(0!==this.appVariantChecker.current.version.compare(this.state.version)||void 0!==this.state.expiry&&this.state.expiry<Date.now())}shouldPromptUpdate(){return!this.appVariantChecker.outside("windows-native")&&null!==this.appVariantChecker.current.version&&0===this.appVariantChecker.current.version.compare(this.state.version)&&!(void 0!==this.state.expiry&&this.state.expiry>Date.now())&&this.state.updateAvailable}setUpdateDetected(){this.state={updateAvailable:!0}}setUpdateNotFound(){this.state={updateAvailable:!1,expiry:Date.now()+this._24Hours}}setUpdateIgnored(){!0===this.state.updateAvailable&&(this.state={updateAvailable:!1,expiry:Date.now()+this._30Days})}})||Si)||Si)||Si)||Si,Ui=(0,ke.Gr)()(Ti=function(e){return(0,ke.WQ)(lr.j)(e,void 0,0)}(Ti=Reflect.metadata("design:type",Function)(Ti=Reflect.metadata("design:paramtypes",[void 0===lr.j?Object:lr.j])(Ti=class{constructor(e){this.nativeMessagingService=e}checkUpdate(e,t,r){const i=[this.nativeMessagingService.listen(Ri,(e=>{i.forEach((e=>e())),r(e)})),this.nativeMessagingService.listen(Bi,(()=>{i.forEach((e=>e())),t()})),this.nativeMessagingService.listen(Ni,(t=>{i.forEach((e=>e())),e(t)}))];this.nativeMessagingService.send(new Ii)}downloadAndInstallUpdate(e,t,r,i,n){const o=[this.nativeMessagingService.listen(Pi,(e=>{o.forEach((e=>e())),"NotFound"!==e.payload.reason?r(e):i()})),this.nativeMessagingService.listen(Bi,(()=>{o.forEach((e=>e())),i()})),this.nativeMessagingService.listen(Li,(()=>{o.forEach((e=>e())),t()})),this.nativeMessagingService.listen(Di,(e=>{n(e.payload.status,e.payload.progress)})),this.nativeMessagingService.listen(Mi,(()=>{o.forEach((e=>e())),e()}))];this.nativeMessagingService.send(new Fi)}cancelUpdate(e,t){const r=[this.nativeMessagingService.listen(Ei,(e=>{r.forEach((e=>e())),t(e)})),this.nativeMessagingService.listen(Li,(()=>{r.forEach((e=>e())),e()}))];this.nativeMessagingService.send(new ki)}})||Ti)||Ti)||Ti)||Ti,zi=(0,ke.Gr)()(Ci=function(e){return(0,ke.WQ)(ft.e)(e,void 0,0)}(Ci=function(e){return(0,ke.WQ)(ji)(e,void 0,1)}(Ci=function(e){return(0,ke.WQ)(Ui)(e,void 0,2)}(Ci=Reflect.metadata("design:type",Function)(Ci=Reflect.metadata("design:paramtypes",[void 0===ft.e?Object:ft.e,void 0===ji?Object:ji,void 0===Ui?Object:Ui])(Ci=class{constructor(e,t,r){this.appCapabilitiesService=e,this.updateStateManager=t,this.updateService=r}triggerCheckingForUpdate(){!0!==this.appCapabilitiesService.capabilities?.gwy__update_prompted&&!0===this.appCapabilitiesService.capabilities?.gwy__in_app_update&&this.updateStateManager.shouldCheckForUpdate()&&(p.z.logEvent("[Usage] Checking Update",{context:"update-checker"}),this.updateService.checkUpdate((e=>{this.updateStateManager.setUpdateDetected(),p.z.logEvent("[Usage] Update Detected",{context:"update-checker",...e.payload})}),(()=>{this.updateStateManager.setUpdateNotFound(),p.z.logEvent("[Usage] Update Not Found",{context:"update-checker"})}),(e=>{this.updateStateManager.setUpdateNotFound(),p.z.logEvent("[Error] Check Update Failed",{context:"update-checker",...e.payload})})))}})||Ci)||Ci)||Ci)||Ci)||Ci)||Ci;function Wi(){return(0,_i.l)(ji)}var Vi=r(879181);const Hi=[Vi.P,Ei,ki,Ri,Ii,Pi,Fi,Li,Ni,Mi,Bi,Di];function Gi(e){return e.body?.toJSON()??{}}function qi(e){return!e.active&&e.installing?"new":e.active&&e.installing?"replace":"noop"}const Qi="async-loader-show-spinner",Ki="fs-mask";function Xi(e,t){const r=document.querySelector(".async-loader-container .status-text");r&&(e?(t?r.classList.add(Ki):r.classList.remove(Ki),r.textContent=e):r.textContent=null)}const Yi={onShow:function(e,t){Xi(e,t),document.documentElement.classList.add(Qi)},onHide:function(){document.documentElement.classList.remove(Qi),Xi()}};var Zi=r(956074);function Ji(e){const t=(0,Zi.V)(e);return async()=>{try{return await t()}catch(e){return window.dispatchEvent(new Event("chunkLoadError")),Promise.reject(e)}}}var $i=r(560494),en=r(439415),tn=r(156542),rn=r(662463),nn=r(275221),on=r(155861),sn=r(545516),an=r(804185),cn=r(52509),ln=r(277277);const dn=()=>{const[e,t]=(0,D.useState)(!1),{t:r}=(0,zt.Bd)();(0,D.useEffect)((()=>{const e=()=>{p.z.logEvent("Error - Chunk load error dialog shown"),t(!0)};return window.addEventListener("chunkLoadError",e),()=>{window.removeEventListener("chunkLoadError",e)}}),[]);const i=r("editor.chunkErrorDialog.title","Clipchamp has stopped responding"),n=r("editor.chunkErrorDialog.body","Try relaunching, or if the problem persists, restart your computer."),o=r("editor.chunkErrorDialog.update","Relaunch");return(0,ln.jsx)(cn.a,{title:i,action:o,open:e,onClose:()=>{location.reload()},children:(0,ln.jsx)("p",{children:n})})};var un=r(307525),hn=r(91436),pn=r(175358),mn=r(140169),fn=r(953823),gn=r(148405),An=r(674303),vn=r(356735),yn=r(449467),bn=r(659636),wn=r(191025);const xn=(0,mn.I)(fn.e).attrs({"data-testid":"offline-message"})`
    position: fixed;
    top: 0;
    left: 0;
    z-index: ${wn.h};
    width: 100%;
    height: 100%;
    display: flex;
    overflow: auto;
`,Sn=mn.I.div`
    position: relative;
    background: ${(0,gn.yW)("light","background")};
    padding: 25px 35px;
    border-radius: 0.5rem;
    color: ${(0,gn.yW)("normal","text")};
    overflow: hidden;
    margin: auto;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
`,Tn=mn.I.div.attrs({"data-testid":"spinner"})`
    width: 40px;
    height: 40px;
`,Cn=mn.I.div`
    margin: 8px 0 0 0;
`,_n=({title:e,body:t})=>(0,ln.jsxs)(Sn,{children:[(0,ln.jsx)(Tn,{children:(0,ln.jsx)(An.y,{strokeWidth:10})}),(0,ln.jsx)(Cn,{children:(0,ln.jsx)(vn.o,{variant:"semibold",size:"large",children:e||(0,ln.jsx)(pn.x6,{i18nKey:"editor.offlineMessage.noConnection",children:"No internet connection."})})}),(0,ln.jsx)(Cn,{children:(0,ln.jsx)(vn.o,{color:"light",size:"small",children:t||(0,ln.jsx)(pn.x6,{i18nKey:"editor.offlineMessage.reconnecting",children:"Clipchamp is trying to reconnect..."})})})]}),kn=({title:e,body:t})=>{const{offline:r}=(0,hn.eC)();return(0,D.useEffect)((()=>{r&&p.z.logEvent("Usage - Show Offline Message")}),[r]),(0,ln.jsx)(yn.h,{open:r,children:(0,ln.jsx)(xn,{enter:r,transition:bn.z,duration:{enter:400,exit:400},children:(0,ln.jsx)(_n,{title:e,body:t})})})};var En=r(676653),In=r(781224);const Rn=({children:e})=>{const{t}=(0,zt.Bd)(),[r,i]=(0,En.d)(),{toast:n}=(()=>{const e=(()=>{const e=(0,_i.l)(Br);return{toast$:e.toast$,postToast:t=>{e.onToast.next(t)}}})(),[t,r]=(0,D.useState)();return(0,In.m)(e.toast$,(e=>{r(e)})),{toast:t}})();return(0,D.useEffect)((()=>{if(n){const e=r({...n,title:n.title?t(n.title):void 0,message:n.message?t(n.message):void 0,buttonText:n.buttonText?t(n.buttonText):void 0,onClick:n.onClick?()=>n?.onClick?.((()=>i(e))):void 0})}}),[t,n,r,i]),(0,ln.jsx)(ln.Fragment,{children:e})};var Fn;class Pn extends Tr.L{}Fn=Pn,(0,se.A)(Pn,"type","[Infrastructure] Close Suspended"),(0,se.A)(Pn,"isInstance",(0,A.t9)({type:(0,A.u)(Fn.type)}));var Ln=r(860580),Nn=r(165346),Mn=r(73268),Bn=r(380467),Dn=r(107601),On=r(766828),jn=r(667641),Un=r(977751),zn=r(440125),Wn=r(397448),Vn=r(56352);const Hn=(0,Mn.n)({actionButtons:{display:"flex"}}),Gn=e=>{(0,O.iY)(window.clipchampWebApp,"Expected Clipchamp native web client to be initialized"),window.clipchampWebApp.isCloseable=e},qn=({active:e,...t})=>{const{t:r}=(0,zt.Bd)();return(0,ln.jsx)(Bn.$,{icon:e?(0,ln.jsx)(Dn.y,{size:"extra-tiny"}):void 0,disabled:e,...t,children:e?r("editor.projectClosing.waiting","Saving"):r("editor.projectClosing.wait","Wait to finish saving")})};function Qn(){const e=Hn(),[t,r]=(0,D.useState)(!1),{t:i}=(0,zt.Bd)(),n=(0,De.L)().satisfies("windows-native"),o=(0,lr.v)(),[s]=(0,En.d)(),a=(0,D.useRef)(!1),[c,l]=(0,D.useState)(!1),d=(0,D.useRef)(!1),u=(0,Ln.zD)(),h=(0,D.useMemo)((()=>n&&!(0,C.Us)("ks_pst__disable_native_project_closing")),[n]);function m(){c||(p.z.logEvent("Sync - Wait for Project Sync"),p.z.logUserActionEvent("NativeProjectCloseActionInteracted",{actionType:"LeftClick",closeActionType:"waitSync"}),l(!0))}(0,Nn.yN)((e=>{h&&(d.current=e,Gn(!e),a.current&&!e&&o.send(new Vi.P))}));const f=(0,D.useCallback)((()=>{p.z.logEvent("Sync - Final Project Sync"),p.z.logAppLogicEvent("NativeProjectCloseSyncStart",{}),s({title:i("editor.projectClosing.toastTitle","Saving project"),message:i("editor.projectClosing.toastMessage","Clipchamp will close after saving is complete."),timeout:5e3,category:"default",disableFocusTrap:!0}),u(!1)}),[u,s]);return(0,D.useEffect)((()=>{if(h)return o.listen(Pn,(()=>{a.current||(a.current=!0,d.current?(f(),setTimeout((()=>(p.z.logEvent("Sync - Final Project Sync Timeout"),p.z.logAppLogicEvent("NativeProjectCloseSyncTimeout",{}),r(!0))),5e3)):(Gn(!0),o.send(new Vi.P)))}))}),[f,h,o,s]),(0,ln.jsx)(On.q,{theme:Vn.vg,children:(0,ln.jsxs)(jn.lG,{open:t,onClose:m,children:[(0,ln.jsx)(Un.L,{children:i("editor.projectClosing.title","We’re saving your changes now")}),(0,ln.jsx)(zn.C,{children:(0,ln.jsx)("p",{children:i("editor.projectClosing.body","What would you like to do?")})}),(0,ln.jsxs)(Wn.i,{className:e.actionButtons,children:[(0,ln.jsx)(qn,{appearance:"primary",onClick:m,active:c}),(0,ln.jsx)(Bn.$,{appearance:"outline",onClick:function(){h&&(p.z.logEvent("Sync - Force Close Unsaved Project"),p.z.logUserActionEvent("NativeProjectCloseActionInteracted",{actionType:"LeftClick",closeActionType:"forceClose"}),Gn(!0),o.send(new Vi.P))},children:i("editor.projectClosing.closeAnyway","Close now")})]})]})})}var Kn=r(408546),Xn=r(913677),Yn=r(179315),Zn=r(411148),Jn=r(685421),$n=r(751108),eo=r(620397),to=r(362933),ro=r(641580),io=r(382518),no=r(156666);const oo=(0,Mn.n)({root:{lineHeight:1,textAlign:"start"}}),so=({className:e,...t})=>{const r=oo();return(0,ln.jsx)(no.Wr,{...t,className:(0,io.z)(r.root,e)})},ao={colorBrandFlair1:J.VL[130],colorBrandFlair2:J.vl[110]};var co=r(767716),lo=r(170553),uo=r(123398),ho=r(908804),po=r(698055),mo=r(981991);const fo={enter:(0,an.i7)(["from{opacity:0;transform:translateY(100vh);}to{opacity:1;transform:translateY(0);}"]),exit:(0,an.i7)(["from{opacity:1;transform:translateY(0);}to{opacity:0;transform:translateY(100%);}"])},go=mn.I.div`
    width: 100%;
    position: fixed;
    z-index: 10;
    background: #1f204c;
    display: flex;
    flex-direction: row;
    align-items: center;
    padding: 10px 5px;
    bottom: 0;
    min-height: 50px;
    justify-content: space-evenly;
    animation: ${({transitionAnimation:e})=>e} 0.5s normal forwards ease-in-out;
    flex-wrap: wrap;
`,Ao=mn.I.div`
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1 1 300px;
    max-width: 900px;
    padding: 5px;
`,vo=(0,mn.I)(vn.o)`
    display: flex;
    flex-direction: column;
    color: white;
    align-items: center;
    margin-left: 20px;
    line-height: 22.4px;
`,yo=mn.I.div`
    display: flex;
    flex-direction: row-reverse;
    align-items: center;
    justify-content: center;
    padding: 20px;
`,bo=(0,mn.I)(po.v)`
    position: relative;
    font-style: normal;
    font-weight: 600;
    color: #1f204c;
    background: white;
    border-radius: 4px;
    padding: 9px 16px;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: 100ms ease-in-out all;
    white-space: nowrap;
    :hover {
        background: white;
        color: ${J.VL[100]};
        transform: translateY(-2px);
        transition: all 0.4s;
    }
`,wo=(0,mn.I)(mo.$)`
    color: white;
    border-color: rgba(255, 255, 255, 0.25);
    border-style: solid;
    border-width: thin;
    border-radius: 20%;
    padding: 5px;
    display: flex;
    align-items: center;

    :hover {
        color: ${J.VL[100]};
    }

    svg {
        height: 15px;
        width: 15px;
        path {
            stroke-width: 0.08em;
        }
    }
`,xo=mn.I.a`
    border: none;
    outline: none;
    text-decoration: underline;
    color: white;

    :hover {
        color: ${J.VL[100]};
    }
`,So=(0,mn.I)(vn.o)`
    text-decoration: underline;
    cursor: pointer;
    color: white;
    margin-right: 50px;
    white-space: nowrap;
    align-items: center;
    text-align: center;

    :hover {
        color: ${J.VL[100]};
    }
`,To="acceptCookies",Co=()=>{const e=ho.parse(document.cookie)[To];if(e)return JSON.parse(e)},_o=e=>{const t=location.hostname.includes("clipchamp.com")?".clipchamp.com":location.hostname,r=new Date,i=new Date(r);i.setDate(i.getDate()+365);const n=ho.serialize(To,JSON.stringify(e),{domain:t,expires:i,path:"/"});document.cookie=n};function ko(){const[e,t]=(0,D.useState)(Co()),[r,i]=(0,D.useState)(fo.enter),[n,o]=(0,D.useState)(!1),s=(0,sn.zy)(),a=(0,ot.Jd)(),{data:c}=(0,it.MZ)(),l=(0,D.useRef)(0),d=(0,D.useCallback)((()=>{i(fo.exit),p.z.logEvent("Cookies Banner - Cookies Banner closed")}),[]),u=(0,D.useCallback)((e=>()=>{!0===e&&p.z.enableNonEssential(),_o(e),i(fo.exit),l.current=window.setTimeout((()=>{t(e)}),400),(0,lo.Q_)("acceptCookies",e),e?p.z.logEvent("Cookies Banner - All Cookies enabled"):p.z.logEvent("Cookies Banner - Essential Cookies enabled")}),[]);return(0,D.useEffect)((()=>()=>{clearTimeout(l.current)}),[]),(0,D.useEffect)((()=>{void 0===e&&i(fo.enter)}),[s,e]),(0,D.useEffect)((()=>{c&&o((0,it.yC)(c.countryCode))}),[c]),(0,D.useEffect)((()=>{const e=Co();return void 0===e?i(fo.enter):a?.preferences&&void 0===a.preferences.acceptCookies&&(0,lo.Q_)("acceptCookies",e),()=>{clearTimeout(l.current)}}),[a]),n&&void 0===e?(0,ln.jsxs)(go,{transitionAnimation:r,"data-testid":"cookies-banner",children:[(0,ln.jsxs)(Ao,{children:[(0,ln.jsx)(wo,{onClick:d,"data-testid":"cookies-banner-close-button",children:(0,ln.jsx)(uo.LMj,{"aria-hidden":!0})}),(0,ln.jsx)(vo,{size:"largest",variant:"body",children:(0,ln.jsx)("p",{children:(0,ln.jsxs)(pn.x6,{i18nKey:"global.cookiesBanner.clipchampUsesCookies",children:["Clipchamp uses tracking (via cookies, beacons and analytics tools), to give you the best experience possible when visiting our website and using our platform. However, until you say so, we will only use tracking that is necessary for our website to function. You can learn more about this by reading our"," ",(0,ln.jsx)(xo,{href:"https://clipchamp.com/legal/cookies/",children:"Cookie Notice Policy"}),"."]})})})]}),(0,ln.jsxs)(yo,{children:[(0,ln.jsx)(bo,{onClick:u(!0),"data-testid":"cookies-banner-accept-all",children:(0,ln.jsx)(pn.x6,{i18nKey:"global.cookiesBanner.acceptAll",children:"Accept All Cookies"})}),(0,ln.jsx)("div",{onClick:u(!1),"data-testid":"cookies-banner-accept-essential",children:(0,ln.jsx)(So,{size:"largest",children:(0,ln.jsxs)(pn.x6,{i18nKey:"global.cookiesBanner.acceptEssential",children:["No, only allow",(0,ln.jsx)("br",{}),"minimum cookies"]})})})]})]}):null}const Eo=e=>{e.analytics?p.z.enableNonEssential():p.z.disableNonEssential(),_o(e.analytics),(0,lo.Q_)("acceptCookies",e.analytics),e.analytics&&e.advertising&&e.socialMedia?p.z.logEvent("Cookies Banner - All Cookies enabled"):e.analytics||e.advertising||e.socialMedia?p.z.logEvent("Cookies Banner - Granular cookies consent enabled",e):p.z.logEvent("Cookies Banner - Essential Cookies enabled")};function Io(e){return"chrome-os-twa"===e.type?"ChromeOS":"windows-native"===e.type?"Windows":"UNKNOWN"}var Ro=r(754494);const Fo=mn.I.span`
    background-color: ${Vn.It.colorNeutralBackground3};
    padding: 3px 10px;
    border-radius: 4px;
`;function Po(){const{t:e}=(0,zt.Bd)(),{isOpen:t,props:r}=(0,ro.sp)("unsupported-project");(0,D.useEffect)((()=>{t&&p.z.logEvent("Error - Unsupported Project Schema Dialog",{type:r?.unsupportedProject?.type,projectVersion:r?.unsupportedProject?.projectVersion,clientVersion:r?.unsupportedProject?.clientVersion})}),[t]);const i=e("global.unsupportedProjectError.title","Please refresh"),n=(0,ln.jsxs)(ln.Fragment,{children:[e("global.unsupportedProjectError.errorCodeTile","Error Code"),":"," ",(0,ln.jsx)(Fo,{children:(o=`${r?.unsupportedProject?.projectVersion}|${r?.unsupportedProject?.clientVersion}`,[...(new TextEncoder).encode(o)].map((e=>e.toString(16).padStart(2,"0"))).join(""))})]});var o;const s={buttonText:e("global.unsupportedProjectError.refresh","Refresh"),appearance:"primary",onClick:()=>window.location.reload()};return"template"===r?.unsupportedProject?.type?(0,ln.jsx)(Ro.x,{open:t,dialogTitleText:i,dialogBodyText:e("global.unsupportedProjectError.templateDescription","A temporary issue is causing this template not to load. Please refresh the editor. This problem should resolve soon."),dialogBody:n,buttons:[s]}):(0,ln.jsx)(Ro.x,{open:t,dialogTitleText:i,dialogBodyText:e("global.unsupportedProjectError.projectDescription","A temporary issue is causing this project not to load. Please refresh the editor. This problem should resolve soon. New projects will not be affected."),dialogBody:n,buttons:[s]})}var Lo=r(410040),No=r(999657),Mo=r(14332),Bo=r(809202),Do=r(145481),Oo=r(682523),jo=r(109492),Uo=r(301557),zo=r(575465),Wo=r(24305),Vo=r(225304),Ho=r(957745),Go=r(288660);class qo extends u.g9{constructor(e){super("AuthBackendError: Expired authorization token",{httpCode:e.status,response:e})}}class Qo extends u.g9{constructor(e){super("AuthBackendError: Fetching user not authorized",{httpCode:e.status,response:e})}}const Ko=(0,A.t9)({api_key:A.Kg,created_at:A.Kg,email:A.Kg,family_name:(0,A.T)(A.Kg),given_name:(0,A.T)(A.Kg),name:(0,A.T)(A.Kg),nickname:(0,A.T)(A.Kg),on_paid_utilities_plan:A.Lm,picture:(0,A.T)(A.Kg),preferences:(0,A.eB)(A.wW),total_projects_created:A.Et,updated_at:A.Kg,locale:(0,A.gH)(A.Kg),accepted_ms_terms:(0,A.gH)(A.Lm)});var Xo=r(865669);const Yo=(0,mn.I)(No.$)`
    padding: 0 2rem;
`,Zo={enter:Mo.j,exit:Mo.h},Jo=(0,mn.I)(Bo.Cf)`
    width: 550px;
    line-height: 22px;
`,$o=e=>{if(e?.rejection){const{rejection:t}=e;if((0,u.A3)(t))return`Uncaught (in promise): Error: ${t.message}`;if(e.rejection.message)return`Uncaught (in promise): Error: ${e.rejection.message}`}return e?.message||String(e)},es=({onClose:e})=>{const{t}=(0,zt.Bd)();return(0,ln.jsxs)(ln.Fragment,{children:[(0,ln.jsx)(Do.H,{"aria-label":t("home.error.sessionExpiredCloseAria","Close dialog"),onClose:e}),(0,ln.jsx)(Oo.L,{style:{marginBottom:"24px"},children:(0,ln.jsx)(pn.x6,{i18nKey:"home.error.sessionExpired",children:"Session expired"})}),(0,ln.jsx)(pn.x6,{i18nKey:"home.error.sessionExpiredMessage",children:"Your session has expired, log in again."}),(0,ln.jsx)(jo.i,{style:{marginTop:"24px"},children:(0,ln.jsx)(Yo,{onClick:e,children:(0,ln.jsx)(pn.x6,{i18nKey:"global.gotIt",children:"Got it"})})})]})};function ts(){const e=(0,ot.hD)((e=>e.sessionError)),[t,r]=(0,D.useState)(void 0),i=(0,ir.G)();(0,D.useEffect)((()=>{e&&(r(e),e instanceof Qo?p.z.logEvent("Error - User token unauthorized",{location:location.pathname}):e instanceof qo||e instanceof zo.hY?p.z.logEvent("Error - User token expired",{location:location.pathname}):p.z.logEvent("Error - Dialog Shown",{...(0,u.A3)(e)?e.toEventProperties():{},error:$o(e),location:location.pathname,isOnline:navigator.onLine}))}),[e]);const n=()=>{i.updateSessionError(void 0)},o=t instanceof Qo||t instanceof qo||t instanceof zo.hY?es:Lo.Q;return(0,ln.jsx)(Xo.d,{children:(0,ln.jsx)(Uo.l,{transition:Zo,content:Jo,open:!!e,onClose:n,onExited:()=>{r(void 0),i.logout()},children:(0,ln.jsx)(o,{onClose:n})})})}var rs=r(768870);const is=({children:e})=>{const t=(0,ft.M)(),r=(0,Yn.iT)("gwy__commercial_prompt_for_aad_users");return t?.gwy__disable_consumer&&r&&t?.gwy__launch_uri?(0,ln.jsx)(rs.p,{force:!0}):(0,ln.jsx)(ln.Fragment,{children:e})};var ns=r(901627),os=r(806983),ss=r(771083),as=r(881956),cs=r(422226);const ls="ms-windows-store://downloadsandupdates",ds=mn.I.div`
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;

    > * {
        margin-left: 8px;
        margin-right: 8px;
    }
`,us=mn.I.h3`
    font-size: 1.75rem;
    line-height: 120%;
    font-weight: 600;
    text-transform: none;
    margin-top: 23px;
    margin-bottom: 20px;
`,hs=(0,mn.I)(ss.z)`
    width: 350px;
    height: 5px;
`,ps=mn.I.div`
    width: 600px;
    border: 1px solid ${J.mb[90]};
    border-start-start-radius: 8px;
    border-start-end-radius: 8px;
    margin-top: 10px;
`,ms=mn.I.div`
    border-start-start-radius: 8px;
    border-start-end-radius: 8px;
    background-image: url(${"static/media/store_library_example.0b3746c9.png"});
    width: 598px;
    height: 338px;
`,fs=mn.I.div`
    padding: 24px 20px 8px 24px;
    font-size: 20px;
    font-weight: 600;
    line-height: 28px;
`,gs=mn.I.div`
    padding: 0 24px 12px 24px;

    > p {
        margin-top: 12px;
        font-size: 14px;
        font-weight: 400;
        line-height: 20px;
    }
`,As=mn.I.div`
    display: flex;
    flex-direction: row-reverse;
    justify-content: end;
    align-items: end;
    gap: 16px;
    margin: 16px 20px 24px 20px;
`,vs=({children:e,force:t})=>{const{t:r}=(0,zt.Bd)(),i=(0,De.L)(),{checkUpdate:n,downloadAndInstallUpdate:o,cancelUpdate:s}=(()=>{const e=(0,_i.l)(Ui);return{checkUpdate:(0,cs.Z)((()=>new Promise(((t,r)=>e.checkUpdate((()=>t(!0)),(()=>t(!1)),(e=>r(new Error(e.payload.reason)))))))),downloadAndInstallUpdate:(0,cs.Z)((t=>new Promise(((r,i)=>e.downloadAndInstallUpdate((()=>r(!0)),(()=>r(!1)),(e=>i(new Error(e.payload.reason))),(()=>i(new Error("UpdateNotFound"))),t))))),cancelUpdate:(0,cs.Z)((()=>new Promise(((t,r)=>e.cancelUpdate((()=>t(!0)),(e=>r(new Error(e.payload.reason))))))))}})(),a=(0,lr.v)(),c=Wi(),[d,u]=(0,D.useState)((()=>t?"updatePending":"checking")),[h,m]=(0,D.useState)(0),f=i.satisfies(["windows-native",">=2.5.3"]),{canLaunchUri:g,launchUri:A}=(0,ns.p)();(0,D.useEffect)((()=>{"checking"===d&&(p.z.logEvent("[Usage] Checking Update",{context:"update-installer"}),n().then((e=>u((()=>e?(p.z.logEvent("[Usage] Update Detected",{context:"update-installer"}),"updatePending"):(p.z.logEvent("[Usage] Update Not Found",{context:"update-installer"}),c.setUpdateNotFound(),"updated"))))).catch((e=>(p.z.logEvent("[Error] Check Update Failed",{context:"update-installer",reason:e.message}),u((()=>"updated"))))))}),[n,d,t,c]);const v=(0,D.useCallback)((async()=>{try{return u((e=>"initiating"===e||"inProgress"===e?e:"initiating")),p.z.logEvent("[Usage] Downloading and Installing Update"),await o((e=>{u((t=>"downloading"!==e.toLowerCase().trim()&&"deploying"!==e.toLowerCase().trim()||"initiating"!==t?t:"inProgress"))}))?(p.z.logEvent("[Usage] Update Downloaded and Installed"),u((()=>"updated"))):(p.z.logEvent("[Usage] Update Cancelled",{force:t,state:d}),c.setUpdateIgnored(),u((()=>t?"updatePending":"updated")))}catch(e){p.z.logEvent("[Error] Download and Install Update Failed",{retryCount:h,reason:e instanceof Error?e.message:e}),u((()=>e instanceof Error&&"UpdateNotFound"===e.message?(c.setUpdateNotFound(),"updated"):"failed"))}}),[o,t,h,d,c]),y=(0,D.useCallback)((()=>{p.z.logEvent("[Usage] Update Cancelled",{force:t,state:d}),s().catch((e=>{l.Vy.error(e),p.z.logEvent("[Error] Cancel Update Failed",{force:t,state:d,reason:e instanceof Error?e.message:e})})),c.setUpdateIgnored(),u((()=>t?"updatePending":"updated"))}),[s,t,d,c]),b=(0,D.useCallback)((()=>{p.z.logEvent("[Usage] Retrying Update",{retryCount:h}),u((()=>"updatePending")),m((e=>e+1))}),[h]),w=(0,D.useCallback)((()=>{p.z.logEvent("[Usage] Update Skipped",{force:t,state:d}),c.setUpdateIgnored(),u((()=>t?"updatePending":"updated"))}),[t,d,c]),x=(0,D.useCallback)((()=>{a.send(new Vi.P)}),[a]),S=(0,D.useCallback)((()=>{p.z.logEvent("[Usage] Update Cancelled",{force:t,state:d}),s().catch((e=>{l.Vy.error(e),p.z.logEvent("[Error] Cancel Update Failed",{force:t,state:d,reason:e instanceof Error?e.message:e})})),x()}),[s,x,t,d]),T=(0,D.useCallback)((()=>{p.z.logEvent("[Usage] Launch Store for Update Clicked"),g?A(ls,"Microsoft.WindowsStore_8wekyb3d8bbwe",void 0,(e=>{p.z.logEvent("Usage - Failed to launch store",{context:"native-installer-page",...e.payload}),window.location.href=ls})):window.location.href=ls}),[g,A]),C=(0,D.useCallback)((()=>{p.z.logEvent("[Usage] Open web app clicked",{context:"native-installer-page",force:t}),A("https://www.microsoft365.com/launch/clipchamp")}),[t,A]);return"checking"===d?(0,ln.jsxs)(as.g,{children:[(0,ln.jsx)(vn.o,{size:"large",style:{marginTop:"23px",marginBottom:"20px"},children:r("native.checkingUpdate","Checking for updates...")}),(0,ln.jsx)(ds,{children:(0,ln.jsx)(Bn.$,{appearance:"secondary",onClick:w,"data-testid":"btn-cancel",children:r("native.cancelButton","Cancel")})})]}):"updatePending"===d?(0,ln.jsxs)(as.g,{children:[(0,ln.jsx)(vn.o,{variant:"h3",size:"largest",style:{marginTop:"23px",marginBottom:"20px"},"data-testid":"msg-pending",children:r("native.updateTitle","Update your version of Clipchamp to see us at our best.")}),(0,ln.jsxs)(ds,{children:[(0,ln.jsx)(Bn.$,{appearance:"primary",onClick:v,"data-testid":"btn-update-restart",children:r("native.updateButton","Update and restart")}),t?(0,ln.jsx)(Bn.$,{appearance:"secondary",onClick:x,"data-testid":"btn-cancel",children:r("native.closeButton","Close")}):(0,ln.jsx)(Bn.$,{appearance:"secondary",onClick:w,"data-testid":"btn-cancel",children:r("native.cancelUpdate","Continue to app")})]})]}):"initiating"===d||"inProgress"===d?(0,ln.jsxs)(as.g,{children:[(0,ln.jsx)(vn.o,{variant:"h3",size:"largest",style:{marginTop:"23px",marginBottom:"20px"},children:r("native.updatingClipchamp","Updating Clipchamp...")}),(0,ln.jsx)(hs,{style:{marginBottom:"23px"}}),(0,ln.jsx)(ds,{children:t?(0,ln.jsx)(Bn.$,{appearance:"secondary",onClick:S,"data-testid":"btn-cancel",children:r("native.closeButton","Close")}):(0,ln.jsx)(Bn.$,{appearance:"secondary",onClick:y,"data-testid":"btn-cancel",children:r("native.cancelButton","Cancel")})})]}):"failed"===d?h>=3?(0,ln.jsxs)(as.g,{showClipchampIcon:!1,children:[(0,ln.jsx)(us,{"data-testid":"msg-failed",children:r("native.updateRetryExhaustedTitle","Clipchamp couldn’t update on this device")}),(0,ln.jsxs)(ps,{children:[(0,ln.jsx)(ms,{}),(0,ln.jsx)(fs,{children:r("native.updateRetryExhaustedSubtitle","You can manually update Clipchamp at the Microsoft Store")}),(0,ln.jsxs)(gs,{children:[(0,ln.jsx)("p",{children:r("native.updateRetryExhaustedInstructionLine1","Head to the Microsoft Store, and search for Clipchamp in the library. Select ‘Update’ to get the latest version of Clipchamp, then select ‘Open’ to relaunch the app.")}),(0,ln.jsx)("p",{children:g?(0,ln.jsxs)(pn.x6,{i18nKey:"native.updateRetryExhaustedInstructionLine2WithLink",children:["If you are unable to update via the Microsoft Store, please try using"," ",(0,ln.jsx)(os.M,{onClick:C,children:"Clipchamp in your web browser."})]}):r("native.updateRetryExhaustedInstructionLine2WithoutLink","If you are unable to update via the Microsoft Store, please try using Clipchamp in your web browser.")})]}),(0,ln.jsxs)(As,{children:[(0,ln.jsx)(Bn.$,{appearance:"primary",onClick:T,"data-testid":"btn-go-to-store",children:r("native.goToStoreButton","Go to Microsoft Store")}),t?(0,ln.jsx)(Bn.$,{appearance:"secondary",onClick:x,"data-testid":"btn-cancel",children:r("native.closeButton","Close")}):(0,ln.jsx)(Bn.$,{appearance:"secondary",onClick:w,"data-testid":"btn-cancel",children:r("native.cancelUpdate","Continue to app")})]})]})]}):(0,ln.jsxs)(as.g,{children:[(0,ln.jsx)(vn.o,{variant:"h3",style:{marginTop:"23px",marginBottom:"20px"},"data-testid":"msg-failed",children:r("native.updateFailed","Looks like Clipchamp wasn't able to be updated.")}),(0,ln.jsxs)(ds,{children:[(0,ln.jsx)(Bn.$,{appearance:"primary",onClick:b,"data-testid":"btn-retry",children:r("native.retryButton","Try again")}),t?f?(0,ln.jsx)(Bn.$,{appearance:"secondary",onClick:x,"data-testid":"btn-cancel",children:r("native.closeButton","Close")}):null:(0,ln.jsx)(Bn.$,{appearance:"secondary",onClick:w,"data-testid":"btn-cancel",children:r("native.cancelUpdate","Continue to app")})]})]}):(0,ln.jsx)(ln.Fragment,{children:e})};var ys=r(561626);const bs=({children:e})=>{const t=(0,De.L)().satisfies(["windows-native","outdated"]),r=(0,ft.M)(),i=!0===r?.gwy__in_app_update,n=Wi(),o=!(!0===r?.gwy__update_prompted)&&i&&n.shouldPromptUpdate();return t?i?(0,ln.jsx)(vs,{force:!0,children:e}):(0,ln.jsx)(ys.C,{}):o?(0,ln.jsx)(vs,{force:!1,children:e}):(0,ln.jsx)(ln.Fragment,{children:e})};function ws({children:e}){const t=(0,Yn.iT)("ui__dir_helmet"),r=(0,eo.H)(),[i]=(0,eo.o)(),n=(0,D.useMemo)((()=>({dir:r})),[r]);return(0,ln.jsx)(nn.Ht,{client:(0,$n.SX)(),children:(0,ln.jsx)(an.NP,{theme:to.qW,children:(0,ln.jsx)(un.q,{children:(0,ln.jsx)(On.q,{theme:Vn.vg,dir:r,children:(0,ln.jsx)(Kn.d,{action:Eo,locale:i,children:(0,ln.jsx)(so,{themeExtension:ao,children:(0,ln.jsx)(ro.Co,{children:(0,ln.jsxs)(En.t,{children:[t&&(0,ln.jsx)(on.m,{htmlAttributes:n}),e]})})})})})})})})}function xs(){return function(){const e=(0,ot.Jd)(),{data:t}=(0,it.MZ)(),r=(0,De.L)().current;(0,D.useEffect)((()=>{const i={os:Io(r),country:t?.countryCode};(0,C.yk)().initialize(e,i)}),[e,t,r])}(),function(){const e=(0,Yn.UJ)();(0,D.useEffect)((()=>{const t=Object.entries(e).reduce(((e,[t,r])=>t.startsWith("_")?{...e}:{...e,["feature."+t]:r}),{});p.z.setUserProperties(t),p.z.updateFlightState(Ve())}),[e])}(),(0,hn.O6)(),null}const Ss=document.head.querySelector("#fluent")??void 0,Ts=(0,tn.I)(document,{insertionPoint:Ss});function Cs(){(0,Jn.dk)("StartupQos","appStarted",(()=>!(0,C.Us)("ks_multi__performance_event_refactor")));const e=(0,Yn.iT)("tra_wcp_cookie_banner_consumer");return(0,ln.jsx)(rn.H,{renderer:Ts,children:(0,ln.jsx)(ws,{children:(0,ln.jsx)(co.s,{children:(0,ln.jsxs)(Rn,{children:[(0,ln.jsx)(xs,{}),(0,ln.jsxs)(D.Suspense,{fallback:(0,ln.jsx)(Zn.H,{}),children:[(0,ln.jsx)(kn,{}),e?(0,ln.jsx)(Xn.Q,{}):(0,ln.jsx)(ko,{}),(0,ln.jsx)(ts,{}),(0,ln.jsx)(dn,{}),(0,ln.jsx)(Po,{}),(0,ln.jsx)(bs,{children:(0,ln.jsx)(is,{children:(0,ln.jsx)(sn.sv,{})})}),(0,ln.jsx)(Qn,{})]})]})})})})}var _s=r(187981);const ks=["en","de","es","fr","pt-br","ja","it","ru","ko","zh-hans","id","nl","sv","no","fi","da","pl","el","kk","ms","ro","th","tr","uk","vi"];var Es=r(177482);var Is=r(18829);const Rs=mn.I.a`
    text-decoration: underline;
    cursor: pointer;
    color: ${(0,gn.yW)(80,"primary")};
    ${({theme:e})=>({...e.typography.semibold.normal})};
`,Fs=mn.I.p`
    ${({theme:e})=>({...e.typography.body.normal})}
`,Ps=(0,mn.I)(An.y)`
    width: 14px;
    height: 14px;
    margin-right: 10px;
`,Ls=mn.I.div`
    display: flex;
    align-items: center;
`,Ns=({children:e})=>{const t=(0,O.sw)((0,ot.Jd)(),"User is required to check term requirement"),[r,i]=function(){const e=(0,ir.G)();return(0,Es.f)((async t=>{var r;await(r=t,er.E.patch("/user",{body:r})),await e.loadUser()}))}(),n=(0,sn.Zp)(),o=(0,cs.Z)((()=>{p.z.logEvent("Usage - MSFT Terms Accepted Clicked"),i({accepted_ms_terms:!0})})),s=!t.acceptedMsTerms,a=function(){const[e]=(0,eo.o)();return`https://clipchamp.com/${function(e){if(!e)return"en";let t=ks.find((t=>e.includes(t)));if(!t)switch(e){case"pt-BR":t="pt-br";break;case"zh-CN":t="zh-hans";break;default:t="en"}return t}(e)}/blog/new-terms/`}(),c="loading"===r.status||"success"===r.status;return(0,D.useEffect)((()=>{"idle"===r.status&&s&&p.z.logEvent("Usage - MSFT Terms Dialog Shown")}),[r,s]),(0,ln.jsxs)(ln.Fragment,{children:[e,(0,ln.jsxs)(Uo.l,{open:s,disableBackdropClick:!0,disableEscapeKeyDown:!0,children:[(0,ln.jsx)(Oo.L,{children:(0,ln.jsx)(pn.x6,{i18nKey:"home.termsDialog.title",children:"Clipchamp has new terms of use"})}),(0,ln.jsx)(Fs,{children:(0,ln.jsxs)(pn.x6,{i18nKey:"home.termsDialog.message",children:["Clipchamp is now governed by the Microsoft Services Agreement. By continuing, you agree to the"," ",(0,ln.jsx)(Rs,{href:Is.pq,target:"_blank","data-testid":"services-agreement-link",onClick:()=>{p.z.logEvent("Usage - MSFT Terms Dialog Terms Link Clicked")},children:"Microsoft Services Agreement"})," ","and acknowledge that the"," ",(0,ln.jsx)(Rs,{href:Is.XB,target:"_blank",onClick:()=>{p.z.logEvent("Usage - MSFT Terms Dialog Privacy Link Clicked")},children:"Privacy Statement"})," ","applies."," ",(0,ln.jsx)(Rs,{target:"_blank",href:a,onClick:()=>{p.z.logEvent("Usage - MSFT Terms Dialog Learn More Clicked")},children:"Learn more"})]})}),(0,ln.jsxs)(jo.i,{children:[(0,ln.jsxs)(No.$,{onClick:o,disabled:c,children:[c&&(0,ln.jsx)(Ls,{"data-testid":"terms-accepted-spinner",children:(0,ln.jsx)(Ps,{gradientStart:J.pw.white,gradientEnd:J.pw.white})}),(0,ln.jsx)(pn.x6,{i18nKey:"home.termsDialog.actionAccept",children:"Agree and continue"})]}),(0,ln.jsx)(_s.n,{onClick:()=>{p.z.logEvent("Navigate - Clicked sign out",{reason:"MSFTterms"}),n("/signout")},disabled:c,children:(0,ln.jsx)(pn.x6,{i18nKey:"home.termsDialog.signOut",children:"Sign out"})})]})]})]})};function Ms(){return(0,ln.jsx)(D.Suspense,{fallback:(0,ln.jsx)(Zn.H,{}),children:(0,ln.jsx)(Ns,{children:(0,ln.jsx)(sn.sv,{})})})}const Bs=[{element:(0,ln.jsx)(Cs,{}),children:[{path:"/login?/signup?/templates",lazy:Ji((()=>Promise.all([r.e(18928),r.e(5830),r.e(77768),r.e(8847),r.e(36048),r.e(77095),r.e(16867),r.e(91111),r.e(51881),r.e(82928),r.e(75345),r.e(92603),r.e(33712),r.e(43079),r.e(91106),r.e(63268),r.e(95337),r.e(75396),r.e(78949),r.e(40159),r.e(40153),r.e(67952),r.e(69177),r.e(81811),r.e(71634)]).then(r.bind(r,679661))))},{id:"auth",lazy:Ji((()=>Promise.all([r.e(18928),r.e(75396),r.e(85469)]).then(r.bind(r,123013)))),shouldRevalidate:()=>!0,children:[{path:"/signup",loader:(0,$i.uX)("/login")},{path:"/signup/microsoft",loader:(0,$i.uX)("/login/microsoft")},{path:"/signup/microsoft1p",lazy:Ji((()=>r.e(13696).then(r.bind(r,413696))))},{path:"/signup/*",lazy:Ji((()=>Promise.all([r.e(18928),r.e(5830),r.e(77768),r.e(8847),r.e(36048),r.e(77095),r.e(16867),r.e(51881),r.e(82928),r.e(75345),r.e(63268),r.e(95337),r.e(75396),r.e(78949),r.e(40159),r.e(67952),r.e(81811),r.e(41699)]).then(r.bind(r,241699))))},{path:"/login/reset",lazy:Ji((()=>Promise.all([r.e(18928),r.e(5830),r.e(8847),r.e(36048),r.e(77095),r.e(16867),r.e(86140),r.e(63268),r.e(40159),r.e(65175),r.e(49859)]).then(r.bind(r,549859))))},{path:"/login/forgot",lazy:Ji((()=>Promise.all([r.e(18928),r.e(5830),r.e(8847),r.e(36048),r.e(77095),r.e(16867),r.e(86140),r.e(63268),r.e(40159),r.e(65175),r.e(32733)]).then(r.bind(r,932733))))},{path:"/login/*",lazy:Ji((()=>Promise.all([r.e(5830),r.e(77768),r.e(8847),r.e(36048),r.e(77095),r.e(16867),r.e(51881),r.e(75345),r.e(43079),r.e(91106),r.e(63268),r.e(78949),r.e(40159),r.e(67952),r.e(69177),r.e(85163)]).then(r.bind(r,721472))))}]},{path:"/signout",lazy:Ji((()=>r.e(13586).then(r.bind(r,913586))))},{id:"user",loader:async function({request:e}){const{user:t}=await(0,ot.Mg)(e);if((0,C.gZ)("cmig__opt_in")&&Boolean(t?.preferences.consumerOneDrive))throw(0,$i.V2)("/consumer",void 0,e);return(0,Lr.Pq)({user:t})},element:(0,ln.jsx)(Ms,{}),children:[{lazy:Ji((()=>Promise.all([r.e(18928),r.e(77768),r.e(51881),r.e(19846),r.e(11761),r.e(78949),r.e(59806)]).then(r.bind(r,658669)))),children:[{path:"/checkout",lazy:Ji((()=>r.e(12555).then(r.bind(r,412555))))},{path:"/start",lazy:Ji((()=>Promise.all([r.e(18928),r.e(77768),r.e(77095),r.e(91111),r.e(51881),r.e(33712),r.e(61404),r.e(43079),r.e(19846),r.e(91106),r.e(91141),r.e(39354),r.e(8631),r.e(36549),r.e(46386),r.e(33487),r.e(71971)]).then(r.bind(r,441613))))},{lazy:Ji((()=>Promise.all([r.e(18928),r.e(77768),r.e(91111),r.e(51881),r.e(82928),r.e(75345),r.e(61404),r.e(19846),r.e(91106),r.e(53139),r.e(91141),r.e(89020),r.e(86140),r.e(39354),r.e(90432),r.e(61029),r.e(22287),r.e(46386),r.e(43203),r.e(88752)]).then(r.bind(r,388752)))),children:[{path:"/folder?/:folderId?",lazy:Ji((()=>Promise.all([r.e(18928),r.e(5830),r.e(77768),r.e(8847),r.e(36048),r.e(77095),r.e(16867),r.e(91111),r.e(51881),r.e(82928),r.e(92603),r.e(33712),r.e(61404),r.e(91106),r.e(53139),r.e(91141),r.e(89020),r.e(8631),r.e(47861),r.e(77029),r.e(13100),r.e(40153),r.e(43203),r.e(90968),r.e(98413)]).then(r.bind(r,219106)))),children:[{path:"folder/new",lazy:Ji((()=>r.e(32395).then(r.bind(r,132395))))}]},{path:"/template-library",children:[{index:!0,lazy:Ji((()=>Promise.all([r.e(18928),r.e(91111),r.e(92603),r.e(33712),r.e(77029),r.e(40153),r.e(90968),r.e(46566)]).then(r.bind(r,42679))))},{path:":templateSlug",lazy:Ji((()=>Promise.all([r.e(18928),r.e(91111),r.e(92603),r.e(33712),r.e(81398),r.e(40153),r.e(90968),r.e(71307)]).then(r.bind(r,971307))))}]},{path:"/search/:searchTerm?",lazy:Ji((()=>Promise.all([r.e(18928),r.e(77768),r.e(16867),r.e(91111),r.e(82928),r.e(92603),r.e(33712),r.e(53139),r.e(72268),r.e(33866),r.e(40153),r.e(46657)]).then(r.bind(r,517643))))},{path:"/brand",lazy:Ji((()=>Promise.all([r.e(18928),r.e(5830),r.e(77768),r.e(16867),r.e(91111),r.e(51881),r.e(82928),r.e(75345),r.e(7017),r.e(61404),r.e(53139),r.e(89020),r.e(86140),r.e(41390),r.e(36549),r.e(14646),r.e(72268),r.e(24781),r.e(65841),r.e(46805),r.e(46709),r.e(37047),r.e(75396),r.e(60455),r.e(61975),r.e(10001),r.e(10360)]).then(r.bind(r,495578))))},{path:"/trim",lazy:Ji((()=>Promise.all([r.e(8844),r.e(18928),r.e(5830),r.e(77768),r.e(36048),r.e(77095),r.e(16867),r.e(91111),r.e(51881),r.e(82928),r.e(75345),r.e(92603),r.e(33712),r.e(61404),r.e(43079),r.e(19846),r.e(91106),r.e(53139),r.e(91141),r.e(89020),r.e(86140),r.e(41390),r.e(39354),r.e(8631),r.e(36549),r.e(14646),r.e(72268),r.e(71627),r.e(82523),r.e(24781),r.e(47861),r.e(83883),r.e(13770),r.e(60455),r.e(395),r.e(61975),r.e(75313),r.e(98769),r.e(82168),r.e(5200),r.e(17310)]).then(r.bind(r,523449))))},{path:"/account",children:[{index:!0,loader:(0,$i.uX)("/account/general")},{path:"general",lazy:Ji((()=>Promise.all([r.e(18928),r.e(5830),r.e(77768),r.e(8847),r.e(36048),r.e(77095),r.e(16867),r.e(51881),r.e(53139),r.e(41390),r.e(63268),r.e(75396),r.e(78949),r.e(40159),r.e(41329)]).then(r.bind(r,541329))))},{path:"billing",lazy:Ji((()=>Promise.all([r.e(77768),r.e(91111),r.e(75345),r.e(19846),r.e(8631),r.e(26158),r.e(46386),r.e(6075),r.e(97646)]).then(r.bind(r,807833))))},{path:"project-backup",lazy:Ji((()=>Promise.all([r.e(77768),r.e(16867),r.e(61404),r.e(43203),r.e(16539)]).then(r.bind(r,257408))))},{path:"storage",lazy:Ji((()=>Promise.all([r.e(18928),r.e(5830),r.e(8847),r.e(36048),r.e(77095),r.e(91111),r.e(82928),r.e(89020),r.e(55337)]).then(r.bind(r,255337))))},{path:"exportsettings",lazy:Ji((()=>Promise.all([r.e(82928),r.e(55290)]).then(r.bind(r,855290))))},{path:"delete",lazy:Ji((()=>Promise.all([r.e(5830),r.e(8847),r.e(36048),r.e(77095),r.e(41390),r.e(54777)]).then(r.bind(r,454777))))}]}]},{path:"/editor",children:[{path:"new/:contentId?",lazy:Ji((()=>r.e(59590).then(r.bind(r,459590))))},{path:":videoId",loader:async e=>{const{loader:t}=await r.e(18482).then(r.bind(r,618482));return t(e)},lazy:Ji((()=>((0,en.BF)((0,C.G7)("editor__consumer_1ds_events")),Promise.all([r.e(8844),r.e(18928),r.e(5830),r.e(77768),r.e(16867),r.e(91111),r.e(51881),r.e(82928),r.e(75345),r.e(92603),r.e(33712),r.e(61404),r.e(43079),r.e(19846),r.e(91106),r.e(53139),r.e(89020),r.e(86140),r.e(41390),r.e(39354),r.e(99051),r.e(36549),r.e(14646),r.e(72268),r.e(71627),r.e(82523),r.e(24781),r.e(47861),r.e(83883),r.e(60455),r.e(395),r.e(61975),r.e(75313),r.e(4385)]).then(r.bind(r,412421))))),children:[{index:!0,lazy:Ji((()=>Promise.all([r.e(8844),r.e(18928),r.e(5830),r.e(77768),r.e(8847),r.e(36048),r.e(77095),r.e(16867),r.e(91111),r.e(51881),r.e(20413),r.e(82928),r.e(75345),r.e(92603),r.e(33712),r.e(7017),r.e(61404),r.e(43079),r.e(19846),r.e(91106),r.e(53139),r.e(91141),r.e(89020),r.e(21257),r.e(86140),r.e(41390),r.e(39354),r.e(8631),r.e(36549),r.e(14646),r.e(72268),r.e(24952),r.e(71627),r.e(82523),r.e(24781),r.e(47861),r.e(83883),r.e(61029),r.e(46421),r.e(13770),r.e(99856),r.e(25188),r.e(46709),r.e(44416),r.e(27553),r.e(46386),r.e(80894),r.e(60455),r.e(395),r.e(61975),r.e(75313),r.e(98769),r.e(82168),r.e(5200),r.e(55409),r.e(96281)]).then(r.bind(r,832394))))},{path:"export",lazy:Ji((()=>Promise.all([r.e(18928),r.e(5830),r.e(77768),r.e(8847),r.e(36048),r.e(77095),r.e(16867),r.e(91111),r.e(51881),r.e(82928),r.e(75345),r.e(92603),r.e(33712),r.e(61404),r.e(19846),r.e(91106),r.e(53139),r.e(91141),r.e(89020),r.e(41390),r.e(67066),r.e(67435),r.e(75396),r.e(46386),r.e(21055),r.e(38360),r.e(41726)]).then(r.bind(r,819522))))}]},{index:!0,loader:(0,$i.uX)("/")}]},{path:"/export",lazy:Ji((()=>Promise.all([r.e(8844),r.e(18928),r.e(5830),r.e(77768),r.e(8847),r.e(36048),r.e(77095),r.e(16867),r.e(91111),r.e(51881),r.e(82928),r.e(75345),r.e(92603),r.e(33712),r.e(61404),r.e(43079),r.e(19846),r.e(91106),r.e(53139),r.e(91141),r.e(89020),r.e(86140),r.e(41390),r.e(39354),r.e(99051),r.e(36549),r.e(14646),r.e(72268),r.e(71627),r.e(82523),r.e(24781),r.e(47861),r.e(83883),r.e(67066),r.e(46386),r.e(60455),r.e(395),r.e(61975),r.e(75313),r.e(21055),r.e(38360),r.e(28901)]).then(r.bind(r,761731))))}]}]},{id:"native",children:[{path:"/native/activate",lazy:Ji((()=>r.e(45052).then(r.bind(r,96369))))},{path:"/native/update",lazy:Ji((()=>r.e(40353).then(r.bind(r,140353))))},{path:"/native/commercial",lazy:Ji((()=>r.e(19213).then(r.bind(r,719213))))},{path:"/native/*",loader:(0,$i.uX)("/")}]},{path:"/hardware",lazy:Ji((()=>r.e(65623).then(r.bind(r,65623))))},{path:"/xbox",loader:(0,$i.mt)(`/v2/oauth/auth/xbox?${window.location.hash.slice(1)}`)},{id:"remix",children:[{path:"/remix/landing",lazy:Ji((()=>r.e(54108).then(r.bind(r,830799))))},{path:"/remix/:remixId",lazy:Ji((()=>r.e(32687).then(r.bind(r,532687))))}]},{path:"/copilot/:handoffId",lazy:Ji((()=>r.e(33315).then(r.bind(r,133315))))},{path:"/consumer",loader:(0,$i.mt)("/consumer/home")},{path:"/opt-out",lazy:Ji((()=>r.e(44114).then(r.bind(r,944114))))},{path:"*",loader:(0,$i.uX)("/")}]}];var Ds,Os=r(186975),js=r(522117),Us=r(672021),zs=r(701724),Ws=r(350025),Vs=r(687240),Hs=r(26860),Gs=r(571056),qs=r(845960),Qs=r(870199),Ks=r(775678),Xs=r(995052),Ys=r(800668),Zs=r(50396),Js=r(73662),$s=r(670814),ea=r(906756);const ta=["/login","/account/general","/consumer/login"];let ra=(0,ke.Gr)()(Ds=Reflect.metadata("design:type",Function)(Ds=Reflect.metadata("design:paramtypes",[])(Ds=class extends m.qG{constructor(){super(),(0,se.A)(this,"_config",void 0),(0,se.A)(this,"_agent",void 0),(0,se.A)(this,"login",(async e=>{const t=this.formatLoginRequest(e),{accountId:r,loginHint:i,sessionId:n,skipActiveUser:o=!1,msftLoginRoute:s=!1}=t,a=this.agent.getAllAccounts().find((e=>r&&e.homeAccountId===r||i&&e.username===i||n&&e.idTokenClaims?.sid===n))||(o?null:this.agent.getActiveAccount());let c;if(s){if(c=await this.attemptSso(t),!c)return{isRedirecting:!1,redirectUri:void 0,session:void 0};if(c&&c.account&&"business"===(0,$s.HA)(c.account.homeAccountId,c.tenantId))throw new Qs.lR("AAD_NOT_SUPPORTED","Organizational accounts are not supported")}else c=await this.attemptLoginSilent(a,t),o||c||(c=await this.attemptCompleteLoginRedirect()||await this.attemptSso(t));if(c)return{session:this.completeLogin(c,t.skipActiveUser)};if(await this.attemptCompleteLoginRedirect(),i&&(t.loginHint=i,t.usePopupLogin=!0),!0===t.usePopupLogin||void 0===t.usePopupLogin&&this.config.defaults?.usePopupLogin){const e=await this.attemptLoginPopup(t);return{session:this.completeLogin(e,t.skipActiveUser)}}return await this.attemptLoginRedirect(t),{isRedirecting:!0,redirectUri:t.redirectUri??window.location.href}})),(0,se.A)(this,"getToken",(async e=>{const{session:t}=await this.login(e);if(!t||!t.accessToken)throw new ea.l("No valid token","no_token");return t.accessToken})),(0,se.A)(this,"logout",(async()=>{if(this.user)return this.config.defaults?.usePopupLogin?this.agent.logoutPopup():this.agent.logoutRedirect()})),(0,se.A)(this,"completeLoginRedirect",(async()=>{const e=await this.attemptCompleteLoginRedirect();return{session:e?this.completeLogin(e):void 0}})),(0,se.A)(this,"clearSession",(()=>{"localStorage"===this.agent.getConfiguration().cache.cacheLocation&&Object.keys(window.localStorage).filter((e=>e.startsWith("msal")||this.user&&e.startsWith(this.user.accountId))).forEach((e=>{window.localStorage.removeItem(e)})),window.sessionStorage.clear(),this.agent.setActiveAccount(null)})),(0,se.A)(this,"switchUser",(async e=>{const t=this.formatLoginRequest(e);let r;return t.forceSelectAccount=!0,this.config.defaults?.usePopupLogin?(r=await this.attemptLoginPopup(t),{session:this.completeLogin(r,t.skipActiveUser??!1)}):(await this.attemptLoginRedirect(t),{isRedirecting:!0})})),(0,se.A)(this,"attemptCompleteLoginRedirect",(async()=>{try{return await this.agent.handleRedirectPromise()||void 0}catch(e){throw e instanceof Ks.g&&"invalid_scope"===e.errorCode&&(l.Vy.log(e.errorMessage),this.clearSession()),e}})),(0,se.A)(this,"attemptSso",(async({scopes:e=m.cO,sessionId:t,loginHint:r,msftLoginRoute:i=!1})=>{if(this.config.defaults?.useSso||i)try{return await this.agent.ssoSilent({scopes:e,sid:t,loginHint:r})}catch(e){if(i&&e instanceof Xs.CB)return"interaction_required"===e.errorCode&&l.Vy.log("MSAL: User logged in to multiple accounts"),void("login_required"===e.errorCode&&l.Vy.log("MSAL: User not logged in to an account"));if(e instanceof Ys.jT||e instanceof Xs.CB)return void l.Vy.log("Couldn't find existing Microsoft session");throw e}})),(0,se.A)(this,"attemptLoginSilent",(async(e,{scopes:t=m.cO,forceRefresh:r})=>{if(e)try{return await this.agent.acquireTokenSilent({scopes:t,forceRefresh:r,account:e})}catch(e){if(e instanceof Xs.CB){const t=!(0,C.Us)("wal__log_invalid_msal_grant");return"invalid_grant"===e.errorCode&&t&&p.z.logEvent("Error - MSAL invalid grant error",{message:e.errorMessage,subError:e.subError}),void l.Vy.log("Couldn't find existing MSAL session")}throw e}})),(0,se.A)(this,"attemptLoginPopup",(({scopes:e=m.cO,loginHint:t,forceSelectAccount:r,featureRollout:i})=>this.agent.loginPopup({scopes:e,loginHint:t,prompt:r&&!t?"select_account":void 0,extraQueryParameters:i?{safe_rollout:`apply:${i}`}:{}}))),(0,se.A)(this,"attemptLoginRedirect",(({scopes:e=m.cO,redirectUri:t,loginHint:r,forceSelectAccount:i,featureRollout:n})=>{const o=ta.includes(window.location.pathname)?window.location.pathname:"/login";return this.agent.loginRedirect({scopes:e,redirectUri:t||o,loginHint:r,prompt:i?"select_account":void 0,extraQueryParameters:n?{safe_rollout:`apply:${n}`}:{}})})),(0,se.A)(this,"completeLogin",((e,t=!1)=>{if(!e)throw new Zs.eB("failed_login","Could not login user");return!t&&e.account&&this.agent.setActiveAccount(e.account),{accessToken:e.accessToken,idToken:e.idToken,user:(0,$s.LS)(e.idTokenClaims)}})),(0,se.A)(this,"formatLoginRequest",(e=>{const{scopes:t,resource:r,tokenType:i}=e||{},n={...e,...this.validateRequestParameters({scopes:t,resource:r,tokenType:i})};return n.usePopupLogin=void 0===e?.usePopupLogin?this.config.defaults?.usePopupLogin:e.usePopupLogin,n.useSso=void 0===e?.useSso?this.config.defaults?.useSso:e.useSso,n.featureRollout=window.localStorage.getItem("msal_auth_feature_rollout")||n.featureRollout||this.config.defaults?.featureRollout,n}))}get agent(){return this._agent||(this._agent=new Js.vq(this.config),this._agent.disableAccountStorageEvents()),this._agent}get config(){return this._config||(this._config=function(){if(!(0,A.O9)(pt))throw new ht;return pt}()),this._config}async initialize(){return this.agent.initialize()}get user(){const e=this.agent.getActiveAccount();return e?{accountId:(t=e).homeAccountId,tenantId:t.tenantId,appAccountId:t.localAccountId,nativeAccountId:t.nativeAccountId,environment:t.environment,username:t.username,name:t.name,puid:t.idTokenClaims?.puid,ageGroup:t.idTokenClaims?.ageGroup,accountType:(0,$s.HA)(t.homeAccountId,t.tenantId)}:void 0;var t}})||Ds)||Ds)||Ds;var ia=r(867312),na=r(706558),oa=r(15047),sa=r(329524),aa=r(730427);const ca=(0,A.t9)({auth_token:A.Kg}),la=async function(e){if((0,C.G7)("magic__augloop_msa_token")){const t=at.j.getProvider();if((0,A.O9)(t)&&["MICROSOFT","MICROSOFT1P"].includes(t.toUpperCase()))return(async e=>{const t=(0,E.W)(m.yC);return e.Interactive&&console.warn("Augloop is requesting an interactive token login"),await t.getToken({tokenType:"augloop",scopes:["https://augloop.office.com/v2/AugLoop.All"]})})(e)}return(async()=>(await er.E.get("/augloop/auth-token").json(ca)).auth_token)()};var da=r(908545);function ua(){return e=>{const t=(0,E.W)(Gs.e),r=(0,E.W)(Yr.M),i=(0,E.W)(ia.wO)(e),n=r.read(((e,t)=>(0,da.n)(e.assets,t)))[i];return n?t.recoverAssetMedia(n):Promise.reject(new Error(`Asset ${i} not found in store`))}}var ha=r(298552),pa=r(685944),ma=r(734273),fa=r(709134),ga=r(777689),Aa=r(664850),va=r(549654),ya=r(378448);const ba=(0,A.t9)({errorCode:A.Et}),wa="peppermintManager";class xa{constructor(e,t){(0,se.A)(this,"worker",void 0),(0,se.A)(this,"channel",void 0),(0,se.A)(this,"timer",new fa.U),(0,se.A)(this,"channelRequest",(async(...e)=>{this.timer.start();try{return await this.channel.requestAndExpectResponse(...e)}catch(e){if((0,u.A3)(e)&&ba(e.context)){const t=ga.wo.create(e.context.errorCode);throw t.message=e.message,t.stack=e.stack,t}throw e}finally{this.timer.stop()}})),this.buildType=e,this.logDestination=t,this.worker=this.createWorker(),this.channel=this.createChannel(),this.listenForLogs()}createWorker(){return(0,Aa.H)()}createChannel(){return(0,T.q)("peppermint",this.worker)}async rebootModule(){await this.channelRequest("reboot-module",{buildType:this.buildType,logDestination:this.logDestination})}async reboot(){this.timer.clear();const e=this.channelRequest("ping","ping"),t=new Promise(((e,t)=>setTimeout(t,5e3)));try{await Promise.race([e,t])}catch(e){console.warn("Failed to ping worker:",e),this.worker.terminate(),this.worker=this.createWorker(),this.channel=this.createChannel()}try{await this.rebootModule()}catch(e){if(console.warn("Failed to reboot module:",e),"wasm_simd"!==this.buildType)throw e;this.buildType="wasm",await this.rebootModule()}}async createFormatDemuxer(e){const{demuxerId:t}=await this.channelRequest("create-format-demuxer",e);return new va.N(this,t,e)}async createVideoDecoder(e){const{decoderId:t}=await this.channel.requestAndExpectResponse("create-video-decoder",{inputFile:e});return new ya.P(this.channel,this.timer,t)}listenForLogs(){this.channel.onRequestSendResponse("forward-log",(async({level:e,message:t})=>(l.Vy[e](`PeppermintWorker: ${t}`),{data:void 0})))}}var Sa=r(859668),Ta=r(528864),Ca=r(488510),_a=r(815731);r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);class ka{constructor(e,t,r){(0,se.A)(this,"eof",!1),(0,se.A)(this,"recycledSlotCallback",void 0),(0,se.A)(this,"recycledSlots",[]),(0,se.A)(this,"finishedFrameCallback",void 0),(0,se.A)(this,"finishedFrames",[]),this.frameSizeInBytes=e,this.numberOfFrames=t;for(let i=0;i<t;++i)this.recycledSlots.push(r?void 0:new Uint8Array(e))}async getFrameSlot(){return this.recycledSlots.length>0?this.recycledSlots.pop():new Promise((e=>{this.recycledSlotCallback=e}))}async dequeueFrame(e){this.recycledSlots.push(e);const t=this.finishedFrames.shift();if(t)return t;if(this.eof)throw new Error("Stream has ended");return this.resumeCompositor(),new Promise(((e,t)=>{this.finishedFrameCallback=r=>{r instanceof Error?t(r):e(r)}}))}appendFrame(e){if(this.finishedFrameCallback){const t=this.finishedFrameCallback;this.finishedFrameCallback=void 0,t(e)}else this.finishedFrames.push(e)}endOfFrames(){if(this.eof=!0,this.finishedFrameCallback){const e=this.finishedFrameCallback;this.finishedFrameCallback=void 0,e(new Error("Stream has ended"))}}resumeCompositor(){if(this.recycledSlotCallback&&this.recycledSlots.length>0){const e=this.recycledSlots.pop(),t=this.recycledSlotCallback;this.recycledSlotCallback=void 0,t(e)}}}var Ea=r(800256),Ia=r(501716);var Ra,Fa=r(580490),Pa=r(589084),La=r(930394),Na=r(957734),Ma=r(15464),Ba=r(633110),Da=r(855507);let Oa=(0,ke.Gr)()(Ra=Reflect.metadata("design:type",Function)(Ra=Reflect.metadata("design:paramtypes",[])(Ra=class{constructor(){}createSelfie(e,t,r,i,n,o,s,a){const c=o.has("yuv420p-input"),l=o.has("supermix"),d={inputFrameRate:r.fps,numberOfFrames:i,resolution:n,totalDurationInMillis:1e3*i/r.fps,inputFormat:c?"yuv420p":"rgba"},h=new ka(function({inputFormat:e,resolution:t}){switch(e){case"rgba":return function({width:e,height:t}){return e*t*Ia.AN}(t);case"yuv420p":return function({width:e,height:t}){return e*t+Math.ceil(e/2)*Math.ceil(t/2)*2}(t);default:return(0,Gt.xb)(e,"Invalid input format")}}(d),Ia.UU,s);let m;if(l){const e=(0,Da.d)(r);d.supermixOptions=e,m=new ka(function({bufferLength:e=Ea.Ib,channelCount:t=Ea.cA}){return e*t*Float32Array.BYTES_PER_ELEMENT}(e),Ia.R_,!1),t=[{durationInSeconds:d.totalDurationInMillis/1e3,globalOffsetInSeconds:0,localOffsetInSeconds:0,rate:1,needsResampling:(0,Da.D)(r),inputFile:{frameReader:m}}]}return async function(e,t,r){try{let i=await e.next;for(;!i.finished;){t.appendFrame(i.value.video);const e=i.value.audio;void 0!==e&&r?.appendFrame(new Uint8Array(e.buffer));const[n,o]=await(0,Ba.F_)("frame-slot",[t.getFrameSlot(),r?.getFrameSlot()]);i=await i.continue({video:n,audio:o?new Float32Array(o.buffer):void 0})}}finally{t.endOfFrames(),r?.endOfFrames()}}(e,h,m).catch((e=>{console.error("Error during frame grabbing",e),a(e);const t=e instanceof u.g9?e.toEventProperties():{};p.z.logEvent("Error - Export decoding failed",{error:e instanceof Error?e.message:`${e}`,...t})})),{...d,segments:[{video:{frameReader:h},graph:t}]}}async runExport(e,t,r,i,n,o,s,a,c,l,d,h){const m=o.has("mpeg-ts-output"),f={preset:r.transcodingPreset,format:m?"mpegts":r.transcodingFormat,framerate:r.fps,upload:s?{chunkSizeInBytes:s.chunkSizeInBytes}:void 0};if(await(0,Fa.Nm)(),d){const e=function(e){const t=new DataView(e.paddedExtradata.buffer,La.pK.byteLength+e.paddedExtradata.byteOffset);return{profile:(0,Pa.wA)(t),level:(0,Pa.x9)(t)}}(d.h264Extradata);p.z.logEvent("Logging - WebCodecs encoding",{supported:!0,...n,preset:r.id,hardwareAcceleration:d.hardwareAcceleration,...e})}else p.z.logEvent("Logging - WebCodecs encoding",{supported:!1,...n,preset:r.id});return new Promise(((m,g)=>{const A=this.createSelfie(e,t,r,i,n,o,h,g);if(l.cancelled)g(new Na.c);else{const e=performance.now();l.wrap((0,Fa.Wn)(A,f,((t,r,i)=>{m({exportedVideoBlob:t,removalCallback:r,transcoderRunStatistics:i}),a.next(100),a.complete(),Math.ceil((performance.now()-e)/1e3)}),(e=>a.next(e)),(e=>c.next(e)),(e=>{g(e||new Error("Failed to export video")),e instanceof Na.c||((0,Fa.T7)("full").catch((()=>({}))).then((t=>{const r=e instanceof u.g9?e.toEventProperties():{};p.z.logEvent("Error - Export encoding failed",{error:e instanceof Error?e.message:`${e}`,...t,...r,resolution:`${n.width}x${n.height}`})})).catch((e=>console.warn("Failed log encoding error:",e))),a.complete())}),d,h,!0,s))}}))}exportVideo(e,t,r,i,n,o,s,a,c){const l=new _a.t(0),d=new Mr.B,u=new Ma.U;return{transcodedBlob:this.runExport(e,t,r,i,n,o,c,l,d,u,s,a),progress:l,state:d,cancelExport:()=>u.cancel()}}})||Ra)||Ra)||Ra;var ja,Ua=r(972389);let za=(0,ke.Gr)()(ja=function(e){return(0,ke.WQ)(Sa.c)(e,void 0,0)}(ja=function(e){return(0,ke.WQ)(Ta.g)(e,void 0,1)}(ja=function(e){return(0,ke.WQ)(Ca.mP)(e,void 0,2)}(ja=function(e){return(0,ke.WQ)(Oa)(e,void 0,3)}(ja=Reflect.metadata("design:type",Function)(ja=Reflect.metadata("design:paramtypes",[void 0===Sa.c?Object:Sa.c,void 0===Ta.J?Object:Ta.J,void 0===Ca.mP?Object:Ca.mP,void 0===Oa?Object:Oa])(ja=class{constructor(e,t,r,i){this.assetAudioCache=e,this.graphContextFactory=t,this.globalCtx=r,this.videoExporter=i}createTimelineRecorder(){return new Ua.c(this.globalCtx,this.graphContextFactory,this.videoExporter,this.assetAudioCache)}})||ja)||ja)||ja)||ja)||ja)||ja)||ja;var Wa=r(913807),Va=r(670324),Ha=r(917218),Ga=r(315612),qa=r(448260),Qa=r(215363),Ka=r(788855),Xa=r(248142);function Ya(e){let t=0;for(const r of e.tracks)for(const e of r.items)void 0!==(0,Xa.or)(e.asset)&&t++;return t}var Za=r(922557),Ja=r(193308);const $a=1048576,ec=e=>!((0,Ga.or)(e.asset)||1!==e.speed||(e=>{if(!e)return!1;if(e.rotation)return!0;if(e.bounds){if(e.bounds.left||e.bounds.bottom)return!0;if(1!==e.bounds.top||e.bounds.top!==e.bounds.right)return!0}return!!Object.values(e.crop??{}).some(Boolean)})(e.transform)||e.transitionIn||e.transitionOut||e.fadeInOut?.fadeInSeconds||e.fadeInOut?.fadeOutSeconds||1!==(e.volume??1));var tc;let rc=(0,ke.Gr)()(tc=function(e){return(0,ke.WQ)(Yr.M)(e,void 0,0)}(tc=function(e){return(0,ke.WQ)(Ca.mP)(e,void 0,1)}(tc=function(e){return(0,ke.WQ)(za)(e,void 0,2)}(tc=function(e){return(0,ke.WQ)(na.l)(e,void 0,3)}(tc=Reflect.metadata("design:type",Function)(tc=Reflect.metadata("design:paramtypes",[void 0===Yr.M?Object:Yr.M,void 0===Ca.mP?Object:Ca.mP,void 0===za?Object:za,void 0===i.IConfig?Object:i.IConfig])(tc=class extends Wa._{constructor(e,t,r,i){super(t,r),this.projectState=e,this.config=i}async start(e,t,r,i){if(!this.ensureOneExport())return void console.error("Export is already running, ignoring second start request");const n={type:"export:peppermint",manager:await this.rebootPeppermintManager()},{webcodecsConfiguration:o,useHardwareFrames:s}=await this.probeWebcodecsConfiguration({width:t,height:r},e);this.runExport(e,{width:t,height:r},n,i,o,s).then((()=>{})).catch((()=>{}))}onStart(e,t,r,i){!function(e,t,r,i){const n=[];r.assets.forEach((e=>{!(0,Qa.G)(e)&&(0,Ka.K)(e)&&n.push(e.metadata.size)}));const o=n.length>0?n.reduce(((e,t)=>e+t)):0,s=((e,t)=>{if(1!==e.tracks.length)return{losslessExportSupported:!1,inputOuputResolutionsMatch:!1};const[r]=e.tracks;if(0===r.items.length)return{losslessExportSupported:!1,inputOuputResolutionsMatch:!1};if(r.transitions.length>0)return{losslessExportSupported:!1,inputOuputResolutionsMatch:!1};let i,n=!0;for(const e of r.items){if(!(0,qa.q)(e))return{losslessExportSupported:!1,inputOuputResolutionsMatch:!1};if(!ec(e))return{losslessExportSupported:!1,inputOuputResolutionsMatch:!1};if(i&&i.id!==e.asset.id)return{losslessExportSupported:!1,inputOuputResolutionsMatch:!1};i=e.asset,e.asset.metadata.height!==t&&(n=!1)}return i?{losslessExportSupported:!0,inputOuputResolutionsMatch:n}:{losslessExportSupported:!1,inputOuputResolutionsMatch:n}})(r,t),a={exportIdentifier:e,aspectRatio:r.aspectRatio,resolution:`${t}p`,trackCount:r.tracks.length,localAssetsCount:n.length,localAssetsSize:o,isCaptioningEnabled:r.metadata?.captions?.enabled,hideCaptionsInPreview:r.metadata?.captions?.hideCaptionsInPreview,numTrackItemsWithCaptions:Ya(r),isLosslessTrimmingCompatible:s.losslessExportSupported,sourceResolutionMatchesExportResolution:s.inputOuputResolutionsMatch,...(0,Ja.nS)(r.tracks),...(0,Ja.nK)(i),isAutoComposedProject:r.metadata?.autoComposition?.enabled};return t=>{t.logEvent("Usage - Started Export",a),(0,C.G7)("ren__consumer_1ds_events")&&t.logAppLogicEvent("ExportStarted",{exportPresetId:i.id,exportFps:i.fps,correlationId:e})}}(e,r,i,t)(p.z)}async onSuccess(e,t,r,i,n,o,s,a){const c=await n.encoderRunStatistics;!function(e,t,r,i,n,o,s,a,c,l){const d=i.tracks,u=i.projectNumber,h=(0,Ja.of)(n),p=a?{}:(0,Ja.tY)(i),m={aspectRatio:i.aspectRatio,exportIdentifier:e,...(0,Ja.Tl)(t),exportTimeToDurationRatio:Number.parseFloat((t.exportTime/t.duration).toFixed(2)),...(0,Ja.nS)(d),resolution:r,outputFileSize:o,fileSizeToVideoDurationRatio:Number.parseFloat((o/$a/t.duration).toFixed(2)),...(0,Ja.nK)(s),...(0,Ja._z)(i),encoderMemoryUsage:l?Math.round(l.heapSizeInBytesAfterCompletion/$a):void 0,...(0,Ja.ST)(i),...i.analytics?.featureInteractions,...p,...c,exportCount:h,projectNumber:u,isCaptioningEnabled:i.metadata?.captions?.enabled,hideCaptionsInPreview:i.metadata?.captions?.hideCaptionsInPreview,numTrackItemsWithCaptions:Ya(i),isAutoComposedProject:i.metadata?.autoComposition?.enabled,codecCounts:(0,Ja.Qn)(i.tracks),trackItemCount:d.length,timeSpentEditingMs:i.timeSpentEditingMs};return r=>{void 0!==m.exportTime&&m.exportTime<0&&(r.logEvent("Error - Negative Export Time",{...m}),delete m.exportTime,delete m.exportTimeToDurationRatio),r.logEvent("Usage - Export Successful",{...m}),(0,C.G7)("ren__consumer_1ds_events")&&r.logAppLogicEvent("ExportCompleted",{exportPresetId:s.id,exportFps:s.fps,exportTimeSeconds:Math.floor(m.exportTime||0),videoDurationSeconds:Math.floor(t.duration),outputFileSizeBytes:o,isCaptioningEnabled:m.isCaptioningEnabled,hideCaptionsInPreview:m.hideCaptionsInPreview,correlationId:e})}}(e,{duration:n.durationSeconds,exportTime:o},r+"p",i,this.projectState,s,t,this.config.production,a,c)(p.z),p.z.incrementUserProperty("exports"),await async function(e,t){const r=e.tracks,i=[];r.forEach((e=>{e.items.forEach((e=>{((0,Za.n)(e)||"audio"===e.asset.type)&&(0,Qa.G)(e.asset)&&"videoblocks"===e.asset.cloud.provider&&i.push((0,Va.f)(e.asset))}))}));const n=(0,Ha.b)({maxAttempts:3,backOffPolicy:"exponential"}),o=at.j.getToken();await n((async()=>await fetch(`${t}/stock-items/export-notify`,{method:"POST",body:JSON.stringify({stock:i}),headers:{Authorization:"Bearer "+o}})))()}(i,this.config.apiBaseUrl)}onCancel(e,t,r,i,n,o){!function(e,t,r,i,n,o){return s=>{s.logEvent("Error - Export Cancelled",{exportIdentifier:e,...(0,Ja.Tl)(t),...(0,Ja.nK)(r),...(0,Ja.nS)(i),context:n,isAutoComposedProject:o}),(0,C.G7)("ren__consumer_1ds_events")&&s.logUserActionEvent("ExportCancelled",{actionType:"Unknown",exportPresetId:r.id,exportFps:r.fps,exportTimeSeconds:Math.floor(t.exportTime),videoDurationSeconds:Math.floor(t.duration),cancellationReason:n,correlationId:e})}}(e,{exportTime:n,duration:r.durationSeconds},t,i.tracks,o.reason,i.metadata?.autoComposition?.enabled)(p.z)}onFail(e,t,r,i,n,o){!function(e,t,r,i,n,o){const s=n instanceof u.g9?n.toEventProperties():{};return a=>{a.logEvent("Error - Export Failed",{exportIdentifier:e,error:n instanceof Error?n.message:`${n}`,...s,...(0,Ja.Tl)(t),...(0,Ja.nK)(r),...(0,Ja.nS)(i),codecCounts:(0,Ja.Qn)(i),isAutoComposedProject:o}),(0,C.G7)("ren__consumer_1ds_events")&&a.logErrorEvent("ExportFailed",{exportPresetId:r.id,exportFps:r.fps,exportTimeSeconds:Math.floor(t.exportTime),videoDurationSeconds:Math.floor(t.duration),stack:n instanceof Error?n.stack:void 0,correlationId:e})}}(e,{exportTime:n,duration:r.durationSeconds},t,i.tracks,o,i.metadata?.autoComposition?.enabled)(p.z)}onStall(e,t,r,i,n,o,s){const a=this.timelineRecorderFactory.globalCtx.globalCtx.isContextLost();!function(e,t,r,i,n,o,s){return a=>{a.logEvent("Error - Export Stalled",{exportIdentifier:e,exportProgress:r,encoderState:i,compositorState:(0,Ba.PE)(),webglContextLost:n,...(0,Ja.Tl)(t),...(0,Ja.nK)(o),...(0,Ja.nS)(s),codecCounts:(0,Ja.Qn)(s)}),(0,C.G7)("ren__consumer_1ds_events")&&a.logWarningEvent("ExportStalled",{exportPresetId:o.id,exportFps:o.fps,exportTimeSeconds:Math.floor(t.exportTime),videoDurationSeconds:Math.floor(t.duration),exportProgress:r,encoderState:i,webglContextLost:n,correlationId:e})}}(e,{duration:r,exportTime:t},i,n,a,o,s)(p.z),a?console.warn("Ignoring export stall due to context lost"):l.Vy.log(`Stalled at: ${i}%`)}async rebootPeppermintManager(){if(void 0===this.peppermintManager){const e=await(0,ma.Z)(),t=ke.kL.resolve(wa);this.peppermintManager=t(e,this.config.production)}return await this.peppermintManager.reboot(),this.peppermintManager}})||tc)||tc)||tc)||tc)||tc)||tc)||tc;var ic,nc=r(244792);let oc=(0,ke.Gr)()(ic=function(e){return(0,ke.WQ)(nc.ec)(e,void 0,0)}(ic=function(e){return(0,ke.WQ)(lo.F4)(e,void 0,1)}(ic=Reflect.metadata("design:type",Function)(ic=Reflect.metadata("design:paramtypes",[void 0===n.Config?Object:n.Config,"undefined"==typeof UserPreferencesService?Object:UserPreferencesService])(ic=class extends nc.WB{constructor(e,t){super(e),(0,se.A)(this,"getTimesShown",(e=>{const t=this.userPreferencesService.getUserPreferences();return t?.productTourTimesShown?.[e]??0})),(0,se.A)(this,"setTimesShown",((e,t)=>{(0,lo.Q_)("productTourTimesShown",(r=>({...r,[e]:t})))})),(0,se.A)(this,"isEnabled",(e=>{const t=(0,C.gZ)("create__discover_tour"),r=(0,C.gZ)("con__discover_tab");return"discover1"===e||"discover2"===e?Boolean(t)&&Boolean(r):"pauseRemoval"===e})),(0,se.A)(this,"trackStarted",((e,t)=>{p.z.logEvent("Usage - Product tour started",{productTourId:e,timesShown:t})})),(0,se.A)(this,"trackCompleted",(e=>{p.z.logEvent("Usage - Product tour completed",{productTourId:e})})),(0,se.A)(this,"trackNextStep",((e,t)=>{p.z.logEvent("Usage - Product tour next step",{productTourId:e,nextStep:t})})),(0,se.A)(this,"trackDismissed",((e,t)=>{p.z.logEvent("Usage - Product tour dismissed",{productTourId:e,dontShowAgain:t})})),this.userPreferencesService=t}})||ic)||ic)||ic)||ic)||ic;nc.lU,nc.ec;var sc=r(149698),ac=r(279541),cc=r(165604);class lc{constructor(e,t,r,i,n){(0,se.A)(this,"thumbnailJob",void 0),this.node=e,this.time=t,this.target=r,this.width=i,this.height=n,this.thumbnailJob=new cc.Q(e,t,r,i,n,0)}get priority(){return 1}runJob(){return this.thumbnailJob.runJob().then((()=>this.target.canvas.toDataURL()))}}var dc,uc=r(932808),hc=r(16885),pc=r(663393),mc=r(64349),fc=r(304669);let gc=(0,ke.Gr)()(dc=function(e){return(0,ke.WQ)(Gs.e)(e,void 0,0)}(dc=function(e){return(0,ke.WQ)(Ca.mP)(e,void 0,1)}(dc=function(e){return(0,ke.WQ)(Ta.g)(e,void 0,2)}(dc=Reflect.metadata("design:type",Function)(dc=Reflect.metadata("design:paramtypes",[void 0===zs.qI?Object:zs.qI,void 0===Ca.mP?Object:Ca.mP,void 0===Ta.J?Object:Ta.J])(dc=class{constructor(e,t,r){this.assetResolver=e,this.globalCtx=t,this.graphContext=r}build(e){return this.assetResolver.fetch(e).then((t=>this.buildFromCachedFile(t,e)))}buildFromCachedFile(e,t){let r;r="video"===t.type?this.createVideoNode(e,t.metadata):this.createImageNode(e,t.metadata),r.duration="video"===t.type?t.metadata.duration:0;const i=this.createVisualNode(r);return this.renderNodeThumbnail(i,260,this.calculateThumbnailHeight(t.metadata))}createImageNode(e,t){const[r,i]=(0,ac.Dc)(t);return new mc.K(this.globalCtx.thumbnailRoot,this.graphContext.createTempContext(this.globalCtx.thumbnailRoot),e,(0,ac.JZ)(t),-(0,uc.tR)(t.rotation),r,i)}createVideoNode(e,t){return new fc.E(this.globalCtx.thumbnailRoot,new hc.Q,e,-(0,uc.tR)(t.rotation),260,this.calculateThumbnailHeight(t),t.raw)}createVisualNode(e){const t=this.graphContext.createTempContext(this.globalCtx.thumbnailRoot);return new pc.X(this.globalCtx.thumbnailRoot,t,e)}renderNodeThumbnail(e,t,r){return this.globalCtx.jobManager.queue(new lc(e,e.duration/2,this.globalCtx.thumbnailRoot.defaultTarget,t,r)).then((t=>(e.destroy(),t??"")),(t=>{throw e.destroy(),t}))}calculateThumbnailHeight(e){const[t,r]=(0,ac.Dc)(e);return 260/(t/r)}})||dc)||dc)||dc)||dc)||dc)||dc;var Ac=r(948550);const vc={getDataUrl:e=>new Promise(((t,r)=>{const i=new FileReader,n=window.setTimeout((()=>{r(new Error("Timeout turning blob into data URL"))}),5e3);i.addEventListener("error",(()=>{window.clearTimeout(n),r(new Error("Error turning image blob into data URL"))})),i.addEventListener("loadend",(()=>{window.clearTimeout(n),t(i.result)})),i.readAsDataURL(e)})),unsafeGetDataUrl:e=>e instanceof Blob?vc.getDataUrl(e):Promise.reject(new Error("No pre-extracted preview image available")),unwrapBuild:e=>async t=>{for(const r of e)try{return await r.build(t)}catch(e){if(e instanceof Ac.me)throw e}throw new Error("Exhausted all strategies during unwrap")}},yc=()=>{};var bc;let wc=(0,ke.Gr)()(bc=function(e){return(0,ke.WQ)(Gs.e)(e,void 0,0)}(bc=Reflect.metadata("design:type",Function)(bc=Reflect.metadata("design:paramtypes",[void 0===zs.qI?Object:zs.qI])(bc=class{constructor(e){this.assetResolver=e}build(e){return this.assetResolver.fetch(e).then((t=>this.fromFFmpeg(t,e))).then((e=>vc.getDataUrl(e)))}fromFFmpeg(e,t){return"image"===t.type?Promise.reject(new Error("Not a video")):function(e,t){return new Promise(((r,i)=>{(0,Fa.of)(e.getTranscoderInputFile(),t,r,(e=>i((0,u.xM)(e,"Error extracting preview image"))),yc)}))}(e,t.metadata)}})||bc)||bc)||bc)||bc;class xc{constructor(){(0,se.A)(this,"thumbnail",void 0),(0,se.A)(this,"thumbnail$",new Mr.B),this.thumbnail=this.thumbnail$.toPromise().then((e=>(0,O.sw)(e,"thumbnail completed without a value")))}}class Sc extends xc{constructor(e,t,r,i,n,o){super(),this.asset=e,this.cloudThumbnail=t,this.videoBlocksThumbnail=r,this.ffmpegThumbnail=i,this.html5Thumbnail=n,this.pluginCloudThumbnail=o}generateThumbnail(){this.generateThumbnailForAsset().then((e=>{this.thumbnail$.next(e),this.thumbnail$.complete()})).catch((e=>{console.error("Failed to create thumbnail"),console.error(e)}))}assetIsFromVideoBlocks(e){return!!e.cloud&&"videoblocks"===e.cloud.provider}buildVideoThumbnail(e){let t;return t=this.assetIsFromVideoBlocks(e)?this.videoBlocksThumbnail:this.cloudThumbnail,vc.unwrapBuild([t,this.ffmpegThumbnail,this.html5Thumbnail])(e)}buildPluginThumbnail(e){return vc.unwrapBuild([this.pluginCloudThumbnail])(e)}generateThumbnailForAsset(){let e;switch(this.asset.type){case"video":case"image":e=this.asset.thumbnailUrl?Promise.resolve(this.asset.thumbnailUrl):this.buildVideoThumbnail(this.asset);break;case"title":e=this.asset.thumbnailUrl?Promise.resolve(this.asset.thumbnailUrl):this.buildPluginThumbnail(this.asset);break;case"transition":e=Promise.resolve(this.asset.thumbnailUrl);break;default:throw new Error("Can't create thumbnail for "+this.asset.type+" asset")}return e}}var Tc,Cc=r(529616),_c=r(953734),kc=r(882884),Ec=r(209858);const Ic=new class{constructor(){(0,se.A)(this,"_fontCache",new Cc.w)}async getFontStyles(e,t){const r=(0,_c.s)(e);return this._fontCache.getFontStyles(r,t)}},Rc={getFontStyles:(e,t)=>{const r=[];for(const t of e){const e=(0,kc.Pu)(t.fontName,`${(0,E.W)(ha.X).contentRepoBucketUrl}/content/font/google`);void 0!==e&&r.push({familyName:t.fontName,idealWeight:t.idealWeight,font:e})}return Ic.getFontStyles(r,t)}};let Fc=(0,ke.Gr)()(Tc=function(e){return(0,ke.WQ)(Gs.e)(e,void 0,0)}(Tc=function(e){return(0,ke.WQ)(Ta.g)(e,void 0,1)}(Tc=function(e){return(0,ke.WQ)(Ca.mP)(e,void 0,2)}(Tc=Reflect.metadata("design:type",Function)(Tc=Reflect.metadata("design:paramtypes",[void 0===zs.qI?Object:zs.qI,"undefined"==typeof GraphContextFactoryService?Object:GraphContextFactoryService,void 0===Ca.mP?Object:Ca.mP])(Tc=class{constructor(e,t,r){this.assetResolver=e,this.graphContextFactory=t,this.globalCtx=r}build(e){return this.buildFromCachedFile(e)}buildFromCachedFile(e){const t=this.createPluginNode(e);t.duration=5;const r=this.createVisualNode(t);return this.renderNodeThumbnail(r)}createPluginNode(e){const t=this.graphContextFactory.createTempContext(this.globalCtx.thumbnailRoot);return new Ec.q(this.globalCtx.thumbnailRoot,t,Rc,e.options,(e=>(console.warn("Fetching an asset in the headless render is a noop:",e),new Promise((()=>{})))))}createVisualNode(e){const t=this.graphContextFactory.createTempContext(this.globalCtx.thumbnailRoot);return new pc.X(this.globalCtx.thumbnailRoot,t,e)}renderNodeThumbnail(e){return this.globalCtx.jobManager.queue(new lc(e,e.duration/2,this.globalCtx.thumbnailRoot.defaultTarget,260,146)).then((t=>(e.destroy(),t??"")),(t=>{throw e.destroy(),t}))}})||Tc)||Tc)||Tc)||Tc)||Tc)||Tc;var Pc;const Lc=(0,A.t9)({thumbnail_url:(0,A.H7)(A.Kg)});let Nc=(0,ke.Gr)()(Pc=class{async build(e){const t=await er.E.get(`/storage/assets/${e.id}`).json(Lc);if(!t.thumbnail_url)throw new Error("Thumbnail not present in request payload.");return t.thumbnail_url}})||Pc;var Mc;let Bc=(0,ke.Gr)()(Mc=class{build(e){if(!e.cloud||"videoblocks"!==e.cloud.provider)return Promise.reject(new Error("Cannot extract thumbnail for non videoblocks provider"));const t="video"===e.type?"v":"i";return Promise.resolve(`${(0,E.W)(ha.X).contentRepoBucketUrl}/content/thumbs/stryb_${t}${e.cloud.id}.jpg`)}})||Mc;var Dc;let Oc=(0,ke.Gr)()(Dc=function(e){return(0,ke.WQ)(Nc)(e,void 0,0)}(Dc=function(e){return(0,ke.WQ)(Bc)(e,void 0,1)}(Dc=function(e){return(0,ke.WQ)(gc)(e,void 0,2)}(Dc=function(e){return(0,ke.WQ)(Fc)(e,void 0,3)}(Dc=function(e){return(0,ke.WQ)(wc)(e,void 0,4)}(Dc=Reflect.metadata("design:type",Function)(Dc=Reflect.metadata("design:paramtypes",[void 0===Nc?Object:Nc,void 0===Bc?Object:Bc,void 0===gc?Object:gc,void 0===Fc?Object:Fc,void 0===wc?Object:wc])(Dc=class extends sc.W{constructor(e,t,r,i,n){super(),this.cloudThumbnailProvider=e,this.contentRepoThumbnailProvider=t,this.html5ThumbnailProvider=r,this.pluginCloudThumbnailProvider=i,this.ffmpegThumbnailProvider=n}createAssetThumbnailJob(e){return new Sc(e,this.cloudThumbnailProvider,this.contentRepoThumbnailProvider,this.ffmpegThumbnailProvider,this.html5ThumbnailProvider,this.pluginCloudThumbnailProvider)}})||Dc)||Dc)||Dc)||Dc)||Dc)||Dc)||Dc)||Dc;const jc=()=>e=>{};var Uc,zc=r(505541);let Wc=(0,ke.Gr)()(Uc=class extends zc.gM{get graphItemExpandedFields(){return""}get graphExcludeHeaders(){return["X-Requested-With","client-request-id"]}})||Uc;const Vc="local-cache",Hc=`/${Vc}/`,Gc=`${Hc}assets/lookup`;function qc(){const e=new Worker(new URL(r.p+r.u(91063),r.b),{type:"module"});return[e,(0,T.q)("libheif",e)]}var Qc,Kc=r(620234),Xc=r(479309),Yc=r(483125),Zc=r(597906),Jc=r(154942),$c=r(625902),el=r(769159),tl=r(481973),rl=r(573878),il=r(228915),nl=r(593848),ol=r(885935);let sl=(0,ke.Gr)()(Qc=class{constructor(){(0,se.A)(this,"assetCreationBatching",new ol.Y((async e=>{try{return await er.E.post("/storage/assets",{body:e}),new Array(e.length).fill(void 0)}catch(t){throw console.error(`Error storing batch of ${e.length} assets`,t),t}}))),(0,se.A)(this,"assetDeletionBatching",new ol.Y((async e=>{try{return await er.E.put("/storage/assets/delete",{body:e}),new Array(e.length).fill(void 0)}catch(t){throw console.error(`Error batch deleting ${e.length} assets`),t}}),20)),(0,se.A)(this,"assetScheduleInProgressList",[]),(0,se.A)(this,"assetScheduleDeletionBatching",new ol.Y((async e=>{try{return await er.E.patch("/storage/assets/delete",{body:e}),new Array(e.length).fill(void 0)}catch(t){throw console.error(`Error batch schedule deleting ${e.length} assets`),t}}),20))}async createAsset(e,t){const r=(0,ot.K4)(),i=this.makeBackendAssetObj(e,t,r?.id);try{await this.assetCreationBatching.enqueueForBatchExecution(i,(()=>{}))}catch{}return Promise.resolve()}async updateAsset(e,t){const r=this.makeBackendAssetObj(e,t);await er.E.put(`/storage/assets/${e.id}`,{body:r})}async deleteAsset(e){try{return await this.assetDeletionBatching.enqueueForBatchExecution(e,(()=>{})),Promise.resolve()}catch(t){if((0,C.G7)("core__log_asset_delete_failed")){const r=t instanceof u.g9?t.toEventProperties():{};p.z.logEvent("Error - Failed to delete asset",{assetId:e.id,projectId:e.projectId,requestType:"batch",...r})}throw t}}async scheduleAssetBackupDeletion(e,t){if(!this.assetScheduleInProcess(e)){this.assetScheduleInProgressList.push(e);try{await this.assetScheduleDeletionBatching.enqueueForBatchExecution({id:e,projectId:t},(()=>{})),this.removeScheduleInProgress(e)}catch(t){if(this.removeScheduleInProgress(e),(0,C.G7)("core__log_asset_delete_failed")){const r=t instanceof u.g9?t.toEventProperties():{};p.z.logEvent("Error - Failed to schedule asset deletion",{assetId:e,requestType:"batch",reason:t instanceof Error?t.message:"unknown",...r})}return l.Vy.error(new Error(`Failed to schedule asset ${e} for deletion (ignoring)`),t),Promise.resolve()}}return Promise.resolve()}assetScheduleInProcess(e){return this.assetScheduleInProgressList.includes(e)}removeScheduleInProgress(e){this.assetScheduleInProgressList=this.assetScheduleInProgressList.filter((t=>t!==e))}makeBackendAssetObj(e,t,r){return{id:e.id,name:e.name,asset_size:e.metadata.size,imported_size:e.metadata.importedSize,project_id:t,workspace_id:r}}})||Qc;var al,cl=r(474107),ll=r(2857);let dl=(0,ke.Gr)()(al=function(e){return(0,ke.WQ)(Yr.M)(e,void 0,0)}(al=function(e){return(0,ke.WQ)(sl)(e,void 0,1)}(al=function(e){return(0,ke.WQ)(rl.D)(e,void 0,2)}(al=function(e){return(0,ke.WQ)(Gs.e)(e,void 0,3)}(al=function(e){return(0,ke.WQ)(cl.T)(e,void 0,4)}(al=function(e){return(0,ke.WQ)(il.z)(e,void 0,5)}(al=Reflect.metadata("design:type",Function)(al=Reflect.metadata("design:paramtypes",[void 0===Yr.M?Object:Yr.M,void 0===sl?Object:sl,void 0===rl.D?Object:rl.D,void 0===zs.qI?Object:zs.qI,void 0===cl.T?Object:cl.T,void 0===il.z?Object:il.z])(al=class extends Os.${constructor(e,t,r,i,n,o){let s,a;super(e),this.state=e,this.backend=t,this.project=n,this.rehydrateEventEmitter=o,(0,je.sl)((e=>!!e)).subscribe((e=>{s=this.unregisterListener(s),a=this.unregisterListener(a),e&&(s=r.registerMetadataListener((e=>{this.updateUnhandled(e)})),a=o.registerRehydrateListener((async(e,t)=>{i.fetch(e,(t=>{"resolved"===t&&this.demoteToLocal(e.id)}))})))}))}unregisterListener(e){e&&e()}exists(e){return this.state.read((t=>t.assets.allIds.map((e=>t.assets.byId[e])).some(e)))}async upsert(e){if(this.state.read((t=>t.assets.allIds.includes(e.id))))return await this.update(e);const{id:t}=this.state.read((e=>e));if(this.state.update((t=>{t.assets.allIds.push(e.id),t.assets.byId[e.id]={...e}}),"disabled"),(0,Ka.N)(e)&&(0,ll.E)(e))try{await this.backend.createAsset(e,t)}catch(e){throw new Ac.oL(e instanceof Error?e.message:String(e))}}async update(e){!function(e){(0,M.ch)((t=>{if(!t.allIds.includes(e.id))return;if(t.bundledIds.includes(e.id))return;const r=t.byId[e.id];r&&(t.byId[e.id]={...r,...e})}))}(e);const t=e.id;if(!this.state.read((e=>e.assets.allIds.includes(t))))return;const r=this.state.read((e=>e)),i=r.assets.byId[t];let n=!1;if(i&&("name"in e&&i.name!==e.name||"thumbnailUrl"in e&&i.thumbnailUrl!==e.thumbnailUrl)&&(n=!0),this.state.update((r=>{const i=r.assets.byId[t];i&&(r.assets.byId[t]={...i,...e})}),"disabled"),(0,Ka.N)(e)&&(0,ll.E)(e)&&n)try{await this.backend.updateAsset(e,r.id)}catch(e){throw new Ac.oL(e instanceof Error?e.message:String(e))}}async delete(e,t){this.state.update(((t,r)=>{this.project.mutateProject(t,r,(t=>{t.removeAllItemsForAsset(e.id)}));const i=t.assets.allIds.indexOf(e.id);-1!==i&&t.assets.allIds.splice(i,1),delete t.assets.byId[e.id]}),"reset"),(0,ll.E)(e)&&await this.backend.deleteAsset({id:e.id,projectId:t})}async scheduleDeleteBackup(e,t){await this.backend.scheduleAssetBackupDeletion(e,t),this.demoteToLocal(e)}upsertUnhandled(e){this.upsert(e).catch((e=>{l.Vy.error(new u.g9("Failed to add asset",{originalError:e}))}))}updateUnhandled(e){this.update(e).catch((e=>{l.Vy.error(new u.g9("Failed to update asset",{originalError:e}))}))}deleteUnhandled(e,t){this.delete(e,t).catch((e=>{l.Vy.error(new u.g9("Failed to remove asset",{originalError:e}))}))}})||al)||al)||al)||al)||al)||al)||al)||al)||al;var ul=r(626443),hl=r(582901),pl=r(757013),ml=r(879205),fl=r(271716),gl=r(644069);const Al=(0,A.t9)({asset_state:(0,A.u)("persisted")}),vl=(0,A.t9)({asset_state:(0,A.u)("uploading"),signed_url:A.Kg,additional_headers:(0,A.eB)(A.Kg)}),yl=(0,A.ey)(Al,vl),bl=[ul.v.REQUEST_TIMEOUT,ul.v.TOO_MANY_REQUESTS,ul.v.INTERNAL_SERVER_ERROR,ul.v.BAD_GATEWAY,ul.v.SERVICE_UNAVAILABLE,ul.v.GATEWAY_TIMEOUT];class wl extends hl.T{constructor(e,t){super(t),this.backend=e}async initializeAssetUploadTransactional(e){let t,r;try{if(t=await this.fetchAssetFromCache(e),this.getMetadataSize(e)!==t.size&&this.getMetadataImportedSize(e)!==t.size)throw new pl.gL(t.type,t.size);p.z.logEvent("Sync - Asset Blob Retrieved from Cache",{assetId:e.id,assetType:e.type,assetName:e.name,assetImportedSize:this.getMetadataImportedSize(e),assetMimeType:t.type})}catch(e){if(e instanceof pl.gL)throw e;return void console.error(e)}try{r=await er.E.patch(`/storage/assets/${e.id}`,{retryableHttpCodes:[...bl,0],retryPolicy:{doRetry:Vo.PL,maxAttempts:6,backOffPolicy:"exponential",backOff:100,exponentialOption:{maxInterval:6400,multiplier:2}},body:{mime_type:t.type,md5_hash:""}}).json(yl)}catch(e){if(e instanceof Vo.j$||e instanceof Vo.iC||e instanceof Vo.l0)throw new pl.Kh(e.message,"asset-patch");throw e}if(!function(e){return"persisted"===e.asset_state}(r))return{assetBlob:t,signedUploadUrl:r.signed_url,additionalHeaders:r.additional_headers};{const t={id:e.id,deleteBackupAt:void 0,cloud:{id:e.id,provider:"cloudbackup"}};await this.assetRepository.update(t)}}async uploadAsset(e,t,r){if((0,A.O9)(e.cloud)&&!(0,gl.NT)(e.cloud.provider))return;try{await(0,ml.Ak)(this.generatePermanentUrl(e.id))}catch{throw new pl.cv}if((0,ll.E)(e)){const t=(0,je.U1)((e=>e.id));if(!t)throw new u.g9("Failed to get projectId for asset",{assetId:e.id});await this.backend.createAsset(e,t)}const i=await this.initializeAssetUploadTransactional(e);if(!(0,A.O9)(i))return;const{signedUploadUrl:n,assetBlob:o,additionalHeaders:s}=i;try{if(await fl.r.put(n,{headers:{...s,"Content-Type":o.type,"ngsw-bypass":"true"},retryableHttpCodes:[...bl,0],retryPolicy:{doRetry:Vo.PL,maxAttempts:6,backOffPolicy:"exponential",backOff:100,exponentialOption:{maxInterval:6400,multiplier:2}},body:o,extraData:{responseType:"blob",onProgress:e=>t(e.loaded,e.total||o.size)}}),r.isStopped)return;const i={id:e.id,deleteBackupAt:void 0,cloud:{id:e.id,provider:"cloudbackup"}};return await this.assetRepository.update(i)}catch(e){if(e instanceof Vo.j$||e instanceof Vo.iC||e instanceof Vo.l0)throw new pl.Kh(e.message,"signedurl-upload");throw e}}}var xl;let Sl=(0,ke.Gr)()(xl=function(e){return(0,ke.WQ)(Os.u)(e,void 0,0)}(xl=function(e){return(0,ke.WQ)(rl.D)(e,void 0,1)}(xl=function(e){return(0,ke.WQ)(Gs.e)(e,void 0,2)}(xl=function(e){return(0,ke.WQ)(sl)(e,void 0,3)}(xl=function(e){return(0,ke.WQ)(il.z)(e,void 0,4)}(xl=Reflect.metadata("design:type",Function)(xl=Reflect.metadata("design:paramtypes",[void 0===dl?Object:dl,void 0===rl.D?Object:rl.D,void 0===zs.qI?Object:zs.qI,void 0===sl?Object:sl,void 0===il.z?Object:il.z])(xl=class extends Ws.ZQ{constructor(e,t,r,i,n){super(t,r,n),this.assetRepository=e,this.backend=i,this.registerUploadProviders(),this.registerUploadSubscriptions()}registerUploadProviders(){this.providers.cloudbackup=new wl(this.backend,this.assetRepository)}handleProjectAssets(e){const t=(0,je.U1)((e=>e.id)),r=this.isBackupEnabled();for(const i of e)if(r)this.queueOrCompleteUpload(i);else if(void 0!==t&&void 0!==i.cloud&&"cloudbackup"===i.cloud.provider){this.cancelUpload("cloudbackup",i.id);const e=(0,v.uV)();e?.plan.id!==nl.uf&&this.assetRepository.scheduleDeleteBackup(i.id,t).catch((()=>{}))}this.cancelUnavailableAssetUploads(e),this.status.next(this.statusMap)}isBackupEnabled(){return(0,je.U1)((e=>e.isCloudBackupEnabled))??!1}})||xl)||xl)||xl)||xl)||xl)||xl)||xl)||xl;var Tl=r(981131),Cl=r(28593),_l=r(962097),kl=r(159614),El=r(404918),Il=r(880560),Rl=r(132702),Fl=r(624646),Pl=r(20431);const Ll="https://api.twitter.com/1.1";class Nl extends Pl.n{constructor(e){super(e,"twitter")}async fetchUserInfo(){const e=await this.get({endpoint:`${Ll}/account/verify_credentials.json`});return[{email:e.name,profilePicSrc:e.profile_image_url_https}]}async uploadFile(e){const t=new URLSearchParams({command:"INIT",total_bytes:e.size.toString(),media_type:e.type}),r=await this.post({endpoint:`${Ll}/media/upload.json?`+t,options:{headers:{"Content-Type":"multipart/form-data"}}}),i=5242880;let n=0;for(let t=0;t<e.size;t+=i){const o=e.slice(t,t+i),s=new URLSearchParams({command:"APPEND",media_id:r.media_id.toString(),segment_index:n.toString()});await this.post({endpoint:`${Ll}/media/upload.json?`+s,options:{headers:{"Content-Type":"multipart/form-data"},body:o}}),n++}const o=new URLSearchParams({command:"FINALIZE",media_id:r.media_id.toString()});await this.post({endpoint:`${Ll}/media/upload.json?`+o,options:{headers:{"Content-Type":"multipart/form-data"}}});const s=new URLSearchParams({command:"STATUS",media_id:r.media_id.toString()});return await this.get({endpoint:`${Ll}/media/upload.json?`+s,options:{headers:{"Content-Type":"multipart/form-data"}}})}async createTweet(e,t){const r=new URLSearchParams({status:e,media_ids:t});return await this.get({endpoint:`${Ll}/statuses/update.json`+r})}async post({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"POST"}})}async get({endpoint:e,options:t}){return this.requestWithRetry({endpoint:e,options:{...t,method:"GET"}})}}var Ml,Bl=r(706361),Dl=r(236229),Ol=r(902131),jl=r(271498);let Ul=(0,ke.Gr)()(Ml=class{create(e,t){switch(e){case"box":case"box_edit_in":return new Tl.G(t);case"dropbox":return new Dl.b(t);case"gdrive":return new Fl.g(t);case"google_photos":return new Ol.N(t);case"linkedin":return new _l.B(t);case"onedrive":return new kl.bg("onedrive",t);case"onedrive1p":return new kl.bg("onedrive1p",t);case"pinterest":return new El.N(t);case"tiktok":return new jl.P(t);case"twitter":return new Nl(t);case"xbox":return new Il.Q(t);case"youtube":return new Bl.Q(t);case"zoom":return new Rl.q(t);case"instagram":return new Cl.l(t);default:throw new Error(`Unknown integration: ${e}`)}}})||Ml;const zl="contentResolutionStrategy";class Wl{}var Vl,Hl=r(594012),Gl=r(355185),ql=r(602453);const Ql=(0,A.t9)({title:A.Kg,type:(0,A.u)("video","audio","image"),vendorId:A.Kg});let Kl=(0,ke.Gr)()(Vl=function(e){return(0,ke.WQ)(ha.X)(e,void 0,0)}(Vl=function(e){return(0,ke.WQ)(Hl.x)(e,void 0,1)}(Vl=Reflect.metadata("design:type",Function)(Vl=Reflect.metadata("design:paramtypes",[void 0===ha.IContentConfig?Object:ha.IContentConfig,void 0===Hl.x?Object:Hl.x])(Vl=class extends Wl{constructor(e,t){super(),this.config=e,this.remoteImport=t}loadContent(e,t){if("stryb"!==e.vendor)throw new Error(`Content Vendor was incorrect, expected stryb, got ${e.vendor}`);if(!(e=>{switch(e){case"audio":case"video":case"image":return!0;default:return!1}})(e.type))throw new Error(`Tried to load StoryBlocks content with invalid type: ${e.type}`);return fl.r.get(`${this.config.contentRepoUrl}/v1/content/${(0,Gl.YQ)(e)}`,{headers:{"x-content-repo-api-key":this.config.contentRepoKey}}).json(Ql).then((e=>{const r={id:(0,Or.F)(),name:e.title,hidden:!1,type:e.type,cloud:{provider:"videoblocks",id:e.vendorId}};return this.remoteImport.importRemoteAsset(t,r).then((e=>(0,O.sw)(e,"remoteImport completed without a value")))}))}match(e){return"stryb"===e.vendor&&(0,ql.JI)(e)}})||Vl)||Vl)||Vl)||Vl)||Vl;var Xl;const Yl=new Set(["motion-title","graphic-element","audio","video","image","element"]);let Zl=(0,ke.Gr)()(Xl=function(e){return(0,ke.WQ)(Hl.x)(e,void 0,0)}(Xl=function(e){return(0,ke.WQ)(Zc.ug)(e,void 0,1)}(Xl=Reflect.metadata("design:type",Function)(Xl=Reflect.metadata("design:paramtypes",[void 0===Hl.x?Object:Hl.x,void 0===pa.E?Object:pa.E])(Xl=class extends Wl{constructor(e,t){super(),this.remoteImport=e,this.assetCollect=t}async loadContent(e,t){if("cc"!==e.vendor)throw new Error(`Content Vendor was incorrect, expected cc, got ${e.vendor}`);const r=(0,Gl.YQ)(e),i=await this.assetCollect.getAssetById(r);return(0,ql.JI)(e)||(0,ql.vq)(e)?await this.remoteImport.importRemoteAsset(t,i).then((e=>(0,O.sw)(e,"remoteImport completed without a value"))):i}match(e){return"cc"===e.vendor&&Yl.has(e.type)}})||Xl)||Xl)||Xl)||Xl)||Xl;var Jl,$l=r(457480),ed=r(484331),td=r(945897),rd=r(981680);const nd=["title","video","audio"];let od=(0,ke.Gr)()(Jl=function(e){return(0,ke.zE)(zl)(e,void 0,0)}(Jl=function(e){return(0,ke.WQ)(cl.T)(e,void 0,1)}(Jl=function(e){return(0,ke.WQ)(td.Z)(e,void 0,2)}(Jl=Reflect.metadata("design:type",Function)(Jl=Reflect.metadata("design:paramtypes",[Array,void 0===cl.T?Object:cl.T,void 0===td.Z?Object:td.Z])(Jl=class extends rd.v{constructor(e,t,r){super(),this.strategies=e,this.projectWrapper=t,this.projects=r}async createProjectFrom(e,t=ed.X){const r=jt.Ay.t(ed.u),i=await(0,$l.s)(this.projects.createProjectAndLoadContent$(r,t)),n=await Promise.all(e.map((e=>{const t=this.strategies.find((t=>t.match(e)));return t?t.loadContent(e,i):void console.error(`No strategy was found for ${(0,Gl.YQ)(e)}`)})).filter(A.O9));if(n.length<=0)throw new Error("No content strategy could be found.");const o=n.map((e=>[nd.indexOf(e.type),e])).sort((([e],[t])=>t-e)).map((([,e])=>e));return this.projectWrapper.update((e=>{const t=new Map,r=new Map;for(const{id:i}of o){const n=e.getAssetUnchecked(i);if(!n.trackType)continue;const o=r.get(n.type)??e.createTrack(n.trackType);r.set(n.type,o);const s=o.createItem(n,e.aspectRatio),a=t.get(n.type)??0;s.moveTo(a),t.set(n.type,s.endTime)}}),"reset"),i}match(){return!0}})||Jl)||Jl)||Jl)||Jl)||Jl)||Jl;var sd,ad=r(599038),cd=r(656717),ld=r(716887),dd=r(33493),ud=r(995895);let hd=(0,ke.Gr)()(sd=function(e){return(0,ke.WQ)(nc.lU)(e,void 0,0)}(sd=function(e){return(0,ke.WQ)(Zc.ug)(e,void 0,1)}(sd=function(e){return(0,ke.WQ)(ld.I)(e,void 0,2)}(sd=function(e){return(0,ke.WQ)(cd.a8)(e,void 0,3)}(sd=function(e){return(0,ke.WQ)(td.Z)(e,void 0,4)}(sd=Reflect.metadata("design:type",Function)(sd=Reflect.metadata("design:paramtypes",[void 0===oc?Object:oc,void 0===pa.E?Object:pa.E,void 0===ld.I?Object:ld.I,void 0===cd.a8?Object:cd.a8,void 0===td.Z?Object:td.Z])(sd=class extends rd.v{constructor(e,t,r,i,n){super(),this.productTour=e,this.assetCollect=t,this.projectUtilsService=r,this.projectSchemaService=i,this.createService=n}async createProjectFrom(e){const t=e.find((({vendor:e,type:t})=>"cc"===e&&"template"===t));if(!t)throw new Error("Could not find valid template from parsed ids");const r=await this.assetCollect.getContentById((0,Gl.YQ)(t));if(r&&(0,ql.Fl)(r)){const e=await this.projectSchemaService.getUnknownProjectGuard(),t=await fl.r.get(r.projectUrl).json(e),i=await this.projectSchemaService.migrate(t),n=(0,dd.I)((0,ad.c3)(i,r.id,r.subtype,r.title));await this.createService.createProjectForState(await this.projectUtilsService.loadProjectAssets(n)),p.z.logEvent("Usage - Template used",{id:r.id,subtype:r.subtype,name:r.title,tags:r.keywords,source:"deeplink"}),p.z.logEvent("Usage - Create video",{context:"template",id:r.id,name:r.title,projectType:"template",deeplink:!0});const o=(0,d.tu)(),s=(0,ud.v)({pathname:(0,Jr._G)(n.id)});return await o.navigate(s),n.id}throw new Error(`Content repo returned non-template content. Recieved: ${r}`)}match(e){return e.some((({type:e})=>"template"===e))}})||sd)||sd)||sd)||sd)||sd)||sd)||sd)||sd;class pd extends xa{constructor(e,t){super(e,t?"forward":"console")}createWorker(){return new Worker(new URL(r.p+r.u(44084),r.b),{type:"module"})}async createVideoDecoder(e){const t=await super.createVideoDecoder(e);let r=!1;return t.onFrame((e=>"webcodec"===e.type?(r=!0,"keep-listening"):(r&&p.z.logEvent("Error - WebCodec Decoder Failed"),"done"))),t}}const md=()=>(e,t)=>new pd(e,t);var fd=r(639327);const gd={id:"local",acceptAsDefault:!0,resolve:e=>Promise.resolve({variants:[],getFile:()=>({id:`local:${e}`,localFontName:e,fetch:()=>Promise.reject(new Error("Can't fetch a local font"))})})};class Ad extends u.g9{constructor(e){super("Failed to fetch builtin font",e)}}function vd(e){return{id:"builtin",acceptAsDefault:!0,async resolve(t){const r=t.toLocaleLowerCase(),i=kc.xA;for(const t of i)if(t.name.toLocaleLowerCase()===r)return{variants:t.variants,getFile:r=>{const i=t.variants.find((e=>e.weight===r.weight&&e.feature===r.feature))?.filename,n=`${e}/${i}`;return{id:`url:${n}`,async fetch(){const e=await fetch(n);if(!e.ok)throw new Ad({fontUrl:n,statusCode:e.status,statusText:e.statusText});return e.arrayBuffer()}}}}}}}function yd({data:e},t){if("status"in e.file)return;const r=e.file;return{variants:[{weight:e.supportedFontWeight}],getFile(e){const i=`cloud:"${r.provider}"-"${r.id}"-${e.weight}`;return{id:i,async fetch(){try{const e=await t.fetchAsset({id:i,name:i,hidden:!0,type:"video",cloud:r}).then((e=>(0,O.sw)(e,"fetchAsset completed without a value")));return p.z.logEvent("BrandKitFontBackupResolved",{fontId:r.id}),e.arrayBuffer()}catch(e){throw e instanceof Error&&p.z.logErrorEvent("BrandKitFontBackupResolveFailed",{errorCode:e.message,errorAlertType:"Fatal",stack:e.stack}),new Error("Failed to fetch backup brandkit font file")}}}}}}var bd,wd=r(241210),xd=r(21442),Sd=r(129328);async function Td(e){return(await(0,$n.SX)().fetchQuery(["brand"],(()=>Sd.g.getBrandResources()))).filter((0,xd.nm)(e))}let Cd=(0,ke.Gr)()(bd=function(e){return(0,ke.WQ)(fd.wz)(e,void 0,0)}(bd=Reflect.metadata("design:type",Function)(bd=Reflect.metadata("design:paramtypes",[void 0===fd.wz?Object:fd.wz])(bd=class extends tl.MC{constructor(e){super(),(0,se.A)(this,"fontBaseUrl",void 0),this.remote=e,this.fontBaseUrl=`${k.T.contentRepoBucketUrl}/content/font/google`}createBrandFontProvider(){return{id:"brand",acceptAsDefault:!1,resolve:async e=>function(e,t,r,i){const n=vd(i);return{id:"brand",acceptAsDefault:!1,resolve(i){for(const o of e){if(o.id!==i)continue;const e=o.data;switch(e.subtype){case"builtin":return n.resolve(e.fontName);case"local":return gd.resolve(e.fontName);case"custom_font":const i=t.find((({id:t})=>t===e.fontName));return i?Promise.resolve(yd(i,r)):Promise.resolve(void 0)}}return Promise.resolve(void 0)}}}(await Td("font"),await Td("custom_font"),this.remote,this.fontBaseUrl).resolve(e)}}createBuiltinFontProvider(){return vd(this.fontBaseUrl)}getFontProviders(){return[this.createBuiltinFontProvider(),gd,this.createBrandFontProvider()]}resolveFont(e){return(0,wd.M)(e,this.getFontProviders())}})||bd)||bd)||bd)||bd;var _d=r(596076),kd=r(859730),Ed=r(986549),Id=r(907315),Rd=r(594464),Fd=r(823939),Pd=r(924309),Ld=r(657968),Nd=r(689999),Md=r(307391),Bd=r(225762),Dd=r(327866),Od=r(691421),jd=r(860784),Ud=r(128041);class zd{constructor(e){(0,se.A)(this,"isCurrentlyIdle",!0),(0,se.A)(this,"pendingBatchedCalls",new Ud.o),this.batchExecutionFunction=e}runRequest(e){const t=new jd.z;return this.pendingBatchedCalls.enqueue({parameter:e,controllable:t}),this.isCurrentlyIdle&&this.runNextBatch(),t.promise}runNextBatch(){this.isCurrentlyIdle=!1;const e=this.pendingBatchedCalls.dequeueAll();e&&e.length>0?this.batchExecutionFunction(e.map((e=>e.parameter))).then((t=>{e.forEach(((e,r)=>{e.controllable.watch(new Promise(((e,i)=>{"resolved"===t[r].status?e(t[r].result):i(t[r].error)}))).catch((e=>{console.warn("Single request of batch failed",e)}))})),this.runNextBatch()})).catch((t=>{console.error(`Batch call failed globally, rejecting all ${e.length} batched calls`,t),e.forEach((e=>{e.controllable.reject(t)})),this.runNextBatch()})):this.isCurrentlyIdle=!0}}let Wd;function Vd(){return(0,Dd.Sv)(Vc,1,((e,t)=>{t.oldVersion<1&&e.result.createObjectStore(Bd.Wd.ASSETS_TABLE,{keyPath:"permanentUrl"})}))}var Hd;let Gd=(0,ke.Gr)()(Hd=function(e){return(0,ke.WQ)(ia.OZ)(e,void 0,0)}(Hd=function(e){return(0,ke.WQ)(Fd.n)(e,void 0,1)}(Hd=Reflect.metadata("design:type",Function)(Hd=Reflect.metadata("design:paramtypes",[void 0===o.GeneratePermanentUrlFromAssetId?Object:o.GeneratePermanentUrlFromAssetId,void 0===Fd.n?Object:Fd.n,void 0===Nd.i?Object:Nd.i])(Hd=class extends Vs.o{constructor(e,t,r){super(t,r),this.generatePermanentUrlFromAssetId=e,this.eviction=t,this.storageManager=r}async lookupCachedAssets(e){await(0,Pd.k)("cache-lookup");try{return(await(0,ml.KU)(Gc,e.map(this.generatePermanentUrlFromAssetId))).map((e=>new Ld.Z(this.extractAssetIdFromPermanentUrl(e.permanentUrl),e.fileSize,e.fileName)))}catch(e){throw new Md.xE(e instanceof Error?e.message:"Unknown underlying error")}}get localCacheDatabase(){return Vd()}get assetWriteBatchQueue(){return Wd||(Wd=new zd((async e=>async function(e,t,r=10,i=1073741824){const n=function(e,t,r){let i=0,n=[];const o=[];for(const s of e)i+=s.blob.size,n.push(s),(n.length>=r||i>=t)&&(o.push(n),n=[],i=0);return n.length>0&&o.push(n),o}(t,i,r),o=[],s=[];for(const t of n)try{const r=await(0,Od.z)(e,t);s.push(...r)}catch(e){const r=e instanceof Error?e.message:"<unknown>";l.su.error("caching-utils",`Error when writing bucket of ${t.length} items: ${r}`),o.push(...t)}for(const t of o)try{const r=await(0,Od.z)(e,[t]);s.push(...r)}catch(e){const t=(0,u.xM)(e,"Error when writing single record");l.su.error("caching-utils",`Error when writing single record: ${t}`),s.push({status:"rejected",error:t})}return s}(await Vd(),e))))}})||Hd)||Hd)||Hd)||Hd)||Hd;var qd,Qd=r(444020),Kd=r(843875);let Xd=(0,ke.Gr)()(qd=function(e){return(0,ke.WQ)(nc.lU)(e,void 0,0)}(qd=function(e){return(0,ke.WQ)(Yc.II)(e,void 0,1)}(qd=Reflect.metadata("design:type",Function)(qd=Reflect.metadata("design:paramtypes",[void 0===oc?Object:oc,void 0===Yc.A$?Object:Yc.A$])(qd=class extends L.Q{constructor(e,t){super(t),this.productTour=e}async prepareStorageOptions(){if(!(0,ot.wz)())return Promise.resolve();try{const e=await(0,Kd.U5)();return(0,O.iY)(e,"Expected workspace to be defined for sync"),{workspace:e}}catch(e){throw new Qd.O("PrepareStorageOptions")}}performCloseProject(e){const t=(0,d.tu)(),r=(0,Lr.B6)("/editor/:id",t.state.location.pathname),i=r?.params?.id,n=(0,je.U1)((e=>e));!n||n.id!==i&&void 0!==i||(e&&(0,je.jK)(),(0,ot.o3)(void 0))}})||qd)||qd)||qd)||qd)||qd;var Yd=r(142330),Zd=r(885627),Jd=r(167436);const $d=(0,A.t9)({info:(0,A.t9)({url:A.Kg})}),eu=[ul.v.BAD_GATEWAY,ul.v.GATEWAY_TIMEOUT,ul.v.SERVICE_UNAVAILABLE,ul.v.REQUEST_TIMEOUT,ul.v.INTERNAL_SERVER_ERROR];class tu extends Zd.L{constructor(e,t,r){super(),(0,se.A)(this,"matchFileHash",!1),this.assetRepository=e,this.contentRepoUrl=t,this.contentRepoKey=r}async downloadAsset(e,{progress:t,abort:r}={}){if(!("cloud"in e)||!e.cloud||!e.cloud.id)return Promise.reject(new Error("Tried to fetch asset without provider details."));const{cloud:{id:i},type:n}=e;if(!n)return Promise.reject(new u.g9("Tried to fetch stock asset without type",{asset:e}));let o="1080p";(0,Jd.W)(e)&&e.metadata.height>=2160&&(o="2160p");const s=`/stock-items/${n}/download/${i}?resolution=${o}`;let a=-1;try{const i=await er.E.get(s,{retryableHttpCodes:eu,retryPolicy:{doRetry:Vo.PL,maxAttempts:3,backOffPolicy:"exponential"},signal:r}).json($d);if((0,C.Us)("pst__disable_video_blocks_repo_update_ks")&&e.cloud){const t={id:e.id,cloud:e.cloud};this.assetRepository.updateUnhandled(t)}let n=i.info.url;n=`https://stock-proxy.clipchamp.com/?url=${encodeURIComponent(Buffer.from(n).toString("base64"))}`,a=Date.now();const o=await fl.r.get(n,{retryableHttpCodes:eu,retryPolicy:{doRetry:Vo.PL,maxAttempts:3,backOffPolicy:"exponential"},signal:r,extraData:{responseType:"blob",onProgress:e=>{e.total&&t&&t(e.loaded/e.total)}}});(0,O.sw)(o.blob,"Expected VideoBlocks response body to be defined");const c=await o.blob();let l;if(a>0&&c.size>0){const e=c.size/1024/1024;l=(Date.now()-a)/1e3/e}return p.z.logEvent("Logging - Content Download Success",{type:e.type,provider:"storyblocks",secondsPerMegabyte:l}),c}catch(t){(0,Gt.vA)("cloud"in e&&!!e.cloud,"Expected VideoBlocks asset to have cloud info");const r=(0,Gl.YQ)({locale:"en",vendor:"stryb",vendorId:e.cloud.id,type:e.type});throw p.z.logEvent("Error - Content Download Failed",{type:e.type,provider:"storyblocks",id:r}),t instanceof Error&&this.reportStockFailure(e,r,t),t}}reportStockFailure(e,t,r){throw l.Vy.setExtraContext({type:e.type,storyblocksId:"cloud"in e&&e.cloud?.id||void 0,err:r}),fl.r.get(`${this.contentRepoUrl}/v1/content/validate/${t}`,{headers:{"x-content-repo-api-key":this.contentRepoKey}}).catch((e=>{l.Vy.error(e)})),r||new Error("Error downloading VideoBlocks asset")}}const ru={video:"v",audio:"a",image:"i"},iu=[ul.v.BAD_GATEWAY,ul.v.GATEWAY_TIMEOUT,ul.v.SERVICE_UNAVAILABLE,ul.v.REQUEST_TIMEOUT,ul.v.INTERNAL_SERVER_ERROR];class nu extends Zd.L{constructor(e){super(),(0,se.A)(this,"matchFileHash",!1),this.clipchampStockBucketUrl=e}async downloadAsset(e,{progress:t,abort:r}={}){if(!("cloud"in e)||!e.cloud||!e.cloud.id)return Promise.reject(new Error("Tried to fetch asset without provider details."));const{cloud:{id:i}}=e,n=i.includes("_")?i:`cc_${function(e){if("image"===e.type||"video"===e.type||"audio"===e.type)return ru[e.type];throw new Error("Unexpected asset type")}(e)}${i}`,o=(0,Gl.QO)(n),s=(0,Gl.YQ)({...o,locale:"en"}),a=`${this.clipchampStockBucketUrl}/${s}`,c=await fl.r.get(a,{retryableHttpCodes:iu,retryPolicy:{doRetry:Vo.PL,maxAttempts:3,backOffPolicy:"exponential"},signal:r,extraData:{responseType:"blob",onProgress:e=>{e.total&&t&&t(e.loaded/e.total)}}});return(0,O.sw)(c.blob,"Expected Clipchamp response body to be defined"),c.blob()}}const ou=(0,A.t9)({id:A.Kg,download_url:A.Kg});class su extends Zd.L{constructor(){super(),(0,se.A)(this,"matchFileHash",!1)}async downloadAsset(e,{progress:t}={}){(0,Gt.vA)("cloud"in e&&!!e.cloud,"Expected ClipGCloud asset to have cloud info");try{const r=await er.E.get(`/storage/brand/${e.cloud.id}/download`).json(ou);return(await fl.r.get(r.download_url,{extraData:{responseType:"blob",excludeHeaders:["X-Requested-With","Content-Type"],onProgress:e=>{e.total&&t&&t(e.loaded/e.total)}}})).blob()}catch(e){throw l.Vy.error(e),e}}}class au extends Zd.L{constructor(e){super(),(0,se.A)(this,"matchFileHash",!1),this.createUrl=e}async downloadAsset(e,{progress:t}={}){if("cloud"in e&&e.cloud){const r=this.createUrl+"/assets/projects/assets/"+e.cloud.id;return(await fl.r.get(r,{extraData:{responseType:"blob",onProgress:e=>{e.total&&t&&t(e.loaded/e.total)}}})).blob()}return Promise.reject(new Error("Tried to fetch asset without provider details."))}}class cu extends Zd.L{constructor(){super(),(0,se.A)(this,"matchFileHash",!1)}async downloadAsset(e,{progress:t}={}){if(!("cloud"in e)||!e.cloud||!e.cloud.id)return Promise.reject(new Error("Tried to fetch asset without provider details."));const{cloud:{id:r}}=e;let i=r;i=i.startsWith("giphysticker_")?i.slice(13):i.slice(6);try{return(await(0,fl.r)(`https://media3.giphy.com/media/${i}/giphy.gif`,{method:"GET",extraData:{responseType:"blob",onProgress:e=>{e.total&&t&&t(e.loaded/e.total)}}})).blob()}catch(e){throw e instanceof Vo.j$&&l.Vy.error(e.response.statusText),e}}}var lu=r(364701);const du=(0,A.t9)({signed_url:A.Kg}),uu=[ul.v.BAD_GATEWAY,ul.v.GATEWAY_TIMEOUT,ul.v.SERVICE_UNAVAILABLE,ul.v.REQUEST_TIMEOUT,ul.v.INTERNAL_SERVER_ERROR];class hu extends Zd.L{constructor(e){super(),(0,se.A)(this,"matchFileHash",!1),this.assetRepository=e}async downloadAsset(e,{progress:t}={}){if(!("cloud"in e)||!e.cloud||!e.cloud.id)throw new Error("Tried to fetch asset without provider details.");if(!this.isRemixableProject()&&!this.isCloudStorageEnabledForProject())throw new Zd.a("Cloud backup disabled for this project");try{const r=await er.E.get(`/storage/assets/${e.cloud.id}/download`).json(du);return(await fl.r.get(r.signed_url,{retryableHttpCodes:uu,retryPolicy:{doRetry:Vo.PL,maxAttempts:3,backOffPolicy:"exponential"},extraData:{responseType:"blob",excludeHeaders:["X-Requested-With","Content-Type"],onProgress:e=>{e.total&&t&&t(e.loaded/e.total)}}})).blob()}catch(r){throw r instanceof Vo.j$&&(t&&t(0),this.reportBackupRestoreFailure(e,r)),r}}reportBackupRestoreFailure(e,t){return l.Vy.setExtraContext({type:e.type,backendId:"cloud"in e?e.cloud?.id:void 0,err:t}),(0,lu.$)(t||new Error("Error downloading CloudBackup asset"))}isCloudStorageEnabledForProject(){return(0,je.U1)((e=>e.isCloudBackupEnabled))??!1}isRemixableProject(){return"remixed"===(0,je.U1)((e=>e.flavor))}}var pu;const mu={videoblocks:()=>Promise.resolve(new tu((0,E.W)(Os.u),k.T.contentRepoBucketUrl,k.T.contentRepoKey)),clipchamp_stock:()=>Promise.resolve(new nu(k.T.clipchampStockBucketUrl)),clipgcloud:()=>Promise.resolve(new su),clipchamp:()=>Promise.resolve(new au(k.T.createUrl)),cloudbackup:()=>Promise.resolve(new hu((0,E.W)(Os.u))),box:e=>r.e(85941).then(r.bind(r,485941)).then((({BoxProvider:t})=>new t(e))),box_edit_in:e=>r.e(52410).then(r.bind(r,352410)).then((({BoxEditInProvider:t})=>new t(e))),gdrive:e=>r.e(53675).then(r.bind(r,453675)).then((({GDriveProvider:t})=>new t(e))),hubble:()=>Promise.resolve(new Yd.c(k.T.hubbleCdnUrl)),zoom:e=>r.e(65119).then(r.bind(r,865119)).then((({ZoomProvider:t})=>new t(e))),dropbox:e=>r.e(32168).then(r.bind(r,532168)).then((({DropboxProvider:t})=>new t(e))),onedrive:e=>Promise.all([r.e(15661),r.e(55457)]).then(r.bind(r,655457)).then((({OneDrive1pProvider:t})=>new t(e))),onedrive1p:e=>Promise.all([r.e(15661),r.e(55457)]).then(r.bind(r,655457)).then((({OneDrive1pProvider:t})=>new t(e))),google_photos:e=>r.e(71995).then(r.bind(r,171995)).then((({GooglePhotosProvider:t})=>new t(e))),giphy:()=>Promise.resolve(new cu),text_to_speech:()=>Promise.all([r.e(99051),r.e(44873),r.e(21507)]).then(r.bind(r,408697)).then((({TextToSpeechProvider:e})=>new e((0,E.W)(Jc.Vg)))),windows_native:()=>{if(!(0,E.W)(De.T).satisfies("windows-native"))throw new Error("Trying to use Windows native provider outside Windows app.");return r.e(4237).then(r.bind(r,204237)).then((({WindowsNativeProvider:e})=>new e((0,E.W)(lr.j))))},url:()=>r.e(4237).then(r.bind(r,204237)).then((({URLProvider:e})=>new e)),xbox:e=>r.e(42717).then(r.bind(r,742717)).then((({XboxProvider:t})=>new t(e)))};let fu=(0,ke.Gr)()(pu=Reflect.metadata("design:type",Function)(pu=Reflect.metadata("design:paramtypes",[])(pu=class extends Hs.U{constructor(){super(),(0,se.A)(this,"cachedProviders",{})}async getProvider(e){return this.cachedProviders[e]=this.cachedProviders[e]||await mu[e]((0,E.W)(Xc.aU))}})||pu)||pu)||pu;var gu,Au=r(6690);class vu extends Tr.L{constructor(e,t,r={}){super(),(0,se.A)(this,"payload",void 0),this.payload={id:e,scopes:t,parameters:r}}}gu=vu,(0,se.A)(vu,"type","[Auth] Acquire Delegated token"),(0,se.A)(vu,"isInstance",(0,A.t9)({type:(0,A.u)(gu.type),payload:(0,A.t9)({id:A.Kg,scopes:(0,A._j)(A.Kg),parameters:(0,A.Sd)(A.Kg,A.Kg)})}));var yu,bu=r(275848),wu=r(712362),xu=r(148584),Su=r(323051),Tu=r(828941),Cu=r(834486);class _u extends Tr.L{}yu=_u,(0,se.A)(_u,"type","[Auth] Sign Out"),(0,se.A)(_u,"isInstance",(0,A.t9)({type:(0,A.u)(yu.type)}));var ku,Eu,Iu=r(795586);class Ru extends Tr.L{constructor(e,t,r,i){super(),(0,se.A)(this,"payload",void 0),this.payload={scopes:e,defaultToWindowsAccount:t,accountId:r,loginHint:i}}}ku=Ru,(0,se.A)(Ru,"type","[Auth] Sign In with Microsoft"),(0,se.A)(Ru,"isInstance",(0,A.t9)({type:(0,A.u)(ku.type),payload:(0,A.t9)({scopes:(0,A._j)(A.Kg),defaultToWindowsAccount:A.Lm,accountId:(0,A.H7)(A.Kg),loginHint:(0,A.H7)(A.Kg)})}));const Fu=(0,A.t9)({accessToken:A.Kg,idToken:(0,A.H7)(A.Kg)});class Pu extends Error{constructor(e,t){super(e,t),(0,se.A)(this,"reason",void 0),this.reason=t?.reason||"unknown"}}class Lu extends ea.l{}const Nu="NativeAppAuthService_Lock"+(0,We.u)();let Mu=(0,ke._G)()(Eu=Reflect.metadata("design:type",Function)(Eu=Reflect.metadata("design:paramtypes",[void 0===lr.j?Object:lr.j,void 0===ft.e?Object:ft.e,"undefined"==typeof MicrosoftBaseLoginRequest?Object:MicrosoftBaseLoginRequest])(Eu=class extends m.qG{constructor(e,t,r){super(r),(0,se.A)(this,"tokenCachingEnabled",!1),(0,se.A)(this,"login",(({scopes:e,tokenType:t,resource:r,accountId:i,loginHint:n,skipActiveUser:o=!1,defaultToWindowsAccount:s=!1})=>{const a=this.validateRequestParameters({scopes:e,resource:r,tokenType:t});return!0===this.nativeAppCapabilitiesService.capabilities?.gwy__windows_app_sign_in?this.acquireDelegatedToken(a.tokenType||"graph",a.scopes,a.resource,a.forceRefresh):this.signInWithMicrosoft(a.scopes||[],i,n,o,s)})),(0,se.A)(this,"getToken",(async e=>{const{session:t}=await this.login(e);return(0,O.sw)(t?.accessToken,"Expected access token from native application")})),(0,se.A)(this,"clearSession",(()=>{this.onLogout(),!0===this.nativeAppCapabilitiesService.capabilities?.gwy__windows_app_sign_in&&this.nativeMessaging.send(new _u)})),(0,se.A)(this,"logout",(()=>{this.clearSession()})),(0,se.A)(this,"getDefaultAccount",(()=>({accountId:void 0,loginHint:void 0}))),(0,se.A)(this,"signInWithMicrosoft",(async(e,t,r,i=!1,n=!1)=>{if(!i){const e=this.getDefaultAccount();t=e.accountId,r=e.loginHint}return new Promise(((i,o)=>{const s=[this.nativeMessaging.listen(Iu.I,(e=>{if(s.forEach((e=>e())),Fu(e.payload)){const t=(0,$s.LS)((0,Au.oL)(e.payload.idToken||e.payload.accessToken)),r=decodeURIComponent(e.payload.accessToken);return i({session:{accessToken:r,idToken:e.payload.idToken,user:t}})}o(new Lu("Invalid authentication message"))})),this.nativeMessaging.listen(Su.O,(()=>{s.forEach((e=>e())),o(new Pu("Canceled by user",{reason:"Canceled by user"}))})),this.nativeMessaging.listen(Cu.z,(()=>{s.forEach((e=>e())),o(new Pu("Cancelled by user",{reason:"Attempted to use AAD account"}))})),this.nativeMessaging.listen(Tu.W,(e=>{s.forEach((e=>e())),o(new Lu(e.payload.error))}))];this.nativeMessaging.send(new Ru(e,n,t,r))}))})),(0,se.A)(this,"acquireDelegatedToken",(async(e,t=[],r,i=!1)=>{if(this.tokenCachingEnabled&&!i&&!(0,C.Us)("ks_multi__native_token_caching")&&["graph","sharepoint","substrate"].includes(e)){const i=this.getCachedToken(r||e,t);if(i)return(0,O.iY)(this.userSession,"Expected user to be defined"),{session:{accessToken:i,idToken:this.userSession.idToken,user:this.userSession.user}}}return(0,C.Us)("ks_multi__native_token_locking")?this.sendDelegatedTokenRequest(e,t,r):window.navigator.locks.request(Nu,(()=>this.sendDelegatedTokenRequest(e,t,r)))})),(0,se.A)(this,"sendDelegatedTokenRequest",(async(e,t=[],r)=>{const i=(0,We.u)();return new Promise(((n,o)=>{const s=[this.nativeMessaging.listen(xu.p,(async r=>{if(i===r.payload.id){if(s.forEach((e=>e())),Fu(r.payload)){const i=decodeURIComponent(r.payload.accessToken);this.tokenCachingEnabled&&!(0,C.Us)("ks_multi__native_token_caching")&&["graph","sharepoint","substrate"].includes(e)&&this.setCachedToken(e,t,i);const o=r.payload.idToken||this.userSession?.idToken;let s=this.userSession?.user;return o&&(s=(0,$s.Rd)(o),"graph"===e&&s&&this.onLogin({accessToken:i,user:s,idToken:o})),(0,O.iY)(s,"Expected user to be defined"),n({session:{accessToken:i,idToken:o,user:s}})}o(new Lu("Invalid authentication message"))}})),this.nativeMessaging.listen(bu.S,(e=>{i===e.payload.id&&(s.forEach((e=>e())),o(new Pu("Canceled by user",{reason:"Canceled by user"})))})),this.nativeMessaging.listen(wu.u,(e=>{i===e.payload.id&&(s.forEach((e=>e())),o(new Lu(e.payload.error)))}))],a=r?{resource:r}:{resource:""};this.nativeMessaging.send(new vu(i,t,a))}))})),this.nativeMessaging=e,this.nativeAppCapabilitiesService=t}async initialize(){}})||Eu)||Eu)||Eu;var Bu;const Du=()=>{const e=at.j.getClaim("user.microsoft1p.oid"),t=at.j.getClaim("user.microsoft1p.tid")||"9188040d-6c67-4c5b-b112-36a304b66dad";return e&&t?`${e}.${t}`:void 0};let Ou=(0,ke.Gr)()(Bu=function(e){return(0,ke.WQ)(lr.j)(e,void 0,0)}(Bu=function(e){return(0,ke.WQ)(ft.e)(e,void 0,1)}(Bu=function(e){return(0,ke.WQ)(m.Ti)(e,void 0,2)}(Bu=Reflect.metadata("design:type",Function)(Bu=Reflect.metadata("design:paramtypes",[void 0===lr.j?Object:lr.j,void 0===ft.e?Object:ft.e,"undefined"==typeof MicrosoftBaseLoginRequest?Object:MicrosoftBaseLoginRequest])(Bu=class extends Mu{constructor(e,t,r){super(e,t,r),(0,se.A)(this,"getDefaultAccount",(()=>({accountId:Du(),loginHint:at.j.getClaim("email")})))}})||Bu)||Bu)||Bu)||Bu)||Bu)||Bu;const ju=(0,A.t9)({code:A.Kg});var Uu,zu,Wu,Vu=r(85759),Hu=r(432186),Gu=r.n(Hu);class qu extends Tr.L{constructor(e,t){super(),(0,se.A)(this,"payload",void 0),this.payload={redirectUrl:e,error:t}}}Uu=qu,(0,se.A)(qu,"type","[Auth] Sign In with Google Failed"),(0,se.A)(qu,"isInstance",(0,A.t9)({type:(0,A.u)(Uu.type),payload:(0,A.t9)({redirectUrl:(0,A.H7)((0,A.gH)(Gu())),error:(0,A.H7)((0,A.gH)(Gu()))})}));class Qu extends Tr.L{constructor(e){super(),(0,se.A)(this,"payload",void 0),this.payload={redirectUrl:e}}}zu=Qu,(0,se.A)(Qu,"type","[Auth] Signed In with Google"),(0,se.A)(Qu,"isInstance",(0,A.t9)({type:(0,A.u)(zu.type),payload:(0,A.t9)({redirectUrl:A.Kg})}));class Ku extends Tr.L{}Wu=Ku,(0,se.A)(Ku,"type","[Auth] Sign In with Google"),(0,se.A)(Ku,"isInstance",(0,A.t9)({type:(0,A.u)(Wu.type)}));const Xu=async e=>{try{await(0,er.E)("user/credential",{method:"PATCH",body:{action:"deactivate",credentials:e}})}catch(e){throw(0,Go.H)(e,"UNEXPECTED_DEACTIVATE_CREDENTIAL_ERROR","Unexpected error deactivating a credential")}};var Yu=r(484204),Zu=r(888313);const Ju={handleSignedInWithGoogle(e,t){const r=new URL(e.payload.redirectUrl);if(r.origin!==window.location.origin)return l.Vy.error("Invalid redirect URL, unmatched origin",{browserUrl:window.location.origin,redirectUrl:r.origin}),void t.loginError(new ea.l((0,pn.mj)("home.account.signinWithGoogleFailed","We are unable to sign you in with Google. Please try again."),"GOOGLE_SIGNIN_FAILED"));window.location.href=e.payload.redirectUrl},handleSignInWithGoogleFailed(e,t){if(e.payload.error)return void t.loginError(new ea.l("We are unable to sign you in with Google. Please try again.",e.payload.error));if(!e.payload.redirectUrl)return l.Vy.error("Both error redirect URL and error message are not provided"),void t.loginError(new ea.l("We are unable to sign you in with Google. Please try again.","GOOGLE_SIGNIN_FAILED"));const r=new URL(e.payload.redirectUrl);if(r.origin!==window.location.origin)return l.Vy.error("Invalid redirect URL, unmatched origin",{browserUrl:window.location.origin,redirectUrl:r.origin}),void t.loginError(new ea.l("We are unable to sign you in with Google. Please try again.","GOOGLE_SIGNIN_FAILED"));window.location.href=e.payload.redirectUrl}};var $u=r(537250);const eh=(0,A.t9)({token:A.Kg});var th,rh;let ih=(0,ke.Gr)()(th=function(e){return(0,ke.WQ)(De.T)(e,void 0,0)}(th=function(e){return(0,ke.WQ)(lr.j)(e,void 0,1)}(th=function(e){return(0,ke.WQ)(m.yC)(e,void 0,2)}(th=function(e){return(0,ke.WQ)(ft.e)(e,void 0,3)}(th=Reflect.metadata("design:type",Function)(th=Reflect.metadata("design:paramtypes",[void 0===De.T?Object:De.T,void 0===lr.j?Object:lr.j,"undefined"==typeof MicrosoftAuthService?Object:MicrosoftAuthService,void 0===ft.e?Object:ft.e])((rh=class e extends gt.H{constructor(e,t,r,i){super(),(0,se.A)(this,"loggedInSubject",new Mr.B),(0,se.A)(this,"loggedOutSubject",new Mr.B),(0,se.A)(this,"loggedIn$",void 0),(0,se.A)(this,"loggedOut$",void 0),(0,se.A)(this,"getCookie",(e=>{const t=ho.parse(document.cookie)[e];if(t)return JSON.parse(t)})),this.appVariantCheckerService=e,this.nativeMessagingService=t,this.microsoftAuthService=r,this.nativeAppCapabilitiesService=i,this.loggedIn$=this.loggedInSubject.asObservable(),this.loggedOut$=this.loggedOutSubject.asObservable()}resetMagicLink(){(0,ot.tR)((e=>{e.magicLinkSent=void 0}))}loginCancelled(){(0,ot.tR)((e=>{e.loading=!1,e.provider=void 0}))}disableAutoWindowsAuthentication(){window.localStorage.setItem(zo.zC,JSON.stringify(!1)),(0,ot.tR)((e=>{e.loginMethod="default"}))}blockUnderageUser(){sessionStorage.setItem(zo.yy,"true"),(0,ot.tR)((e=>{e.underageUserBlocked=!0}))}async deactivateCredentials(e){try{await Xu(e)}catch(e){l.Vy.error(e)}}async prefetchProfilePicture(e){const t=at.j.getClaim("provider"),r=e=>{if(!e)return;const{user:t}=(0,ot.IM)();t&&(0,ot.tR)((t=>{t.user&&(t.user.picture=e)}))};if("MICROSOFT1P"!==t)return r(e),Promise.resolve();try{const e=await async function(e="MICROSOFT1P"){if("MICROSOFT1P"===e){const e=(0,N.K4)(),t=await e.get("/me/photo/$value",{extraData:{scopes:["User.Read"]}}),r=await t.blob();return window.URL.createObjectURL(r)}throw new Error("Prefetching profile pictures only supported for Microsoft accounts")}(t);r(e)}catch(e){if(e instanceof Vo.j$&&404===e.status)return;l.Vy.error(e)}}async registerWithCode(e,t,r,i,n){(0,ot.tR)((e=>{e.loading=!0,e.error=void 0}));try{const o=await async function(e,t,r,i,n){const o=(0,E.W)(De.T),s=(0,j.P)(o);try{return(await er.E.post($u.d.GetToken,{retryableHttpCodes:Wo.U,retryPolicy:{doRetry:Vo.PL,maxAttempts:3,backOffPolicy:"exponential",backOff:500},body:{code:e,provider:"EMAIL_PASSWORD",region:t,given_name:r,family_name:i,password:n,app_variant:o.current.type,launch_source:s}}).json(eh)).token}catch(e){throw(0,Go.H)(e,"UNEXPECTED_REDEEM_CODE_ERROR","Unexpected error redeeming code")}}(n,i,t,r,e);await this.loginSuccess(o)}catch(e){this.loginError(e,n)}}async updateUserPreference(e,t){await(0,lo.cS)(e,t)}async loadUser(t){try{const e=await async function(){try{const e=await er.E.get("/user",{retryableHttpCodes:[...Wo.U,0],retryPolicy:{doRetry:Vo.PL,maxAttempts:4,backOffPolicy:"exponential",backOff:500}}).json(Ko);return{email:e.email,apiKey:e.api_key,firstName:null!==e.given_name?e.given_name:void 0,lastName:null!==e.family_name?e.family_name:void 0,name:null!==e.name?e.name:void 0,nickname:null!==e.nickname?e.nickname:void 0,picture:null!==e.picture?e.picture:void 0,preferences:{...e.preferences},totalProjectsCreated:e.total_projects_created,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at),locale:e.locale??void 0,acceptedMsTerms:e.accepted_ms_terms??!1}}catch(e){if(e instanceof Vo.j$){if(401===e.status)throw new Qo(e);if(419===e.status)throw new qo(e);throw new Ho.S(e)}if(e instanceof Vo.RG&&!(0,C.Us)("wal__reshape_type_error"))throw e;throw(0,Go.H)(e,"UNEXPECTED_FETCH_USER_ERROR","Unexpected error fetching user data")}}(),{picture:t,...r}=e;(0,ot.tR)((e=>{e.user={...r}})),this.prefetchProfilePicture(t);const i=(0,ot.IM)().user||e;!function(e){localStorage.setItem(It,JSON.stringify(e))}({apiKey:i.apiKey,userType:i.preferences.userType,email:i.email}),(0,ot.tR)((e=>{e.loading=!1,e.provider=void 0,e.user={...i}}))}catch(r){const i=(0,C.Us)("wal__retry_user_on_type_error");if(r instanceof Vo.RG&&!i){const r=(t?.retryAttempt??0)+1;if(r<=e.MAX_RETRY_ATTEMPTS)return await(0,Vu.u)(e.RETRY_TIME_MS*r),this.loadUser({retryAttempt:r})}l.Vy.error(r),r instanceof qo||r instanceof Qo||(0,ot.IM)().user?this.updateSessionError(r):this.logout(r)}}async login(e,t,r){(0,ot.tR)((r=>{r.loading=!0,r.provider="email",r.magicLinkSent=void 0,r.email=e,r.password=t}));try{const i=await(0,Yu.M)(e,t,r);i.email?(0,ot.tR)((e=>{e.loading=!1,e.magicLinkSent=i.email})):i.token&&await this.loginSuccess(i.token)}catch(e){this.loginError(e)}}async loginWithCode(e,t,r,i){(0,ot.tR)((e=>{e.loading=!0,e.magicLinkSent=void 0,e.error=void 0}));try{const n=await async function(e,t,r){const i=(0,E.W)(De.T);let n=`${$u.d.GetToken}?code=${encodeURIComponent(e)}`;t&&(n+=`&referral_code=${encodeURIComponent(t)}`),r&&(n+=`&region=${encodeURIComponent(r)}`),n+=`&state=${encodeURIComponent(JSON.stringify({app_variant:i.current.type,launch_source:(0,j.P)(i)}))}`;try{return(await er.E.get(n,{retryableHttpCodes:Wo.U,retryPolicy:{doRetry:Vo.PL,maxAttempts:3,backOffPolicy:"exponential",backOff:500}}).json(eh)).token}catch(e){throw(0,Go.H)(e,"UNEXPECTED_REDEEM_CODE_ERROR","Unexpected error redeeming code")}}(e,t,r);await this.loginSuccess(n,i)}catch(t){this.loginError(t,e)}}async loginWithMagicLink(e,t,r,i,n,o){(0,ot.tR)((e=>{e.loading=!0,e.provider="email",e.magicLinkSent=void 0,e.error=void 0}));try{const s=await(0,Zu.r)(e,t,r,i,n,o);(0,ot.tR)((e=>{e.loading=!1,e.magicLinkSent=s.email,e.provider=void 0})),s.token&&(window.location.href=`/login?code=${s.token}`)}catch(e){if((0,ot.tR)((t=>{t.loading=!1,t.provider=void 0,t.error=e})),!(e instanceof Ho.S))throw e}}async loginWithMicrosoft(e,t){p.z.logEvent("Usage - Log in attempt with provider",{loginType:"microsoft1p"}),(0,ot.tR)((e=>{e.loading=!0,e.provider="microsoft1p",e.magicLinkSent=void 0,e.error=void 0})),await this.loginWithMicrosoft1p(!1,e,t)}loginWithProvider(e){p.z.logEvent("Usage - Log in attempt with provider",{loginType:e}),(0,ot.tR)((t=>{t.loading=!0,t.provider=e,t.magicLinkSent=void 0,t.error=void 0})),"google"===e?this.loginWithGoogle():this.navigateToOAuthPage(e)}async loginWithMsalRedirect(){if(!(this.microsoftAuthService instanceof ra))throw new u.eP("MSAL: Expected MSAL auth service upon MSAL redirect");(0,ot.tR)((e=>{e.loading=!0,e.provider="microsoft1p",e.magicLinkSent=void 0,e.error=void 0}));try{const{session:e}=await this.microsoftAuthService.completeLoginRedirect();if(e)return void await this.loginWithMicrosoftToken(e.accessToken,e.idToken);l.Vy.error("MSAL: Failed to complete redirect"),this.loginError(new ea.l("Failed to complete MSAL redirect","MSAL_INVALID_REDIRECT"))}catch(e){return this.microsoftAuthService.clearSession(),l.Vy.error(e),this.loginError(e)}}async loginWithMicrosoftToken(e,t,r,i){(0,ot.tR)((e=>{e.loading=!0,e.provider="microsoft1p",e.magicLinkSent=void 0,e.error=void 0}));try{const r=await async function(e,t){try{return(await er.E.post("/auth/microsoft1p/token",{body:{access_token:e,id_token:t},retryableHttpCodes:[...Wo.U,ul.v.CONFLICT],retryPolicy:{doRetry:Vo.PL,maxAttempts:e?3:0,backOffPolicy:"fixed",backOff:1500}}).json(ju)).code}catch(e){throw(0,Go.H)(e,"UNEXPECTED_TOKEN_EXCHANGE_ERROR","Unexpected error during msa token exchange")}}(e,t);await this.loginWithCode(r,"microsoft1p",void 0,i)}catch(e){e instanceof ea.l&&"AGE_RESTRICTION_NOT_MET"===e.code||(p.z.logEvent("Error - Log in/Sign up",{provider:"microsoft1p",error:"Fail to get user info",platform:r}),l.Vy.error(e)),this.microsoftAuthService.clearSession(),this.loginError(e)}}async loginSuccess(e,t,r=!1){if((0,ot.tR)((t=>{t.token=e})),this.loggedInSubject.next(),at.j.setToken(e),t&&await Xu(t),await this.loadUser(),(0,C.G7)("multi__consumer_1ds")){const e=at.j.getClaim("user.microsoft1p.tid",A.Kg),t=at.j.getClaim("user.microsoft1p.puid",A.Kg),r=at.j.getClaim("user.microsoft1p.oid",A.Kg);e&&r&&(p.z.setMicrosoftUserId(r),p.z.setUserProperties({tenantId:e,puid:t}))}if(!r){const e=at.j.getClaim("user.is_new_user",A.Lm),t=at.j.getClaim("user.launch_source",A.Kg);void 0!==e&&p.z.logAppLogicEvent("LogInSucceeded",{isNewUser:e,launchSource:t})}}logout(e){"auto-windows-authentication"===(0,ot.IM)().loginMethod&&this.disableAutoWindowsAuthentication(),(0,ot.tR)((e=>{e.loading=!1,e.provider=void 0,e.token=void 0,e.user=void 0})),this.loggedOutSubject.next(),at.j.removeToken(),p.z.logout(),(0,Qe.D8)(),Rt(),window.sessionStorage.clear(),this.microsoftAuthService.clearSession();const t=e;if(!0===this.nativeAppCapabilitiesService.capabilities?.gwy__windows_app_sign_in)return;(0,d.tu)().navigate({pathname:"/login",search:t?`?error_code=${t.code}&message=${t.message}`:void 0},{replace:!0}).then((()=>{setTimeout((()=>{window.location.reload()}),0)}));const r=(0,$n.SX)();r.cancelQueries().then((()=>{r.removeQueries()})).catch((e=>{throw l.Vy.log("Could not cancel query operations successfully"),e}))}triggerSignInWithMicrosoft(e,t){return this.loginWithMicrosoft1p(e,{accountId:t})}async loginWithMicrosoft1p(e,t,r){if((0,ot.IM)().loggingInWithMicrosoft)return Promise.resolve();(0,ot.tR)((e=>{e.loggingInWithMicrosoft=!0}));try{if(this.microsoftAuthService instanceof Ou)return await this.nativeLogInWithMicrosoft(this.microsoftAuthService,e,t,r);if(this.microsoftAuthService instanceof ra)return await this.msalLoginWithMicrosoft(this.microsoftAuthService,t,r)}finally{(0,ot.tR)((e=>{e.loggingInWithMicrosoft=!1}))}throw new Error("Expected valid type of auth provider.")}nativeLogInWithMicrosoft(e,t,r,i){return t&&p.z.logEvent("Usage - Windows auto sign-in initiated"),e.login({scopes:[],accountId:r?.accountId,defaultToWindowsAccount:t,tokenType:"graph"}).then((({session:e})=>{t&&p.z.logEvent("Usage - Windows auto sign-in successful"),(0,O.iY)(e,"Expected MSA authentication result"),this.loginWithMicrosoftToken(e.accessToken,e.idToken,"native app",i)})).catch((e=>{e instanceof Lu?(l.Vy.error(e),t&&p.z.logEvent("Usage - Windows auto sign-in failed"),this.loginError(e)):e instanceof Pu&&(t&&p.z.logEvent("Usage - Windows auto sign-in canceled",{reason:e.reason}),this.loginCancelled())}))}msalLoginWithMicrosoft(e,t,r){const i=ta.includes(window.location.pathname)?window.location.pathname:"/login";return e.login({tokenType:"graph",forceSelectAccount:!0,forceRefresh:!0,redirectUri:i,loginHint:t?.loginHint,skipActiveUser:t?.skipActiveUser??!0,msftLoginRoute:t?.msftLoginRoute}).then((({isRedirecting:e,redirectUri:t,session:i})=>{if(!e)return i?void this.loginWithMicrosoftToken(i.accessToken,i.idToken,"web",r):(l.Vy.error("MSAL: Failed to retrieve existing session"),void this.loginCancelled());t&&(0,Lr.V2)(t)})).catch((e=>{l.Vy.error(e),this.microsoftAuthService.clearSession(),this.loginError(new ea.l(e.message,`MSAL_${e.errorCode.toUpperCase()}`))}))}loginError(e,t){(0,ot.tR)((r=>{r.loading=!1,r.provider=void 0,r.error=e,r.code=t})),this.signOutFromWindowsNative()}clearLoginError(){(0,ot.tR)((e=>{e.error=void 0}))}updateSessionError(e){at.j.removeToken(),(0,ot.tR)((t=>{t.sessionError=e}))}initialize(){this.initializeLoginMethod(),this.loadExistingSession()}signOutFromWindowsNative(){!0===this.nativeAppCapabilitiesService.capabilities?.gwy__windows_app_sign_in&&this.nativeMessagingService.send(new _u)}initializeLoginMethod(){const e=window.localStorage.getItem(zo.zC);let t="default";!this.appVariantCheckerService.satisfies("windows-native")||e&&!1===JSON.parse(e)||(t="auto-windows-authentication"),(0,ot.tR)((e=>{e.loginMethod=t}))}loadExistingSession(){const e=e=>{(0,ot.IM)().token!==e&&((0,A.O9)(e)&&!(0,Au.Hm)(e)?((0,ot.tR)((e=>{e.loading=!0})),this.loginSuccess(e,void 0,!0)):(this.logout(),this.updateSessionError(new zo.hY)))};e(at.j.getToken()),at.j.registerForChanges(e)}loginWithGoogle(){if(this.appVariantCheckerService.satisfies("windows-native")){const e=[this.nativeMessagingService.listen(Qu,(t=>{e.forEach((e=>e())),Ju.handleSignedInWithGoogle(t,this)})),this.nativeMessagingService.listen(qu,(t=>{e.forEach((e=>e())),Ju.handleSignInWithGoogleFailed(t,this)}))];this.nativeMessagingService.send(new Ku)}else this.navigateToOAuthPage("google")}navigateToOAuthPage(e,t){window.location.href=this.createAuthUrlWithParameters(e,t)}createStateStr(e,t){const r={redirect_url:(window.location.pathname?.includes("/templates")?k.T.createUrl+"/login":window.location.href)+`${window.location.search?"&":"?"}type=${e}`,error_redirect_url:window.location.href,...t};return encodeURIComponent(JSON.stringify(r))}createAuthUrlWithParameters(e,t){const r=[`state=${this.createStateStr(e,t)}`];return`${k.T.apiBaseUrl}/auth/${e}/login?${r.join("&")}`}},(0,se.A)(rh,"MAX_RETRY_ATTEMPTS",3),(0,se.A)(rh,"RETRY_TIME_MS",1e3),th=rh))||th)||th)||th)||th)||th)||th)||th;var nh,oh=r(744448);let sh=(0,ke.Gr)()(nh=function(e){return(0,ke.WQ)(el.X)(e,void 0,0)}(nh=function(e){return(0,ke.WQ)(cd.a8)(e,void 0,1)}(nh=Reflect.metadata("design:type",Function)(nh=Reflect.metadata("design:paramtypes",[void 0===el.P?Object:el.P,void 0===cd.a8?Object:cd.a8])(nh=class extends Yc.A${constructor(e,t){super(e,t),(0,se.A)(this,"onProjectSynced",((e,t)=>{(0,je.wk)()&&(0,C.Us)("ks_editor__disable_history_update_on_sync")&&(0,je.I8)("overwrite"),this.onSyncFinished.next(t.projectState.version)})),this.projectBackend=e,this.projectSchemaService=t}})||nh)||nh)||nh)||nh)||nh;const ah=(e,t)=>{ke.kL.register(e,{useClass:t},{lifecycle:ke.v0.Singleton})},ch=(e,t)=>{ke.kL.register(e,{useFactory:t})},lh=(e,t)=>{ke.kL.register(e,{useValue:t})};(0,h.IP)(),async function(){performance.mark(F.Tw);const e=(0,P.Xq)("StartupQos","appBootstrapped");k.T.production&&window&&(window.console.log=()=>{}),(0,Q.g)(k.T.sentryEnvironment)&&l.Vy.configure(new X),await async function(){const e=new bt(function(){const e={hosts:[k.T.ecsEndpoint],clientName:k.T.ecsClientName,clientVersion:k.T.ecsClientVersion,agents:"ClipchampCsmr",cloud:"Public",getRolloutEnvironment:Nt,getSubscriptionStatePlan:Mt,extractFeatureIds:e=>e.ConfigIDs.ClipchampCsmr.split(","),extractFeatures:e=>e.ClipchampCsmr??{}};return new Ft(e)}());(0,C.H9)(new St([e,new Tt.g,new Ct])),(0,C.Us)("ks_pst__log_flight_service_no_features")||e.onFeaturesChanged((e=>{0===Object.keys(e).length&&p.z.logEvent("Error - ECS No Features")}));const t=(0,C.yk)();await t.initialize()}(),(0,x.sd)(),(0,v.kg)((e=>{const t=e.state?.plan;if(!(0,A.O9)(t))return void(0,g.EX)();const r=function(e,t){const r={noWatermark:"none",cloudBackup:"none",maxResolution:"1080p",audioStock:"standard",videoStock:"standard",imageStock:"standard",filtersAndEffects:"standard",brandKit:"none",unlimitedImportSize:b[t].unlimitedImportSize,copilot:"none",graphics:"standard"};e.no_watermark&&(r.noWatermark="available"),e.cloud_backup&&(r.cloudBackup="available");const i=[...e.export_resolutions].sort(y.tz);return r.maxResolution=i.at(-1),"unlimited"===e.audio_stock&&(r.audioStock="premium"),"premium"===e.msAudioStock&&(r.audioStock="premium"),"ms365"===e.msAudioStock&&(r.audioStock="ms365"),"unlimited"===e.video_stock&&(r.videoStock="premium"),"premium"===e.msVideoStock&&(r.videoStock="premium"),"ms365"===e.msVideoStock&&(r.videoStock="ms365"),"unlimited"===e.image_stock&&(r.imageStock="premium"),"premium"===e.msImageStock&&(r.imageStock="premium"),"ms365"===e.msImageStock&&(r.imageStock="ms365"),"unlimited"===e.content_transition&&(r.filtersAndEffects="premium"),"unlimited"===e.content_filter&&(r.filtersAndEffects="premium"),e.brand_center&&(r.brandKit="available"),"single"===e.msBrandKit&&(r.brandKit="available"),"multiple"===e.msBrandKit&&(r.brandKit="available"),"premium"===e.graphics&&(r.graphics="premium"),r}(t.features,(0,w.Q_)(t.id));(0,g.$2)(r),e.state?.isCopilotEnabled&&(0,g.Mx)({copilot:"available"});const i=(0,w.mZ)(t.id);p.z.setContext("licenseType",i),p.z.setUserProperties({plan:t.id})})),function(){(0,st.e)({apiBaseUrl:k.T.apiBaseUrl,appleSignInServiceId:k.T.appleSignInServiceId,googleClientId:k.T.googleClientId,facebookId:k.T.facebookId,dropboxOauthId:k.T.dropboxOauthId});const e=(0,E.W)(ft.e);e.init(),!0!==e.capabilities?.gwy__windows_app_sign_in&&at.j.loadFromStorage();const t={useSso:!1,usePopupLogin:!1,tokenType:"graph",scopes:["email"]};ke.kL.register(m.Ti,{useValue:t}),(e=>{const t={auth:{clientId:"",authority:"",knownAuthorities:[],redirectUri:lt,postLogoutRedirectUri:`${lt}/login`,navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1,secureCookies:!dt},system:{loadFrameTimeout:1e4,navigateFrameWait:0,iframeHashTimeout:1e4,loggerOptions:{loggerCallback:ut,logLevel:dt?ct.$.Verbose:ct.$.Info,piiLoggingEnabled:dt}}};pt={auth:{...t.auth,...e?.auth,clientId:e.env.aadAppId,authority:e.env.aadAuthority},cache:{...t.cache,...e?.cache},system:{...t.system,...e?.system},telemetry:{...t.telemetry,...e?.telemetry},defaults:e?.defaults}})({auth:{redirectUri:`${window.location.origin}/login`},system:{loggerOptions:{loggerCallback:mt}},env:{aadAppId:k.T.microsoft1pAppId,aadAuthority:k.T.microsoft1pAuthority,appResourceUri:k.T.microsoft1pAppResourceUrl,graphApiUrl:k.T.microsoft1pGraphHost},defaults:t})}(),(0,R.q)(Yi),(0,Z.wR)(),(0,$n.jy)(),lh(na.l,{appUrl:k.T.createUrl,appName:"create",production:k.T.production,apiBaseUrl:k.T.apiBaseUrl,environmentName:k.T.production?"prod":"test",speakerCoachEndPoint:k.T.speakerCoachEndPoint,dfcEnvironment:k.T.dfcEnvironment}),lh(ha.X,{contentRepoUrl:k.T.contentRepoUrl,contentRepoBucketUrl:k.T.contentRepoBucketUrl,contentRepoKey:k.T.contentRepoKey}),ch(oa.L,(()=>_d.S)),ch(wa,md),ch(js.F,ua),lh(ia.wO,(0,ia.ue)(Hc)),lh(ia.OZ,(0,ia.UG)(k.T.createUrl,Hc)),lh(sa.l,Jr.bB),ch(Us.K,qc),ke.kL.register(m.yC,{useFactory:(0,ke._j)((e=>e.resolve(De.T).satisfies("windows-native")),Ou,ra)}),ch(aa.E,jc),ah(Gs.e,zs.qI),ah(Os.u,dl),ah(Ws.T6,Sl),ah(Vs.B,Gd),ah(el.X,oh.G),ah(Ta.g,Ta.J),ah(tl.jR,Cd),ah(sc.L,Oc),ah(Wa.b,rc),ah(Zc.ug,pa.E),ah(Yc.II,sh),ah(Kc.qC,Ul),ah(zc.rj,Wc),ke.kL.register(L.C,{useClass:Xd},{lifecycle:ke.v0.Singleton}),ah(gt.l,ih),ke.kL.register(nc.lU,{useClass:oc},{lifecycle:ke.v0.Singleton}),ke.kL.register(nc.ec,{useValue:{discover1:{steps:1},discover2:{steps:1},tts:{steps:1},pauseRemoval:{steps:1,expiryDate:new Date("2024-06-24T12:00+10:00")}}}),ch(qs.o,_d.u),ke.kL.register(Jc.B_,{useValue:{augloopEnvironment:k.T.augloopEnvironment,getAuthToken:la}}),ke.kL.register($c.Zy,{useValue:["AzureFastTranscription","AzureCognitiveServices","AugloopCameraTranscript","Augloop"]}),ah(lo.F4,ot.nE),lh(Xc.Dw,{apiBaseUrl:k.T.apiBaseUrl}),ke.kL.register($c.hZ,{useValue:{showCaptionSurvey:!0}}),ke.kL.register(zl,Kl),ke.kL.register(zl,Zl),ke.kL.register(rd.H,hd),ke.kL.register(rd.H,od),ah(Hs.g,fu),ke.kL.register(Pe,{useValue:{brazeApiKey:k.T.brazeApiKey,brazeSdkEndpoint:k.T.brazeSdkEndpoint}}),ke.kL.register(Me.D,Le),function(){const e=[Ed.Z5,(0,Id.g)(new Rd.V(ke.kL.resolve(Jc.Vg)))];(0,kd.a)(e)}(),(0,C.G7)("editor__fullstory_enabled")&&(0,U.Ts)({orgId:k.T.fullstoryOrgId,devMode:!k.T.production}),(0,C.G7)("pst__handle_undefined_mode_throw")?(0,O.wT)("throw",l.Vy.error.bind(l.Vy)):(0,C.G7)("pst__handle_undefined_mode_log")&&(0,O.wT)("log",l.Vy.error.bind(l.Vy));const t=(0,E.W)(m.yC);await t.initialize(),function(){const e=(0,E.z)(Me.D).find((e=>e instanceof Le));if(!e)throw new Error("Failed to find Braze service.");const t=[e,...rt()];p.z.loadProviders(...t),p.z.bootOnlyEssentialProviders()}();const r=(0,E.W)(De.T).satisfies("windows-native");if(r&&function(){const e=(0,E.W)(lr.j),t=(0,E.W)(dr);(0,E.W)(Fr).init();const r=[ti,si,ui];e.init(r,Hi),t.declare({})}(),(0,E.W)(L.C).init(),function(){let e;document.referrer.startsWith("https://clipchamp.com/")&&(e=document.referrer.replaceAll(/\?.*$/g,""),p.z.logEvent("Usage - Referred by marketing site",{url:e})),p.z.doWithProvider(Ke,(t=>{e?.startsWith("https://clipchamp.com/watch/")?t.setOnce("watch_page_referrer",e):(t.setOnce("marketing_site_referrer",e),t.setOnce("watch_page_referrer",!1))}))}(),self.addEventListener("securitypolicyviolation",(e=>{console.warn("CSP violation was detected",e),p.z.logEvent("Usage - CSP violation",function(e){const t={};for(const[r,i]of Object.entries(e))"string"!=typeof i&&"number"!=typeof i||(t[r]=i);return t}(e))})),"function"==typeof ReportingObserver?new ReportingObserver((e=>{for(const t of e)console.warn("COOP/COEP violation was detected","function"==typeof t.toJSON?t.toJSON():t),p.z.logEvent("Usage - COOP/COEP violation",Gi(t))}),{buffered:!0,types:["coep","coop"]}).observe():console.warn("Browser does not support Reporting API, COOP/COEP violations will not be monitored!"),await async function(){const e=(0,it.Sq)().then((e=>{p.z.setUserProperties({country_code:e.countryCode})})).catch((()=>{console.warn("Failed to log location")})),t=void 0===performance.memory?.jsHeapSizeLimit?void 0:Math.round(performance.memory?.jsHeapSizeLimit/2**20),r=void 0===navigator.deviceMemory?void 0:1024*navigator.deviceMemory,i=Dt()(),n={hw_virtual_cores:navigator.hardwareConcurrency,hw_device_memory:r,hw_jsheap_limit:t,hw_platform:navigator.platform,hw_screen_height:window.screen.height,hw_screen_width:window.screen.width,hw_64bit_client:"x64"===i||"arm64"===i,hw_is_touch_screen:"ontouchstart"in window||navigator.maxTouchPoints>0,wasm_supported:(0,Ot.support)(),wasm_streaming:Ot.supportStreaming,...Object.keys(Ot.feature).reduce(((e,t)=>(e[`wasm_feature_${t}`]=Ot.feature[t],e)),{})},o=Promise.all([navigator.storage?.estimate(),navigator.storage?.persisted()]).then((([e,t])=>{p.z.setUserProperties({...n,hw_storage_quota:e?.quota,hw_storage_type:t?"persistent":"temporary"})})).catch((e=>{console.warn("Cannot probe storage quota for telemetry",e),p.z.setUserProperties({...n,hw_storage_quota:void 0,hw_storage_type:void 0})}));await Promise.all([o,e])}(),await async function(){const e=await(0,it.Sq)();(0,it.yC)(e.countryCode)||p.z.enableNonEssential()}(),!(0,N.gW)(k.T.microsoft1pGraphHost))throw new Error("Unrecognised GraphAPI environment, ensure environment is valid");var i;(0,N.iu)((async e=>{return await(t=e,t?.token)||await async function(e){const t=(0,E.W)(m.yC);return await t.getToken({scopes:e?.scopes,tokenType:"graph"})||(l.Vy.error("Could not re-authenticate user and get valid token"),"")}(e);var t}),k.T.microsoft1pGraphHost),i=B.Js,(0,M.ch)((e=>{for(const t of i)e.byId[t.id]||e.allIds.includes(t.id)||e.bundledIds.includes(t.id)||(e.byId[t.id]=t,e.allIds.push(t.id),e.bundledIds.push(t.id))})),(0,d.Ed)(Bs),await async function(){(0,E.W)(gt.l).initialize(),await(0,ot.CJ)((e=>e.loading)).pipe((0,re.p)((e=>!e)),(0,ne.s)(1)).toPromise()}(),await ar(),function(){const e=(0,C.AY)(),t=Object.keys(e).filter((t=>e[t]));p.z.setUserProperties({features:t});const r=(0,E.W)(Be.zp),i=(0,E.W)(De.T);let n=!1;!r.isTWA&&["fullscreen","standalone","minimal-ui"].some((e=>window.matchMedia("(display-mode: "+e+")").matches))&&(n=!0),p.z.setUserProperties({commit_id:"9f3dcec",viewport_width:window.innerWidth,viewport_height:window.innerHeight,is_pwa:n,isWindowsTWA:i.satisfies("windows-twa"),isChromeOSTWA:i.satisfies("chrome-os-twa"),isWindowsNative:i.satisfies("windows-native"),appLanguage:(0,Ue.Xo)(),nativeAppVersion:i.current.version?.raw??null,windowsVersion:(0,Oe.v)(i.current),isWindowsSecureMode:window.clipchampWindowsNativeApp?.os?.secureMode??null,systemProcessorCount:window.clipchampWindowsNativeApp?.os?.processorCount??null,totalSystemRAMInGB:window.clipchampWindowsNativeApp?.os?.physicallyInstalledRAMInGB??null})}(),Y(),(0,I.rw)(k.T.apiBaseUrl),J.vl[90],J.DV[80],function(){const e=(0,E.W)(De.T).satisfies("windows-twa");self.addEventListener("appinstalled",(()=>{p.z.logEvent("Usage - PWA installed")})),document.addEventListener("contextmenu",(t=>{e&&t.preventDefault()}),{passive:!1,capture:!0})}(),function(){let e;const t=()=>{document.body.classList.remove("navigating-via-keyboard"),window.addEventListener("keydown",e),window.removeEventListener("mousedown",t)};e=r=>{"Tab"===r.code&&(document.body.classList.add("navigating-via-keyboard"),window.removeEventListener("keydown",e),window.addEventListener("mousedown",t))},window.addEventListener("keydown",e)}(),(0,z.LO)(),function(){const e=(0,d.tu)(),t=new $.c((t=>{e.subscribe((({location:e})=>{t.next(e.pathname)}))})),r=(0,ot.Qp)((e=>e));(0,ee.z)([t.pipe((0,te.B)(150),(0,re.p)((e=>!e.includes("login")))),r.pipe((0,re.p)(A.O9))]).pipe((0,ie.T)((([,e])=>e)),(0,ne.s)(1)).subscribe((e=>{p.z.setUserId(e.apiKey),p.z.setUserProperties(function(e){const t=(0,v.uV)();return t?function(e,t){return{...nt(e),plan:t.plan.id}}(e,t):nt(e)}(e))})),t.pipe((0,oe.i)(1)).subscribe((e=>p.z.page(e))),p.z.page("")}(),await async function(){if(!("serviceWorker"in navigator))return;if((0,C.Us)("ks_multi__consumer_sw_telemetry"))return void await navigator.serviceWorker.register("/service-worker.js");performance.mark(F.nq);const e=await navigator.serviceWorker.register("/service-worker.js");performance.mark(F.rC),e.addEventListener("updatefound",(()=>{const t=e.installing;if(!t)return;performance.mark(F.ZA);const r=qi(e);t.addEventListener("statechange",(()=>{if("installed"===t.state){performance.mark(F.Tj);const e=performance.measure(F.qF,F.ZA,F.Tj);p.z.logAppLogicEvent("ServiceWorkerInstalled",{durationMs:e.duration,loadType:r})}if("activating"===t.state&&performance.mark(F.Vz),"activated"===t.state){performance.mark(F.pd);const e=performance.measure(F.Iv,F.Vz,F.pd);p.z.logAppLogicEvent("ServiceWorkerActivated",{durationMs:e.duration,loadType:r})}}))}));const t=performance.measure(F.gl,F.nq,F.rC);p.z.logAppLogicEvent("ServiceWorkerRegistered",{durationMs:t.duration,loadType:qi(e)})}(),(0,R.S)({status:"hide"}),(0,S.Q$)((async e=>{const t=(0,T.q)("feature-flags",e);await t.handshaken,(0,C.N0)((e=>{t.sendMessageSync("update",e)}),!0)})),(0,g.yZ)((e=>{(0,C.G7)("magic__log_entitlements")&&p.z.setUserProperties({...e})})),await(0,f.c)(_).catch((()=>{(0,d.tu)().navigate("/hardware?ec=wa002")})),r&&function(){const e=(0,E.W)(Fr),t=(0,E.W)(zi);e.onInitialized(),t.triggerCheckingForUpdate()}(),(0,j.V)(),(0,je.R8)((e=>{e?.id&&p.z.setContext("projectId",e.id)})),performance.mark(F.jY);const n=performance.measure(F.ch,F.Tw,F.jY);(0,C.G7)("multi__consumer_1ds")&&p.z.logAppLogicEvent("AppBootstrapped",{duration:n.duration}),(0,C.Us)("ks_multi__performance_event_refactor")||e()}().then((()=>{a.createRoot(document.getElementById("root")).render((0,ln.jsx)(c.pg,{router:(0,d.tu)()}))})).catch((e=>{console.error("App failed to bootstrap:",e),l.Vy.error(new u.g9("App failed to bootstrap",{originalError:e}))}))},172530:(e,t,r)=>{r.d(t,{b:()=>T});var i=r(324586);const n=/\bhttps?:\/\/\S+\w/gi,o="SCRUBBED",s="mis";let a=function(e){return e[e.Always=0]="Always",e[e.IfAnyFramesOffend=1]="IfAnyFramesOffend",e[e.OnlyOffendingFrames=2]="OnlyOffendingFrames",e[e.OnlyOffendingFrameContent=3]="OnlyOffendingFrameContent",e[e.Never=4]="Never",e}({}),c=function(e){return e[e.Never=0]="Never",e[e.WhenNotMarkedAsSafe=1]="WhenNotMarkedAsSafe",e[e.Always=2]="Always",e}({});r(584570),r(82265),r(988124);var l=r(615101);let d=[];const u=e=>{const t=e.match(n);return!!t&&!t.every((e=>{try{return(e=>{const{hostname:t,pathname:r}=new URL(e);for(const e of d)if(t.endsWith(e.hostSuffix)&&(!e.pathRegExp||e.pathRegExp.test(r)))return!0;return!1})(e)}catch(e){return!1}}))},h=(e,t)=>(e&t)===t,p=(e,t,r,i=a.Never)=>{if(e===s||void 0===e)return s;if(t!==r){if(e===t)return s;t&&(e=e.replace(t,r))}if(i===a.OnlyOffendingFrameContent){const t="\n";return e.split(t).map((e=>e.replace(n,(e=>{const t=new URL(e),r=[...t.searchParams.keys()].reduce(((e,t)=>e+`${t}=${o}`),"");let i=t.pathname.split("/").pop()||t.pathname;return r&&(i+=`?${r}`),i})))).join(t)}if(i===a.OnlyOffendingFrames){const t="\n";return e.split(t).map((e=>u(e)?"FRAME_SCRUBBED":e)).join(t)}return i!==a.IfAnyFramesOffend||u(e)?i===a.Never?e:o:e},m=(e,t,r=c.Always,i=a.Never)=>{const n=((e,t=c.Always)=>"mis"===e||void 0===e||""===e?"mis":h(t,c.Always)?o:t===c.Never||h(t,c.WhenNotMarkedAsSafe)&&(0,l.N7)(e)?(0,l.aK)(e):o)(t,r);return{message:n,stack:p(e,t,n,i)}};var f=r(138615),g=r(847269);const A=e=>({flightsUsed:e.getUsedFlights().join(","),flightsUnused:"",flightsOverridden:e.getFlightOverrideOccurred().length>0});r(379321);var v=r(403045),y=r(479083),b=r(80540),w=r(375669);const x="a:unauthenticatedUser";class S{constructor(e){(0,i.A)(this,"cvPlugin",void 0),(0,i.A)(this,"logger",new v.A),(0,i.A)(this,"erroringEventNamesLogged",[]),(0,i.A)(this,"eventNamespace",void 0),this.loggerConfig=e,this.cvPlugin=new w.A,e.localUserId||(e.localUserId=x);const t={channelConfiguration:{disableTelemetry:!e.ingestionKey},disableCookiesUsage:!0,extensions:[this.cvPlugin],extensionConfig:[],instrumentationKey:e.ingestionKey};if(e.overrideEndpointUrl&&(t.endpointUrl=e.overrideEndpointUrl),this.logger.initialize(t,[]),this.eventNamespace=(0,y.Hm)((0,b.Z)(S.identifier),this.logger.evtNamespace()),e.unloadListeners)for(const[t,r]of Object.entries(e.unloadListeners))(0,y.ee)(r,[],this.eventNamespace)||this.logger.track({name:"UnloadListenerHookingError",data:{message:"Failed to hook unload listener",key:t}});const r=this.logger.getPropertyManager();r.getPropertiesContext().user.localId=e.localUserId,r.getPropertiesContext().app.name=e.appName,r.getPropertiesContext().app.ver=e.version,r.getPropertiesContext().session.id=e.sessionId,r.setProperty("userAgent",window.navigator.userAgent?window.navigator.userAgent.split(/=>(.+)/)[0]:"")}flush(e=!0,t){this.logger.flush(e,t)}trackEvent(e){try{this.loggerConfig.includeTimingFields&&window.performance&&(e.data={...e.data,browserTimingMethod:"PerformanceNavigationTiming",msSinceAppStart:window.performance.measure("MsSinceNavigationStart").duration}),this.logger.track(e)}catch(t){const r=void 0!==e?e.name:"undefined";if(this.hasErroringEventBeenPreviouslyLogged(r)){const t=void 0===e;this.logger.track({name:"TrackingEventError",data:{eventName:r,isEventUndefined:t}}),this.markErroringEventAsLogged(r)}}}userSignedIn(e){const t=this.logger.getPropertyManager();let r="";e.length>2&&":"!==e[1]&&(r="a:"+e),t.getPropertiesContext().user.localId=r??e}userSignedOut(){const e=this.logger.getPropertyManager().getPropertiesContext();e&&(e.user.localId=x)}unload(){(0,y.Ds)(null,this.eventNamespace),this.logger.unload()}markErroringEventAsLogged(e){this.erroringEventNamesLogged.push(e)}hasErroringEventBeenPreviouslyLogged(e){return!this.erroringEventNamesLogged.includes(e)}}(0,i.A)(S,"identifier","OneDSLogger");class T{constructor(e,t,r){(0,i.A)(this,"_logger",void 0),(0,i.A)(this,"_context",void 0),(0,i.A)(this,"_initialData",void 0),(0,i.A)(this,"essential",!0),this._initialData={...t},this._context=((e,t)=>({component:"Clipchamp",schemaVer:"5.2.0",mediaType:"video",mediaService:e.mediaService??"Clipchamp.com",source:"Clipchamp.com",accountType:e.accountType??"Unknown",language:e.language??"",platform:e.platform??"Web",tenantId:e.tenantId??"",userId:e.userId??"",version:e.version??"",puid:e.puid,odspItemId:e.odspItemId,siteId:e.siteId??"",siteSubscriptionId:e.siteSubscriptionId??"",environment:e.environment??"",workload:e.workload??"",clipchampSessionId:e.sessionId??"",ring:t.ring,providers:t.getProviders().join(","),...A(t)}))(t,r),e.unloadListeners||(e.unloadListeners={}),e.unloadListeners.logAppExited=()=>{this.logAppLogicEvent("AppExited",{},{async:!1}),this.flush(!1,(()=>setTimeout((()=>{}),2e3))),this._logger?.unload()},this._logger=new S(e)}flush(e,t){this._logger.flush(e,t)}logEvent(e,t){}logAppLogicEvent(e,t,r){const i=r?.async??!0,n={name:e,data:{eventType:"ApplicationLogic",...this._context,...t},sync:!i};this.trackEvent(n)}logUserActionEvent(e,t,r){const i=r?.async??!0,n={name:e,data:{eventType:"UserAction",...this._context,...t},sync:!i};this.trackEvent(n)}logWarningEvent(e,t,r){if(!t.stack){const e=new Error;t.stack=e.stack??(0,l.vU)(s)}const i=r?.async??!0,n={name:e,data:{eventType:"ErrorAlert",ErrorAlertType:"Warning",...this._context,...t,...m(t.stack,t.message,c.WhenNotMarkedAsSafe,a.OnlyOffendingFrameContent)},sync:!i};this.trackEvent(n)}logErrorEvent(e,t,r){if(!t.stack){const e=new Error;t.stack=e.stack??(0,l.vU)(s)}const i=r?.async??!0,n={name:e,data:{eventType:"ErrorAlert",...this._context,...t,...m(t.stack,t.message,c.WhenNotMarkedAsSafe,a.OnlyOffendingFrameContent)},sync:!i};this.trackEvent(n),this.forwardErrorEvents(n)}logout(){this._logger.userSignedOut(),this._context.userId=x,this._context.accountType=this._initialData.accountType||"Unknown",this._context.tenantId=this._initialData.tenantId||"",this._context.puid=void 0}setUserId(){}setMicrosoftUserId(e){(0,g.sw)(e,"UserId must be provided for analytics context"),this._logger.userSignedIn(e),this._context.userId=e,"ConsumerAnonymous"===this._context.accountType?this._context.accountType="Consumer":"BusinessAnonymous"===this._context.accountType&&(this._context.accountType="Business")}setUserProperties(e){"tenantId"in e&&(this._context.tenantId=e.tenantId,this._context.tenantId.includes("9188040d-6c67-4c5b-b112-36a304b66dad")?this._context.accountType="Consumer":this._context.accountType="Business"),"puid"in e&&(this._context.puid=e.puid),"appLanguage"in e&&(this._context.language=e.appLanguage),window.clipchampWindowsNativeApp?this._context.platform="Win32":"is_pwa"in e&&!0===e.is_pwa||"isWindowsTWA"in e&&!0===e.isWindowsTWA?this._context.platform="Web":"isChromeOSTWA"in e&&!0===e.isChromeOSTWA&&(this._context.platform="ChromeOS")}updateFlightState(e){Object.assign(this._context,A(e))}trackEvent(e){if((0,f.G7)("wal__gdpr_compliant_unauthenticated_events"))(e.data?.isGDPRCompliant||this.isGDPRCompliant())&&this._logger.trackEvent(e);else{if(!this.isGDPRCompliant())return;this._logger.trackEvent(e)}}boot(){}incrementUserProperty(e){}isGDPRCompliant(){return!!this._context.tenantId}shouldSendPII(){return!1}page(e){}setOptOut(e){}setEmailStatus(e){}forwardErrorEvents(e){(0,f.Us)("ks_multi__telemetry_error_forwarding")||"HandledError"===e.name||"UnhandledError"===e.name||("Fatal"===e.data?.errorAlertType?this.trackEvent({name:"HandledError",data:{originalEventType:e.name,correlationId:e.data.correlationId,errorAlertType:e.data.errorAlertType,errorCode:e.data.errorCode,message:e.data.message,staticMessage:e.data.message,stack:e.data.stack},sync:e.sync}):"Unhandled"===e.data?.errorAlertType&&this.trackEvent({name:"UnhandledError",data:{originalEventType:e.name,correlationId:e.data.correlationId,errorAlertType:e.data.errorAlertType,errorCode:e.data.errorCode,message:e.data.message,staticMessage:e.data.message,stack:e.data.stack},sync:e.sync}))}getContext(){return this._context}}},562229:(e,t,r)=>{r.d(t,{z:()=>l});var i=r(324586),n=(r(379321),r(566573)),o=r(573340),s=r(7089),a=r(650882),c=r(615101);const l=new class{constructor(){(0,i.A)(this,"essential",void 0),(0,i.A)(this,"providers",[]),(0,i.A)(this,"extraProperties",void 0),(0,i.A)(this,"context",{}),(0,i.A)(this,"throttledEvents",{})}getProviders(){return this.providers}loadProviders(...e){this.providers.push(...e)}reset(){this.providers=[],this.extraProperties=void 0,this.context={}}bootOnlyEssentialProviders(){this.providers.forEach((e=>{e.essential&&e.boot()}))}boot(){this.providers.forEach((e=>{e.boot()}))}flush(e,t){this.providers.filter((e=>e.flush)).forEach((r=>r.flush?.(e,t)))}incrementUserProperty(e){this.providers.forEach((t=>t.incrementUserProperty(e)))}isGDPRCompliant(){return this.providers.every((e=>e.isGDPRCompliant()))}shouldSendPII(){return this.providers.every((e=>e.shouldSendPII()))}logEvent(e,t={}){const r="object"==typeof t?{...this.context,...t}:t;this.logForEachProvider(r,((t,r)=>t.logEvent(e,r)))}logAppLogicEvent(e,t,r){this.assertValidCorrelationId(t),this.shouldLog(e,t,r)&&this.logForEachProvider({...this.context,...t},((t,r)=>t.logAppLogicEvent?.(e,r)))}logUserActionEvent(e,t,r){this.assertValidCorrelationId(t),this.shouldLog(e,t,r)&&(!1===Object.prototype.hasOwnProperty.call(t,"isIntentional")&&(t={...t,isIntentional:!0}),this.logForEachProvider({...this.context,...t},((t,r)=>t.logUserActionEvent?.(e,r))))}logWarningEvent(e,t,r){this.assertValidCorrelationId(t),this.shouldLog(e,t,r)&&this.logForEachProvider({...this.context,...t},((t,r)=>t.logWarningEvent?.(e,r)))}logErrorEvent(e,t,r){this.assertValidCorrelationId(t),this.shouldLog(e,t,r)&&this.logForEachProvider({...this.context,...t},((t,r)=>t.logErrorEvent?.(e,r)))}logDeidentifiedEvent(e,t){this.logDeidentifiedEventsForEachProvider({...t},((t,r)=>t.logDeidentifiedEvent?.(e,r)))}getFullEventName(e,t){return"object"==typeof(r=t)&&null!==r&&"name"in r?`${e.toString()}.${t.name}`:e.toString();var r}shouldLog(e,t,r){if(void 0===r)return!0;if(r.enabled&&!r.enabled())return!1;const i=this.getFullEventName(e,t);return this.shouldSample(r)&&!this.isThrottled(i,r)&&!this.isLoggedOnce(i,r)}shouldSample(e){return"object"!=typeof(t=e)||null===t||!("sampleRate"in t)||e.sampleRate>=1||!(e.sampleRate<=0)&&Math.random()<e.sampleRate;var t}isThrottled(e,t){if("object"==typeof(r=t)&&null!==r&&"throttleRate"in r){const r=e in this.throttledEvents?this.throttledEvents[e]:void 0,i=Date.now(),n=!r||"number"==typeof r&&i>=r;return n&&(this.throttledEvents[e]=i+t.throttleRate),!n}var r;return!1}isLoggedOnce(e,t){if("object"==typeof(r=t)&&null!==r&&"onceOnly"in r){const r=e in this.throttledEvents?this.throttledEvents[e]:void 0,i=Date.now(),n=!r||"number"==typeof r&&i>=r;return n&&(this.throttledEvents[e]=t.onceOnly),!n}var r;return!1}logDeidentifiedEventsForEachProvider(e,t){window.requestIdleCallback((r=>{r.timeRemaining()>0?this.providers.forEach((r=>t(r,e))):t(this,e)}))}logForEachProvider(e,t){window.requestIdleCallback((r=>{r.timeRemaining()>0?(e=this.extraProperties?{...this.extraProperties,...e}:e,this.providers.forEach((r=>t(r,e)))):t(this,e)}))}assertValidCorrelationId(e){if(e.correlationId&&!(0,s.O)(e.correlationId)){e.correlationId=void 0;const t=new a.g9("Invalid correlationId provided for event payload. CorrelationIds should be a valid UUID string.",{},!0);this.logWarningEvent("InvalidTelemetryEvent",{errorAlertType:"Warning",errorCode:"InvalidCorrelationId",message:(0,c.vU)(t),stack:t.stack})}}logout(){this.providers.forEach((e=>e.logout()))}page(e){this.providers.forEach((t=>t.page(e)))}setContext(e,t){"object"==typeof e?this.context={...this.context,...e}:this.context[e]=t}setExtraProperties(e){this.extraProperties=e}setOptOut(e){this.providers.forEach((t=>t.setOptOut(e)))}enableNonEssential(){this.providers.forEach((e=>{e.essential||e.boot()}))}disableNonEssential(){this.providers.forEach((e=>{e.essential||e.setOptOut(!0)}))}setEmailStatus(e){this.providers.forEach((t=>t.setEmailStatus(e)))}setUserId(e){this.providers.filter((e=>!e.setMicrosoftUserId)).forEach((t=>t.setUserId(e)));try{"undefined"!=typeof window&&this.setUserProperties({"browser-name":(0,n.Y0)(),"browser-version":(0,n.JF)()})}catch(e){o.Vy.error("Failed to set browser details for user")}}setMicrosoftUserId(e){this.providers.filter((e=>"setMicrosoftUserId"in e)).forEach((t=>t.setMicrosoftUserId(e)))}updateFlightState(e){this.providers.filter((e=>e.updateFlightState)).forEach((t=>t.updateFlightState?.(e)))}setUserProperties(e){this.providers.forEach((t=>{if(t.isGDPRCompliant()&&t.shouldSendPII()){if("email"in e){const r=e.email??"",[,i]=r.split("@");if(i)return void t.setUserProperties({...e,domain:i})}t.setUserProperties(e)}else{const r={...e};delete r.email,delete r.name,delete r.first_name,delete r.last_name,delete r.teamName,t.setUserProperties(r)}}))}doWithProvider(e,t){for(const r of this.providers)if(r instanceof e)return t(r)}}},413497:(e,t,r)=>{r.d(t,{d:()=>n,t:()=>i});const i="00000000-0000-0000-0000-000000000001",n={type:"component",id:i,hidden:!0,name:"Component"}},994651:(e,t,r)=>{r.d(t,{vj:()=>ve,wB:()=>f,Kv:()=>ee,RD:()=>W,Ot:()=>z});var i=r(914023),n=r(294258),o=r(709629),s=r(903523),a=r(588657),c=r(552614),l=r(320043),d=r(177191),u=r(532203),h=r(175358);const p=(0,h.mj)("editor.presets.noFilters","None"),m=(0,h.mj)("editor.presets.noEffects","None"),f=(0,h.mj)("editor.presets.backgroundRemoval","Background removal"),g=(0,h.mj)("editor.presets.filmic","Filmic"),A=(0,h.mj)("editor.presets.blur","Blur"),v=(0,h.mj)("editor.presets.radial","Radial"),y=(0,h.mj)("editor.presets.vertical","Vertical"),b=(0,h.mj)("editor.presets.glass","Glass"),w=(0,h.mj)("editor.presets.glitch","Glitch"),x=(0,h.mj)("editor.presets.retroGraphics","Retro graphics"),S=(0,h.mj)("editor.presets.vhs","VHS"),T=(0,h.mj)("editor.presets.vaporwave","Vaporwave"),C=(0,h.mj)("editor.presets.smoke","Smoke"),_=(0,h.mj)("editor.presets.slowZoomRandom","Slow zoom random"),k=(0,h.mj)("editor.presets.slowZoom","Slow zoom"),E=(0,h.mj)("editor.presets.crashZoom","Crash zoom"),I=(0,h.mj)("editor.presets.colorShift","Color shift"),R=(0,h.mj)("editor.presets.disco","Disco"),F=(0,h.mj)("editor.presets.greenScreen","Green screen"),P=(0,h.mj)("editor.presets.blackWhiteRemoval","Black/white removal"),L=(0,h.mj)("editor.presets.blurFill","Blur fill"),N=(0,h.mj)("editor.presets.chromaticAberration","Chromatic aberration"),M=(0,h.mj)("editor.presets.comic","Comic"),B=(0,h.mj)("editor.presets.rotate","Rotate"),D=(0,h.mj)("editor.presets.spin","Spin"),O=(0,h.mj)("editor.presets.flash","Flash"),j=(0,h.mj)("editor.presets.move","Move"),U=(0,h.mj)("editor.presets.pulse","Pulse"),z=new i.g$(p,"noFilters","colour-filter");z.uiOrder=-1;const W=new i.g$(m,"noEffects","effect-filter");W.uiOrder=-1,new i.g$(f,"backgroundRemoval","effect-filter").uiOrder=-1;const V=new i.g$(P,"blackWhiteRemoval","effect-filter",{fields:[{id:"blackWhiteRemovalCutoff",defaultValue:.3,label:(0,h.mj)("editor.propertyPanel.filterBlackWhiteRemovalCutoff","Color threshold"),type:"range",maxValue:1,minValue:0,step:.01,position:["span","left"]},{id:"blackWhiteRemovalColor",defaultValue:"black",label:(0,h.mj)("editor.propertyPanel.filterBlackWhiteRemovalColor","Removal color"),type:"select",position:["span","left"],values:[{displayText:(0,h.mj)("editor.propertyPanel.filterBlackWhiteRemovalColorBlack","Black"),id:"black"},{displayText:(0,h.mj)("editor.propertyPanel.filterBlackWhiteRemovalColorWhite","White"),id:"white"}]}]});V.renderOrder=1010,V.uiOrder=1070,V.blackWhiteRemovalEnabled=!0,V.blackWhiteRemovalCutoff=.3,V.blackWhiteRemovalColor="black";const H=new i.g$(g,"filmic","effect-filter",{fields:[{id:"grainAmount",defaultValue:.5,label:(0,h.mj)("editor.propertyPanel.filterGrainAmount","Grain"),type:"range",maxValue:1,minValue:0,step:.01,position:["span","left"]},{id:"lutIntensity",defaultValue:1,label:(0,h.mj)("editor.propertyPanel.filterLutIntensity","Intensity"),type:"range",maxValue:2,minValue:0,step:.01,position:["span","left"]}]});H.renderOrder=3020,H.uiOrder=1100,H.lutSrc="static/media/FILMIC.fd29e187.png",H.lutIntensity=1,H.grainAmount=.5;const G=new i.g$(A,"blur","effect-filter",{fields:[{id:"blurAmount",defaultValue:2,label:(0,h.mj)("editor.propertyPanel.filterBlurIntensity","Blur"),type:"range",maxValue:10,minValue:1,step:.05,position:["span","left"]}]});G.blurAmount=2,G.renderOrder=3080,G.uiOrder=1080;const q=new i.g$(v,"radial","effect-filter");q.renderOrder=1060,q.uiOrder=1180,q.pattern=!0,q.radialAmount=1;const Q=new i.g$(y,"vertical","effect-filter");Q.renderOrder=1050,Q.uiOrder=1170,Q.pattern=!0,Q.verticalAmount=1;const K=new i.g$(b,"glass","effect-filter");K.renderOrder=3070,K.uiOrder=1140,K.glassAmount=1;const X=new i.g$(w,"glitch","effect-filter",{fields:[{id:"glitchAmount",defaultValue:.2,label:(0,h.mj)("editor.propertyPanel.filterGlitchAmount","Glitch intensity"),type:"range",maxValue:1,minValue:0,step:.01,position:["span","left"]},{id:"glitchSpeed",defaultValue:7.2,label:(0,h.mj)("editor.propertyPanel.filterGlitchSpeed","Glitch speed"),type:"range",maxValue:32,minValue:1,step:1,position:["span","left"]}]});X.renderOrder=1070,X.uiOrder=1100,X.glitchAmount=.2,X.glitchSpeed=7.2;const Y=new i.g$(x,"8bit","effect-filter",{fields:[{id:"pixelation",defaultValue:10,label:(0,h.mj)("editor.propertyPanel.pixelation","Pixelation"),type:"range",maxValue:15,minValue:5,step:.5,position:["span","left"]},{id:"colorPalette",defaultValue:"retro-handheld-green",label:(0,h.mj)("editor.propertyPanel.retroGraphicsColorPalette","Color Palette"),type:"select",position:["span","left"],values:[{displayText:(0,h.mj)("editor.propertyPanel.filterRetroGraphicsOriginalColorPalette","Original"),id:"original"},{displayText:(0,h.mj)("editor.propertyPanel.filterRetroGraphics8bitColorPalette","8-bit"),id:"8-bit"},{displayText:(0,h.mj)("editor.propertyPanel.filterRetroGraphicsHandheldGreenColorPalette","Retro Handheld (Green)"),id:"retro-handheld-green"}]}]});Y.renderOrder=3060,Y.uiOrder=1165,Y.pixelation=10,Y.colorPalette="retro-handheld-green";const Z=new i.g$(S,"vhs","effect-filter",{fields:[{id:"grainAmount",defaultValue:.8,label:(0,h.mj)("editor.propertyPanel.filterGrainAmount","Grain"),type:"range",minValue:0,maxValue:1,step:.01,position:["span","left"]},{id:"lutIntensity",defaultValue:1,label:(0,h.mj)("editor.propertyPanel.filterLutIntensity","Intensity"),type:"range",maxValue:2,minValue:0,step:.01,position:["span","left"]}]});Z.renderOrder=3040,Z.uiOrder=1010,Z.lutSrc="static/media/VHS.5ebec0fc.png",Z.lutIntensity=1,Z.vhsShiftFrequency=1.6,Z.grainAmount=.8;const J=new i.g$(T,"vaporwave","effect-filter",{fields:[{id:"vhsShiftFrequency",defaultValue:1.5,label:(0,h.mj)("editor.propertyPanel.filterVhsShiftFrequency","Effect intensity"),type:"range",maxValue:5,minValue:0,step:.01,position:["span","left"]},{id:"grainAmount",defaultValue:.5,label:(0,h.mj)("editor.propertyPanel.filterGrainAmount","Grain"),type:"range",minValue:0,maxValue:1,step:.01,position:["span","left"]},{id:"lutIntensity",defaultValue:1,label:(0,h.mj)("editor.propertyPanel.filterLutIntensity","Intensity"),type:"range",maxValue:2,minValue:0,step:.01,position:["span","left"]}]});J.renderOrder=3030,J.uiOrder=1020,J.lutSrc="static/media/VAPORWAVE.a1d0c10e.png",J.lutIntensity=1,J.vhsShiftFrequency=1.5,J.grainAmount=.5,J.glitchAmount=.01,J.glitchSpeed=16;const $=new i.g$(C,"smoke","effect-filter");function ee(){const e=[0,.5,1];return[e[Math.floor(Math.random()*e.length)],e[Math.floor(Math.random()*e.length)]]}$.renderOrder=1040,$.uiOrder=1190,$.smokeEnabled=!0;const te=new i.g$(_,"slowzoom","effect-filter",{fields:[{id:"szSpeed",defaultValue:.05,label:(0,h.mj)("editor.propertyPanel.filterSlowZoomSpeed","Speed"),type:"range",maxValue:.95,minValue:.01,step:.01,position:["span","left"]},{id:"szReverse",defaultValue:!1,label:(0,h.mj)("editor.propertyPanel.filterSlowZoomReverse","Reverse"),type:"toggle",position:["span","left"]}]});te.renderOrder=1030,te.uiOrder=1050,te.szMode="zoom_to_random",te.szPosition=ee(),te.szSpeed=.05,te.szReverse=!1;const re=new i.g$(k,"slowzoomcenter","effect-filter",{fields:[{id:"szPosition",defaultValue:[.5,.5],type:"grid",label:(0,h.mj)("editor.propertyPanel.filterSlowZoomPosition","Position"),position:["span","left"]},{id:"szSpeed",defaultValue:.05,label:(0,h.mj)("editor.propertyPanel.filterSlowZoomSpeed","Speed"),type:"range",maxValue:.95,minValue:.01,step:.01,position:["span","left"]},{id:"szReverse",defaultValue:!1,label:(0,h.mj)("editor.propertyPanel.filterSlowZoomReverse","Reverse"),type:"toggle",position:["span","left"]}]});re.renderOrder=1020,re.uiOrder=1040,re.szMode="custom_zoom",re.szPosition=[.5,.5],re.szSpeed=.05,re.szReverse=!1;const ie=new i.g$(E,"crashzoom","effect-filter",{fields:[{id:"crashZoomPosition",defaultValue:[.5,.5],type:"grid",label:(0,h.mj)("editor.propertyPanel.filterPosition","Position"),position:["span","left"]},{id:"crashZoomZoomAmount",defaultValue:2,label:(0,h.mj)("editor.propertyPanel.filterZoom","Zoom"),type:"range",maxValue:3.5,minValue:1,step:.1,position:["span","left"]},{id:"crashZoomSteps",defaultValue:"1",label:(0,h.mj)("editor.propertyPanel.filterSteps","Steps"),type:"select",position:["span","left"],values:[{displayText:"1",id:"1"},{displayText:"2",id:"2"},{displayText:"3",id:"3"}]},{id:"crashZoomStepDelay",defaultValue:.8,label:(0,h.mj)("editor.propertyPanel.filterStepDelay","Step delay"),type:"range",maxValue:3,minValue:.8,step:.1,position:["span","left"]}]});ie.renderOrder=1010,ie.uiOrder=1030,ie.crashZoomPosition=[.5,.5],ie.crashZoomZoomAmount=2,ie.crashZoomSteps="1",ie.crashZoomStepDelay=.8,ie.crashZoomEnabled=!0;const ne=new i.g$(O,"flash","effect-filter",{fields:[{id:"flash.speed",defaultValue:1,label:(0,h.mj)("editor.propertyPanel.filterSpeed","Speed"),type:"range",maxValue:4,minValue:.125,step:.125,position:["span","left"]},{id:"flash.fade",defaultValue:!1,label:(0,h.mj)("editor.propertyPanel.filterFade","Fade"),type:"toggle",position:["span","left"]}]});ne.renderOrder=4050,ne.uiOrder=1006,ne.flash=(0,n.E)();const oe=new i.g$(U,"pulse","effect-filter",{fields:[{id:"pulse.speed",defaultValue:2,label:(0,h.mj)("editor.propertyPanel.filterSpeed","Speed"),type:"range",maxValue:5,minValue:.2,step:.01,position:["span","left"]},{id:"pulse.amount",defaultValue:.15,label:(0,h.mj)("editor.propertyPanel.filterAmount","Amount"),type:"range",maxValue:.5,minValue:.01,step:.01,position:["span","left"]},{id:"pulse.loop",defaultValue:!0,label:(0,h.mj)("editor.propertyPanel.filterLoop","Loop"),type:"toggle",position:["span","left"]}]});oe.renderOrder=4010,oe.uiOrder=1008,oe.pulse=(0,o.L)();const se=new i.g$(I,"colorShift","effect-filter");se.renderOrder=3010,se.uiOrder=1130,se.colorShiftEnabled=!0;const ae=new i.g$(R,"disco","effect-filter");ae.renderOrder=3e3,ae.uiOrder=1120,ae.discoEnabled=!0;const ce=new i.g$(F,"greenScreen","effect-filter",{fields:[{id:"greenScreenCutoff",defaultValue:.3,label:(0,h.mj)("editor.propertyPanel.filterGreenScreenCutoff","Screen threshold"),type:"range",maxValue:1,minValue:0,step:.01,position:["span","left"]},{id:"greenScreenColor",defaultValue:"g",label:(0,h.mj)("editor.propertyPanel.filterGreenScreenColor","Screen color"),type:"select",position:["span","left"],values:[{displayText:(0,h.mj)("editor.propertyPanel.filterGreenScreenColorRed","Red"),id:"r"},{displayText:(0,h.mj)("editor.propertyPanel.filterGreenScreenColorGreen","Green"),id:"g"},{displayText:(0,h.mj)("editor.propertyPanel.filterGreenScreenColorBlue","Blue"),id:"b"}]}]});ce.renderOrder=1e3,ce.uiOrder=1060,ce.greenScreenEnabled=!0,ce.greenScreenCutoff=.3,ce.greenScreenColor="g";const le=new i.g$(L,"blurFill","effect-filter");le.renderOrder=-1,le.uiOrder=1090,le.blurFillEnabled=!0;const de=new i.g$(N,"chromaticAberration","effect-filter",{fields:[{id:"chromaticAberrationAmount",defaultValue:1,label:(0,h.mj)("editor.propertyPanel.filterChromaticAberrationAmount","Effect intensity"),type:"range",maxValue:5,minValue:0,step:.01,position:["span","left"]}]});de.renderOrder=3050,de.uiOrder=1030,de.chromaticAberrationAmount=1;const ue=new i.g$(M,"cartoon","effect-filter",{fields:[{id:"cartoonHalftoneIntensity",defaultValue:.3,type:"range",maxValue:1,minValue:0,step:.01,position:["span","left"],label:(0,h.mj)("editor.propertyPanel.filterCartoonHalftone","Halftone dot opacity")}]});ue.renderOrder=1080,ue.uiOrder=1160,ue.cartoonEnabled=!0,ue.cartoonHalftoneIntensity=.3;const he=new i.g$(j,"move","effect-filter",{fields:[{id:"move.direction",defaultValue:0,type:"angle",label:(0,h.mj)("editor.propertyPanel.filterDirection","Direction"),position:["span","left"]},{id:"move.distance",defaultValue:.5,label:(0,h.mj)("editor.propertyPanel.filterDistance","Distance"),type:"range",maxValue:1,minValue:.01,step:.01,position:["span","left"]},{id:"move.speed",defaultValue:1,label:(0,h.mj)("editor.propertyPanel.filterSpeed","Speed"),type:"range",maxValue:2,minValue:.1,step:.1,position:["span","left"]},{id:"move.ease",defaultValue:!0,label:(0,h.mj)("editor.propertyPanel.filterEase","Ease"),type:"toggle",position:["span","left"]},{id:"move.mode",defaultValue:"simple",label:(0,h.mj)("editor.propertyPanel.filterMode","Mode"),type:"select",position:["span","left"],values:[{displayText:(0,h.mj)("editor.propertyPanel.filterModeSimple","Simple"),id:"simple"},{displayText:(0,h.mj)("editor.propertyPanel.filterModeBoomerang","Boomerang"),id:"boomerang"},{displayText:(0,h.mj)("editor.propertyPanel.filterModeLoop","Loop"),id:"loop"}]}]});he.renderOrder=4070,he.uiOrder=1005,he.move=(0,s.j)();const pe=new i.g$(B,"rotate","effect-filter",{fields:[{id:"rotate.speed",defaultValue:.15,label:(0,h.mj)("editor.propertyPanel.filterSpeed","Speed"),type:"range",maxValue:2,minValue:.05,step:.05,position:["span","left"]},{id:"rotate.reverse",defaultValue:!1,label:(0,h.mj)("editor.propertyPanel.filterReverse","Reverse"),type:"toggle",position:["span","left"]}]},!1);pe.renderOrder=4e3,pe.uiOrder=1010,pe.rotate=(0,a.d)();const me=new i.g$(D,"spin","effect-filter",{fields:[{id:"spin.bounce",defaultValue:!0,label:(0,h.mj)("editor.propertyPanel.filterBounce","Bounce"),type:"toggle",position:["span","left"]},{id:"spin.loop",defaultValue:!1,label:(0,h.mj)("editor.propertyPanel.filterLoop","Loop"),type:"toggle",position:["span","left"]},{id:"spin.reverse",defaultValue:!1,label:(0,h.mj)("editor.propertyPanel.filterReverse","Reverse"),type:"toggle",position:["span","left"]}]},!1);me.renderOrder=4040,me.uiOrder=1009,me.spin=(0,c.y)();const fe=new i.g$((0,h.mj)("editor.propertyPanel.filterKaleidoscope","Kaleidoscope"),"kaleidoscopeFilter","effect-filter",{fields:[{id:"kaleidoscopeV2.speed",defaultValue:.3,label:(0,h.mj)("editor.propertyPanel.filterKaleidoscopeSpeed","Speed"),type:"range",maxValue:1,minValue:.1,step:.01,position:["span","left"]},{id:"kaleidoscopeV2.segments",defaultValue:8,type:"range",maxValue:20,minValue:5,step:1,position:["span","left"],label:(0,h.mj)("editor.propertyPanel.filterKaleidoscopeSegments","Segments")},{id:"kaleidoscopeV2.enableColorShift",defaultValue:!1,type:"toggle",position:["span","left"],label:(0,h.mj)("editor.propertyPanel.filterKaleidoscopeColorShift","Color shift")}]});fe.kaleidoscopeV2=(0,l.x)(),fe.renderOrder=1210,fe.uiOrder=1210;const ge=new i.g$((0,h.mj)("editor.propertyPanel.filterGlow","Glow"),"glowFilter","effect-filter",{fields:[{id:"glowV2.strength",defaultValue:.6,type:"range",maxValue:.95,minValue:.05,step:.05,position:["span","left"],label:(0,h.mj)("editor.propertyPanel.filterGlowStrength","Strength")}]});ge.glowV2=(0,d.d)(),ge.renderOrder=1220,ge.uiOrder=1220;const Ae=new i.g$((0,h.mj)("editor.propertyPanel.filterDiffusion","Diffusion"),"diffusionFilter","effect-filter",{fields:[{id:"diffusionV2.strength",defaultValue:.7,type:"range",maxValue:.95,minValue:.05,step:.05,position:["span","left"],label:(0,h.mj)("editor.propertyPanel.filterDiffusionStrength","Strength")}]});Ae.diffusionV2=(0,u.R)(),Ae.renderOrder=1230,Ae.uiOrder=1230;const ve=[z,W,H,G,q,Q,K,X,de,ue,Z,J,$,re,se,ae,ce,V,le,te,Y,ge,fe,Ae,ie,ne,pe,me,he,oe]},591652:(e,t,r)=>{r.d(t,{P:()=>P});var i=r(187115),n=r(175358);const o="f27453ed-0851-45b4-aceb-14210cb2c008",s="61c957cd-18d8-4511-84f4-ec3508ff70a6",a="c83251bb-af5a-4b36-8e8a-c8b933b2054b",c="4ed96fa1-e393-4efc-af08-e4fe50a23855",l="ff4dfa51-b9db-43bc-894a-c3be0981895e",d="3b9ed6f3-759e-4d9b-bffd-c5e09f86276e",u="73714884-7558-4cf8-996c-3b4a93ee6c44",h="a5cce080-1e6a-4be6-b9a3-925c57975247",p="ccfe78ae-2905-4f7a-816a-3235071bd857",m="da818461-a5d8-4582-b4ba-a3320a1dcf16",f="f6fba9a1-8bcc-469f-81f0-8d695b4e7086",g="6aae0678-5a3a-4aae-a9f9-36790663a24f",A="2130f484-c7ae-4200-bf6f-bbf9d940a238",v="a5b25b82-6824-4af4-8251-b002c5403e3c",y="3760e9e2-07d1-4aad-b731-ee8035dd03f9",b="d506ba90-cbee-45fa-8289-aa539db63168",w="92b8f25e-24a4-4daf-8f9e-3addf606f178",x="527cb57b-d093-4d2f-9260-2d9b89cfff07",S="6741238e-6f30-439b-8096-d3adf9a70c18",T="f18f89e5-30d5-4aa7-87e9-5768df383a2b",C="dd796b0e-ebdc-4e86-bc57-ede3199616dc",_="b7d83976-c223-49b0-8203-dbdad6865215",k="f6f68a91-74fc-4366-b30b-74f21c1690cc",E="21c3ad8e-6166-4124-acf1-b4685a7e113d",I={simpleStyledTextAsset:{title:(0,n.mj)("editor.sidebar.simpleTextPreset","Simple"),createAssetFunction:function(e="Add your text here"){return{id:T,hidden:!1,name:"SimpleStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:T,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:400,fontId:"builtin:Rubik",fill:{type:"solidColor",hex:1118481,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},classicStyledTextAsset:{title:(0,n.mj)("editor.sidebar.classicTextPreset","Classic"),createAssetFunction:function(e="Add your text here"){return{id:l,hidden:!1,name:"ClassicStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:l,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:48/360,fontWeight:400,fontId:"builtin:Yeseva One",fill:{type:"solidColor",hex:15987439,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},subtitleStyledTextAsset:{title:(0,n.mj)("editor.sidebar.subtitleTextPreset","Subtitle"),createAssetFunction:function(e="Add your text here"){return{id:C,hidden:!1,name:"SubtitleStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:C,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:400,fontId:"builtin:DM Sans",fill:{type:"solidColor",hex:16777215,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},memeStyledTextAsset:{title:(0,n.mj)("editor.sidebar.memeTextPreset","Meme"),createAssetFunction:function(e="Add your text here"){return{id:g,hidden:!1,name:"MemeStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:g,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:40/360,fontWeight:400,fontId:"builtin:Anton",fill:{type:"solidColor",hex:16777215,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},playfulStyledTextAsset:{title:(0,n.mj)("editor.sidebar.playfulTextPreset","Playful"),createAssetFunction:function(e="Add your text here"){return{id:b,hidden:!1,name:"PlayfulStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:b,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:.1,fontWeight:400,fontId:"builtin:Luckiest Guy",fill:{type:"solidColor",hex:5353720,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},plutoStyledTextAsset:{title:(0,n.mj)("editor.sidebar.plutoTextPreset","Pluto"),createAssetFunction:function(e="Add your text here"){return{id:w,hidden:!1,name:"PlutoStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:w,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:400,fontId:"builtin:Dela Gothic One",fill:{type:"solidColor",hex:12451584,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},inkStyledTextAsset:{title:(0,n.mj)("editor.sidebar.inkTextPreset","Ink"),createAssetFunction:function(e="Add your text here"){return{id:p,hidden:!1,name:"InkStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:p,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:.1,fontWeight:400,fontId:"builtin:Knewave",fill:{type:"solidColor",hex:1315087,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},retroStyledTextAsset:{title:(0,n.mj)("editor.sidebar.retroTextPreset","Retro"),createAssetFunction:function(e="Add your text here"){return{id:x,hidden:!1,name:"RetroStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:x,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:.1,fontWeight:400,fontId:"builtin:Fugaz One",fill:{type:"solidColor",hex:16766464,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},beachStyledTextAsset:{title:(0,n.mj)("editor.sidebar.beachTextPreset","Beach"),createAssetFunction:function(e="Add your text here"){return{id:s,hidden:!1,name:"BeachStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:s,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:.1,fontWeight:400,fontId:"builtin:Pacifico",fill:{type:"solidColor",hex:9956051,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},grooveStyledTextAsset:{title:(0,n.mj)("editor.sidebar.grooveTextPreset","Groove"),createAssetFunction:function(e="Add your text here"){return{id:h,hidden:!1,name:"GrooveStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:h,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:34/360,fontWeight:400,fontId:"builtin:Shrikhand",fill:{type:"solidColor",hex:16422634,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},blockStyledTextAsset:{title:(0,n.mj)("editor.sidebar.blockTextPreset","Block"),createAssetFunction:function(e="Add your text here"){return{id:a,hidden:!1,name:"BlockStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:a,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:48/360,fontWeight:400,fontId:"builtin:Bebas Neue",fill:{type:"solidColor",hex:0,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},lightStyledTextAsset:{title:(0,n.mj)("editor.sidebar.lightTextPreset","Light"),createAssetFunction:function(e="Add your text here"){return{id:m,hidden:!1,name:"LightStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:m,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:34/360,fontWeight:400,fontId:"builtin:Quicksand",fill:{type:"solidColor",hex:16777215,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},oakStyledTextAsset:{title:(0,n.mj)("editor.sidebar.oakTextPreset","Oak"),createAssetFunction:function(e="Add your text here"){return{id:y,hidden:!1,name:"OakStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:y,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:.1,fontWeight:700,fontId:"builtin:Playfair Display",fill:{type:"solidColor",hex:11575428,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},westStyledTextAsset:{title:(0,n.mj)("editor.sidebar.westTextPreset","West"),createAssetFunction:function(e="Add your text here"){return{id:k,hidden:!1,name:"WestStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:k,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:400,fontId:"builtin:Ultra",fill:{type:"solidColor",hex:16717362,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},wideStyledTextAsset:{title:(0,n.mj)("editor.sidebar.wideTextPreset","Wide"),createAssetFunction:function(e="Add your text here"){return{id:E,hidden:!1,name:"WideStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:E,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:25/360,fontWeight:800,fontId:"builtin:Syne",fill:{type:"solidColor",hex:14417664,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},fridayStyledTextAsset:{title:(0,n.mj)("editor.sidebar.fridayTextPreset","Friday"),createAssetFunction:function(e="Add your text here"){return{id:u,hidden:!1,name:"FridayStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:u,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:400,fontId:"builtin:Oi",fill:{type:"solidColor",hex:15767095,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},diaryStyledTextAsset:{title:(0,n.mj)("editor.sidebar.diaryTextPreset","Diary"),createAssetFunction:function(e="Add your text here"){return{id:d,hidden:!1,name:"DiaryStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:d,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:40/360,fontWeight:400,fontId:"builtin:Sue Ellen Francisco",fill:{type:"solidColor",hex:16622335,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},markerStyledTextAsset:{title:(0,n.mj)("editor.sidebar.markerTextPreset","Marker"),createAssetFunction:function(e="Add your text here"){return{id:f,hidden:!1,name:"MarkerStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAL30lEQVR4Ae3cXXLb1hXA8QNSTjTTPihvSvJgegWVVxBoxlbrp1ArsLwCSyuwtAJLK7C8AjNPmSbuiF5B1BVYfXClN6ut01Etkug5F6AEAhdfMi0ik/9vxhObBEB83I9zz72ICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv32rP/fDb3/qrwlwiwL5Dfj65/7zSGTb/t4JZPOfDwYDuaHVn/pbetU9WZLDs/XBiQAlWl9BVv/WfyYT2b36IJCTIJJBZ0levlsfHEsDq0f9XjCSX7SyrbhDjWXn9C+DfQEKtLqCWIGWkbz1fqkVZbkr90/WB+dS0+rr/guJZGv2MLJ/+nCwI4BHR9psLEeF30XS+99InklNrifKVI74MLJt4xsBPFrbgyRjhRdV2y0vyVdVvUguTMu6SW+k53e2MTiUOXAVNJDH7h9d2Ws6Nuod9VcuRrLd1dDz3UazsPNT2W9fXkov6ui4Tn3RlWGd+5iEu0/tENGS7LR1PNjKCuJCK+s9oviml6katKcH+BXWzx4OhjW2u6pwQSDnUSTHep4vb1pZvn7df6rHuB4HaWXVbn2nSSJiJnQM5LA7kYOqimKVUhuX40aNgu6jBWYtCuRPOg60/65kn5F+P6gq8KuvNx8HEu3rda8k+5zr895r43iwnRXEM1Yooq3mfV9hSFrVV/rXsOoY9oC0Em3WqSDf/LXfn3TccWeN5N7Zo2atYFkvWXRduWPE4eFsKFrSIybjOvvNsKowW1p9EkjoKoRIf1qg69B76S1b3x7118aaKPF918akSevGIO4B1qwcZtq1Z49xMXYPIZSa6lQOK4xR11+gO3ek0RyNCzE68rzo+3Egv9QcG+XHYdqqW9iT/sgaDD3esyTpEcabSd96anfPU6xX0z/v7Rx0m+f2PJpUDt3+xPex/c547Glcprt15fk3r/t9aZElaZtx/YG3mUQy00raw9Vj7DZ6oOJ/oOaqxbW5Ey14elyvqEY4OEMLZuU5xr3LvaKvrTDp9Yf53eRcC+LVfbGKpg2GHauXO4ied/DRhXj91DFv3opr5ehqb+z9zp5txX3Se/JCK/OwSej3ObWqB0lasrDBLlYYvrdQwAqB/rFCt9+wckg0kR8Kv4wrbFj5YDUMkQrWitt/bVxUZ3xl25S1qBO9dv9ucjAN91yDIeXjOd3+xgN7q4yB7a9jHy1NT5Z/nQ0Np9dclEX0nMvKxcdaY8Zb0a4e5FJC11I3YANwDQU+6YZqqONtrZLeY0vqnUiv7GvXio/kSCvHsZ5zLhzTQrajFftp9vonkcv0FA3YQ895nGgh3beCaWlwPeZ2xXm/XP7vdY8xudTCXlUqdIxj++m9OTwtGXe5UFdDOr32odbm0LPJnh7nce6Zd11Gb1daoF1jkE6z8GpepjPrOQ3CvUAqxiBJGtdXOfTDJzpZua+/t+4yOrPC7BjBuPGJv1LuXa6IG4OVZe+Sln9Hs29bJ5vX4Yz1PJ5zkCDuZdaXP8hXZw8G93TMtluVlNA07rT3C3NfTjSdrcfwXrNeV1vmplpTQVxGp2kc30BQ3ApbqjgXYriFkUUhgT7c7EO1Sla2mNLSot7P40J6aH9PCtwwu01n7Nl3Om+S/VhDPZclKrmXus3gyw9yz1VKvz3PZyeaWTu//ENceDVk2nJ/PJU35Tvvp1Y5/qyVQ5JrDrQ3ygulBdoTYhU88Pgrl4ZtNK5I76v/2dN05kCuW7QZLqzIGHc0tPEPyIf2cLWQ2MMPZ44TuH8XpZx9hfzw9EFcSJMW81nkKRjZBEBZ6Fc652PZpUB7qwflGTvfmMQyXhrKXt+/yfUx9XzWfaliHZet5e6hbj+tHG5eJXAhZJjdN4hu9rznrRU9SNLyhkXfdyJv6FHHMBrJfWspg4LKYdtkQ4XCVLMVsJE8sb/q+eQG9kUDdW/lSNiA3VKqEs9lhL5t9Bpme7/L5q1rYBOa49qTofVDXau8mpHLJhOSe9jLnUdHju2ada7L0s2WVPHOr+h2Q2mBVvQgJa21a2XfPRzYTbVu/3md4017jXQIERVkfLwmhb3Z3rQy+VpZLYR9ffBxK/lwsJc6nzXv5dn8QnKwInrMg+xA2Frdkl18v/PyVMcadTZNerJQmojT36GkwlgLCye+TaOkoSq/gOGnvNIwTwvvQSonBqM4Pk0K+17ZsaYVwxdfVw6iq89nuHxHBqs/9nuux/NMULowMN5311rI6UCzUeVMn7NVjo3Bdvb8Iqk/KWmrlc9qVo5kh8fSkO88Jze8ZpdV+1Awj7IAi+9B4tSun7XEG9chgWU9tHAOxhpn22DU1gLpwzmPgng91GlB+GAFelwwhtH9/z7zgfUe/gGupWnf2x0bx9uVs2PEqc2hNGiRk0o+tLmM04389Vio2Kj3aPDbyTKQrdwXFlp2rscFriGw93J0/igay74v1evWakkjQ7EeeqPeerjbsvAKUhouBPkZ7mQSaksacMtRimbAU6FSskhyS+bBFjDaYD4eUJdKkhDHWghffvlvGaTTrh7fSaPTEJtEPdIn/aRqxazOvj/1HODEjV02Gq+27dXYZmhjOe3xDyuueWEWWkEKszsmfjBPZA5Kl4GMU4PBgolKS4texc41zCy6G1UXlLoLJRO9si8LMn6hJBN2Np+h3/9LK+OJ+2Yid/UE/iF39D74M2N7jRdh/ujCwPIsVCrV22YLrSAXF3oTC85AC+XB6aPGrZZXycOazWB13FqhWfogo8ClR2tXkKibGsBb5QwqdznSMcth1bsgbvxRkhGzRkVDnnW9pz0R78tm4VUaOR0iBq5SDyLP8XzL+F3Dps8uWNJwL87chRr6HUwbBVu4OamKr/Re6zXfvcn7L7dpoRVkeVnOLwrCjyAoXkA4N9H1BJV3otJ6sYkcWiXS1tcK+l13bjpusZDIWn39fFeyadH0AL7uoNcG99qCu4oykTddPX5uuXvFeM2FQnGFP9G066Yt/Ks7f+TtITsuq3WUuhaXunXPbClJRCUVwVbiaqbxrr2+HNUd9yTXrPtZxuqNpvOHt/3CV5Xqtu0z05vzPvcQNbV79mAwl/Aq+Y3tKJsijlvHe9N/JgUhbHIebvBv74bkQ7h4GYW4d1ve5l4qqhmyTV/ISsKi6bzLkXfjSMcYmdbeQh1toY9qrW/T+6G/txLJJ07QjeSeVp4XkrmXTa85eXHsh0Wnexee5tWbkV9JG3mXHtyYtUz5D2c/C3wFo+Q8rNLZ+xLejNdIDlPHPc78zrnOZG/aEhOpkEygWVi0rdu/sh7LO2FqFdkTCllv4hoBrTxWQIt+J3mjb13kE3tta3TiHuxN7qtL2bG3PyUq/43pNSfvoLyYrgZelIVXkE4n8+DiSbahzFHSbQ+vPrCl2ZeZOZUg/1DtlVQp4OZZfBVoMjuo1Rh9pgGIkoLq9rfWtmZjYC27G/xmGxQrcJfl80NWeaxS6l+tEuwllWVof1zLPpL7ds567AO5uWFSyeK/Z76z47vewLZpcM1lqxBuw8JDLKPx/9urMMATKsxD1f/YIB2OuExQdL2IsOS8t9KvzPomzJJl52/tYbvjJoXR89u7YincsnAoDl/sexdm2fFsGc4843bvmMpjmpp24zGtZOlGLfe6s+d15LrXXPfV48+lHRXEbtaSbBVlTW71PL7Qh/oxvz6rbB+XzUkG7UXb2VqlOvG0e6NvIn1t2b9PjwfSlc/9Zle2bZLu7NH8M0C9V1rA/yhryRKZuGJ35Lw7luM7v8rJxbKs1Pldu5Yv/iPDqjmOZOn+lmQqi60f02u+LwvUigoCP5cE0IGzLTNvW3bnc/k9XjMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3Jb/A1rcYCMSwt0OAAAAAElFTkSuQmCC",entities:[{id:f,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:40/360,fontWeight:400,fontId:"builtin:Permanent Marker",fill:{type:"solidColor",hex:1620816,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},noteStyledTextAsset:{title:(0,n.mj)("editor.sidebar.noteTextPreset","Note"),createAssetFunction:function(e="Add your text here"){return{id:v,hidden:!1,name:"NoteStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:v,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:400,fontId:"builtin:Rock Salt",fill:{type:"solidColor",hex:14210769,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},scribbleStyledTextAsset:{title:(0,n.mj)("editor.sidebar.scribbleTextPreset","Scribble"),createAssetFunction:function(e="Add your text here"){return{id:S,hidden:!1,name:"ScribbleStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:S,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:400,fontId:"builtin:Schoolbell",fill:{type:"solidColor",hex:8774859,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},monoStyledTextAsset:{title:(0,n.mj)("editor.sidebar.monoTextPreset","Mono"),createAssetFunction:function(e="Add your text here"){return{id:A,hidden:!1,name:"MonoStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:A,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:400,fontId:"builtin:Space Mono",fill:{type:"solidColor",hex:15985767,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},thinStyledTextAsset:{title:(0,n.mj)("editor.sidebar.thinTextPreset","Thin"),createAssetFunction:function(e="Add your text here"){return{id:_,hidden:!1,name:"ThinStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMqSURBVHgB7dqPURpBFAfgZyYFWAIdxA4kHVgCHcQOYjrQCmIqMB1IOjAVSAemg8tuOMKfwRXvDu/A75vZ8UDu4A33g3fsRgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGtOgp1VVXWZ/pzWN69PTk7+BDCXAvJYLY1iYNJrukjjLo37NMYBb2nIAUmv56xa9zTEEB+aDzEgGydgX67iMF1s3M6t4DhoZVABoZWHLffNglY+xrDkN3kWzZzF8gJ6Fs2PM4sDlH4w+Jm+/W7S5pc08o8HN+m+aUBWzS9MFyaxB9XAL9LpnhYLCgQECgQECgQECgQECgQECoY2D3I06p+Bx2mMNv6V5yjyfM9D14sd03PmuaCz+mY+/sMr98+z8f/mktK+ty88dhRvXB8tDGEeJN13msbXar4Oahf3Xb7WvEymzZKZ1fqe+X+v9fVBi9WBxYmTNp/SuIrljP5Lxml8r0/MUQzUSn2PcYT1lWixWqrf+PtYbzWmafyOutWIedsR9WPyyZVbmfOVffLffBJNUlvyIwakru8ulq1bNo0jqe/dqHposerxuNFSjF9xvMst7crO+285XqctVgf1TbqsjxaqfgKyuP3U9Dm3nIR5e9cWZvNYXQdkUPX1wTVIc7knH8W8vfj80q8+z0n7zfL+sd6mXEbPqvk1xyiOtL53p4dvkE6fq5q3W9XKJ/arP2W7/AYZYn198A3Szm3TT9ZN6TjXsfyUXVzo9m2f9U3iAAhIO9+iWzcr2+fRv33W9ykOgIA0N637606PubI9jn4de307EZDmfkX3VpeGjKJfx17fTgSkuWl0bHPtUs8XstPoWF3f/xqrA5hdF5Dm9rUQb7ay3WdA9lXfQS1gFJDmjn2lqpW4ISBQJCBQICBQICBQICBQICBQICBQICBQICBQICBQICBQICBQICBQICBQICBQICBQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnfgLQwGkwOMi65sAAAAASUVORK5CYII=",entities:[{id:_,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:300,fontId:"builtin:Montserrat",fill:{type:"solidColor",hex:16777215,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},bubbleStyledTextAsset:{title:(0,n.mj)("editor.sidebar.bubbleTextPreset","Bubble"),createAssetFunction:function(e="Add your text here"){return{id:c,hidden:!1,name:"BubbleStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,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",entities:[{id:c,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:400,fontId:"builtin:Fredoka One",fill:{type:"solidColor",hex:15493046,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},arcadeStyledTextAsset:{title:(0,n.mj)("editor.sidebar.arcadeTextPreset","Arcade"),createAssetFunction:function(e="Add your text here"){return{id:o,hidden:!1,name:"ArcadeStyledPlainText",type:"procedural",thumbnailUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJKSURBVHgB7dptkppAEADQwcqBklxAcrK4JwteIMmJlsUt2Z2d0i5AwK/3/lGD04zYTtuSEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADy7Kq3ox75th5zXXdTL3221S9yln/t2193o36fG7u3ebhJwlgSBwLe0oO9/2nqzSXV//KW+qlJTtWmfjX1syW2Vtodtuj9WbnEtiybIITnO1qJdcuQf/O73yed57fvr6uz0XYIrUGJBQIJAYPYSK2/llj3df9vqbFs5HyvbhPmcUZtwTHtxjpZzFG+qNeJF92GOeIPe2BnjlYaubwg7CAQkCAQW7WLdkrJ13HkZ8rrX19Tkx/kchznzeqIaOOeYeOXYZsJX2vE66/44X8Nhzv+/qubU2NT1lfEiS8SL1jfW0yRI2TqeWqd+qZGLYnvp/2uON7pJIx1r+7o/ztdwTLjm1NjU9ZXxIkvEi9Y3lhILAhIEAquWWENbq1PbhJFHeEJ47bbrtV3z89Kzg0BAgkBg1RJriTbho1u77XpLlm6bD7FqgizRJnx0a7ddb8kt/GZUYkFAgkDgef5Jn8nQp46nKtvRc8Qbc1H3GC+a81J2EAhIEAjMXmLN1Zo799Tq1KddL233jY13yZxJPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMf1BnhvE6Rt3903AAAAAElFTkSuQmCC",entities:[{id:o,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:24/360,fontWeight:400,fontId:"builtin:Press Start 2P",fill:{type:"solidColor",hex:3260927,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}}};var R=r(608352),F=r(478081);const P=[(0,i.S)(),(0,R.F)(),(0,F.R)(),...Object.values(I).map((e=>e.createAssetFunction()))]},362724:(e,t,r)=>{r.d(t,{J9:()=>d,NM:()=>s,_0:()=>a,dX:()=>c,lP:()=>l});var i=r(776016),n=r(126014);const o="593a6ddd-6b2d-43fb-80f8-724e2a993ba4",s={fontFamily:"builtin:Open Sans",fontSize:22,fontStyleBold:!1,fontStyleItalics:!1,color:{hex:16777215,alpha:1},stroke:{width:.003,hex:0,alpha:1},horizontalAlignment:"center"};function a(e){return{id:o,segments:[{id:"2c636a90-9d16-4b82-8bc8-23043a5b6183",type:"com.clipchamp.text",properties:{content:[{text:"",fontSize:e.fontSize/360,fontWeight:e.fontStyleBold?700:400,fontId:e.fontFamily,fill:{type:"solidColor",hex:e.color.hex,alpha:e.color.alpha},isItalic:e.fontStyleItalics,...(0,i.O9)(e.stroke)?{strokeWidth:e.stroke.width,stroke:{type:"solidColor",hex:e.stroke.hex,alpha:e.stroke.alpha}}:{}}],horizontalAlignment:e.horizontalAlignment,wrapWidth:.95}},{id:"d7d843ef-7d3e-4b89-b4ca-a215183fa682",type:"com.clipchamp.place",properties:{framePos:{x:0,y:-.8},rotation:0}}]}}function c(e){const t={...s};return e.segments.forEach((e=>{"com.clipchamp.text"===e.type&&(e.properties.content&&e.properties.content.forEach((e=>{e.fontId&&(t.fontFamily=e.fontId),e.fontSize&&(t.fontSize=360*e.fontSize),e.fontWeight&&(t.fontStyleBold=e.fontWeight>400),e.isItalic&&(t.fontStyleItalics=e.isItalic),e.fill&&(t.color={hex:e.fill.hex,alpha:e.fill.alpha}),e.stroke&&(t.stroke={hex:e.stroke.hex,alpha:e.stroke.alpha,width:e.strokeWidth??s.stroke.width})})),e.properties.horizontalAlignment&&(t.horizontalAlignment=e.properties.horizontalAlignment))})),t}const l={id:o,hidden:!1,name:"PlainText",type:"procedural",thumbnailUrl:n,entities:[a(s)]};function d(e){return e.id===o}},187115:(e,t,r)=>{r.d(t,{S:()=>o});var i=r(126014);const n="95ca2982-747b-47e5-8880-1118ea0262a1";function o(e="Add your text here"){return{id:n,hidden:!1,name:"PlainText",type:"procedural",thumbnailUrl:i,entities:[{id:n,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:700,fontId:"builtin:DM Sans",fill:{type:"solidColor",hex:16777215,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},608352:(e,t,r)=>{r.d(t,{F:()=>o});const i="data:image/png;base64,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",n="0896ad23-4a85-47d5-9629-04ff45778c1c";function o(e="Add your text here"){return{id:n,hidden:!1,name:"HeadingStyledPlainText",type:"procedural",thumbnailUrl:i,entities:[{id:n,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:30/360,fontWeight:800,fontId:"builtin:Montserrat",fill:{type:"solidColor",hex:16777215,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},478081:(e,t,r)=>{r.d(t,{R:()=>o});const i="data:image/png;base64,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",n="00555a8f-8125-4d99-b967-6a85c0ebae2a";function o(e="Add your text here"){return{id:n,hidden:!1,name:"SubheadingStyledPlainText",type:"procedural",thumbnailUrl:i,entities:[{id:n,segments:[{id:"b9b3cf3e-c25b-4a1b-b3bb-556f97a17673",type:"com.clipchamp.text",properties:{content:[{text:e,fontSize:24/360,fontWeight:600,fontId:"builtin:Montserrat",fill:{type:"solidColor",hex:16777215,alpha:1}}],horizontalAlignment:"center",wrapWidth:.8}},{id:"547ce982-a261-48a6-a27e-b1599a843b4d",type:"com.clipchamp.place",properties:{}}]}]}}},897427:(e,t,r)=>{r.d(t,{ad:()=>i});const i=[{id:"VISUAL_WATERMARK_FULLCOLOUR_LOGO_21",name:"watermark2021.png",type:"image",hidden:!0,metadata:{size:9612,width:1024,height:139,rotation:0,raw:{streams:[{index:0,codec_name:"png",codec_long_name:"unknown",codec_type:"video",codec_time_base:"0/1",codec_tag_string:"[0][0][0][0]",codec_tag:"0x0000",width:1024,height:139,coded_width:1024,coded_height:139,has_b_frames:0,sample_aspect_ratio:"1:1",display_aspect_ratio:"1024:139",pix_fmt:"rgba",level:-99,color_range:"pc",r_frame_rate:"25/1",avg_frame_rate:"0/0",time_base:"1/25",disposition:{attached_pic:0}}],format:{filename:"/input.0.png",nb_streams:1,nb_programs:0,format_name:"png_pipe",size:"9612"}},importedSize:9612},cloud:{provider:"clipchamp",id:"watermark2021.png"}},{id:"AUDIO_WATERMARK_21",name:"watermark2021.mp3",type:"audio",hidden:!0,metadata:{duration:1.311995,bitRate:352800,channels:1,sampleRate:22050,size:57994,raw:{streams:[{index:0,codec_name:"pcm_s16le",codec_long_name:"unknown",codec_type:"audio",codec_time_base:"1/22050",codec_tag_string:"[1][0][0][0]",codec_tag:"0x0001",sample_fmt:"s16",sample_rate:"22050",channels:1,channel_layout:"stereo",bits_per_sample:16,r_frame_rate:"0/0",avg_frame_rate:"0/0",time_base:"1/22050",duration_ts:28928,duration:"1.311927",bit_rate:"352800",disposition:{attached_pic:0}}],format:{filename:"/input.0.vnd.wave",nb_streams:1,nb_programs:0,format_name:"wav",duration:"1.359000",size:"57994",bit_rate:"353641"}},importedSize:34010},cloud:{provider:"clipchamp",id:"watermark2021.mp3"}}]},571056:(e,t,r)=>{r.d(t,{e:()=>n,f:()=>o});var i=r(739367);const n="assetResolverService",o=()=>(0,i.l)(n)},228915:(e,t,r)=>{r.d(t,{z:()=>o});var i,n=r(324586);r(379321);let o=(0,r(825702).Gr)()(i=class{constructor(){(0,n.A)(this,"listeners",[]),(0,n.A)(this,"assetListeners",new Map)}registerRehydrateListener(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter((t=>t!==e))}}rehydrateWithFile(e,t){const r=this.assetListeners.get(e.id)??[];for(const e of r)e(t);this.assetListeners.delete(e.id);for(const r of this.listeners)r(e,t)}onRehydrate(e,t){const r=this.assetListeners.get(e)??[];return r.push(t),this.assetListeners.set(e,r),this.unsubscribe.bind(this,e,t)}unsubscribe(e,t){const r=this.assetListeners.get(e)??[];this.assetListeners.set(e,r.filter((e=>e!==t)))}})||i},988839:(e,t,r)=>{r.d(t,{S:()=>w,e:()=>y});var i,n=r(324586),o=r(815731),s=r(673101),a=r(396159),c=r(801330),l=r(197761),d=r(515956),u=r(825702),h=r(562229),p=r(754768),m=r(739367),f=r(871287),g=r(571056),A=r(312148),v=r(228915);let y=(0,u.Gr)()(i=function(e){return(0,u.WQ)(g.e)(e,void 0,0)}((b=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[void 0===p.q?Object:p.q,void 0===v.z?Object:v.z])(i=class{constructor(e,t){(0,n.A)(this,"assets",new o.t([])),(0,n.A)(this,"assetsRequiringHydration$",this.assets.asObservable()),(0,n.A)(this,"requiresHydration$",this.assetsRequiringHydration$.pipe((0,s.T)((e=>e.length>0)),(0,a.F)(),(0,c.t)(1))),this.assetResolverService=e,this.rehydrateEventEmitter=t,this.assetResolverService.assetsWithStatus$("hydration-required").subscribe(this.assets),this.assetsRequiringHydration$.pipe((0,l.p)((e=>e.length>0)),(0,d.s)(1)).subscribe((()=>{h.z.logEvent("Usage - Assets Requiring Relinking"),h.z.logAppLogicEvent("AssetRelinkRequired",{})}))}async rehydrateWithFiles(e,t={errorNoMatch:!0}){const r=await Promise.all(e.map((async e=>{const t=await(0,f.wr)(e.file);return{...e,hash:t}})));let i=0;for(const e of this.assets.value)this.attemptHydrationWithFiles(e,r)&&i++;if(t.errorNoMatch&&0===i)throw new Error("None of the selected files match any missing assets");return i}hashResolvesPendingFetchJob(e,t){return this.assets.value.some((r=>(0,A.q)(r,e,t)[0]))}attemptHydrationWithFiles(e,t){for(const r of t){const{file:t,hash:i,source:n}=r,[o]=(0,A.q)(e,i,t.size);if(o)return this.resolveHydrationRequest(e,t,n),!0}return!1}resolveHydrationRequest(e,t,r){this.rehydrateEventEmitter.rehydrateWithFile(e,{file:t,source:r})}})||i)||i,i=(0,u.WQ)(v.z)(b,void 0,1)||i))||i)||i;var b;const w=()=>(0,m.l)(y)},312148:(e,t,r)=>{r.d(t,{q:()=>n});var i=r(776016);function n(e,t,r){return function(e,t){return e.fileHashes?.original===t||e.fileHashes?.transcode===t}(e,t)?[!0,"hash"]:function(e){return void 0===e?.fileHashes?.original||void 0===e?.fileHashes?.transcode}(e)?[s(e,r),"size"]:[!1,"hash"]}const o=(0,i.t9)({size:(0,i.H7)(i.Et),importedSize:(0,i.H7)(i.Et)});function s(e,t){return"metadata"in e&&o(e.metadata)&&(e.metadata.size===t||"importedSize"in e.metadata&&e.metadata.importedSize===t)}},642959:(e,t,r)=>{r.d(t,{T:()=>a});var i=r(324586),n=(r(379321),r(815731));class o extends Error{constructor(){super("Asset not found")}}class s{constructor(e,t){(0,i.A)(this,"statusStream",new n.t("pending")),(0,i.A)(this,"status$",this.statusStream.asObservable()),(0,i.A)(this,"progress",new n.t({value:0,type:"initial"})),(0,i.A)(this,"progress$",this.progress.asObservable()),this.asset=e,this.handlers=t}get source(){return"chain"}get status(){return this.statusStream.value}cancelJob(){this.statusStream.next("canceled"),this.progress.complete(),this.statusStream.complete()}setProgress(e){const t=Math.min(Math.max(e.value,0),1);this.progress.next({value:t,type:e.type})}retrieveFile(){return this.handlers.reduceRight(((e,t)=>(r,i,n)=>t.handleFetchChain(r,i,((t,r)=>e(t,r,n)))),((e,t,r)=>r(e,t)))({asset:this.asset,onProgress:e=>this.setProgress(e),onStatus:e=>this.statusStream.next(e)},{file:void 0},((e,t)=>Promise.resolve(t))).then((e=>{if(!e.file)throw new o;return e.file}))}setResolved(){this.statusStream.next("resolved"),this.setProgress({value:1,type:"finished"})}}class a{constructor(){(0,i.A)(this,"handlers",[])}register(e){this.handlers.push(e)}createFetchJob(e){return new s(e,this.handlers)}}},578831:(e,t,r)=>{r.d(t,{d:()=>c,u:()=>a});var i=r(324586),n=(r(379321),r(776016)),o=r(696267);const s=(0,n.t9)({generationSequence:(0,n._j)((0,n.t9)({type:n.Kg}))});class a{constructor(e,t){(0,i.A)(this,"source","generation"),(0,i.A)(this,"_id",void 0),this.handlers=e,this.originalAsset=t}static match(e){return s(e)&&e.generationSequence.length>0}static fromAsset(e,t){if(!a.match(t))throw new Error("Asset is not a generated asset");const r=t.generationSequence.map((t=>{for(const r of e)if(r.match(t))return r.create(t)})).filter((e=>void 0!==e));return new a(r,t)}async asset(){return{...this.originalAsset,id:await this.id(),name:this.originalAsset?.name??this.name(),generationSequence:await this.config(),hidden:!0}}findGenerationHandler(e){return this.handlers.find(e)}async id(){if(this._id)return Promise.resolve(this._id);const e=JSON.stringify(await this.config());return this._id=await(0,o.d)((new TextEncoder).encode(`${this.source}/${e}`)),this._id}name(){return""}async config(){return Promise.all(this.handlers.map((e=>e.config())))}async file(e){let t;for(const r of this.handlers)t=await r.handleGeneration(t,{assetId:await this.id(),onProgress:e.onProgress,onStatus:e.onStatus});if(!t)throw new Error("No generation steps matched");return t}addHandler(e){this.handlers.push(e),this._id=void 0}removeHandler(e){this.handlers=this.handlers.filter((t=>t!==e)),this._id=void 0}getHandlers(){return this.handlers}}function c(e){return{handleFetchChain:async(t,r,i)=>{if(!a.match(t.asset))return i(t,r);const n=a.fromAsset(e,t.asset),o=await n.file(t);return i(t,{source:n.source,file:o})}}}},626602:(e,t,r)=>{r.d(t,{D:()=>o});var i=r(324586),n=r(776016);class o{constructor(e){(0,i.A)(this,"assetLookupCache",new WeakMap),(0,i.A)(this,"assetRecoveryCache",new WeakMap),this.caching=e}async performInitialFetch(e){try{return await this.attemptRehydrationViaCache(e)}catch{return await this.recoverFileForCaching(e)}}recoverFileForCaching(e){let t=this.assetRecoveryCache.get(e);return(0,n.O9)(t)||(t=e.retrieveFile().then((async t=>(e.setResolved(),await this.caching.storeAsset(e.asset.id,t)))).catch((t=>{throw this.assetRecoveryCache.delete(e),t})),this.assetRecoveryCache.set(e,t)),t}attemptRehydrationViaCache(e){let t=this.assetLookupCache.get(e);return void 0===t&&(t=new Promise(((t,r)=>{setTimeout((()=>{this.caching.getByAssetID(e.asset.id).then((r=>{e.setResolved(),t(r)}),r)}))})),this.assetLookupCache.set(e,t)),t}}},754768:(e,t,r)=>{r.d(t,{q:()=>u});var i=r(324586),n=r(815731),o=r(811438),s=r(584571),a=r(673101),c=r(477793),l=r(801330),d=r(396159);class u{constructor(e,t,r){(0,i.A)(this,"_fetchJobs",new n.t(new Map)),(0,i.A)(this,"assetStatus$",this._fetchJobs.pipe((0,a.T)((e=>[...e.values()])),(0,c.n)((e=>{const t=e.map((e=>e.status$.pipe((0,a.T)((t=>({status:t,asset:e.asset}))))));return 0===e.length?(0,o.of)([]):(0,s.z)(t)})),(0,l.t)(1))),this.assetFetchJobFactory=e,this.recoveryService=t,this.caching=r}clear(){this._fetchJobs.value.forEach((e=>e.cancelJob())),this._fetchJobs.next(new Map)}fetch(e,t){const r=this.getOrCreateFetchJobForAsset(e);return r.status$.subscribe(t),this.recoveryService.performInitialFetch(r)}getProgress$(e){return this.getOrCreateFetchJobForAsset(e).progress$}jobStatus$(e){return this.getOrCreateFetchJobForAsset(e).status$}assetsWithStatus$(e){return this.assetStatus$.pipe((0,a.T)((t=>t.filter((({status:t})=>e===t)).map((({asset:e})=>e)))),(0,d.F)(((e,t)=>e.length===t.length&&e.every(((e,r)=>e===t[r])))))}remove(e){const t=this._fetchJobs.value,r=t.get(e.id);r&&(this._fetchJobs.next(new Map([...t].filter((([t])=>t!==e.id)))),this.caching.removeFromCache(r.asset.id).catch((e=>console.warn("Failed to remove asset from cache:",e))),r.cancelJob())}getOrCreateFetchJobForAsset(e,t=!0){const r=this._fetchJobs.value;let i=r.get(e.id);return!t&&i&&"resolved"===i.status&&(i=void 0),i||(i=this.assetFetchJobFactory.createFetchJob(e),this._fetchJobs.next(new Map([...r,[e.id,i]]))),i}}},884800:(e,t,r)=>{r.d(t,{d:()=>n});var i=r(871287);class n{constructor(e){this.cachingOrchestrator=e}async getByAssetID(e){return await this.cachingOrchestrator.lookupCachedFile(e)}async lookupAssetIds(e){return await this.cachingOrchestrator.lookupCachedAssets(e)}async importAndStoreWithID(e,t,r){const n=await this.cachingOrchestrator.createNewCachable(e,r);await t(n);const o=await n.getBlobAsFile(),s=await(0,i.wr)(o);return[await this.cachingOrchestrator.cacheCachableFile(e,n),s]}async removeFromCache(e){try{return(await this.getByAssetID(e)).removeFromCache()}catch(t){return console.warn(`Asset with id ${e} does not exist in cache, nothing to delete`,t),!1}}async storeAsset(e,t){return await this.cachingOrchestrator.cacheLocalFile(e,t)}}},186975:(e,t,r)=>{r.d(t,{$:()=>s,u:()=>o});var i=r(2e3),n=r(215363);const o="assetRepository";class s{constructor(e){this.state=e}demoteToLocal(e){this.state.update((t=>{const r=t.assets.byId[e];r&&!(0,i.c)(r)&&(0,n.G)(r)&&(t.assets.byId[e].cloud=void 0)}))}}},625927:(e,t,r)=>{r.d(t,{F:()=>n,u:()=>o});var i=r(7089);function n(){return(0,i.u)()}function o(e,t){return{id:n(),name:e,hidden:!1,cloud:t}}},781828:(e,t,r)=>{r.d(t,{VB:()=>v,h0:()=>b,ii:()=>A,kc:()=>y});var i=r(122643),n=r(942791),o=r(578831),s=r(571056),a=r(889688),c=r(507243),l=r(131512),d=r(474107),u=r(345153),h=r(186975),p=r(114998),m=r(536964),f=r(425793);async function g(e){const t=(0,a.W)(i.g),r=await t.importAssetProvider(e);if(!r)throw new Error("Failed to import asset");const n=(0,a.W)(s.e);return await n.fetch(r),r}async function A(e,t){const r=function(e,t){const r=l.LB.bind(null,(0,a.W)(d.T)),i=(0,c.p_)(e.assetId);if(!i)throw new Error(`Asset with id ${e.assetId} not found`);if((0,m.MW)(i)){const e=(0,p.H6)(i);return e.addHandler(t),e}return new o.u([new n.Z(r,(0,a.W)(s.e),e.assetId),t],r(e.assetId))}(e,t),i=await g(r);return(0,c.sA)(e.id,i.id),y(),i}async function v(e,t){const r=(0,c.p_)(e.assetId);if(!r||!(0,m.MW)(r))return;const i=(0,p.H6)(r),o=i.findGenerationHandler((e=>e instanceof t));if(o&&i.removeHandler(o),i.getHandlers().length>1){const t=await g(i);(0,c.sA)(e.id,t.id)}else{const t=(0,p.XP)(r,n.Z);if(!t)return;const i=t.assetId;(0,c.sA)(e.id,i)}y()}function y(){const e=(0,a.W)(d.T),t=(0,a.W)(s.e),r=(0,a.W)(h.u),i=(0,u.U1)((e=>e.id));if(!i)return;const n=e.read((e=>e.getAllAssets())).filter((e=>(0,m.MW)(e.value))),o=e.read((e=>e.getAllItemsWithAssetIds(n.map((e=>e.id)))));for(const s of n)o.some((e=>e.assetId===s.id))||(0,f.A)(e,t,r,i,s.value)}function b(e,t){const r=(0,p.Qs)(e);return void 0!==r?.findGenerationHandler((e=>e instanceof t))}},536964:(e,t,r)=>{r.d(t,{MW:()=>s,v$:()=>a});var i=r(114998),n=r(942791);const o=e=>(0,i.XP)(e,n.Z);function s(e){return void 0!==o(e)}function a(e,t){return e.read((e=>e.getAllAssets())).filter((e=>function(e,t){const r=o(e);return r?.assetId===t}(e.value,t))).map((e=>e.value))}},425793:(e,t,r)=>{r.d(t,{A:()=>m,X:()=>p}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(562229),n=r(571056),o=r(138615),s=r(422226),a=r(941604),c=r(474107),l=r(507243),d=r(345153),u=r(227565),h=r(536964);function p(){const e=(0,c.U)(),t=(0,n.f)(),r=(0,u.y)(),h=(0,l.M9)();return(0,s.Z)(((n,s,c=!1)=>{if(!h)return;const l=(0,a.lE)();m(e,t,r,h,n),!0!==c&&(0,a.G$)(l,((e,t)=>{(0,o.G7)("editor__user_action_metrics")&&function(e,t){const r=Object.values((0,d.U1)((e=>e.items.byId))??{});(function(e,t){for(const r of t)if(r.assetId===e)return!0;return!1})(e.id,r)&&i.z.logUserActionEvent?.("TimelineItemInteracted",{timelineItemActionType:"itemDeleted",itemType:e.appearAsType??e.type,actionType:t?.actionType||"Unknown",numberOfItems:1,startTimeMs:t?.startTimeMs,durationMs:t?.durationMs,durationNextTickMs:t?.durationNextTickMs})}(n,{durationMs:e?.duration,durationNextTickMs:t?.duration,startTimeMs:e?.startTime,...s})}))}))}function m(e,t,r,i,n,s=new Set){for(const o of(0,h.v$)(e,n.id))s.has(o.id)||(s.add(o.id),m(e,t,r,i,o,s));!function(e,t){e.update((e=>{e.forEachTrack((e=>{e.forEachItem((r=>{r.assetId===t&&e.removeItem(r.id)}))}))}))}(e,n.id),"logo"!==n.appearAsType&&r.deleteUnhandled(n,i),"logo"!==n.appearAsType||(0,o.Us)("multi__brandkit_delete_logo")||r.deleteUnhandled(n,i),t.remove(n)}},279541:(e,t,r)=>{r.d(t,{Dc:()=>a,JZ:()=>d,Sk:()=>l,m8:()=>c});var i=r(187974),n=r(476636),o=r(932808),s=r(776016);function a(e){const t=(0,o.y)(new n.Z(e.width,e.height).mul(function(e){const t=(0,i.$g)(e.raw);if(void 0===t)return new n.Z(1,1);const r=(0,i.xL)(t.sample_aspect_ratio);return Number.isNaN(r)?new n.Z(1,1):r<1?new n.Z(1,1/r):new n.Z(r,1)}(e)),(0,o.tR)(e.rotation));return[t.x,t.y]}function c(e){if(!("metadata"in e&&"width"in e.metadata&&"height"in e.metadata&&(0,s.O9)(e.metadata.width)&&(0,s.O9)(e.metadata.height)))return 1;const t=a(e.metadata);return t[0]&&t[1]?t[0]/t[1]:1}function l(e){const[t,r]=a(e.asset.metadata);return t/r}function d(e){return e.raw.streams.length>0&&"svg"===e.raw.streams[0].codec_name}},859668:(e,t,r)=>{r.d(t,{c:()=>b});var i=r(324586),n=r(825702),o=r(571056),s=r(387427),a=(r(34456),r(159129),r(940233),r(270818),r(513173),r(205218),r(71447)),c=r(673101),l=r(104455);function d(e,t){const r=s.D8*Math.floor(t),i=r+s.D8;return e.subarray(r,i)}function u(e,t){return t<0?s.BP:d(e.data,t)}class h{constructor(e){this.buffer=e}destroy(){this.buffer.stop()}waitForDataAt(e){return t=this.buffer,(r=Math.ceil(e*s.Pn))<t.availableSamples?Promise.resolve():t.sampleProgress$.pipe((0,a.v)((e=>e<r)),(0,c.T)((()=>{}))).toPromise();var t,r}trySampleDataAt(e){return function(e,t){const r=Math.floor(t),i=Math.ceil(t);if(r===i)return u(e,r);const n=u(e,r),o=u(e,i),a=t-r,c=1-a,d=new Uint8Array(s.D8);for(let e=0;e<s.D8;e++){const t=(0,l.qL)(n[e])*c+(0,l.qL)(o[e])*a;d[e]=(0,l.aW)(t)}return d}(this.buffer,e*s.Pn)}}var p=r(217563),m=r(860784);class f{constructor(e,t){(0,i.A)(this,"completePromise",void 0),(0,i.A)(this,"sampleCount",void 0),this.renderContext=e,this.sampleSecs=t;const r=Math.max(0,this.renderContext.length-1)/this.renderContext.sampleRate;this.sampleCount=Math.floor(r/this.sampleSecs)}start(e){if(this.completePromise)throw new Error("Cannot start AudioSampleStream that's already running");const t=new m.z;return this.completePromise=t,e(0),this.renderContext.suspend(this.sampleSecs).then((()=>{this.next(e,1)})),t.watch(this.renderContext.startRendering().then((()=>{}))),t.promise}next(e,t){if(!this.completePromise)return;e(t);const r=t+1;r>=this.sampleCount?this.stop():(this.renderContext.suspend(this.sampleSecs*r).then((()=>{this.next(e,r)})),this.renderContext.resume())}stop(){this.completePromise&&(this.completePromise.resolve(),this.completePromise=void 0)}}function g(e){return function(e){const t=new h(e);return{value:t,free(){t.destroy()}}}(function(e){const t=new p.B,{renderContext:r,analyserNode:i}=function(e){const t=new OfflineAudioContext({numberOfChannels:1,sampleRate:s.sQ,length:e.duration*s.sQ}),r=new AudioBufferSourceNode(t,{buffer:e}),i=new AnalyserNode(t,{fftSize:2*s.D8,smoothingTimeConstant:s.Aq,maxDecibels:s.HJ,minDecibels:s.lf});return r.connect(i),i.connect(t.destination),r.start(),{renderContext:t,analyserNode:i}}(e),n=new f(r,1/s.Pn),o=new Uint8Array(n.sampleCount*s.D8),a={data:o,availableSamples:0,sampleProgress$:t,stop(){n.stop()}};return n.start((e=>{a.availableSamples=e+1,i.getByteFrequencyData(d(o,e)),t.next(e)})).then((()=>{t.complete()})),a}(e))}var A,v=r(701724),y=r(780369);let b=(0,n.Gr)()((w=A=Reflect.metadata("design:type",Function)(A=Reflect.metadata("design:paramtypes",[void 0===v.qI?Object:v.qI])(A=class{constructor(e){(0,i.A)(this,"assetAudioCache",void 0),this.assetAudioCache=new y.j(e,{decodeContext:new AudioContext,createRenderedAudioDataSource:g})}})||A)||A,A=(0,n.WQ)(o.e)(w,void 0,0)||A))||A;var w},780369:(e,t,r)=>{r.d(t,{j:()=>l});var i=r(324586),n=r(374380),o=r(342455),s=r(387427);class a{constructor(e){(0,i.A)(this,"readyInternalSource",void 0),this.sourcePromise=e,e.then((e=>{this.readyInternalSource=e.value}))}destroy(){this.sourcePromise.then((e=>e.free()))}async waitForDataAt(e){return(await this.sourcePromise).value.waitForDataAt(e)}trySampleDataAt(e){return this.readyInternalSource?this.readyInternalSource.trySampleDataAt(e):s.BP}}var c=r(989230);class l{constructor(e,t){(0,i.A)(this,"audioSourceCache",o.w.create().value),this.assetResolver=e,this.platform=t}getSource(e){return this.audioSourceCache.get(e.id,(()=>function(e){const t=new a(e);return{value:t,free(){t.destroy()}}}(function(e,t,r){return t.fetch(e).then((t=>(0,c.J)(r.decodeContext,t,e.metadata.raw,(()=>{})))).then(r.createRenderedAudioDataSource).catch((t=>(console.warn(`Failed to build audio data for asset ${e.id}`,t),{value:(0,n.N)(),free(){}})))}(e,this.assetResolver,this.platform))))}}},776303:(e,t,r)=>{r.d(t,{h:()=>V,k:()=>G});var i=r(324586),n=r(217563),o=r(825702),s=r(562229),a=r(187974),c=r(126714),l=r(268774),d=r(730427),u=r(138615),h=r(889688),p=r(739367),m=r(272908),f=r(573340),g=r(345153),A=r(788855),v=r(36366),y=r(944355);function b(e,t){return Math.ceil(e/t)*t}var w=r(801080),x=r(871287),S=r(7089),T=r(650882),C=r(699276),_=r(20106),k=r(105850),E=r(459212),I=r(847269),R=r(973622),F=r(672021);let P;var L,N=r(638118),M=r(464764),B=r(375356),D=r(261719),O=r(53898),j=r(167251),U=r(107042);function z(e,t,r){const i={duration:t.duration,size:e.metadata.size,importedSize:t.size,creationTime:e.metadata.creationTime};if("video"===e.type&&(n=t)&&"number"==typeof n.rotation&&"number"==typeof n.width&&"number"==typeof n.height){const n=(0,a.yL)(e.metadata.raw),o=(0,a.yL)(t.raw),s=r.transcodeVideo||n?.codec_name!==o?.codec_name;return{...i,rotation:s?0:e.metadata.rotation,width:s?t.width:e.metadata.width,height:s?t.height:e.metadata.height}}var n;return i}const W=1048576;let V=(0,o.Gr)()(L=function(e){return(0,o.WQ)(C.dk)(e,void 0,0)}((H=L=Reflect.metadata("design:type",Function)(L=Reflect.metadata("design:paramtypes",[void 0===C.dk?Object:C.dk,void 0===m.e?Object:m.e])(L=class{constructor(e,t){(0,i.A)(this,"convertingAsset$",new n.B),this.caching=e,this.nativeAppCapabilitiesService=t}isHevcDisabled(){return!0===this.nativeAppCapabilitiesService.capabilities?.ren__disable_hevc}isHeifImage(e){return"image/heic"===e.type||"image/heif"===e.type}async correctFileEventProperties(e,t){const r=await(0,E.c)(t);return e.mimeType=(0,y.a)(r.mime),e.fileSupport=r.support,(0,E.J)(t,r)}updateAssetEventProperties(e,t){const r=(0,a.$g)(t.metadata.raw),i=(0,c.xF)(t.metadata.raw),n="audio"===t.type?void 0:t.metadata,o=Number.parseInt(t.metadata.raw.format.size??"");Number.isNaN(o)||(e.fileSizeBytes=b(o,100)),Object.assign(e,{fileSupport:(0,U.nv)(t.metadata.raw),assetType:t.type,containerFormat:t.metadata.raw.format.format_name,videoCodec:r?.codec_name,audioCodec:i?.codec_name,pixelFormat:r?.pix_fmt,sampleFormat:i?.sample_fmt,durationSeconds:"image"===t.type?void 0:t.metadata.duration,pixelWidth:n?.width,pixelHeight:n?.height,pixelCount:void 0===n?void 0:n?.width*n?.height,aspectRatio:void 0===n?void 0:n?.width/n?.height,frameRate:(0,a.at)(r?.avg_frame_rate)||void 0,colorRange:r?.color_range,colorSpace:r?.color_space,colorTransfer:r?.color_transfer})}async attemptCacheFile(e,t,r,i){let n,o;if(t=await this.correctFileEventProperties(i,t),this.logImportStarted(i),(0,A.N)(e)&&(n=e.metadata),this.isHeifImage(t)){if(this.isHevcDisabled())throw new j.vo("heic");const{pngFile:r,safeImageAsset:o}=await async function(e,t,r){void 0===P&&(P=(0,h.W)(F.K));const[i,n]=P;let o;try{o=(await n.requestAndExpectResponse("decode",{blob:e})).imageData}catch(e){throw console.warn(e),i.terminate(),P=void 0,e}const s=await function(e){return new Promise(((t,r)=>{const i=document.createElement("canvas");i.width=e.width,i.height=e.height,(0,I.sw)(i.getContext("2d"),"Failed to create 2D context").putImageData(e,0,0),i.toBlob((e=>{null===e?r(new Error("Failed to convert HEIF image data to PNG")):t(e)}))}))}(o),a=new File([s],e.name,{type:"image/png",lastModified:e.lastModified}),c=await(0,R.bS)((0,l.A)(a));return{safeImageAsset:{...t,type:"image",metadata:{...r,...c,size:e.size,importedSize:c.size}},pngFile:a}}(t,e,n);return this.updateAssetEventProperties(i,o),this.logImportAttempt(i),await this.storeImage(o,new File([r],t.name,{type:"image/png"}))}const s=(0,l.A)(t);try{o=await(0,R.AT)(s,"media")}catch(r){throw(0,U.TT)(i.fileSupport)?r:new j.Us(t,e,r)}const d=function(e){return void 0!==(0,a.yL)(e)?"video":void 0!==(0,c.xF)(e)?"audio":void 0!==(0,a.$g)(e)?"image":void 0}(o);if(void 0===d)throw new j.Us(t,e);if("image"===d){const r={...e,type:d,metadata:{...n,...await(0,O.ME)(s,o)}};return this.updateAssetEventProperties(i,r),this.logImportAttempt(i),await this.storeImage(r,t)}if((0,k.cV)(o)&&this.isHevcDisabled())throw new j.vo("hevc");{const c={loop:"gif"===(0,a.yL)(o)?.codec_name,...e,...(0,v.k)(d,(0,O.NN)(s,o,n))};return this.updateAssetEventProperties(i,c),this.logImportAttempt(i),await this.storeMedia(c,t,r)}}async storeImage(e,t){const r=await(0,B.P)(t,e.metadata.raw);if(r){const[i,n]=await this.caching.importAndStoreWithID(e.id,(i=>(0,N.v)(t,e.metadata.raw,i,r)),t.name);return async function(e,t){const r=t.metadata,i=e.getTranscoderInputFile(),n=await(0,R.bS)(i),o={...n,size:r.size,importedSize:n.size,creationTime:r.creationTime};return{cachedFile:e,asset:{...t,metadata:o},inputAsset:t,transcoded:!0}}(i,e={...e,fileHashes:{...e.fileHashes,transcode:n}})}{if(e.fileHashes){const r=await(0,x.wr)(t);e=e.fileHashes.original!==r?{...e,fileHashes:{...e.fileHashes,transcode:r}}:{...e,fileHashes:{...e.fileHashes,transcode:null}}}const r=await this.caching.storeAsset(e.id,t);return{asset:e,inputAsset:e,cachedFile:r,transcoded:!1}}}async importAndStoreMedia(e,t,r,i,n){const[o,s]=await this.caching.importAndStoreWithID(t,(t=>(0,M.j)({source:"local",file:r,size:r.size,name:r.name},e.metadata.raw,t,i.importOptions,n)),r.name);return async function(e,t,r){const i=await(0,R.sw)(e.getTranscoderInputFile());(0,D.qN)(i.raw),(0,u.Us)("ks_pst__ensure_audio_duration")||(0,D.T9)(i.raw);const n={...i,...z(t,i,r.importOptions)};return{cachedFile:e,asset:{...t,...(0,v.k)(t.type,n)},inputAsset:t,transcoded:!0,transcodeReason:r.transcodeReason}}(o,e={...e,fileHashes:{...e.fileHashes,transcode:s}},i)}async storeMedia(e,t,r){const i=await(0,B.U)(t,e.metadata.raw);return i?(this.convertingAsset$.next(),await this.importAndStoreMedia(e,e.id,t,i,r)):(e.fileHashes&&(e={...e,fileHashes:{...e.fileHashes,transcode:null}}),(0,u.Us)("ks_pst__ensure_audio_duration")||((0,D.qN)(e.metadata.raw),(0,D.T9)(e.metadata.raw)),{cachedFile:await this.caching.storeAsset(e.id,t),asset:e,inputAsset:e,transcoded:!1})}async cacheFile(e,t,r,i,n=!0){const o=performance.now(),s={correlationId:(0,S.u)(),fileSizeBytes:b(t.size,100),mimeType:(0,y.a)(t.type),fileExtension:(0,w.v)((0,_.R9)(t)),source:r,fileSupport:"unsupported"};try{if(n&&void 0===e.fileHashes?.original){const r=await(0,x.wr)(t);e.fileHashes={...e.fileHashes,original:r}}const r=await this.attemptCacheFile(e,t,i,s),a=(performance.now()-o)/1e3;return this.logImportSuccess(s,r,a),r}catch(e){(0,u.G7)("iet__log_import_errors")&&f.Vy.error(e);const t=(performance.now()-o)/1e3;throw this.logImportError(s,t,e),e}}async cacheRecoveryFile(e,t,r,i){const n=await this.cacheFile(e,t,r,i,!1);return n.asset={...n.asset,fileHashes:e.fileHashes},(0,A.N)(e)&&(n.asset.metadata={...n.asset.metadata,size:e.metadata.size}),n}logImportStarted(e){s.z.logEvent("Usage - Started Import",{...e}),s.z.logUserActionEvent("MediaImportStarted",{actionType:"Unknown",...e})}logImportAttempt(e){s.z.logEvent("Logging - Import Attempt",{...e}),s.z.logAppLogicEvent("MediaImportAttempted",{...e})}logImportSuccess(e,t,r){const i={...e};this.updateAssetEventProperties(e,t.asset),e.fileSupport=i.fileSupport,s.z.logEvent("Logging - Import Success",{...e,inputContainerFormat:i.containerFormat,inputVideoCodec:i.videoCodec,inputAudioCodec:i.audioCodec,inputFileSizeBytes:i.fileSizeBytes,transcoded:t.transcoded,transcodeReason:t.transcodeReason,inputProcessing:this.getInputProcessing(e,i,t.transcoded),importTimeSeconds:r,importTimeToDurationRatio:void 0===e.durationSeconds?void 0:r/e.durationSeconds,fileSizeToVideoDurationRatio:void 0===e.durationSeconds?void 0:i.fileSizeBytes/W/e.durationSeconds}),s.z.logAppLogicEvent("MediaImportCompleted",{...e,transcoded:t.transcoded,importTimeSeconds:r,importTimeToVideoDurationRatio:void 0===e.durationSeconds?void 0:r/e.durationSeconds,fileSizeToVideoDurationRatio:void 0===e.durationSeconds?void 0:i.fileSizeBytes/W/e.durationSeconds}),(0,h.W)(d.E)("Floodgate.MediaImportCompleted")}logImportError(e,t,r){const{assets:i,tracks:n}=(0,g.U1)((e=>e))??{},o=i?.allIds&&i.allIds.length>0,a=n?.allIds&&n.allIds.length>0;s.z.logEvent((0,U.TT)(e.fileSupport)?"Error - Import Failed":"Error - Import Not Supported",{...e,importTimeSeconds:t,error:r instanceof Error?r.message:`${r}`,isEmptyProject:!(o||a),...r instanceof T.g9?r.toEventProperties():{}}),(0,U.TT)(e.fileSupport)?s.z.logErrorEvent("MediaImportFailed",{errorAlertType:"Fatal",...e,importTimeSeconds:t,stack:r instanceof Error?r.stack:void 0}):s.z.logWarningEvent("MediaImportNotSupported",{errorAlertType:"Warning",...e,importTimeSeconds:t,stack:r instanceof Error?r.stack:void 0})}getInputProcessing(e,t,r){return r?e.audioCodec!==t.audioCodec?e.videoCodec!==t.videoCodec?"full-transcode":"audio-transcoded":e.videoCodec!==t.videoCodec?"full-transcode":"repackaged":"unchanged"}})||L)||L,L=(0,o.WQ)(m.e)(H,void 0,1)||L))||L)||L;var H;const G=()=>(0,p.l)(V)},167251:(e,t,r)=>{r.d(t,{HJ:()=>a,Us:()=>n,ph:()=>o,vo:()=>s});var i=r(650882);class n extends i.g9{constructor(e,t,r){let i;void 0!==r&&(i=r instanceof Error?r.message:String(r)),super("Provided file is not a type that can be cached.",{originalError:i}),console.error(`Error storing ${e.size}-byte file for asset ${t.name} (${t.id}) in cache`)}}class o extends i.g9{constructor(e,t){super(t?`${t.title} ${t.message}`:""),this.asset=e,this.toastConfig=t}}class s extends i.g9{constructor(e){super(`${e} support is disabled`,{disabledCodec:e}),this.disabledCodec=e}}class a extends i.g9{constructor(e){super("Ignore resolving the provided asset",{asset:e})}}},107042:(e,t,r)=>{r.d(t,{Ag:()=>u,TT:()=>o,nv:()=>l}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(187974),n=r(126714);function o(e){switch(e){case"supported":case"maybe-supported":return!0;default:return!1}}const s=new Set(["image2","png_pipe","jpeg_pipe","bmp_pipe","tiff_pipe","webp_pipe","svg_pipe","gif","ogg","flac","matroska,webm","aac","mp3","mpeg","mpegts","mov,mp4,m4a,3gp,3g2,mj2","wav","avi","asf","amr","dv"]),a=new Set(["png","mjpeg","bmp","tiff","webp","svg","gif","vp8","vp9","mpeg1video","mpeg2video","mpeg4","h263","h264","hevc","msmpeg4v1","msmpeg4v2","msmpeg4v3","wmv1","wmv2","wmv3","wmv3image","mss1","mss2","qtrle","prores","rawvideo","vc1","vc1image","dvvideo"]),c=new Set(["vorbis","opus","flac","mp1","mp2","mp3","aac","wmav1","wmav2","wmapro","wmalossless","wmavoice","dts","ac3","eac3","truehd","gsm","gsm_ms","amr_nb","alac"]);function l(e){const t=e.format.format_name;if(void 0===t||!s.has(t))return"unsupported";const r=(0,i.$g)(e)?.codec_name;let o=!0;void 0===r||a.has(r)||(o=!1);const l=(0,n.xF)(e)?.codec_name;return void 0===l||c.has(l)||l.startsWith("pcm_")||l.startsWith("adpcm_")?o?void 0===r&&void 0===l?"unsupported":"supported":"unsupported-video":o?"unsupported-audio":"unsupported"}const d=new Set(["image/png","image/jpeg","image/bmp","image/tiff","image/webp","image/svg+xml","image/gif","audio/ogg","audio/opus","audio/x-flac","video/x-matroska","video/webm","audio/aac","audio/mpeg","video/mpeg","video/MP1S","video/MP2P","video/mp2t","video/quicktime","audio/mp4","video/mp4","audio/x-m4a","video/3gpp","audio/wav","video/vnd.avi","audio/x-ms-asf","video/x-ms-asf","audio/amr"]);function u(e){return d.has(e)?"maybe-supported":"unsupported"}},134150:(e,t,r)=>{r.d(t,{k:()=>o});var i=r(324586),n=r(815731);class o{get status(){return this.statusStream.value}constructor(e){(0,i.A)(this,"progress$",void 0),(0,i.A)(this,"status$",void 0),(0,i.A)(this,"statusStream",new n.t("pending")),(0,i.A)(this,"progress",new n.t({value:0,type:"initial"})),this.asset=e,this.status$=this.statusStream.asObservable(),this.progress$=this.progress.asObservable()}cancelJob(){this.statusStream.next("canceled"),this.progress.complete(),this.statusStream.complete()}setProgress(e){const t=Math.min(Math.max(e.value,0),1);this.progress.next({value:t,type:e.type})}setResolved(){this.statusStream.next("resolved"),this.setProgress({value:1,type:"finished"})}}},859730:(e,t,r)=>{r.d(t,{H:()=>h,a:()=>p});var i=r(825702),n=r(642959),o=r(578831),s=r(228915),a=r(186749),c=r(639327),l=r(352536),d=r(924388);const u="assetFetchJobRegistry",h="getGraphTokenCallback",p=(e=[],t)=>{i.kL.register(u,{useToken:n.T},{lifecycle:i.v0.Singleton}),(0,a.b)(e),(e=>{const t=i.kL.resolve(u);e&&e(t),t.register((0,l.s)(i.kL.resolve(c.wz))),t.register((0,o.d)(i.kL.resolve(a._))),t.register((0,d.K)(i.kL.resolve(s.z)))})(t)}},352536:(e,t,r)=>{r.d(t,{T:()=>p,s:()=>m});var i=r(615101),n=r(324586),o=r(312148),s=r(860784),a=r(948550),c=r(134150);class l extends Error{constructor(){super("No selected files matched for local asset fetch job")}}class d extends c.k{}class u extends d{constructor(e){super(e),(0,n.A)(this,"source","rehydrate"),(0,n.A)(this,"hydrationRequest",void 0),(0,n.A)(this,"relinkReference",void 0)}attemptHydrationWithFiles(e){let t=0;for(const r of e){const{file:e,hash:i,source:n}=r,[s]=(0,o.q)(this.asset,i,e.size);if(s){this.resolveHydrationRequest(e,n);break}t++}if(t===e.length)throw new l}resolveHydrationRequest(e,t){this.relinkReference=t,this.statusStream.next("resolved"),this.hydrationRequest&&this.hydrationRequest.resolve(e)}cancelJob(){this.hydrationRequest&&this.hydrationRequest.reject(new a.me),super.cancelJob()}retrieveFile(){return this.hydrationRequest||(this.hydrationRequest=new s.z),this.statusStream.next("hydration-required"),this.hydrationRequest.promise}}class h extends Error{constructor(e){super(e)}}class p extends u{constructor(e,t){super(e),this.remote=t,this.source=function(e){if("cloud"in e)return e.cloud?.provider}(e)??this.source}async retrieveFile(){this.statusStream.next("downloading"),this.setProgress({value:0,type:"downloading"});try{return await this.remote.fetchAsset(this.asset,{progress:e=>this.setProgress({value:e,type:"downloading"})})}catch(e){if(this.setProgress({value:0,type:"initial"}),this.asset.cloud?.provider&&["videoblocks","hubble"].includes(this.asset.cloud?.provider))throw this.statusStream.next("stock-unavailable"),new h((0,i.vU)("Asset unavailable"));if("clipgcloud"===this.asset.cloud?.provider)throw this.statusStream.next("logo-unavailable"),new h((0,i.vU)("Brand asset unavailable"));throw e}}}const m=e=>({handleFetchChain:async(t,r,i)=>{const n=t.asset;if(!(e=>"cloud"in e&&void 0!==e.cloud)(n))return i(t,r);const o=new p(n,e);return o.progress$.subscribe((e=>t.onProgress?.(e))),o.status$.subscribe((e=>t.onStatus?.(e))),o.retrieveFile().then((e=>({file:e,source:n.cloud.provider}))).catch((e=>{if(e instanceof h)throw e;return i(t,r)}))}})},924388:(e,t,r)=>{r.d(t,{K:()=>c});var i=r(324586),n=r(860784),o=r(948550),s=r(134150);class a extends s.k{constructor(e,t){super(t),(0,i.A)(this,"source","rehydrate"),(0,i.A)(this,"hydrationRequest",void 0),(0,i.A)(this,"relinkReference",void 0),this.rehydrateEventEmitter=e}cancelJob(){this.hydrationRequest&&this.hydrationRequest.reject(new o.me),super.cancelJob()}retrieveFile(){return this.hydrationRequest||(this.hydrationRequest=new n.z,this.statusStream.next("hydration-required"),this.rehydrateEventEmitter.onRehydrate(this.asset.id,(({file:e,source:t})=>{this.resolveHydrationRequest(e,t)}))),this.hydrationRequest.promise}resolveHydrationRequest(e,t){this.relinkReference=t,this.hydrationRequest&&this.hydrationRequest.resolve(e)}}const c=e=>({handleFetchChain:async(t,r,i)=>{const n=await i(t,r);if(void 0!==n.file)return n;const o=new a(e,t.asset);return o.progress$.subscribe((e=>t.onProgress(e))),o.status$.subscribe((e=>t.onStatus(e))),{file:await o.retrieveFile(),source:"rehydrate"}}})},573878:(e,t,r)=>{r.d(t,{D:()=>f,Y:()=>A});var i,n=r(324586),o=(r(379321),r(825702)),s=r(626602),a=r(138615),c=r(739367),l=r(788855),d=r(776016),u=r(776303),h=r(699276),p=r(32737),m=r(20106);let f=(0,o.Gr)()(i=function(e){return(0,o.WQ)(u.h)(e,void 0,0)}((g=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[void 0===u.h?Object:u.h,void 0===h.dk?Object:h.dk])(i=class extends s.D{constructor(e,t){super(t),(0,n.A)(this,"metadataListeners",[]),this.assetCaching=e}recoverFileForCaching(e){let t=this.assetRecoveryCache.get(e);return(0,d.O9)(t)||(t=e.retrieveFile().then((async t=>{const r=await this.assetCaching.cacheRecoveryFile(e.asset,t,e.source,(t=>e.setProgress({value:t,type:"transcoding"}))),i=this.updateRotationMetadata(e.asset,r.asset);return(0,d.O9)(i)&&this.metadataListeners.forEach((e=>e(i))),e.setResolved(),r.cachedFile})).catch((t=>{throw this.assetRecoveryCache.delete(e),t})),this.assetRecoveryCache.set(e,t)),t}async performInitialFetch(e){if((0,a.G7)("ren__blobs_in_export")){let t=await super.performInitialFetch(e);try{await(0,m.Ii)(t)}catch{this.assetLookupCache.delete(e),this.assetRecoveryCache.delete(e),t=await super.performInitialFetch(e);try{await(0,m.Ii)(t)}catch{this.assetLookupCache.delete(e),this.assetRecoveryCache.delete(e),p.V2.delete(e.asset.id),t=await super.performInitialFetch(e),await(0,m.Ii)(t)}}return t}return super.performInitialFetch(e)}registerMetadataListener(e){return this.metadataListeners.push(e),()=>{this.metadataListeners=this.metadataListeners.filter((t=>t!==e))}}updateRotationMetadata(e,t){if((0,l.N)(t))return"video"===t.type?{id:t.id,type:t.type,loop:t.loop,metadata:{...t.metadata,rotation:e.metadata.rotation}}:{id:t.id,type:t.type,loop:t.loop,metadata:t.metadata}}})||i)||i,i=(0,o.WQ)(h.dk)(g,void 0,1)||i))||i)||i;var g;function A(){return(0,c.l)(f)}},701724:(e,t,r)=>{r.d(t,{So:()=>A,j7:()=>g,qI:()=>v});var i,n=r(324586),o=r(217563),s=r(584571),a=r(811438),c=r(477793),l=r(673101),d=r(801330),u=r(825702),h=r(642959),p=r(754768),m=r(573878),f=r(699276);function g(e){return"video"===e.type||"image"===e.type||"audio"===e.type}const A="assetFetchJobRegistry";let v=(0,u.Gr)()(i=function(e){return(0,u.WQ)(A)(e,void 0,0)}(i=function(e){return(0,u.WQ)(m.D)(e,void 0,1)}((y=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[void 0===h.T?Object:h.T,void 0===m.D?Object:m.D,void 0===f.dk?Object:f.dk])(i=class extends p.q{constructor(e,t,r){super(e,t,r),(0,n.A)(this,"assetsRequiringReplacing$",void 0),(0,n.A)(this,"destroyed$",new o.B),(0,n.A)(this,"requiresReplacing$",void 0),this.requiresReplacing$=this._fetchJobs.pipe((0,c.n)((e=>{const t=[...e.values()].map((e=>e.status$));return(0,s.z)([(0,a.of)("resolved"),...t])})),(0,l.T)((e=>e.includes("stock-unavailable"))),(0,d.t)(1)),this.assetsRequiringReplacing$=this.requiresReplacing$.pipe((0,c.n)((()=>this._fetchJobs)),(0,l.T)((e=>[...e.values()].reduce(((e,t)=>"stock-unavailable"===t.status?[...e,t]:e),[]))),(0,d.t)(1))}clear(){this.destroyed$.next(),this.destroyed$.complete(),super.clear()}getOrCreateFetchJobForAsset(e,t){if(!g(e))throw new Error("The provided asset is not fetchable.");return super.getOrCreateFetchJobForAsset(e,t)}recoverAssetMedia(e){const t=this.getOrCreateFetchJobForAsset(e,!1);return this.recoveryService.recoverFileForCaching(t)}})||i)||i,i=(0,u.WQ)(f.dk)(y,void 0,2)||i))||i)||i)||i;var y},594012:(e,t,r)=>{r.d(t,{P:()=>A,x:()=>f});var i,n=r(324586),o=r(825702),s=r(562229),a=r(186975),c=r(739367),l=r(573340),d=r(644069),u=r(776303),h=r(167251),p=r(103179),m=r(639327);let f=(0,o.Gr)()(i=function(e){return(0,o.WQ)(a.u)(e,void 0,0)}(i=function(e){return(0,o.WQ)(m.wz)(e,void 0,1)}(i=function(e){return(0,o.WQ)(u.h)(e,void 0,2)}((g=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[void 0===a.$?Object:a.$,void 0===m.wz?Object:m.wz,void 0===u.h?Object:u.h,void 0===p.N?Object:p.N])(i=class{constructor(e,t,r,i){(0,n.A)(this,"errorHandler",void 0),this.assetRepository=e,this.remote=t,this.assetCaching=r,this.placeholder=i}async importRemoteAsset(e,t,r,i){this.placeholder.assetPlaceholderExists(t.id)||this.placeholder.createPlaceholderForAsset(t.id,t.name,t.cloud);try{const r=await this.remote.fetchAsset(t,{progress:e=>this.placeholder.setProgressForAsset(t.id,e)}),i=!(0,d.KG)(t.cloud.provider),{asset:n}=await this.assetCaching.cacheFile(t,r,t.cloud.provider,(e=>{this.placeholder.setProgressForAsset(t.id,e)}),i);return this.assetRepository.upsertUnhandled(n),s.z.logEvent("Usage - assets added to project",{id:n.id,project_id:e,type:n.type}),n}catch(e){if(e instanceof h.HJ||e instanceof m.s8)return void l.Vy.log(e);if(l.Vy.error(e),e instanceof h.Us)this.errorHandler?.(e);else{if(i)throw e;s.z.logEvent("Error - Adding Stock Failed",{id:t.cloud?.id}),this.errorHandler?.(e,r)}return}finally{this.placeholder.deletePlaceholderForAsset(t.id)}}setErrorHandler(e){this.errorHandler=e}})||i)||i,i=(0,o.WQ)(p.N)(g,void 0,3)||i))||i)||i)||i)||i;var g;const A=()=>(0,c.l)(f)},350025:(e,t,r)=>{r.d(t,{B6:()=>C,T6:()=>S,ZQ:()=>T});var i=r(324586),n=(r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(815731)),o=r(217563),s=r(720291),a=r(811438),c=r(565493),l=r(343314),d=r(719296),u=r(562229),h=r(138615),p=r(739367),m=r(571511),f=r(489077),g=r(225304),A=r(644069),v=r(7089),y=r(650882),b=r(615101),w=r(776016),x=r(757013);const S="assetUploadService";class T{constructor(e,t,r){(0,i.A)(this,"statusMap",{cloudbackup:{}}),(0,i.A)(this,"status",new n.t(this.statusMap)),(0,i.A)(this,"assets$",void 0),(0,i.A)(this,"jobs",new o.B),(0,i.A)(this,"providers",{}),(0,i.A)(this,"error$",void 0),(0,i.A)(this,"_error$",new o.B),this.assetRecovery=e,this.assetResolver=t,this.rehydrateEventEmitter=r,this.assets$=(0,f.Eu)(),this.error$=this._error$.asObservable(),r.registerRehydrateListener(((e,r)=>{t.fetch(e,(t=>{"resolved"===t&&setTimeout((()=>{this.cancelUpload("cloudbackup",e.id),this.isBackupEnabled()&&this.queueOrCompleteUpload(e)}),10)}))}))}registerUploadSubscriptions(){this.jobs.pipe((0,c.H)((e=>this.registerUploadAsset(e)))).subscribe(),this.assets$.subscribe((e=>this.handleProjectAssets(e)))}clearAssetQueue(e){this.statusMap[e]={},this.status.next(this.statusMap)}queueAssetUpload(e,t){this.isAssetAlreadyQueued(e,t)||(this.logUploadQueuedEvent(e,t),this.newAssetStatus(t,e),this.jobs.next({service:e,asset:t}))}cancelUpload(e,t){const r=this.statusMap[e][t];r&&(delete this.statusMap[e][t],r.cancelObservable.next(),r.cancelObservable.complete(),this.status.next(this.statusMap))}uploadInProgress(e){for(const[t,r]of Object.entries(this.statusMap))if(!e||e===t)for(const e of Object.values(r)){const t=e?.uploadPercent||0;if(t>=0&&t<1)return!0}return!1}clearUploadJobs(){for(const e of Object.keys(this.statusMap)){for(const t of Object.keys(this.statusMap[e]))this.cancelUpload(e,t);this.clearAssetQueue(e)}}isAssetAlreadyQueued(e,t){return void 0!==this.statusMap[e][t.id]}registerUploadAsset(e){const t=(0,v.u)();this.logUploadStartEvent(e,t);const r=this.statusMap[e.service][e.asset.id]?.cancelObservable;return r?(0,s.H)(this.attemptAssetUpload(e,r,t)).pipe((0,l.Q)(r),(0,d.W)((r=>(this.handleAssetUploadError(r,e,t),(0,h.G7)("pst__asset_upload_retry")&&r instanceof g.j$&&404===r.status&&(this.logUploadRetryEvent(e,t),this.cancelUpload(e.service,e.asset.id)),(0,a.of)())))):(this.logUploadFailureEvent("Asset missing from status map",e,"StatusMap",t),(0,a.of)())}async attemptAssetUpload(e,t,r){if(await this.performAssetUpload(e),t.isStopped)this.logUploadCancelledEvent(e,r);else if(this.logUploadSuccessEvent(e,r),this.statusMap[e.service][e.asset.id]){const t=this.getAssetUploadSize(e.asset);this.setAssetStatus(e.asset,e.service,1,t,t)}}handleAssetUploadError(e,t,r){if(e instanceof x.Kh)this.logUploadRequestErrorEvent(e,t,r);else if(e instanceof x.cv)this.logUploadUnlinkedWarningEvent(e.message,t,r);else if(e instanceof x.gL)this.logUploadCacheFetchErrorEvent(e,t,r);else if(e instanceof g.j$)this.logUploadFailureEvent(e.response.statusText,t,"Http",r,e.status);else if(e instanceof g.Dr){const i=e.originalError instanceof Error?e.originalError.message:"Unknown Network Error";this.logUploadFailureEvent(i,t,"Network",r)}else e instanceof x.Nm?this.logUploadFailureEvent(e.message,t,"QuotaExceeded",r):e instanceof x.YW?this.logUploadFailureEvent(e.message,t,"AssetUndefined",r):e instanceof x.lq?this.logUploadFailureEvent(e.message,t,"ProjectItemNotSet",r):e instanceof m.S?this.logUploadFailureEvent(e.message,t,"FailedTypeCheck",r):this.logUploadFailureEvent(e.message,t,"Unknown",r);this._error$.next(e),this.setAssetStatus(t.asset,t.service,-1,0,this.getAssetUploadSize(t.asset))}async performAssetUpload(e){const t=this.providers[e.service];if(void 0===t)throw new Error(`Unhandled upload provider ${e.service}`);const r=this.statusMap[e.service][e.asset.id];if(!r)throw new y.g9((0,b.vU)("Failed to get status for asset"),{assetId:e.asset.id});return this.setAssetStatus(e.asset,e.service,0,0,this.getAssetUploadSize(e.asset)),t.uploadAsset(e.asset,((t,r)=>{this.setAssetStatus(e.asset,e.service,t/r,t,r)}),r.cancelObservable)}newAssetStatus(e,t){this.statusMap[t][e.id]={asset:e,service:t,cancelObservable:new o.B,loaded:0,total:this.getAssetUploadSize(e)},this.status.next(this.statusMap)}setAssetStatus(e,t,r,i,n){const o=this.statusMap[t][e.id];o&&(this.statusMap[t][e.id]={...o,loaded:i,total:n,uploadPercent:r,error:-1===r?"unknown error":void 0},this.status.next(this.statusMap))}getAssetUploadSize(e){return this.getMetadataImportedSize(e)??this.getMetadataSize(e)??0}getMetadataImportedSize(e){return"metadata"in e&&"importedSize"in e.metadata?e.metadata.importedSize:void 0}getMetadataSize(e){return"metadata"in e?e.metadata.size:void 0}queueOrCompleteUpload(e){if(void 0===e.cloud||(0,A.NT)(e.cloud.provider))this.queueAssetUpload("cloudbackup",e);else if("cloudbackup"===e.cloud.provider){const t=this.getAssetUploadSize(e);this.setAssetStatus(e,"cloudbackup",1,t,t)}}cancelUnavailableAssetUploads(e){const t=new Set(e.map((e=>e.id)));for(const e of Object.keys(this.statusMap.cloudbackup))t.has(e)||this.cancelUpload("cloudbackup",e)}formatAnalyticsData(e){return{provider:e.service,assetType:e.asset.type,originalSize:this.getMetadataSize(e.asset)??0,importedSize:this.getMetadataImportedSize(e.asset)}}logUploadQueuedEvent(e,t){const r=this.formatAnalyticsData({asset:t,service:e});u.z.logAppLogicEvent("MediaUploadQueued",r),u.z.logEvent("Sync - Asset Upload Queued",r)}logUploadStartEvent(e,t){const r=this.formatAnalyticsData(e);u.z.logAppLogicEvent("MediaUploadStarted",{...r,correlationId:t}),u.z.logEvent("Sync - Asset Upload Start",r)}logUploadSuccessEvent(e,t){const r=this.formatAnalyticsData(e);u.z.logAppLogicEvent("MediaUploadCompleted",{...r,correlationId:t}),u.z.logEvent("Sync - Asset Upload Success",r)}logUploadCancelledEvent(e,t){const r=this.formatAnalyticsData(e);u.z.logAppLogicEvent("MediaUploadCancelled",{...r,correlationId:t}),u.z.logEvent("Sync - Asset Upload Cancelled",r)}logUploadRetryEvent(e,t){const r=this.formatAnalyticsData(e);u.z.logAppLogicEvent("MediaUploadRetry",{...r,correlationId:t}),u.z.logEvent("Sync - Retry Asset Upload",r)}logUploadRequestErrorEvent(e,t,r){u.z.logEvent("Error - Sync Asset Upload Failure",{reason:e.message,requestType:e.requestType,...this.formatAnalyticsData(t)})}logUploadCacheFetchErrorEvent(e,t,r){const i=this.formatAnalyticsData(t);u.z.logErrorEvent("MediaUploadFailed",{...i,errorAlertType:"Fatal",errorType:"CacheFetch",correlationId:r}),u.z.logEvent("Error - Sync Asset Upload Failure",{reason:e.message,fetchedMimeType:e.assetMimeType,fetchedSize:e.assetSize,...i})}logUploadFailureEvent(e,t,r,i,n){const o=this.formatAnalyticsData(t);switch(u.z.logErrorEvent("MediaUploadFailed",{...o,errorAlertType:"Fatal",errorType:r,errorCode:(0,w.Et)(n)?`${n}`:void 0,correlationId:i}),r){case"StatusMap":u.z.logEvent("Error - Sync StatusMap Missing Job Asset",o);break;case"Network":u.z.logEvent("Error - Sync Asset Upload Network Error",{reason:e,...o});break;default:u.z.logEvent("Error - Sync Asset Upload Failure",{reason:e,errorType:r,...o})}}logUploadUnlinkedWarningEvent(e,t,r){const i=this.formatAnalyticsData(t);u.z.logWarningEvent("MediaUploadUnlinked",{...i,errorAlertType:"Warning",correlationId:r}),u.z.logEvent("Error - Sync Asset Upload Unlinked Error",{reason:e,...i})}}function C(){return(0,p.l)(S)}},757013:(e,t,r)=>{r.d(t,{Kh:()=>l,Nm:()=>o,YW:()=>s,cv:()=>n,gL:()=>a,lq:()=>c,n2:()=>i});class i extends Error{constructor(){super("Feature not allowed on current plan."),Object.setPrototypeOf(this,i.prototype)}}class n extends Error{constructor(){super("Asset requires relinking and cannot be uploaded.")}}class o extends Error{constructor(){super("Cloud quota exceeded. Asset could not be uploaded.")}}class s extends Error{constructor(){super("Asset is undefined and could not be uploaded.")}}class a extends Error{constructor(e,t){super("Asset fetched from cache does not match asset metadata size. Asset could not be uploaded."),this.assetMimeType=e,this.assetSize=t}}class c extends Error{constructor(){super("Project item not set. Asset could not be uploaded.")}}class l extends Error{constructor(e,t){super(e),this.requestType=t}}},582901:(e,t,r)=>{r.d(t,{T:()=>c});var i=r(867312),n=r(889688),o=r(271716),s=r(847269),a=r(757013);class c{constructor(e){this.assetRepository=e}async fetchAssetFromCache(e){const t=await o.r.get(this.generatePermanentUrl(e.id),{headers:{"X-Clipchamp-SkipManualRehydration":"true"},extraData:{responseType:"blob"}});try{return(0,s.sw)(t.blob,"HTTP request completed without a value"),t.blob()}catch(e){throw new a.cv}}generatePermanentUrl(e){return(0,n.W)(i.OZ)(e)}getMetadataImportedSize(e){return"metadata"in e&&"importedSize"in e.metadata?e.metadata.importedSize:void 0}getMetadataSize(e){return"metadata"in e?e.metadata.size:void 0}}},491330:(e,t,r)=>{r.d(t,{F:()=>i,t:()=>n});class i extends Error{constructor(e){super(e),Object.setPrototypeOf(this,i.prototype)}}class n extends Error{constructor(e){super(e)}}},989230:(e,t,r)=>{r.d(t,{J:()=>a});var i=r(580490),n=r(573340),o=r(650882),s=r(491330);function a(e,t,r,a,c=!1){return r.streams.some((e=>"audio"===e.codec_type))?new Promise(((n,s)=>{(0,i.d)(t.getTranscoderInputFile(),r,(t=>n(e.decodeAudioData(t))),(e=>s((0,o.xM)(e,"Error decoding audio"))),a,c)})).catch((e=>{throw n.Vy.setExtraContext({extra:e,metadata:r}),new s.F("Failed to decode audio")})):Promise.reject(new s.t("Input metadata does not have any audio streams"))}},807955:(e,t,r)=>{r.d(t,{a:()=>n});var i=r(324586);class n{constructor(e,t,r){(0,i.A)(this,"fileName",void 0),this.eviction=e,this.assetId=t,this.internalFile=r,this.fileName=r.fileName}async appendBlob(e){await this.internalFile.appendBlob(e)}async writeBlob(e,t){await this.internalFile.writeBlob(e,t)}async getBlobAsFile(){const e=await this.internalFile.getFile("application/octet-stream");return new File([e],this.fileName,{type:e.type})}async removeFromCache(){try{return await this.internalFile.remove(),!0}catch(e){return console.warn("Error removing file from FileSystem API",e),!1}}}},891697:(e,t,r)=>{r.d(t,{c:()=>n,y:()=>o});const i=1073741824;function n(e){const t=1*i;return e?Math.ceil(e/t):void 0}function o(e,t){return void 0!==e&&t?e/t:void 0}},657968:(e,t,r)=>{r.d(t,{C:()=>u,Z:()=>d});var i=r(324586),n=r(268774),o=r(867312),s=r(879205),a=r(889688),c=r(32737);class l{constructor(e){(0,i.A)(this,"permanentUrl",void 0),this.assetId=e,this.permanentUrl=this.generatePermanentUrlFromAssetId(e)}async removeFromCache(){c.V2.delete(this.assetId);const[e]=await Promise.allSettled([this.permanentUrl,this.generatePermanentUrlFromAssetId((0,o.Uk)(this.assetId))].map((e=>(0,s.ux)(e))));return"fulfilled"===e.status||(console.warn(`Could not remove a blob for asset ${this.assetId} from database`,e.reason),!1)}generatePermanentUrlFromAssetId(e){return(0,a.W)(o.OZ)(e)}}class d extends l{constructor(e,t,r){super(e),this.fileSizeInBytes=t,this.fileName=r}getTranscoderInputFile(){return{source:"http",url:this.permanentUrl,size:this.fileSizeInBytes,name:(this.fileName||this.assetId).replaceAll(/[^\w.-]/g,"_")}}}class u extends l{constructor(e,t){super(e),this.blob=t}getTranscoderInputFile(){return(0,n.A)(this.blob)}}},823939:(e,t,r)=>{r.d(t,{n:()=>h});var i=r(324586),n=(r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(562229)),o=r(897427),s=r(867312),a=r(138615),c=r(889688),l=r(345153),d=r(891697);const u=["VISUAL_WATERMARK"];class h{constructor(){(0,i.A)(this,"watermarkAssetNames",void 0),this.watermarkAssetNames=[...u,...o.ad.map((e=>e.id))]}reverseMapPermanentUrlToAsset(e){const t=(0,c.W)(s.wO)(e);return(0,l.U1)((e=>e.assets.byId[t]))}extractAssetIdFromPermanentUrl(e){return(0,c.W)(s.wO)(e)}isWatermarkAsset(e){return this.watermarkAssetNames.includes(e)}getAllTimelineAssetIds(){const e=Object.values((0,l.U1)((e=>e.items.byId))??{});return new Set(e.map((e=>e.assetId)))}getProjectAssetIds(){return new Set(Object.keys((0,l.U1)((e=>e.assets.byId))??{}))}logEvictionStartEvent(e,t){(0,a.G7)("pst__log_cache_eviction")&&n.z.logEvent("Caching - Eviction Start",{storageUsedGB:(0,d.c)(e.usage),storageUsedToAvailableRatio:(0,d.y)(e.usage,e.quota),toBeCachedBytes:t.fileSizeInBytes})}}},687240:(e,t,r)=>{r.d(t,{B:()=>I,o:()=>R});var i=r(626443),n=r(562229),o=r(769942),s=r(193010),a=r(867312),c=r(879205),l=r(307391),d=r(869655);function u(e,t){return(t.quota||0)-(t.usage||0)-e.fileSizeInBytes<Math.max(Math.min(.1*(t.quota||0),209715200),52428800)}var h=r(573340);async function p(e,t,r){if(!u(e,t))return h.su.info("caching-utils",`Evicted cache entries to end up with ${t.usage}/${t.quota} bytes of cache usage`),Promise.resolve();{const i=r.shift();if(!i)return h.su.warn("caching-utils",`We have depleted the cache (ie., no more cache entries to evict), but are still at ${t.usage}/${t.quota} bytes of storage`),Promise.resolve();try{return await(0,c.ux)(i.permanentUrl),await p(e,{usage:(t.usage||0)-i.fileSizeInBytes,quota:t.quota},r)}catch(n){return h.su.error("caching-utils",`Error evicting ${i.permanentUrl} (${i.fileSizeInBytes} bytes) from cache`,n),await p(e,t,r)}}}var m=r(691421),f=r(903277),g=(r(379321),r(225762)),A=r(138615),v=r(889688),y=r(807955),b=r(657968);function w(e,t,r){t.postMessage({operation:e,response:r})}var x=r(924309);let S=function(e){return e[e.RATHER_EVICT_FIRST=-1]="RATHER_EVICT_FIRST",e[e.MEH_EVICT_EITHER=0]="MEH_EVICT_EITHER",e[e.RATHER_EVICT_SECOND=1]="RATHER_EVICT_SECOND",e}({});function T(e,t){if(!e||!t){if(e)return S.RATHER_EVICT_SECOND;if(t)return S.RATHER_EVICT_FIRST}return S.MEH_EVICT_EITHER}function C(e,t){return T(!e,!t)}var _=r(32737),k=r(522117),E=r(238025);const I="cachingOrchestratorToken";class R{constructor(e,t){this.eviction=e,this.storageManager=t,this.registerMessageListener().catch((()=>{}))}async registerMessageListener(){await(0,x.k)("mc-listener-registration"),self.navigator.serviceWorker.addEventListener("message",(async e=>{if(e.ports&&e.ports[0]&&(0,s.NG)(e.data)){const t=e.ports[0];switch(e.data.operation){case s.Y2.HydrationLookup:await async function(e,t,r){if((0,s.v5)(e))try{const i=await r(e);w(s.Y2.HydrationLookup,t,i)}catch(r){console.warn(`Permanent error in performing local lookup of ${e.permanentUrl}`,r),w(s.Y2.HydrationLookup,t)}else console.error('Received invalid data in "request" property of message payload for lookup request',e),w(s.Y2.HydrationLookup,t)}(e.data.request,t,(async e=>await this.processLocalLookupRequest(e,(()=>this.hydrationCallback(e.permanentUrl)))));break;case s.Y2.FileSystemPermission:await async function(e,t){try{if(!(0,s.uZ)(e))throw new Error("Request is of an invalid format for FileHandlePermission");{const r=await e.handle.requestPermission({mode:"read"});w(s.Y2.FileSystemPermission,t,"granted"===r?{statusCode:i.v.ACCEPTED,permission:r}:{statusCode:i.v.FORBIDDEN,permission:r})}}catch(e){console.error("An error occurred while requesting FileSystem access",e),w(s.Y2.FileSystemPermission,t,{statusCode:i.v.BAD_REQUEST,statusText:e instanceof Error?e.message:"unknown error"})}}(e.data.request,t);break;case s.Y2.QueryFeatureFlag:await async function(e,t){try{if((0,s.uU)(e))return void w(s.Y2.QueryFeatureFlag,t,{feature:e.feature,enabled:(0,A.G7)(e.feature)});throw new Error("Request is of an invalid format for QueryFeatureRequest")}catch(e){console.error("An error occurred while querying FeatureFlag enabled",e)}}(e.data.request,t);break;default:console.warn(`Received unhandle-able request ${e.data.operation} from service worker`,e.data)}}}))}get hydrationCallback(){return(0,v.W)(k.F)}async createNewCachable(e,t){await(0,x.k)("cache-new");const r=await o.h.createNewFile(t);return new y.a(this.eviction,e,r)}async processLocalLookupRequest(e,t){try{return(0,_.wt)(this.extractAssetIdFromPermanentUrl(e.permanentUrl),e.requestHeaders)}catch(r){if(e.skipManualRehydration)throw r;return await(0,E.j)(e,t),{statusCode:i.v.ACCEPTED,responseHeaders:new Map,responseContent:null}}}extractAssetIdFromPermanentUrl(e){return(0,v.W)(a.wO)(e)}async cacheLocalFile(e,t){return await(0,x.k)("cache-local-file"),await this.conditionallyEvictCache({fileSizeInBytes:t.size}),await this.cacheExistingFile(e,t)}async cacheCachableFile(e,t){await(0,x.k)("cache-file");const r=await t.getBlobAsFile();await this.conditionallyEvictCache({fileSizeInBytes:r.size});const i=await this.cacheExistingFile(e,r);return await t.removeFromCache(),i}async lookupCachedFile(e){return await(0,x.k)("cache-confirm"),(0,A.G7)("ren__blobs_in_export")?this.lookupFileInDatabase(e):this.lookupFileWithServiceWorker(e)}async lookupFileWithServiceWorker(e){const t=(0,v.W)(a.OZ)(e);try{const r=await(0,c.Ak)(t);return n.z.logAppLogicEvent("MediaCacheFetchCompleted",{fileSize:r.fileSize}),new b.Z(e,r.fileSize,r.fileName)}catch(e){if(e instanceof c.VB&&(e.isSevere?n.z.logErrorEvent("MediaCacheFetchFailed",{errorCode:`${e.statusCode}`,message:"",errorAlertType:"Fatal",errorType:"CacheFetch"}):n.z.logAppLogicEvent("MediaCacheFetchNoMatch",{httpResponseCode:e.statusCode,isFilmstrip:e.message.includes("_filmstrip")})),e instanceof l.Jk)throw n.z.logErrorEvent("MediaCacheFetchFailed",{message:"",errorAlertType:"Fatal",errorType:"InactiveServiceWorker"}),e;throw new l.xE(e instanceof Error?e.message:"Unknown underlying error")}}async lookupFileInDatabase(e){const t=(0,v.W)(a.OZ)(e);try{const r=await this.localCacheDatabase,i=await(0,m.TK)(r,t);return n.z.logAppLogicEvent("MediaCacheFetchCompleted",{fileSize:i.size}),new b.C(e,i)}catch(t){t instanceof d.a?n.z.logErrorEvent("MediaCacheFetchFailed",{errorCode:`${t.code}`,message:t.name,errorAlertType:"Fatal",errorType:"IDBTransaction"}):t instanceof d.u&&n.z.logAppLogicEvent("MediaCacheFetchNoMatch",{isFilmstrip:t.message.includes("_filmstrip")});try{const t=(0,_.E_)(e);return new b.C(e,t)}catch{throw new l.xE(t instanceof Error?t.message:"Unknown underlying error")}}}get evictionCandidateComparitor(){return e=this.eviction,(t,r)=>function(e,t,r){function i(t){try{return e.extractAssetIdFromPermanentUrl(t.permanentUrl)}catch(e){h.su.warn("caching-utils",`Foreign object in local cache: ${t.permanentUrl} (asset: ${t.asset?t.asset.id:"<none>"})`)}}const n=i(t),o=i(r);return T(!!n&&e.isWatermarkAsset(n),!!o&&e.isWatermarkAsset(o))}(e,t,r)||function(e,t,r){const i=e.getProjectAssetIds(),n=t.asset,o=n&&i.has(n.id),s=r.asset;return T(o,s&&i.has(s.id))}(e,t,r)||function(e,t){const r=new RegExp("^(.*)_(downscale|filmstrip)$");return C(r.test(e.permanentUrl),r.test(t.permanentUrl))}(t,r)||function(e,t,r){const i=e.getAllTimelineAssetIds();return T(t.asset&&i.has(t.asset.id),r.asset&&i.has(r.asset.id))}(e,t,r)||function(e,t){return C(!!e.asset&&"cloud"in e.asset&&!!e.asset.cloud,!!t.asset&&"cloud"in t.asset&&!!t.asset.cloud)}(t,r)||function(e,t){return Math.sign(t.fileSizeInBytes-e.fileSizeInBytes)}(t,r);var e}async conditionallyEvictCache(e){try{const t=await(0,f.x)(),r=this.storageManager.getCustomStorageLimit(),i=t.quota&&r?t.quota*r:t.quota,n={usage:t.usage,quota:i};if(u(e,n)){this.eviction.logEvictionStartEvent(n,e);try{const t=await async function(e,t){return new Promise(((r,i)=>{const n=t.transaction([g.Wd.ASSETS_TABLE],"readonly").objectStore(g.Wd.ASSETS_TABLE).openCursor(),o=[];n.onsuccess=()=>{const t=n.result;t?(o.push({permanentUrl:t.value.permanentUrl,asset:e.reverseMapPermanentUrlToAsset(t.value.permanentUrl),fileSizeInBytes:t.value.blob.size}),t.continue()):r(o)},n.onerror=e=>{h.su.error("caching-utils","Error iterating over cache",e),i(new Error("Error iterating over cache"))}}))}(this.eviction,await this.localCacheDatabase);return t.sort(this.evictionCandidateComparitor),await p(e,n,t)}catch(e){console.error("Error retrieving eviction candidates",e)}}}catch(e){console.error("Error determining cache storage quota/usage",e)}}async queueStoreBlobInDatabase(e,t,r){return this.assetWriteBatchQueue.runRequest({permanentUrl:e,blob:t,fileName:r})}async cacheExistingFile(e,t){const r=(0,A.G7)("ren__blobs_in_export")?new b.C(e,t):new b.Z(e,t.size,t.name);_.V2.cache(e,t);try{return await this.queueStoreBlobInDatabase(r.permanentUrl,t,t.name),(0,A.G7)("ren__blobs_in_export")?this.lookupFileInDatabase(e):r}catch(e){return console.warn(`Error storing ${t.size}-byte file ${t.name||"<no name>"} in cache, will only hold file handle in session memory`,e),r}}}},699276:(e,t,r)=>{r.d(t,{dk:()=>p,eN:()=>g,qK:()=>f});var i,n=r(324586),o=r(26985),s=r(217563),a=r(825702),c=r(884800),l=r(307391),d=r(781224),u=r(739367),h=r(687240);let p=(0,a.Gr)()((m=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",["undefined"==typeof CachingOrchestrator?Object:CachingOrchestrator])(i=class extends c.d{constructor(e){super(e),(0,n.A)(this,"cacheError$",new s.B)}async getByAssetID(e){try{return await super.getByAssetID(e)}catch(e){this.handleError(e)}}async lookupAssetIds(e){try{return await super.lookupAssetIds(e)}catch(e){this.handleError(e)}}async importAndStoreWithID(e,t,r){try{return await super.importAndStoreWithID(e,t,r)}catch(e){this.handleError(e)}}async storeAsset(e,t){try{return await super.storeAsset(e,t)}catch(e){this.handleError(e)}}handleError(e){throw e instanceof l.Jk&&this.cacheError$.next(e),e}})||i)||i,i=(0,a.WQ)(h.B)(m,void 0,0)||i))||i;var m;function f(){return(0,u.l)(p)}function g(){const e=f();return(0,d.A)((0,o.useMemo)((()=>e.cacheError$.asObservable()),[e]),void 0)}},924309:(e,t,r)=>{r.d(t,{k:()=>a});var i=r(562229),n=r(307391),o=r(138615);let s;function a(e="unknown"){return s=s||async function(e){const t=await navigator.serviceWorker.ready;if(t.active){if(navigator.serviceWorker.controller)return t.active;throw console.warn("Soft page reload is required","Active service worker is not controlling the page"),i.z.logWarningEvent("ServiceWorkerSoftReload",{errorAlertType:"Warning",initiator:e},{async:(0,o.Us)("ks_multi__worker_reload_telemetry_flush")}),window.location.reload(),new n.df("Active service worker is not controlling the page")}throw console.error("Error looking up active service worker"),s=void 0,new n.Jk("No active service worker instance was found")}(e)}},32737:(e,t,r)=>{r.d(t,{V2:()=>l,E_:()=>d,wt:()=>u});var i=r(324586);class n{constructor(){(0,i.A)(this,"memoryCache",new Map)}delete(e){this.memoryCache.delete(e)}get(e){const t=this.memoryCache.get(e);if(t&&t.size>0)return t;this.delete(e)}clear(){this.memoryCache.clear()}}var o=r(626443),s=r(573340),a=r(225762),c=r(193010);const l=new class extends n{cache(e,t){this.memoryCache.set(e,t)}};function d(e){const t=l.get(e);if(t){if(t.size>0)return t;console.warn(`Locally cached file ${t.name} for asset ${e} got stale, removing it`,l),l.delete(e)}throw new Error(`File handle for asset ${e} is not locally held`)}function u(e,t){return function(e,t){if("number"==typeof t.fromByte||"number"==typeof t.toByte){const r=t.fromByte||0,i=t.toByte||e.size-1;if(r<e.size){s.su.info("caching-utils",`Serving ${e.size}-byte blob ${e instanceof File?e.name:"<unnamed>"} as partial content HTTP/${o.v.PARTIAL_CONTENT}, Range: bytes=${r}-${i}`);const t=e.slice(r,i+1);return{statusCode:o.v.PARTIAL_CONTENT,responseContent:t,responseHeaders:new Map([[c.Wu.ACCEPT_RANGES,"bytes"],[c.Wu.CACHE_CONTROL,a.h1],[c.Wu.CONTENT_RANGE,`bytes ${r}-${r+t.size-1}/${e.size}`]])}}return s.su.warn("caching-utils",`Cannot serve partial request (Range: bytes=${r}-${i}) on ${e.size}-byte blob ${e instanceof File?e.name:"<unnamed>"}: HTTP/${o.v.REQUESTED_RANGE_NOT_SATISFIABLE}`),{statusCode:o.v.REQUESTED_RANGE_NOT_SATISFIABLE,responseContent:null,responseHeaders:new Map}}return s.su.info("caching-utils",`Serving ${e.size}-byte blob ${e instanceof File?e.name:"<unnamed>"} in full as as HTTP/${o.v.OK}`),{statusCode:o.v.OK,responseContent:e,responseHeaders:new Map([[c.Wu.ACCEPT_RANGES,"bytes"],[c.Wu.CACHE_CONTROL,a.h1]])}}(d(e),function(e){if(e.has(c.UD.RANGE)){const t=/^bytes=(\d+)-(\d+)?$/.exec(e.get(c.UD.RANGE));if(t)return{fromByte:Number.parseInt(t[1]),toByte:t[2]?Number.parseInt(t[2]):void 0}}return{}}(t))}},20106:(e,t,r)=>{r.d(t,{Ii:()=>l,R9:()=>o,RZ:()=>a});var i=r(450139),n=r(650882);function o(e){const t=e.name.lastIndexOf(".");return-1===t?void 0:e.name.slice(Math.max(0,t+1)).toLowerCase()}const s=4;async function a(e){let t;var r;return t="local"===e.source?await(r=e.file,new Promise(((e,t)=>{const i=new FileReader;i.onabort=()=>{t(new Error("Reading file aborted"))},i.onerror=()=>{t(new Error("Error reading file"))},i.onload=()=>{e(i.result)},i.readAsText(r.slice(0,s))}))):await async function(e){const t=await fetch(e,{headers:{Range:"bytes=0-"+(s-1)}});if(t.ok)return(await t.text()).slice(0,Math.max(0,s));throw new Error("Invalid status code from range request")}(e.url),t}const c=5e3;async function l(e,t=c){return(0,i.d)((async(t,r)=>{try{await a(e.getTranscoderInputFile()),t()}catch(e){r(n.g9.fromUnknownError(e,"Failed to read cached file"))}}),t,"Timeout reading file")}},522117:(e,t,r)=>{r.d(t,{F:()=>i});const i="hydrationCallback"},238025:(e,t,r)=>{r.d(t,{j:()=>n}),r(193010);const i=new Map;function n(e,t){let r=i.get(e.permanentUrl);return r||(r=t(),i.set(e.permanentUrl,r),r.then((()=>{i.delete(e.permanentUrl)}),(()=>{console.warn(`Rehydration of ${e.permanentUrl} has failed, removing it from pool`),i.delete(e.permanentUrl)}))),r}},105850:(e,t,r)=>{r.d(t,{Fj:()=>d,SJ:()=>o,cV:()=>u,eV:()=>l,hv:()=>a,kT:()=>c});var i=r(187974),n=r(126714);function o(e){return!("w69b-mediawriter"!==e.format.tags?.encoder&&!e.format.tags?.encoder?.startsWith("Bandicam"))}const s=20;function a(e){return"mov,mp4,m4a,3gp,3g2,mj2"===e.format.format_name&&!!e.format.tags&&"qt  "===e.format.tags.major_brand&&e.streams.some((e=>"video"===e.codec_type&&(0,i.at)(e.avg_frame_rate)<=s&&e.tags&&"Core Media Data Handler"===e.tags?.handler_name))}function c(e){return e.streams.some((e=>{const t=e.tags?.rotate??"0";return"video"===e.codec_type&&"0"!==t}))}function l(e){const t=(0,n.xF)(e);return!!t&&("number"!=typeof t.start_pts||Number.isNaN(Number.parseFloat(t.start_time||"")))}function d(e){const t=(0,n.xF)(e);return!!t&&"mp3"===t.codec_name&&"number"==typeof t.start_pts&&0!==t.start_pts}function u(e){const t=(0,i.yL)(e);return!!t&&"hevc"===t.codec_name}},576924:(e,t,r)=>{r.d(t,{L:()=>p,Y:()=>m});var i=r(324586),n=(r(584570),r(82265),r(988124),r(126714)),o=r(187974),s=r(138615),a=r(517934),c=r(652870),l=r(835552),d=r(105850),u=r(261719),h=r(948550);function p(e){const t={videoTracks:e.videoTracks,audioTracks:e.audioTracks};if(!t.audioTracks||!t.videoTracks)if("function"==typeof e.captureStream){const r=e.captureStream();t.audioTracks=r.getAudioTracks(),t.videoTracks=r.getVideoTracks()}else t.audioTracks=[],t.videoTracks=[];return t}class m{constructor(e,t){(0,i.A)(this,"priority",a.A.ASSET_LOAD),this.videoOrAudioFile=e,this.rawMetadata=t}runJob(){return new Promise(((e,t)=>{const r=URL.createObjectURL(this.videoOrAudioFile);let i=!0,a="loading";const m=this.rawMetadata,f=void 0!==(0,n.xF)(this.rawMetadata),g=void 0!==(0,o.yL)(this.rawMetadata),A=(0,u.Zk)(this.rawMetadata),v=(0,d.hv)(this.rawMetadata),y=(0,d.SJ)(this.rawMetadata),b=(0,d.eV)(this.rawMetadata),w=(0,d.Fj)(this.rawMetadata),x=(0,d.kT)(this.rawMetadata),S=(0,d.cV)(this.rawMetadata),T=document.createElement("video");function C(){const e=p(T);F(e.audioTracks.length>0,e.videoTracks.length>0)}function _(e){switch(a){case"playing":console.warn("Video loaded successfully, but failed to play - transcoding it to import it",e),E("transcode-audio-transcode-video","cannot-play");break;case"seeking":console.warn("Video played successfully, but failed to seek - transcoding it to import it",e),E("transcode-audio-transcode-video","cannot-seek");break;case"loading":F()}}function k(){if(i)try{T.removeEventListener("error",_),T.removeEventListener("loadedmetadata",C),T.pause(),T.removeAttribute("src"),T.remove(),URL.revokeObjectURL(r)}catch(e){console.error("An error happened while cleaning up after ourselves while trying to check the playability of a video file",e)}finally{i=!1}}function E(t,r){a="resolved",k(),e({handling:t,transcodeReason:r})}async function I(){a="playing",await(0,c.H)(T),a="seeking";const e=new l.gU(T,m);try{await e.seek(T.duration/2)}finally{e.destroy()}}function R(){S&&(0,s.G7)("ren__disable_native_hevc_decoder")?E("repackage-audio-transcode-video","hevc"):v||y?E("transcode-audio-transcode-video",v?"ios-screen-recording":"problematic-screen-recording"):b||w?E("transcode-audio-repackage-video",b?"audio-missing-start-time":"mp3-non-zero-start-time"):x||A?E("repackage-audio-repackage-video",x?"rotation-metadata":"webm-without-duration"):E("keep-as-is",void 0)}function F(e=!1,r=!1){const i=function(e,t){return(g?"Y":"N")+(t?"Y":"N")+(f?"Y":"N")+(e?"Y":"N")}(e,r);switch(i){case"NNNN":case"NNNY":case"NYNN":case"NYNY":k(),t(new h.pZ);break;case"NNYY":case"NYYY":case"YYNN":case"YYNY":case"YYYY":I().then(R,_);break;case"NNYN":case"NYYN":case"YYYN":E("transcode-audio-repackage-video","cannot-play-audio");break;case"YNYY":a="playing",I().then((()=>{E("repackage-audio-transcode-video","cannot-play-video")}),_);break;default:E("transcode-audio-transcode-video","cannot-play-video-audio")}}T.setAttribute("crossorigin","anonymous"),T.setAttribute("preload","auto"),T.setAttribute("webkit-playsinline",""),T.setAttribute("playsinline",""),T.setAttribute("src",r),T.setAttribute("muted","muted"),T.muted=!0,T.addEventListener("loadedmetadata",C),T.addEventListener("error",_)}))}}},486690:(e,t,r)=>{r.d(t,{j:()=>c});var i=r(324586),n=r(313311),o=r(847269),s=r(576924),a=r(976523);class c{constructor(){(0,i.A)(this,"jobManager",new n.r)}canPlay(e,t){return this.jobManager.queue(new s.Y(e,t)).then((e=>(0,o.sw)(e,"Can play result undefined, job likely cancelled")))}canShow(e,t){return this.jobManager.queue(new a.H(e,t)).then((e=>e??"reject-file")).catch((e=>(console.warn("CanShowJob failed",e),"reject-file")))}}},976523:(e,t,r)=>{r.d(t,{H:()=>s});var i=r(324586),n=(r(584570),r(82265),r(988124),r(486967)),o=r(517934);class s{constructor(e,t){(0,i.A)(this,"priority",o.A.ASSET_LOAD),this.imageFile=e,this.rawMetadata=t}runJob(){const e=this.rawMetadata.streams.find((e=>"video"===e.codec_type));if(!e)return Promise.resolve("reject-file");switch(this.rawMetadata.format.format_name){case"image2":return"bmp"===e.codec_name?Promise.resolve("transcode-bmp"):"tiff"===e.codec_name?Promise.resolve("transcode-tif"):this.tryShowingImage().then((t=>t?this.isRotated()&&"mjpeg"===e.codec_name?"transcode-jpeg":"keep-as-is":"mjpeg"===e.codec_name?"transcode-jpeg":"reject-file"));case"tiff_pipe":return Promise.resolve("transcode-tif");case"bmp_pipe":return Promise.resolve("transcode-bmp");default:return this.tryShowingImage().then((e=>e?"keep-as-is":"reject-file"))}}isRotated(){return 0!==(0,n.vq)(this.rawMetadata)}tryShowingImage(){const e=URL.createObjectURL(this.imageFile);return new Promise((t=>{const r=document.createElement("img");r.onload=()=>{t(!0)},r.onerror=e=>{t(!1)},r.src=e})).then((t=>(window.clearTimeout(void 0),URL.revokeObjectURL(e),t)))}}},122643:(e,t,r)=>{r.d(t,{g:()=>f});var i,n=r(324586),o=(r(379321),r(217563)),s=r(825702),a=r(186975),c=r(988839),l=r(474107),d=r(345153),u=r(788855),h=r(776303),p=r(103179),m=r(199893);let f=(0,s.Gr)()(i=function(e){return(0,s.WQ)(a.u)(e,void 0,0)}(i=function(e){return(0,s.WQ)(c.e)(e,void 0,1)}(i=function(e){return(0,s.WQ)(h.h)(e,void 0,2)}(i=function(e){return(0,s.WQ)(p.N)(e,void 0,3)}((g=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[void 0===a.$?Object:a.$,void 0===c.e?Object:c.e,void 0===h.h?Object:h.h,void 0===p.N?Object:p.N,void 0===l.T?Object:l.T])(i=class{constructor(e,t,r,i,s){(0,n.A)(this,"error$",void 0),(0,n.A)(this,"_error$",new o.B),this.assetRepository=e,this.rehydrateService=t,this.assetCachingService=r,this.placeholder=i,this.projectService=s,this.error$=this._error$.asObservable()}async addFilesAsync(e,t={}){const r=e.map((e=>({file:e,source:{type:"filesystem"}})));await this.rehydrateService.rehydrateWithFiles(r,{errorNoMatch:!1});const i=await Promise.all(e.map((e=>(0,m.m)(e)))),{newFiles:n}=this.filterExisting(i);return await Promise.all(n.map((async({file:e,asset:r})=>{this.placeholder.createPlaceholderForAsset(r.id,r.name,r.cloud,e.size,r.fileHashes);try{const i=await this.cacheFile(e,r,t?.metadata?.origin);return this.addAsset(i.asset,t),i}catch(e){throw this.placeholder.deletePlaceholderForAsset(r.id),e}}))).then((e=>e.map((e=>e.asset)))).catch((e=>this._error$.next(e)))}async importAssetProvider(e){const t=await e.asset(),r=(0,d.U1)((e=>e.assets.byId))??{};if(r[t.id])return r[t.id];try{const r=await e.file({}),i=await this.cacheFile(r,t,e.source);return this.addAsset(i.asset,{}),i.asset}catch(e){this._error$.next(e)}}addFiles(e,t={}){this.addFilesAsync(e,t).then((()=>{})).catch((e=>this._error$.next(e)))}filterExisting(e){const t=Object.values((0,d.U1)((e=>e.assets.byId))??{}).filter(u.N).map((e=>({id:e.id,size:e.metadata.size,name:e.name,fileHashes:e.fileHashes})));return this.placeholder.placeholders.forEach((e=>{e.fileSize&&t.push({id:e.id,size:e.fileSize,name:e.name,fileHashes:e.fileHashes})})),(0,m.F)(e,t,this.projectService)}addAsset(e,t){t.metadata&&(e={...e,metadata:{...e.metadata,...t.metadata}}),this.assetRepository.upsertUnhandled(e)}async cacheFile(e,t,r="file"){const i=await this.assetCachingService.cacheFile(t,e,r,(e=>this.placeholder.setProgressForAsset(t.id,e)));return this.placeholder.deletePlaceholderForAsset(t.id),i}})||i)||i,i=(0,s.WQ)(l.T)(g,void 0,4)||i))||i)||i)||i)||i)||i;var g},199893:(e,t,r)=>{r.d(t,{F:()=>a,m:()=>s}),r(379321),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(562229),n=r(625927),o=r(871287);async function s(e){const t=(0,n.F)(),r=await(0,o.wr)(e);return{asset:{id:t,name:e.name,hidden:!1,fileHashes:{original:r}},file:e}}function a(e,t,r){const n=[],o=new Set,s=[];return e.forEach((e=>{const a=t.some((t=>{if(t.size===e.file.size){const n=void 0!==t.fileHashes?.original&&t.fileHashes.original!==e.asset.fileHashes?.original;return i.z.logEvent("Warning - File size already exists in project",{existingAssetName:t.name,newAssetName:e.file.name,matching:t.name===e.file.name,byteMismatch:n}),!n&&(r.read((r=>{const i=r.getAsset(t.id)?.value;i&&s.push({asset:i,file:e.file})})),!0)}return!1})),c=o.has(e.asset.fileHashes?.original);a||c||(n.push(e),o.add(e.asset.fileHashes?.original))})),{newFiles:n,existingFiles:s}}},459212:(e,t,r)=>{r.d(t,{J:()=>l,c:()=>c});var i=r(107042);const n=33554432,o={mime:"image/svg+xml",ext:"svg",support:"supported"};function s(e){return{mime:e&&e.type||"application/octet-stream",support:"unsupported"}}async function a(e){if(e.size>n)return console.warn("File is too large, not loading it into memory for svg check"),!1;const{default:t}=await r.e(73406).then(r.bind(r,473406)),i=await e.arrayBuffer();return t(Buffer.from(i).toString())}async function c(e){if(!(e instanceof Blob))return console.warn("Type system error, argument is not a Blob",e),Promise.resolve(s(e));if(0===e.size)return console.warn(`Invalid file size of ${e.size} bytes`,e),Promise.resolve(s(e));try{if(("image/svg+xml"===e.type||"application/octet-stream"===e.type||"application/xml"===e.type||""===e.type)&&await a(e))return o;const t=await async function(e){const{default:t}=await Promise.all([r.e(75071),r.e(5025)]).then(r.t.bind(r,175071,23));return e.stream?await t.fromStream(e.stream()):await t.fromBlob(e)}(e);if(!t){if(await a(e))return o;throw new Error(`Cannot determine MIME type of ${e instanceof File?e.name:"blob"}`)}return{...t,support:(0,i.Ag)(t.mime)}}catch(t){return console.warn(`Error probing MIME type of ${e.name}`,t),s(e)}}function l(e,t){let r=e.name;if(void 0!==t.ext){const e=r.lastIndexOf(".");-1!==e&&(r=r.slice(0,e)),r=`${r}.${t.ext}`}return e.type===t.mime&&e.name===r?e:new File([e],r,{type:t.mime,lastModified:e.lastModified})}},942791:(e,t,r)=>{r.d(t,{$:()=>c,Z:()=>a});var i=r(324586),n=r(271716),o=r(776016);const s=(0,o.t9)({type:(0,o.u)("com.clipchamp.parentAsset"),properties:(0,o.t9)({version:(0,o.u)("1.0.0"),assetId:o.Kg})});class a{constructor(e,t,r){this.assetGetter=e,this.assetResolverService=t,this.assetId=r}static fromConfig(e,t,r){return new a(e,t,r.properties.assetId)}config(){const e={type:"com.clipchamp.parentAsset",properties:{assetId:this.assetId,version:"1.0.0"}};return Promise.resolve(e)}handleGeneration(e,t){const r=this.assetGetter(this.assetId);return this.assetResolverService.fetch(r,t.onStatus).then((e=>(t.onStatus?.("pending"),e))).then((e=>((e,t)=>{const r=e.getTranscoderInputFile();return"local"===r.source?Promise.resolve(r.file):n.r.get(e.permanentUrl,{extraData:{responseType:"blob",onProgress:e=>{e.total&&t&&t({type:"downloading",value:e.loaded/e.total})}}}).then((e=>{if(!e.ok)throw new Error(`Failed to fetch parent asset: ${e.statusText}`);return e.blob()}))})(e,t.onProgress))).then((e=>new File([e],r.name,{type:e.type})))}}(0,i.A)(a,"match",s);const c=(e,t)=>({match:a.match,create:a.fromConfig.bind(null,e,t)})},186749:(e,t,r)=>{r.d(t,{_:()=>c,b:()=>l});var i=r(825702),n=r(131512),o=r(474107),s=r(701724),a=r(942791);const c="assetGenerationSteps",l=e=>{i.kL.register(c,{useValue:[(0,a.$)(n.LB.bind(null,i.kL.resolve(o.T)),i.kL.resolve(s.qI)),...e]})}},114998:(e,t,r)=>{r.d(t,{H6:()=>a,Qs:()=>c,XP:()=>l});var i=r(578831),n=r(889688),o=r(186749);class s extends Error{constructor(){super("Asset is not a GenerationAssetProvider")}}function a(e){if(!i.u.match(e))throw new s;return i.u.fromAsset((0,n.W)(o._),e)}function c(e){try{return a(e)}catch(e){if(e instanceof s)return;throw e}}function l(e,t){const r=c(e);return r?.findGenerationHandler((e=>e instanceof t))}},672021:(e,t,r)=>{r.d(t,{K:()=>i});const i="createHeifWorkerChannel"},873890:(e,t,r)=>{r.d(t,{n:()=>c});var i=r(650882);function n(e){return e?.format}function o(e){return e?.streams??[]}function s(e){return o(e).find((e=>"video"===e?.codec_type))}function a(e){return o(e).find((e=>"audio"===e?.codec_type))}function c(e,t,r){return i.g9.fromUnknownError(r,`Failed to import ${e} file`,{assetType:e,containerFormat:n(t)?.format_name,videoCodec:s(t)?.codec_name,audioCodec:a(t)?.codec_name,pixelFormat:s(t)?.pix_fmt,sampleFormat:a(t)?.sample_fmt})}},638118:(e,t,r)=>{r.d(t,{v:()=>s});var i=r(580490),n=r(873890);const o=()=>{};function s(e,t,r,s){return new Promise(((a,c)=>{(0,i.E8)({source:"local",file:e,size:e.size,name:"image."+s.sourceExtension},t,r,a,(e=>c((0,n.n)("image",t,e||new Error("Error importing file")))),o)}))}},464764:(e,t,r)=>{r.d(t,{j:()=>s});var i=r(580490),n=r(873890);const o=()=>{};function s(e,t,r,s,a){return new Promise(((c,l)=>{(0,i.n2)(e,t,r,c,(e=>l((0,n.n)("media",t,e||new Error("Error importing file")))),a,o,s)}))}},375356:(e,t,r)=>{r.d(t,{P:()=>s,U:()=>a});var i=r(486690),n=r(948550);const o=new i.j;function s(e,t){return o.canShow(e,t).then((e=>{switch(e){case"keep-as-is":return;case"transcode-bmp":return{sourceExtension:"bmp"};case"transcode-jpeg":return{sourceExtension:"jpg"};case"transcode-tif":return{sourceExtension:"tif"};default:throw new n.pZ}}))}async function a(e,t){const{handling:r,transcodeReason:i}=await o.canPlay(e,t);return"keep-as-is"===r?void 0:{importOptions:{transcodeVideo:"repackage-audio-transcode-video"===r||"transcode-audio-transcode-video"===r,transcodeAudio:"transcode-audio-repackage-video"===r||"transcode-audio-transcode-video"===r},transcodeReason:i}}},261719:(e,t,r)=>{r.d(t,{T9:()=>a,Zk:()=>o,qN:()=>s});var i=r(187974),n=r(126714);function o(e){return"matroska,webm"===e.format.format_name&&Number.isNaN(Number.parseFloat(e.format.duration||"N/A"))}function s(e){if(void 0===(0,i.yL)(e))return;const t=(0,n.Ms)(e);if(Number.isNaN(t))throw new Error("File duration could not be determined")}function a(e){if(void 0===(0,n.xF)(e))return;const t=(0,n.Jq)(e);if(Number.isNaN(t))throw new Error("File duration could not be determined")}},165533:(e,t,r)=>{r.d(t,{C:()=>s});var i=r(650882),n=r(20106);function o(e,t,r){return console.error(`Failed to extract metadata of file, first four bytes are ${t}`),i.g9.fromUnknownError(r,"Failed to extract metadata of file",{assetType:e,magicFourBytes:t})}async function s(e,t,r){try{return o(e,await(0,n.RZ)(t),r)}catch(t){return console.error("Error reading magic four bytes",t),o(e,void 0,r)}}},53898:(e,t,r)=>{r.d(t,{ME:()=>l,NN:()=>d,wh:()=>a}),r(584570),r(82265),r(988124);var i=r(126714),n=r(486967),o=r(187974);function s(e,t,r){const i=t.format.tags?.creation_time??(0,n.f7)(t,r);return void 0!==i?i:"local"===e.source&&e.file instanceof File?new Date(e.file.lastModified).toISOString():void 0}function a(e){const t="local"===e.source?URL.createObjectURL(e.file):e.url;return new Promise(((e,r)=>{const i=document.createElement("img");i.onload=()=>{e([i.naturalWidth,i.naturalHeight])},i.onerror=()=>{r(new Error("Failed to extract image dimensions"))},i.src=t})).finally((()=>{"local"===e.source&&URL.revokeObjectURL(t)}))}function c(e,t){const r={...e},i=e.frames?.[0];return void 0===i||0===Object.keys(t).length?delete r.frames:r.frames=[{media_type:i.media_type,width:i.width,height:i.height,stream_index:i.stream_index,tags:t}],r}async function l(e,t){const r=t.streams.find((e=>"video"===e.codec_type));if(r){let i=r.width,o=r.height;r.width&&r.height&&"svg"!==r.codec_name||([i,o]=await a(e));const l={},d=(0,n.vq)(t,l),u=s(e,t,l);return{size:e.size,width:i,height:o,rotation:d,creationTime:u,raw:c(t,l)}}throw new Error("File did not contain a video (image) stream")}function d(e,t,r){const{frames:n,...a}=t,c=function(e,t){const r=(0,i.xF)(t);if(r)return{duration:(0,i.Jq)(t),bitRate:Number.parseInt(r.bit_rate||""),channels:r.channels||2,sampleRate:Number.parseInt(r.sample_rate||""),size:e.size,raw:t}}(e,a),l=(0,o.yL)(a),d=s(e,a);if(l){const t=function(e,t){let r=0;return e>0?r=e:t&&t.duration>0&&(r=t.duration),r}((0,i.Ms)(a),c);return{...r,size:e.size,duration:t,width:l.width,height:l.height,rotation:l.tags&&Number.parseFloat(l.tags.rotate)||0,creationTime:d,audio:c,raw:a}}if(c)return{...r,...c,creationTime:d};throw new Error("File did neither contain a video stream, nor were we able to extract audio metadata")}},973622:(e,t,r)=>{r.d(t,{AT:()=>a,bS:()=>c,sw:()=>l});var i=r(580490),n=r(873890),o=r(53898),s=r(165533);function a(e,t){return new Promise(((r,n)=>(0,i.Jw)(e,(e=>r(e)),(r=>(0,s.C)(t,e,r??new Error("Failed to extract metadata: ")).then(n,n)),(()=>{}))))}async function c(e){const t=await a(e,"image");try{return await(0,o.ME)(e,t)}catch(e){throw(0,n.n)("image",t,e)}}async function l(e){const t=await a(e,"media");try{return(0,o.NN)(e,t)}catch(e){throw(0,n.n)("media",t,e)}}},948550:(e,t,r)=>{r.d(t,{me:()=>n,oL:()=>o,pZ:()=>i});class i extends Error{constructor(){super("The file is not supported at all")}}class n extends Error{constructor(){super("Request Cleared")}}class o extends Error{constructor(e){super(e)}}},103179:(e,t,r)=>{r.d(t,{N:()=>l,d:()=>c});var i,n=r(324586),o=r(815731),s=r(825702),a=r(649079);class c extends Error{constructor(e){super("Attempted to create a duplicate placeholder with id: "+e)}}let l=(0,s.Gr)()((d=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[void 0===a.M?Object:a.M])(i=class{constructor(e){(0,n.A)(this,"placeholders$",void 0),(0,n.A)(this,"_placeholders",new o.t([])),this.projectStateService=e,this.placeholders$=this._placeholders.asObservable()}get placeholders(){return this._placeholders.value}createPlaceholderForAsset(e,t,r,i,n){if(this.getPlaceholderForAsset(e))throw new c(e);this.updatePlaceholder({id:e,name:t,cloudDetails:r,fileSize:i,progress:0,fileHashes:n})}deletePlaceholderForAsset(e){this._placeholders.next(this._placeholders.value.filter((t=>t.id!==e)))}reset(){this._placeholders.next([])}setProgressForAsset(e,t){if(!this.projectStateService.isLoaded())return;const r=this.getPlaceholderForAsset(e);r&&this.updatePlaceholder({...r,progress:Math.min(100,Math.max(0,100*t))})}assetPlaceholderExists(e){return this._placeholders.value.some((t=>t.id===e))}getPlaceholderForAsset(e){return this._placeholders.value.find((t=>t.id===e))}updatePlaceholder(e){const t=[...this._placeholders.value.filter((t=>t.id!==e.id)),e].sort(((e,t)=>e.name<t.name?1:-1));this._placeholders.next(t)}})||i)||i,i=(0,s.WQ)(a.M)(d,void 0,0)||i))||i;var d},885627:(e,t,r)=>{r.d(t,{L:()=>n,a:()=>i});class i extends Error{constructor(e){super(e)}}class n{}},142330:(e,t,r)=>{r.d(t,{c:()=>p});var i=r(324586),n=r(626443),o=r(562229),s=r(298995),a=r(271716),c=r(225304),l=r(7089),d=r(776016),u=r(885627);const h=[n.v.BAD_GATEWAY,n.v.GATEWAY_TIMEOUT,n.v.SERVICE_UNAVAILABLE,n.v.REQUEST_TIMEOUT,n.v.INTERNAL_SERVER_ERROR];class p extends u.L{constructor(e){super(),(0,i.A)(this,"matchFileHash",!1),this.cdnUrl=e}async downloadAsset(e,{progress:t}={}){const r=(0,l.u)(),i=e.type,n=e.cloud?.id;try{if(o.z.logAppLogicEvent("HubbleContentDownloadInitiated",{contentType:i,correlationId:r}),!(0,d.O9)(this.cdnUrl))throw o.z.logErrorEvent("HubbleContentDownloadFailed",{correlationId:r,contentPath:n,errorAlertType:"Fatal",errorCode:"HubbleCdnUrlNotDefined"}),new s.hF("Cannot retrieve Hubble content without CDN URL.");if(!(0,d.O9)(e.cloud)||!(0,d.O9)(e.cloud.id))throw o.z.logErrorEvent("HubbleContentDownloadFailed",{correlationId:r,contentPath:n,errorAlertType:"Fatal",errorCode:"HubbleCloudIdNotDefined"}),new s.v5("Cannot retrieve Hubble content without the cloud ID.");const l=`${this.cdnUrl}/${e.cloud.id}`,u=await a.r.get(l,{retryableHttpCodes:h,retryPolicy:{doRetry:c.PL,maxAttempts:3,backOffPolicy:"exponential"},headers:{"x-correlation-id":r},extraData:{responseType:"blob",onProgress:e=>{e.total&&t&&t(e.loaded/e.total)}}});return o.z.logAppLogicEvent("HubbleContentDownloadCompleted",{contentType:i,correlationId:r}),u.blob()}catch(e){if(e instanceof c.Xb)throw o.z.logErrorEvent("HubbleContentDownloadFailed",{statusCode:(0,s.DD)(e.status),correlationId:r,contentPath:n,errorAlertType:"Fatal",errorCode:(0,s.H$)(e.status)}),new s.L7("GET",(0,s.DD)(e.status));if(e instanceof c.j$)throw o.z.logErrorEvent("HubbleContentDownloadFailed",{statusCode:(0,s.DD)(e.status),correlationId:r,contentPath:n,errorAlertType:"Fatal",errorCode:(0,s.H$)(e.status)}),new s.GA("GET",(0,s.DD)(e.status));if(e instanceof c.Dr)throw o.z.logErrorEvent("HubbleContentDownloadFailed",{correlationId:r,contentPath:n,errorAlertType:"Fatal",errorCode:"NetworkError"}),new s.PN("GET",navigator.onLine);if(e instanceof c.vt)throw o.z.logErrorEvent("HubbleContentDownloadFailed",{correlationId:r,contentPath:n,errorAlertType:"Fatal",errorCode:"NetworkAbortError"}),new s.lk("GET");if(e instanceof c.iC)throw o.z.logErrorEvent("HubbleContentDownloadFailed",{correlationId:r,contentPath:n,errorAlertType:"Fatal",errorCode:"JsonParseError"}),new s.Wy("Hubble content request failed on json parse");if(e instanceof c.l0)throw o.z.logErrorEvent("HubbleContentDownloadFailed",{correlationId:r,contentPath:n,errorAlertType:"Fatal",errorCode:"UnexpectedResponseBody"}),new s.fL("Hubble content request failed on unexpected response body");if(e instanceof s.hF||e instanceof s.v5)throw e;throw o.z.logErrorEvent("HubbleContentDownloadFailed",{correlationId:r,contentPath:n,errorAlertType:"Unhandled",errorCode:"UnknownError"}),new s.pq("Hubble content request failed with an unknown error")}}setCdn(e){this.cdnUrl=e}}},971280:(e,t,r)=>{r.d(t,{Y:()=>v,F:()=>A});var i,n,o,s=r(324586),a=(r(379321),r(776016)),c=r(397814);class l extends c.L{constructor(e,t){super(),(0,s.A)(this,"payload",void 0),this.payload={id:e,error:t}}}i=l,(0,s.A)(l,"type","[Asset] Load File Failed"),(0,s.A)(l,"isInstance",(0,a.t9)({type:(0,a.u)(i.type),payload:(0,a.t9)({id:a.Kg,error:a.Kg})}));class d extends c.L{constructor(e){super(),(0,s.A)(this,"payload",void 0),this.payload={id:e}}}n=d,(0,s.A)(d,"type","[Asset] File Loaded"),(0,s.A)(d,"isInstance",(0,a.t9)({type:(0,a.u)(n.type),payload:(0,a.t9)({id:a.Kg})}));class u extends c.L{constructor(e,t){super(),(0,s.A)(this,"payload",void 0),this.payload={id:e,path:t}}}o=u,(0,s.A)(u,"type","[Asset] Load File"),(0,s.A)(u,"isInstance",(0,a.t9)({type:(0,a.u)(o.type),payload:(0,a.t9)({id:a.Kg,path:a.Kg})}));var h=r(613001),p=r(175358),m=r(7089),f=r(167251),g=r(885627);const A={PATH_NOT_SUPPORTED:[(0,p.mj)("editor.providerImport.nativeAppPathNotSupportedTitle","Path not supported by Clipchamp."),(0,p.mj)("editor.providerImport.nativeAppPathNotSupportedSubtitle","Please launch the Clipchamp app using an alternative path.")],FAILED_TO_LOAD:[(0,p.mj)("editor.providerImport.nativeAppGeneralErrorTitle","Something went wrong."),(0,p.mj)("editor.providerImport.nativeAppGeneralErrorSubtitle","Please try again.")]};class v extends g.L{get errorMessageMap(){return A}constructor(e){super(),(0,s.A)(this,"matchFileHash",!1),this.nativeMessagingService=e}downloadAsset(e,t={}){return(0,h.U2)(e)&&e.cloud.id?this.loadFile(e):Promise.reject(new Error("Tried to fetch asset without provider details"))}async loadFile(e){return new Promise(((t,r)=>{const i=(0,m.u)();let n=null,o=!1,s=!1;const a=[],c=this.createFileInputField(i);let h=null;const p=()=>{h&&c.removeEventListener("change",h),c.remove(),a.forEach((e=>e()))},g=()=>{s||o&&n&&(p(),s=!0,t(n))},A=(t="FAILED_TO_LOAD")=>{if(s)return;let i="";if(t in this.errorMessageMap&&([t,i]=this.errorMessageMap[t]),p(),s=!0,"ACCESS_DENIED"===t)return r(new f.HJ(e));r(new f.ph(e,{title:t,message:i}))};h=e=>{const t=e.target?.files;t&&0!==t.length?(n=t[0],g()):A("FAILED_TO_LOAD")},a.push(this.nativeMessagingService.listen(l,(e=>{e.payload.id===i&&A(e.payload.error)})),this.nativeMessagingService.listen(d,(e=>{e.payload.id===i&&(o=!0,g())}))),c.addEventListener("change",h),document.body.append(c),this.nativeMessagingService.send(new u(i,e.cloud.id))}))}createFileInputField(e){const t=document.createElement("input");return t.type="file",t.id=e,t.dataset.testid=e,t.style.visibility="hidden",t.style.position="absolute",t.style.width="0",t.style.height="0",t}}},26860:(e,t,r)=>{r.d(t,{U:()=>n,g:()=>i});const i="remoteAssetRegistry";class n{}},639327:(e,t,r)=>{r.d(t,{$l:()=>S,Zk:()=>y,gx:()=>v,s8:()=>A,wz:()=>w});var i,n=r(324586),o=r(825702),s=r(562229),a=r(312148),c=r(739367),l=r(571511),d=r(225304),u=r(650882),h=r(860784),p=r(7089),m=r(871287),f=r(885627),g=r(26860);class A extends Error{constructor(e){super(e)}}class v extends Error{constructor(){super("Project item not set. Asset could not be downloaded.")}}class y extends Error{constructor(e){super(e)}}class b extends u.g9{constructor(e){super("Remote file does not match imported asset",e)}}let w=(0,o.Gr)()((x=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[void 0===g.U?Object:g.U])(i=class{constructor(e){(0,n.A)(this,"resetControllable",new h.z),(0,n.A)(this,"abortController",new AbortController),this.remoteAssetRegistry=e}async fetchAsset(e,t){if("cloud"in e&&e.cloud){const r=(0,p.u)(),i={provider:e.cloud.provider,correlationId:r,resolver:"provider"};s.z.logEvent("Usage - Remote Asset Fetch Start",i),s.z.logAppLogicEvent("MediaDownloadInitiated",i);const n=await this.remoteAssetRegistry.getProvider(e.cloud.provider);if(n)try{const r=performance.now(),o=await Promise.race([this.resetControllable.promise,n.downloadAsset(e,{...t,abort:this.abortController.signal})]);e.fileHashes&&n.matchFileHash&&await this.validateRemoteFileHash(e,o);const a=performance.now()-r;return s.z.logEvent("Usage - Remote Asset Fetch Success",{...i,downloadDurationMs:a,sizeToDownloadDurationRatio:o.size/a}),s.z.logAppLogicEvent("MediaDownloadCompleted",{...i,fileSize:o.size,durationMs:a,startTimeMs:r}),new File([o],e.name,{type:o.type,lastModified:Date.now()})}catch(e){throw this.handleError(e,i),e}}throw new Error("No provider for asset")}handleError(e,t){if(e instanceof b&&(s.z.logEvent("Error - Remote Asset Fetch Mismatch",{...t,...e.toEventProperties()}),s.z.logErrorEvent("MediaDownloadMismatchError",t)),e instanceof y&&(s.z.logEvent("Error - Remote Asset Fetch Not Found",{...t,errorMessage:e.message}),s.z.logWarningEvent("MediaDownloadNotFoundError",t)),e instanceof f.a)s.z.logEvent("Error - Remote Asset Fetch Expected Failure",{...t,errorMessage:e.message});else if(!(e instanceof A))if(e instanceof d.j$)this.logErrorEvent("Http",e.message,t,e.status.toString());else if(e instanceof d.Dr)this.logErrorEvent("Network",e.message,t);else if(e instanceof l.S)this.logErrorEvent("FailedTypeCheck",e.message,t);else if(e instanceof v)this.logErrorEvent("ProjectItemNotSet",e.message,t);else{let r;"message"in e&&(r=e.message),this.logErrorEvent("Unknown",r,t)}}logErrorEvent(e,t,r,i){s.z.logErrorEvent("MediaDownloadFailedError",{...r,errorCode:i,errorType:e}),s.z.logEvent("Error - Remote Asset Fetch Failure",{...r,errorStatus:i,errorType:e,errorMessage:t})}reset(){this.resetControllable.reject(new A("Fetch Asset reset")),this.resetControllable.promise.catch((()=>{})),this.abortController.abort(),this.abortController=new AbortController,this.resetControllable=new h.z}async validateRemoteFileHash(e,t){const r=await(0,m.wr)(t),[i,n]=(0,a.q)(e,r,t.size);if(!i)throw new b({matchType:n,originalHash:e.fileHashes?.original,transcodeHash:e.fileHashes?.transcode})}})||i)||i,i=(0,o.WQ)(g.g)(x,void 0,0)||i))||i;var x;const S=()=>(0,c.l)(w)},227565:(e,t,r)=>{r.d(t,{y:()=>o});var i=r(739367),n=r(186975);const o=()=>(0,i.l)(n.u)},466287:(e,t,r)=>{async function i({audioBuffer:e,newNumChannels:t,newSampleRate:r}){t||(t=e.numberOfChannels),r||(r=e.sampleRate);const i=new OfflineAudioContext({numberOfChannels:t,sampleRate:r,length:e.duration*r*t}),n=new AudioBufferSourceNode(i,{buffer:e});return n.start(0),n.connect(i.destination),await i.startRendering()}r.d(t,{D:()=>i})},905470:(e,t,r)=>{r.d(t,{M:()=>s});var i=r(989230),n=r(571056),o=r(889688);async function s({asset:e,audioContext:t,assetResolver:r,onProgress:s}){t||(t=new AudioContext),r||(r=(0,o.W)(n.e)),s||(s=()=>{});const a=await r.fetch(e);return(0,i.J)(t,a,e.metadata.raw,s,!0)}},961722:(e,t,r)=>{r.d(t,{I7:()=>c,X:()=>a,vg:()=>s}),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);const i={ChunkID:0,ChunkSize:4,Format:8,Subchunk1ID:12,Subchunk1Size:16,AudioFormat:20,NumChannels:22,SampleRate:24,ByteRate:28,BlockAlign:32,BitsPerSample:34,Subchunk2ID:36,Subchunk2Size:40},n=i.Subchunk2Size+4;function o(e,t,r){for(let i=0;i<r.length;i++)e.setUint8(t+i,r.charCodeAt(i))}function s(e,t){const r=function(e,t,r){const s=2*r,a=2*e,c=new ArrayBuffer(n),l=new DataView(c);return o(l,i.ChunkID,"RIFF"),l.setUint32(i.ChunkSize,a+36,!0),o(l,i.Format,"WAVE"),o(l,i.Subchunk1ID,"fmt "),l.setUint32(i.Subchunk1Size,16,!0),l.setUint16(i.AudioFormat,1,!0),l.setUint16(i.NumChannels,1,!0),l.setUint32(i.SampleRate,r,!0),l.setUint32(i.ByteRate,s,!0),l.setUint16(i.BlockAlign,2,!0),l.setUint16(i.BitsPerSample,16,!0),o(l,i.Subchunk2ID,"data"),l.setUint32(i.Subchunk2Size,a,!0),new Uint8Array(c)}(e.byteLength/Uint16Array.BYTES_PER_ELEMENT,0,t),s=new Uint8Array(r.length+e.byteLength);return s.set(r,0),s.set(new Uint8Array(e),r.length),s}function a(e){return Int16Array.from(e.getChannelData(0).map((e=>32768*Math.min(Math.max(e,-1),1)))).buffer}function c(e){return s(a(e),e.sampleRate)}},559755:(e,t,r)=>{r.d(t,{j:()=>c});var i=r(324586),n=(r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(776016)),o=r(382684),s=r(6690);const a="token",c=new class{constructor(){(0,i.A)(this,"token",void 0),(0,i.A)(this,"claims",void 0),(0,i.A)(this,"listeners",new Set)}setToken(e){this.setTokenAny(e)}getToken(){return this.token}getClaims(){return this.claims}getClaim(e,t){return(0,o.D)(this.claims,e,t)}getProvider(){const e=this.getClaims();if(e)return(0,o.D)(e,"provider")}removeToken(){this.setTokenAny(void 0)}registerForChanges(e){return this.listeners.add(e),()=>this.listeners.delete(e)}loadFromStorage(){const e=window.localStorage.getItem(a);if((0,n.O9)(e))return this.setTokenAny(e),e}saveToStorage(){(0,n.O9)(this.token)?window.localStorage.setItem(a,this.token):window.localStorage.removeItem(a)}setTokenAny(e){this.token!==e&&(this.token=e,this.claims=this.parseJwt(this.token),this.listeners.forEach((e=>e(this.token,this.claims))),this.saveToStorage())}parseJwt(e){if(e)try{return(0,s.oL)(e)}catch{return}}}},719587:(e,t,r)=>{r.d(t,{F1:()=>p,Ti:()=>l,ZO:()=>h,cO:()=>u,go:()=>d,qG:()=>A,yC:()=>g});var i=r(324586),n=r(138615),o=r(847269),s=r(540076),a=r(670814),c=r(6690);const l="microsoftAuthDefaultOptions",d=e=>void 0!==e?.isRedirecting,u=["profile","openid","offline_access"],h="service::www.microsoft.com::MBI_SSL",p={graph:"https://graph.microsoft.com",substrate:"https://substrate.office.com",augloop:"https://augloop.office.com/v2",pushChannel:"https://pushchannel.1drv.ms",ocps:"https://clients.config.office.net",mac:"https://portal.office.com",office:"https://officeapps.live.com",sharepoint:void 0},m=["profile","openid","offline_access",".default"],f=(e,t)=>0===e.length?[`${t}/.default`]:e.map((e=>e.startsWith("https://")||[...m,"email"].some((t=>e.endsWith(t)))?e:`${t}/${e}`)),g="microsoftAuthService";class A{constructor(e){(0,i.A)(this,"userSession",void 0),(0,i.A)(this,"accessTokens",{}),this.defaultRequest=e}onLogin({user:e,idToken:t}){(this.userSession?.user.accountId!==e.accountId||this.userSession?.user.idTokenClaims?.iat!==e.idTokenClaims?.iat||t&&this.userSession?.idToken!==t)&&(this.userSession={user:e,idToken:t})}onLogout(){this.userSession=void 0}setCachedToken(e,t,r){let i;try{i=(0,c.oL)(r)}catch{return}(0,o.iY)(i,"Access token is invalid");const n=(0,a.nE)(i)||t,l=i.aud,d=f(n,l),u=i.exp;(0,s.vA)(!!u,"Cannot cache a token without an expiry"),(0,s.vA)(!(0,c.Hm)(u,300),"Cannot cache a token that has already expired");const h={scopes:d,token:r,expiry:u};this.accessTokens[e]=h}getCachedToken(e,t){const r=this.accessTokens[e];if(void 0!==r&&(i=r.scopes,0===(n=t).length||!(i.length<n.length)&&n.every((e=>{return t=e,m.some((e=>t.endsWith(e)))||i.includes(e);var t})))&&!(0,c.Hm)(r.expiry,300))return r.token;var i,n}validateRequestParameters(e){switch(e.tokenType=e.tokenType||this.defaultRequest?.tokenType||"graph",e.tokenType){case"graph":return this.createGraphRequest(e);case"sharepoint":return this.createSharePointRequest(e);case"custom":return this.createCustomRequest(e);case"substrate":return this.createSubstrateRequest(e);default:{const t=p[e.tokenType];return!t||(0,n.Us)("ks_multi__disable_auth_default_scope")?{resource:p[e.tokenType],tokenType:e.tokenType}:{scopes:f([],t),tokenType:e.tokenType}}}}createSubstrateRequest(e){(0,s.vA)("substrate"===e.tokenType,"Invalid token type");const{resource:t,...r}=e,i=p[e.tokenType];(0,o.iY)(i,"Missing resource URI for token type");const n=e.scopes||"substrate"===this.defaultRequest?.tokenType&&this.defaultRequest?.scopes||[];return{...r,scopes:f(n,i),tokenType:e.tokenType}}createGraphRequest(e){(0,s.vA)("graph"===e.tokenType,"Invalid token type");const{resource:t,...r}=e,i=p[e.tokenType];(0,o.iY)(i,"Missing resource URI for token type");const n=e.scopes||"graph"===this.defaultRequest?.tokenType&&this.defaultRequest?.scopes||[];return{...r,scopes:f(n,i),tokenType:e.tokenType}}createSharePointRequest(e){(0,s.vA)("sharepoint"===e.tokenType,"Invalid token type");const{resource:t,...r}=e,i=e.scopes||"sharepoint"===this.defaultRequest?.tokenType&&this.defaultRequest?.scopes||[],n=t||("sharepoint"===this.defaultRequest?.tokenType?this.defaultRequest?.resource:void 0);return(0,o.iY)(n,"Missing resource URI for token type"),{...r,scopes:f(i,n),tokenType:e.tokenType}}createCustomRequest(e){(0,s.vA)("custom"===e.tokenType,"Invalid token type");const{resource:t,...r}=e;let i=e.scopes||"custom"===this.defaultRequest?.tokenType&&this.defaultRequest?.scopes||[];const n=t||("custom"===this.defaultRequest?.tokenType?this.defaultRequest?.resource:void 0);return n&&(i=f(i,n)),{...r,scopes:i}}}},558899:(e,t,r)=>{r.d(t,{f:()=>s,e:()=>a});var i=r(776016);class n extends Error{constructor(){super("Auth state is not initalized")}}let o;function s(){if(!(0,i.O9)(o))throw new n;return o}function a(e){var t;o={...e,apiBaseUrl:(t=e.apiBaseUrl,t.endsWith("/")?t.slice(0,-1):t)}}},906756:(e,t,r)=>{r.d(t,{l:()=>i});class i extends Error{constructor(e,t,r){super(e),this.code=t,this.details=r}}},957745:(e,t,r)=>{r.d(t,{S:()=>c}),r(584570),r(82265),r(988124);var i=r(225304),n=r(776016),o=r(906756);const s=(0,n.t9)({error_description:n.Kg,error_code:n.Kg}),a=(0,n.t9)({error_details:(0,n.H7)(n.Gv)});class c extends o.l{constructor(e){let t,r="",n="";if(e instanceof i.j$)if(s(e.body))r=e.body.error_description,n=e.body.error_code,a(e.body)&&(t=e.body.error_details);else{let t;try{const r=new URL(e.response.url);t=`${r.origin}${r.pathname}`}catch{t=e.response.url}r=`Http failure for ${t}: ${e.response.status} ${e.response.statusText}`}else r=e;super(r,n,t)}}},825855:(e,t,r)=>{r.d(t,{D8:()=>c,YB:()=>s,cr:()=>a});var i=r(412746),n=r(776016);const o=(0,i.y)(((e,t)=>({additionHeaders:{},setAdditionalHeaders:t=>{e({additionHeaders:t})},patchAdditionalHeaders:r=>{e({additionHeaders:{...t().additionHeaders,...r}})},getAdditionalHeaders:()=>t().additionHeaders,clearAdditionalHeaders:()=>{e({additionHeaders:{}})},deleteAdditionalHeaders:r=>{const i={...t().additionHeaders};r.forEach((e=>{(0,n.O9)(i[e])&&delete i[e]})),e({additionHeaders:i})}})));function s(){return o.getState().additionHeaders}function a(e){o.setState({additionHeaders:e})}function c(){o.getState().clearAdditionalHeaders()}},972070:(e,t,r)=>{r.d(t,{E:()=>w});var i=r(706558),n=r(889688),o=r(431232),s=r(559755),a=r(558899),c=r(825855);function l(e){return Object.entries(e).reduce(((e,[t,r])=>{const i="function"==typeof r?r():r;return i&&(e[t]=i),e}),{})}function d(e){return e.startsWith("/")?e:"/"+e}const u=(e,t)=>{const r=(0,a.f)().apiBaseUrl,i=s.j.getToken(),n=l((0,c.YB)());return fetch(`${r}${d(e)}`,{...t,headers:{"Content-Type":"application/json",Authorization:"Bearer "+i,"X-Requested-With":"XMLHttpRequest",...n,...t?.headers}})};var h=r(626443),p=r(225304),m=r(776016),f=r(719587),g=r(288660),A=r(24305);const v=(0,m.t9)({code:m.Kg}),y=(0,o.H)((async(e,t)=>{const r=(0,a.f)().apiBaseUrl,i=l((0,c.YB)());return fetch(`${r}${d(e)}`,{...t,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",...i,...t?.headers}})})),b=async()=>{const e=(0,n.W)(f.yC);await e.initialize();const{session:t}=await e.login({usePopupLogin:!1});if(!t)throw new Error("No user session");const r=await(async(e,t)=>{try{return(await y.post("/auth/microsoft1p/token",{body:{access_token:e,id_token:t},retryableHttpCodes:[...A.U,h.v.CONFLICT],retryPolicy:{doRetry:p.PL,maxAttempts:e?3:0,backOffPolicy:"fixed",backOff:1500}}).json(v)).code}catch(e){throw(0,g.H)(e,"UNEXPECTED_TOKEN_EXCHANGE_ERROR","Unexpected error during msa token exchange")}})(t.accessToken,t.idToken),i=await(async e=>{try{const{token:t}=await y.get(`/auth/token?code=${encodeURIComponent(e)}`,{retryableHttpCodes:A.U,retryPolicy:{doRetry:p.PL,maxAttempts:3,backOffPolicy:"exponential",backOff:500}}).json((0,m.t9)({token:m.Kg}));return t}catch(e){throw(0,g.H)(e,"UNEXPECTED_TOKEN_EXCHANGE_ERROR","Clipchamp authentication error")}})(r);return i},w=(0,o.H)((async(e,t)=>{try{return"consumer"===(0,n.W)(i.l).appName?(async(e,t)=>{if(!s.j.loadFromStorage()){const r=await b();return s.j.setToken(r),u(e,t)}const r=await u(e,t);if(401!==r.status)return r;const i=await b();return s.j.setToken(i),u(e,t)})(e,t):u(e,t)}catch{return u(e,t)}}))},845960:(e,t,r)=>{r.d(t,{S:()=>s,o:()=>n});var i=r(825702);const n="AuthUserHooks";function o(){return!1}i.kL.register(n,{useFactory:()=>({useIsPowerUser:o})});const s=e=>{const{useIsPowerUser:t}=i.kL.resolve(n);return t(e)}},382684:(e,t,r)=>{r.d(t,{D:()=>n,h:()=>i});const i={UNDEFINED:0,MINOR_WITHOUT_PARENTAL_CONSENT:1,MINOR_WITH_PARENTAL_CONSENT:2,ADULT:3,NOT_ADULT:4,MINOR_NO_PARENTAL_CONSENT_REQUIRED:5},n=(e,t,r)=>{if(e&&t in e)return r?r(e[t])?e[t]:void 0:e[t]}},670814:(e,t,r)=>{r.d(t,{HA:()=>o,LS:()=>s,Rd:()=>a,nE:()=>c}),r(584570),r(82265),r(988124);var i=r(6690);const n="9188040d-6c67-4c5b-b112-36a304b66dad",o=(e,t)=>t===n||e.includes(n)?"personal":"business",s=e=>({accountId:e.oid,tenantId:e.tid,appAccountId:e.sub,nativeAccountId:void 0,environment:new URL(e.iss).hostname,username:e.preferred_username,name:e.name,puid:e.puid,accountType:o(e.oid,e.tid),idTokenClaims:e}),a=e=>{try{const t=(0,i.oL)(e);return s(t)}catch{return}},c=e=>{const t=e?.scp?e.scp.split(" "):[];if(0!==t.length)return t.filter((e=>"openid"!==e&&"profile"!==e&&"offline_access"!==e))}},288660:(e,t,r)=>{r.d(t,{H:()=>s});var i=r(225304),n=r(906756),o=r(957745);const s=(e,t,r)=>e instanceof i.j$?new o.S(e):e instanceof Error?new n.l(e.message,t):new n.l(r,t)},6690:(e,t,r)=>{function i(e){const t=e.split(".");if(3!==t.length)return;const r=function(e){let t=e.replaceAll("-","+").replaceAll("_","/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Illegal base64url string!")}return function(e){return decodeURIComponent(atob(e).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join(""))}(t)}(t[1]);return r?JSON.parse(r):void 0}function n(e,t=0){if("number"==typeof e)return Date.now()+1e3*t>=1e3*e;const r=function(e){const t=i(e);if(!t)return!1;if(!t.hasOwnProperty("exp"))return!0;const r=new Date(0);return r.setUTCSeconds(t.exp),r}(e);return!1===r||!0!==r&&r.valueOf()<=Date.now()+1e3*t}r.d(t,{oL:()=>i,Hm:()=>n}),r(95732)},24305:(e,t,r)=>{r.d(t,{U:()=>n});var i=r(626443);const n=[i.v.REQUEST_TIMEOUT,i.v.TOO_MANY_REQUESTS,i.v.INTERNAL_SERVER_ERROR,i.v.BAD_GATEWAY,i.v.SERVICE_UNAVAILABLE,i.v.GATEWAY_TIMEOUT]},769942:(e,t,r)=>{r.d(t,{h:()=>R});var i=r(324586);r(379321),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);class n{constructor(e){(0,i.A)(this,"blobs",[]),(0,i.A)(this,"offset",Number.NaN),this.capacityInBytes=e}get isUnanchored(){return Number.isNaN(this.offset)}get isFull(){return this.sizeInBytes>=this.capacityInBytes}get startOffsetInBytes(){return this.offset}get endOffsetInBytes(){return this.offset+this.sizeInBytes}get pageData(){return new Blob(this.blobs,{type:"application/octet-stream"})}anchorPage(e){if(this.isUnanchored)return this.offset=e,0;const t=e-this.offset;return t>=0&&t<this.capacityInBytes?t:Number.NaN}isGapless(e){return e<=this.sizeInBytes}resetPage(){this.offset=Number.NaN,this.blobs.splice(0,this.blobs.length)}writeToPage(e,t){const r=this.sizeInBytes;e===r?this.blobs.push(t):e>r?this.blobs.push(new Blob([new Uint8Array(e-r)]),t):this.seekbackAndWriteOnPage(e,t)}get sizeInBytes(){return this.blobs.reduce(((e,t)=>e+t.size),0)}getBlobSlice(e,t){let r=0;for(let i=0,n=this.blobs.length;i<n;++i){if(e<r+this.blobs[i].size)return{index:i,slice:"prefix"===t?this.blobs[i].slice(0,e-r):this.blobs[i].slice(e-r)};r+=this.blobs[i].size}}seekbackAndWriteOnPage(e,t){const r=this.getBlobSlice(e,"prefix"),i=this.getBlobSlice(e+t.size,"suffix");if(!r)throw new Error(`Cannot locate write at offset ${e} on page of ${this.sizeInBytes} bytes`);i?this.blobs.splice(r.index,i.index-r.index+1,r.slice,t,i.slice):this.blobs.splice(r.index,this.blobs.length-r.index+1,r.slice,t)}}class o{constructor(e,t,r=0){(0,i.A)(this,"page",void 0),this.perFileFlushCallback=e,this.fileSizeInBytes=r,this.page=new n(t)}get size(){return this.fileSizeInBytes}get file(){if(0===this.fileSizeInBytes||0===this.page.startOffsetInBytes&&this.page.endOffsetInBytes===this.fileSizeInBytes)return this.page.pageData;throw new Error("File comprises of more data than is held by the in-memory page")}async flush(){this.page.isUnanchored||(await this.perFileFlushCallback(this.page.startOffsetInBytes,this.page.pageData),this.page.resetPage())}async append(e){return await this.write(this.fileSizeInBytes,e)}async write(e,t){if(0===t.size)return;const r=this.page.anchorPage(e);return o.writeStartsOnPage(r)&&(this.page.isGapless(r)||this.isTruncateOperation(e))?await this.performWrite(r,t):(await this.flush(),await this.write(e,t))}async performWrite(e,t){if(this.page.writeToPage(e,t),this.fileSizeInBytes=Math.max(this.fileSizeInBytes,this.page.endOffsetInBytes),this.page.isFull)return this.flush()}isTruncateOperation(e){return this.page.endOffsetInBytes===this.fileSizeInBytes&&e>this.fileSizeInBytes}static writeStartsOnPage(e){return!Number.isNaN(e)}}var s=r(274764);class a{static async createNewFile(e,t,r){const i=(0,s.tP)(r),n=new a(i,e,t);try{return await n.backingFilePromise,n}catch(r){console.warn(`Error creating file in ${e}, falling back to in-memory storage`,r);const n=new a(i,t,t);return await n.backingFilePromise,n}}constructor(e,t,r){(0,i.A)(this,"backingFilePromise",void 0),(0,i.A)(this,"tainted",!1),(0,i.A)(this,"writeCache",void 0),this.fileName=e,this.backupStorage=r,this.tainted=!1,this.backingFilePromise=t.createNewFile(e),this.writeCache=new o(((e,t)=>this.onWriteCacheFlushed(e,t)),10485760)}async appendBlob(e){return await this.writeCache.append(e)}async writeBlob(e,t){return await this.writeCache.write(t,e)}async getFile(e){try{return(0,s.k0)(this.writeCache.file,this.fileName,e)}catch(t){return await this.writeCache.flush(),await(await this.backingFilePromise).getFile(e)}}async remove(){const e=await this.backingFilePromise;await e.remove()}get size(){return Promise.resolve(this.writeCache.size)}async onWriteCacheFlushed(e,t){const r=await this.backingFilePromise;try{await r.writeBlob(t,e)}catch(i){const n=await this.failoverStorage(i,r);await n.writeBlob(t,e)}finally{this.tainted=!0}}async failoverStorage(e,t){console.warn(`File write operation for ${this.fileName} has failed, failing over to in-memory storage`,e),this.backingFilePromise=this.backupStorage.createNewFile(this.fileName);const r=await this.backingFilePromise;if(this.tainted){console.warn("Existing file content needs to be moved into new in-memory file");const e=await t.getFile("application/octet-stream");await r.appendBlob(e)}return r}}var c=r(776016),l=r(871287);const d="clipchamp";class u{toString(){return this.constructor.name}async genericFileEviction(e,t,r){e.sort(t);const i=await Promise.all(e.map((async e=>{try{return await e.size}catch(t){return void console.warn(`Unable to get file size of "${e.fileName}" for file eviction`,t)}})));let n=i.filter(c.Et).reduce(((e,t)=>e+t),0);for(let t=e.shift();t&&this.requiresMoreEviction(r,n);t=e.shift()){const e=i.shift();if(void 0!==e){try{await t.remove()}catch(e){console.warn(`Unable to evict file "${t.fileName}"`,e);continue}n-=e}else console.warn("Expected evictedBytes to be defined")}}requiresMoreEviction(e,t){return e-t<268435456}async isUsable(){const e=await this.createNewFile((0,s.tP)("sample"));try{if(await e.appendBlob(new Blob([d],{type:"text/plain"})),await(0,l.FG)(await e.getFile("text/plain"))!==d)throw new Error("Sample file did not contain expected text")}catch(e){throw console.error(`Persistence ${this.toString()} is not usable`,e),e}finally{await e.remove()}}get usable(){return this.isUsable()}}const h=5242880;class p{constructor(){(0,i.A)(this,"filledSize",0),(0,i.A)(this,"internalBuffer",new Uint8Array(h))}get size(){return this.filledSize}get buffer(){return this.internalBuffer.subarray(0,this.filledSize)}write(e,t){const r=e+t.byteLength;this.internalBuffer=function(e,t,r){if(e.byteLength>=t)return e;const i="linear"===r.growthStrategy?Math.ceil(t/r.seedBufferSize)*r.seedBufferSize:Math.max(r.seedBufferSize,Math.pow(2,Math.ceil(Math.log2(t)))),n=new Uint8Array(i);return n.set(e,0),n}(this.internalBuffer,r,{seedBufferSize:h,growthStrategy:"linear"}),this.internalBuffer.set(t,e),this.filledSize=Math.max(this.filledSize,r)}}class m{constructor(e,t){(0,i.A)(this,"writeBuffer",new p),this.fileName=e,this.fileSystem=t}async appendBlob(e){const t=await(0,l.gm)(e);this.writeBuffer.write(this.writeBuffer.size,new Uint8Array(t))}async writeBlob(e,t){const r=await(0,l.gm)(e);this.writeBuffer.write(t,new Uint8Array(r))}async remove(){await this.fileSystem.removeFile(this.fileName)}async getFile(e){return(0,s.k0)(new Blob([this.writeBuffer.buffer]),this.fileName,e)}get size(){return Promise.resolve(this.writeBuffer.size)}}class f extends u{constructor(...e){super(...e),(0,i.A)(this,"files",[]),(0,i.A)(this,"supported",!0)}requiresMoreEviction(e,t){return t>134217728}async evictFiles(e){await this.genericFileEviction([...this.files],e,Number.NaN)}async removeFile(e){const t=this.files.findIndex((t=>t.fileName===e));if(-1===t)throw new Error(`No file named ${e} found in in-memory storage`);this.files.splice(t,1)}get usable(){return Promise.resolve(void 0)}async createNewFile(e){const t=new m(e,this);return this.files.push(t),t}}var g=r(563696);const A=new Map;function v(e,t=!1){const r=A.get(e);if(r){if(!t)return r;A.delete(e)}const i=function(e){return new Promise(((t,r)=>{navigator[e===window.TEMPORARY?"webkitTemporaryStorage":"webkitPersistentStorage"].queryUsageAndQuota(((e,r)=>{t({used:e,total:r})}),(t=>{console.error(`Error querying quota for ${e} storage`,t),r(t||new Error(`Error querying quota for ${e} storage`))}))}))}(e);return A.set(e,i),i.catch((()=>{A.delete(e)})),i}let y;const b=10737418240,w=new g.$;async function x(e,t=!1){const r=await function(e,t){return w.createTimedPromise(((r,i)=>{var n;e===window.TEMPORARY?v(window.TEMPORARY).then((e=>{r(e.total-e.used)}),i):t?(n=b,y=y||new Promise(((e,t)=>{navigator.webkitPersistentStorage.requestQuota(n,(t=>{e(t)}),(e=>{console.error("Error requesting quota of 10737418240 bytes for persistent storage",e),t(e||new Error("Error requesting quota of 10737418240 for persistent storage")),setTimeout((()=>{y=void 0}))}))}))).then(r,i):v(window.PERSISTENT).then((e=>{r(e.total-e.used)}),i)}),0)}(e,t);return new Promise(((t,i)=>{self.webkitRequestFileSystem(e,r,(i=>{t({fileSystem:i,storageType:e,capacity:r})}),(t=>{console.warn(`Failed to request file system for ${e} storage`,t),i(t)}))}))}async function S(e){const t=await x(e,!1),r=function(e){return e===window.TEMPORARY?5368709120:b}(e);if(t.capacity>=r)return t;throw new Error(`Insufficient capacity on file system ${e}`)}async function T(e,t,r=3e4){return new Promise(((i,n)=>{setTimeout((()=>{let o,s=!0;const a=setTimeout((()=>{console.error(`Timeout after ${r} millis while performing file writer operation, aborting`),e.abort()}),r);e.onabort=e=>{console.error("File writer operation was aborted",e),o=new Error("File writer operation was aborted")},e.onerror=e=>{console.error("File writer operation has errored",e),o=new Error("File writer operation has errored")},e.onwrite=e=>{s=!1},e.onwriteend=t=>{clearTimeout(a),e.onerror=()=>{},e.onabort=()=>{},e.onwrite=()=>{},e.onwriteend=()=>{},o?(console.error("A file writer error has previously occurred",o),n(o)):s?(console.error("No file write error has occurred, but the operation has not succeeded either"),n(new Error("File writer operation error of unknown origin"))):i()},t()}))}))}function C(e,t){if(0===t.length)return Promise.reject(new Error("Cannot create file with empty file path"));const r=t.split("/");return new Promise(((i,n)=>{const o=setTimeout((()=>{n(new Error(`Timeout when hierachically creating file ${t}`))}),6e4);!function e(t){const s=r.shift();if(void 0===s)throw new Error("Expected nextPathElement to be defined");0===r.length?t.getFile(s,{create:!0,exclusive:!1},(e=>{clearTimeout(o),i(e)}),(e=>{console.error(`Cannot create file "${s}" in parent directory "${t.name}"`,e),clearTimeout(o),n(e)})):function(e,t){return new Promise(((r,i)=>{const n=setTimeout((()=>{i(new Error(`Timeout creating child directory ${t} in parent directory ${e.name}`))}),3e4);e.getDirectory(t,{create:!0,exclusive:!1},(e=>{clearTimeout(n),r(e)}),(e=>{clearTimeout(n),i(e)}))}))}(t,s).then(e,(e=>{console.error(`Cannot create directory "${s}" in parent directory "${t.name}"`,e),clearTimeout(o),n(e)}))}(e)}))}function _(e){return new Promise(((t,r)=>{setTimeout((()=>{e.file(t,(t=>{console.error(`Error retrieving file for ${e.name}`,t),r(t)}))}))}))}function k(e,t,r){return T(e,(()=>{e.position!==r&&e.seek(r),e.write(t)}),3e4)}class E{constructor(e){(0,i.A)(this,"cachedFileAndWriterPromise",void 0),(0,i.A)(this,"fileName",void 0),this.fileSystemFile=e,this.fileName=this.fileSystemFile.fileEntry.name}async appendBlob(e){const{writer:t}=await this.getFileAndWriter();await k(t,e,t.length)}async writeBlob(e,t){const{writer:r}=await this.getFileAndWriter();await function(e,t){return t<=e.length?Promise.resolve():T(e,(()=>{e.truncate(t)}),3e4)}(r,t),await k(r,e,t)}async getFile(e){try{return(0,s.k0)(await _(this.fileSystemFile.fileEntry),this.fileName,e)}catch(t){console.warn(`Re-opening file ${this.fileName}`,t);const r=await function(e,t){if(0===t.length)return Promise.reject(new Error(`Cannot re-open file with empty file name in directory ${e.name}`));const r=t.split("/");return new Promise(((i,n)=>{const o=setTimeout((()=>{n(new Error(`Timeout while re-opening file ${t} in root directory "${e.name}" of file system ${e.filesystem?.name}`))}),6e4);!function e(t){const s=r.shift();if(void 0===s)throw new Error("Expected nextPathElement to be defined");0===r.length?t.getFile(s,{create:!1,exclusive:!1},(e=>{clearTimeout(o),i(e)}),(e=>{console.error(`Cannot open file "${s}" in parent directory "${t.name}" of file system ${t.filesystem?.name}`,e),clearTimeout(o),n(e)})):function(e,t){return new Promise(((r,i)=>{const n=setTimeout((()=>{i(new Error(`Timeout while into child directory ${t} of parent directory ${e.name}`))}),3e4);e.getDirectory(t,{create:!1,exclusive:!1},(e=>{clearTimeout(n),r(e)}),(e=>{clearTimeout(n),i(e)}))}))}(t,s).then(e,(e=>{console.error(`Cannot open directory ${s}" in parent directory "${t.name}"`,e),clearTimeout(o),n(e)}))}(e)}))}(this.fileSystemFile.singleton.fileSystem.root,this.fileName);return(0,s.k0)(await _(r),this.fileName,e)}}get size(){return(e=this.fileSystemFile.fileEntry,new Promise(((t,r)=>{setTimeout((()=>{e.getMetadata((e=>{t(e)}),r)}))}))).then((e=>e.size));var e}async remove(){return e=this.fileSystemFile.fileEntry,new Promise(((t,r)=>{setTimeout((()=>{e.remove(t,r)}))}));var e}getFileAndWriter(){return this.cachedFileAndWriterPromise||(this.cachedFileAndWriterPromise=new Promise(((e,t)=>{this.fileSystemFile.fileEntry.createWriter((t=>{e({...this.fileSystemFile,writer:t})}),(e=>{console.error(`Could not create writer for ${this.fileName}`,e),t(e)}))})).catch((e=>{throw delete this.cachedFileAndWriterPromise,e}))),this.cachedFileAndWriterPromise}}class I extends u{constructor(...e){super(...e),(0,i.A)(this,"supported",window.hasOwnProperty("webkitRequestFileSystem"))}async evictFiles(e){await this.evictFilesFromStorageType(e,window.TEMPORARY),await this.evictFilesFromStorageType(e,window.PERSISTENT)}async createNewFile(e){return new E(await async function(e){const t=await new Promise(((e,t)=>{const r=setTimeout((()=>{t(new Error("Timeout when querying storage"))}),5e3);S(window.PERSISTENT).catch((()=>S(window.TEMPORARY))).then((t=>{clearTimeout(r),e(t)}),(e=>{clearTimeout(r),t(e)}))})).catch((e=>(console.warn("Could not request file system non-interactively",e),async function(){return await x(window.PERSISTENT,!0)}())));return{fileEntry:await C(t.fileSystem.root,e),singleton:t}}(e))}async evictFilesFromStorageType(e,t){const[r,i]=await Promise.all([v(t),x(t)]),n=(await(o=i.fileSystem.root,new Promise(((e,t)=>{o.createReader().readEntries((t=>{e(t.filter((e=>e.isFile&&(0,s.pZ)(e.name))))}),t)})))).map((e=>new E({fileEntry:e,singleton:i})));var o;n.length>0&&await this.genericFileEviction(n,e,r.total)}}const R=new class{constructor(){(0,i.A)(this,"backupStorage",new f),(0,i.A)(this,"cachedPrimaryStorage",void 0)}get primaryStorage(){return this.cachedPrimaryStorage=this.cachedPrimaryStorage||async function(e){if(e.supported)return await e.usable,e;throw console.warn(`Persistence ${e.constructor.name} is not supported on this browser`),new Error("Tested persisted is not supported")}(new I).catch((()=>new f))}async createNewFile(e){return await a.createNewFile(await this.primaryStorage,this.backupStorage,e)}async evictFiles(e=s.NZ){try{await(await this.primaryStorage).evictFiles(e)}finally{await this.backupStorage.evictFiles(e)}}}},274764:(e,t,r)=>{r.d(t,{NZ:()=>l,O2:()=>o,k0:()=>d,kD:()=>a,pZ:()=>s,tP:()=>c});const i=/^clipchamp\.com_(\d+)_.*$/,n=/[^/]+\/([^\s;]+)/;function o(e){return(e||"")+"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replaceAll(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function s(e){return i.test(e)}function a(e){if(!e)return"bin";switch(e.toLowerCase()){case"video/x-ms-asf":return"asf";case"video/x-flv":return"flv";default:const t=n.exec(e);return t&&t[1]&&"*"!==t[1]?t[1]:"bin"}}function c(e){return`clipchamp.com_${Date.now()}_${o(e?(t=e,t.replaceAll(/\W/g,"")):void 0)}.bin`;var t}const l=(e,t)=>{const r=i.exec(e.fileName),n=i.exec(t.fileName);return r?n?Number.parseInt(r[1])-Number.parseInt(n[1]):1:n||e.fileName<t.fileName?-1:e.fileName>t.fileName?1:0};function d(e,t,r){return function(e){return e.hasOwnProperty("name")}(e)&&e.name||Object.defineProperty(e,"name",{value:t||`video.${a(r)}`,configurable:!0}),e.type===r?e:function(e,t){const r=new Blob([e],{type:t||"application/octet-stream"});return Object.defineProperty(r,"name",{value:e.name,configurable:!0}),r}(e,r)}},268774:(e,t,r)=>{r.d(t,{A:()=>o,Y:()=>c}),r(977653),r(584570),r(82265),r(988124);var i=r(225762),n=r(847269);function o(e){return{source:"local",name:"name"in e?e.name:void 0,size:e.size,file:e}}function s(e){let t;if(e instanceof URL)t=e;else{if(!URL.canParse(e))return;t=new URL(e)}const r=t.pathname.split("/").pop();return void 0===r||0===r.length?void 0:r}async function a(e){const t=await fetch(e,{headers:{Range:"bytes=0-0"}});if(416===t.status)return 0;if(!t.ok)throw new Error(`Request failed with response: ${t.statusText} (${t.status})`);const r=(0,n.sw)(t.headers.get("Content-Range"),"Response did not contain Content-Range header"),o=(0,n.sw)(i.gb.exec(r),"Cannot determine file size");return Number.parseInt(o[3])}async function c(e,t){return{source:"http",name:s(e),size:t??await a(e),url:e instanceof URL?e.href:e}}},432300:(e,t,r)=>{r.d(t,{Ck:()=>c,EF:()=>u,IS:()=>d,P1:()=>l,Vz:()=>s,XR:()=>a,c6:()=>i,f8:()=>o,rs:()=>h});const i=1e6;function n(e){return-(e.charCodeAt(0)|e.charCodeAt(1)<<8|e.charCodeAt(2)<<16|e.charCodeAt(3)<<24)}const o=-6,s=-48,a=n("EOF "),c=n("INDA"),l=n("øOPT"),d=n("øFIL"),u=-1668179713,h=-1668179714},580490:(e,t,r)=>{r.d(t,{l2:()=>x,of:()=>A,Jw:()=>g,Nm:()=>S,T7:()=>T,d:()=>y,E8:()=>b,n2:()=>w,Wn:()=>v});var i=r(885935),n=r(769942),o=r(15464),s=r(944865);r(379321),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);const a=16;function c({frameReader:e},t){const r=(i=new Uint8Array(a).map((()=>Math.floor(256*Math.random())%256)),[...i].map((e=>e.toString(16).padStart(2,"0"))).join(""));var i;return t[r]={frameCallback:t=>e.dequeueFrame(t),resumeCallback:()=>e.resumeCompositor()},{streamId:r,frameSizeInBytes:e.frameSizeInBytes,numberOfFrames:e.numberOfFrames}}function l(e,t){return"frameReader"in e?c(e,t):"permanentUrl"in e?{permanentUrl:e.permanentUrl}:e}var d=r(167004);const u=33554432,h=new i.Y((function(e,t){return(0,d.hL)(e,t)})),p=new i.Y((function(e,t){return(0,d.aK)(e,t)})),m=new i.Y((e=>(0,d.RI)(e)));function f(e){const t=[(0,d.Vy)(e)];return Promise.all(t)}function g(e,t,r,i){h.enqueueForBatchExecution(e,i).then(t,r)}function A(e,t,r,i,n){p.enqueueForBatchExecution({inputVideo:e,metadata:t},n).then(r,i)}function v(e,t,r,i,n,s,a,u,h,p){return function(e){return e?f(!0):Promise.resolve([])}(h).then((function(){!function(){const o={};let h;try{h=function(e,t){return{...e,segments:e.segments.map((e=>({...e,graph:e.graph.map((e=>({...e,inputFile:l(e.inputFile,t)}))),video:c(e.video,t)})))}}(e,o),(0,d.J0)(h,t,i,n,o,(function(e,t,r){p&&p.onChunkAvailableCallback(e,t,r)}),a,u).then((function(e){r(e.files[0].blob,e.files[0].remove,e.stats)}),s)}catch(e){s(e)}}()})),new o.t((function(){return f(!0)}))}function y(e,t,r,i,n,o){(function(){if(o){const e="Audio splicing is forced";return console.warn(e),Promise.reject(e)}if("local"===e.source&&e.file&&e.file.size<=u)return console.warn("A/V file is smaller than threshold of "+u/1048576+" MB, will not splice out audio track"),(0,s.BM)(e.file);if("http"===e.source&&e.url&&"number"==typeof e.size&&e.size<=u)return console.warn("A/V URL is smaller than threshold of "+u/1048576+" MB, will not splice out audio track"),(0,s.Zz)(e.url);{const e="File is too large, not loading it into main memory";return console.warn(e),Promise.reject(e)}})().then((function(e){r(e)})).catch((function(){(0,d.d)(e,t,n,(function(){})).then(r,i)}))}function b(e,t,r,i,n,o){(0,d.E8)(e,t,r,o).then(i,n)}function w(e,t,r,i,n,o,s,a){(0,d.xE)(e,t,r,o,s,a).then(i,n)}function x(e){return m.enqueueForBatchExecution(e,(()=>{}))}function S(e){return n.h.evictFiles(e)}function T(e){return(0,d.Wb)(e)}},692701:(e,t,r)=>{r.d(t,{w:()=>A,c:()=>g});var i=r(324586),n=r(401834),o=r(563696),s=r(650882),a=r(944865),c=r(957734);class l{constructor(e){this.reject=e}cancel(){this.reject(new c.c)}}class d{constructor(e){(0,i.A)(this,"promise",void 0),(0,i.A)(this,"timeoutId",void 0),(0,i.A)(this,"expired",!1),(0,i.A)(this,"reject",void 0),this.promise=new Promise(((e,t)=>{this.reject=t,this.expired&&t(new Error("Timeout immediately reached"))})),this.timeoutId=window.setTimeout((()=>{this.expired=!0,this.reject&&this.reject(new Error(`Timeout reached after ${e} milliseconds`))}),e)}cancel(){window.clearTimeout(this.timeoutId)}}class u{constructor(e,t){(0,i.A)(this,"calls",new o.$),(0,i.A)(this,"worker",void 0),(0,i.A)(this,"channel",void 0),(0,i.A)(this,"seqno",0),(0,i.A)(this,"pending",new Map),this.buildType=e,this.createWorker=t,[this.worker,this.channel]=this.start()}cancel(){this.pending.forEach((e=>e.cancel()))}restart(){this.worker&&(this.worker.terminate(),this.cancel(),(0,a.wW)(this.worker)),this.calls.discardQueued(),[this.worker,this.channel]=this.start()}start(){const e=this.createWorker();e.addEventListener("close",(()=>{(0,a.wW)(e),this.cancel()})),e.addEventListener("error",(e=>{console.error(`Worker sent error ${e.message} (${e.filename}: ${e.lineno})`,e.error)}));const t=(0,n.q)("ffmpeg",e);return t.sendMessageSync("init-params",{buildType:this.buildType}),(0,a.At)(e),[e,t]}async cleanupWithPing(e){const t=new d(5e3);try{await Promise.race([t.promise,e])}catch(e){this.restart()}finally{t.cancel()}}call(e,t,r,i){return this.calls.createTimedPromise((async(n,o)=>{const a=this.seqno++;this.pending.set(a,new l(o));try{n(await this.channel.requestAndExpectResponse(e,t,r,i))}catch(e){o((0,s.xM)(e,"EnhancedWorker request failed"))}finally{this.pending.delete(a),"ping"!==e&&await this.cleanupWithPing(this.channel.requestAndExpectResponse("ping",void 0))}}),0)}async cleanup(){await this.cleanupWithPing(this.call("ping",void 0))}send(e,t,r){this.channel.sendMessageSync(e,t,r)}}class h{constructor(e,t){(0,i.A)(this,"worker",void 0),this.buildType=e,this.createWorker=t}ensureWorker(){return void 0===this.worker&&(this.worker=new u(this.buildType,this.createWorker)),this.worker}async cleanup(){if(void 0!==this.worker)return this.worker.cleanup()}call(e,t,r,i){return this.ensureWorker().call(e,t,r,i)}send(e,t,r){this.ensureWorker().send(e,t,r)}}var p=r(734273);r(584570),r(82265),r(988124);const m={"ffmpeg_wasm_relaxed_simd.js":new URL(r(121660),r.b).href,"ffmpeg_wasm_relaxed_simd.wasm":new URL(r(224955),r.b).href,"ffmpeg_wasm_simd.js":new URL(r(130716),r.b).href,"ffmpeg_wasm_simd.wasm":new URL(r(932475),r.b).href,"ffmpeg_wasm.js":new URL(r(194426),r.b).href,"ffmpeg_wasm.wasm":new URL(r(799677),r.b).href};let f;async function g(e){const t=await(0,p.Z)();return function(e){const t=m[`ffmpeg_${e}.wasm`],r=m[`ffmpeg_${e}.js`],i=document.createElement("link");i.setAttribute("rel","preload"),i.setAttribute("as","fetch"),i.setAttribute("type","application/wasm"),i.setAttribute("href",t);const n=document.createElement("link");n.setAttribute("rel","modulepreload"),n.setAttribute("as","script"),n.setAttribute("type","application/javascript"),n.setAttribute("href",r),document.head.append(i,n)}(t),f||(f={fullWorker:new u(t,e),probeWorker:new u(t,e),importWorker:new u(t,e),filmstripWorker:new u(t,e),mixerWorker:new h(t,e)}),f}function A(){if(!f)throw new Error("Workers accessed before initialisation");return f}},167004:(e,t,r)=>{r.d(t,{Vy:()=>F,Wb:()=>_,xE:()=>x,d:()=>T,RI:()=>R,aK:()=>E,hL:()=>k,J0:()=>C,Ip:()=>I,E8:()=>S}),r(379321),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);var i=r(138615),n=r(324586),o=r(774165),s=r(563696),a=r(769942),c=r(274764),l=r(401834),d=r(944865);const u=new class{constructor(){(0,n.A)(this,"writeSessions",new Map),(0,d.Q$)((e=>this.workerStartedCallback(e)))}addSession(e){this.writeSessions.set(e.sessionId,e)}removeSession(e){this.writeSessions.delete(e.sessionId)}workerStartedCallback(e){const t=(0,l.q)("writefs",e);t.onMessageReceipt("writeData",(e=>(this.dispatchWriteDataMessage(e),"continue"))),t.onMessageReceipt("closeFile",(e=>(this.dispatchCloseFileMessage(e),"continue"))),t.onMessageReceipt("endSession",(e=>(this.dispatchEndSessionMessage(e),"continue")))}dispatchWriteDataMessage(e){const t=this.writeSessions.get(e.sessionId);t&&t.onWriteDataMessage(e)}dispatchCloseFileMessage(e){const t=this.writeSessions.get(e.sessionId);t&&t.onCloseFileMessage(e)}dispatchEndSessionMessage(e){const t=this.writeSessions.get(e.sessionId);t&&t.onEndSessionMessage(e)}};class h{constructor(e){(0,n.A)(this,"sessionId",(0,c.O2)("WRITEFS_OUTSIDE_")),(0,n.A)(this,"queue",new s.$),(0,n.A)(this,"files",{}),(0,n.A)(this,"hasExistingFile",void 0),this.hasExistingFile=!!e,e&&(this.files[e.fileName]={file:Promise.resolve(e),closed:new o.h}),u.addSession(this)}get finished(){return Promise.all(Object.values(this.files).map((e=>e.closed.toPromise()))).then((()=>Promise.all(Object.values(this.files).map((e=>e.file)))))}getOrCreateFile(e){return(this.files[e]=this.files[e]||{file:a.h.createNewFile(e),closed:new o.h}).file}onWriteDataMessage(e){return this.queue.enqueuePromise((async()=>{const t=await this.getOrCreateFile(e.operation.path);await t.writeBlob(new Blob([e.operation.bytes]),e.operation.position)}))}onCloseFileMessage(e){this.queue.enqueueFunction((t=>{const r=this.files[e.operation.path];r&&r.closed.complete(),t()}))}onEndSessionMessage(e){this.queue.enqueueFunction((e=>{Object.values(this.files).forEach((e=>e.closed.complete())),u.removeSession(this),e()}))}}var p=r(555089),m=r(126714);function f(e,t){const r=function(e){return e.streams.filter((e=>"video"===e.codec_type)).reduce(((e,t)=>Math.max(e,t.nb_frames||0)),0)}(e),i=(0,m.pe)(e.format.duration||"");return e=>{if("progress"===e.event){const n=function(e,t){return t&&!Number.isNaN(e.details.frame)?e.details.frame/t:Number.NaN}(e,r);if(Number.isNaN(n)){const r=function(e,t){return t?e.details.time/t:Number.NaN}(e,i);Number.isNaN(r)?t(.5):t(r)}else t(n)}}}var g=r(692701);async function A(e,t,r){if(r.sessionId!==e.sessionId)throw new Error(`Session identifiers do not match (${r.sessionId} <> ${e.sessionId})`);const i=await r.finished;return r.hasExistingFile?{files:[],stats:{encodingDurationMillis:e.elapsed,heapSizeInBytesAfterCompletion:e.memory}}:{stats:{encodingDurationMillis:e.elapsed,heapSizeInBytesAfterCompletion:e.memory},files:(await Promise.all(i.map((e=>e.getFile(t))))).map(((e,t)=>({blob:e,remove:()=>i[t].remove()})))}}var v=r(776016);function y(e){return e&&"progress"===e.event&&"details"in e}const b=(0,v.t9)({event:(0,v.u)("state"),details:(0,v.t9)({state:v.Kg})});function w(e){return e&&"module"===e.event&&"details"in e}async function x(e,t,r,i,n,o){const s=f(t,i),a=new h(r.internalFile),{importWorker:c}=await(0,g.w)(),l=await c.call("import-time-transcode",{inputVideo:e,metadata:t,importOptions:o,options:{writefsSessionId:a.sessionId,outputFileName:r.internalFile.fileName}},[],(e=>{y(e)?s(e):w(e)&&n(e.details.status,e.details.progress)}));return await A(l,"video/mp4",a)}async function S(e,t,r,i){const n=new h(r.internalFile),{probeWorker:o}=await(0,g.w)(),s=await o.call("import-image",{inputImage:e,metadata:t,options:{writefsSessionId:n.sessionId,outputFileName:r.internalFile.fileName}},[],(e=>{w(e)&&i(e.details.status,e.details.progress)}));return await A(s,"image/png",n)}async function T(e,t,r,i){const n=f(t,r),{probeWorker:o}=await(0,g.w)();return(await o.call("splice-out-audio",{inputVideo:e,metadata:t},[],(e=>{y(e)?n(e):w(e)&&i(e.details.status,e.details.progress)}))).buffer}async function C(e,t,r,n,o,s,a,c){const l=new h,[{fullWorker:d}]=await Promise.all([(0,g.w)(),(0,p.g)()]),u=(0,i.G7)("iet__external_frame_stream"),m=await d.call("export",{selfie:e,parameters:t,options:{writefsSessionId:l.sessionId,webcodecsConfiguration:a,useExternalFrameStream:u,useHardwareFrames:c}},[],(async t=>{if(y(t))r(function(e,t){const r=e.details.frame/t.numberOfFrames,i=e.details.time/t.totalDurationInMillis;return Number.isNaN(r)?100*i:Number.isNaN(i)?100*r:100*(r+i)/2}(t,e));else if(b(t))n(t.details.state);else if((i=t)&&"frame"===i.event&&"details"in i){const{frameCallback:e,resumeCallback:r}=o[t.details.id];let i=!1;const n=[];try{if(Array.isArray(t.details.slots))for(const r of t.details.slots)n.push(await e(r));else for(let r=0;r<t.details.slots;++r)n.push(await e(void 0))}catch(e){i=!0}const s=[];for(const e of n)e instanceof Uint8Array?s.push(e.buffer):s.push(e);d.send("frame",{id:t.details.id,seqno:t.details.seqno,frames:n,eof:i},s),r()}else(function(e){return e&&"upload"===e.event&&"details"in e})(t)&&s(t.details.index,t.details.blob,t.details.last);var i})),f=await A(m,function(e){switch(e){case"mp4":return"video/mp4";case"mpegts":return"video/MP2T";case"gif":return"image/gif";default:return"application/octet-stream"}}(t.format),l);if(t.upload){const e=f.files[0];if(void 0===e)throw new Error("No uploadable output file was produced by export.");const r=Math.ceil(e.blob.size/t.upload.chunkSizeInBytes);for(let i=0;i<r;++i){const r=i*t.upload.chunkSizeInBytes,n=r+t.upload.chunkSizeInBytes;s(i,e.blob.slice(r,Math.min(n,e.blob.size)),n>=e.blob.size)}}return f}async function _(e){const{importWorker:t,fullWorker:r,probeWorker:i}=await(0,g.w)(),n="full"===e?r:"import"===e?t:i;return await n.call("memory-status",void 0,[],(function(){}))}async function k(e,t){const{probeWorker:r}=await(0,g.w)();return await r.call("batch-probe",{inputVideoArray:e},[],(e=>{w(e)&&t(e.details.status,e.details.progress)}))}async function E(e,t){const{fullWorker:r}=await(0,g.w)();return await r.call("batch-preview",{inputVideoAndMetadataArray:e},[],(e=>{w(e)&&t(e.details.status,e.details.progress)}))}async function I(e,t,r){const i=new h(t.internalFile),{filmstripWorker:n}=await(0,g.w)();await n.call("generate-filmstrip",{inputVideo:e,options:{writefsSessionId:i.sessionId,outputFileName:t.internalFile.fileName,videoRotation:r}},[],(()=>{})),await i.finished}async function R(e){const{probeWorker:t}=await(0,g.w)();return await t.call("batch-probe-filmstrip",{inputFilmstrips:e},[],(()=>{}))}async function F(e){const{importWorker:t,fullWorker:r,probeWorker:i}=await(0,g.w)(),n=e?[r,i]:[r,i,t];await Promise.all(n.map((e=>e.cleanup())))}},589084:(e,t,r)=>{r.d(t,{Dy:()=>c,If:()=>o,aj:()=>d,wA:()=>s,x9:()=>l});const i=[1,2,4,8,16,32],n={baseline:66,constrained_baseline:578,main:77,extended:88,high:100,high_10:110,high_10_intra:2158,multiview_high:118,high_422:122,high_422_intra:2170,stereo_high:128,high_444:144,high_444_predictive:244,high_444_intra:2292,cavlc_444:44};function o(e){return n[e]}function s(e){const t=e.getUint8(1),r=e.getUint8(2),i=Object.entries(n).filter((([,e])=>{const i=e>>8;return t===(255&e)&&(r&i)===i})).pop();if(i)return i[0]}const a=["1","1.1","1.2","1.3","2","2.1","2.2","3","3.1","3.2","4","4.1","4.2","5","5.1","5.2","6","6.1","6.2"];function c(e){return Math.round(10*Number.parseFloat(e))}function l(e){const t=""+e.getUint8(3)/10;if(a.includes(t))return t}function d({profile:e,level:t}){const r=255&e,n=255&t,o=e>>8&31,s=i.reduce(((e,t)=>((o&t)===t&&(e|=256>>t),e)),0);return`avc1.${r.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}`}},930394:(e,t,r)=>{r.d(t,{pK:()=>h,H8:()=>y}),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218),r(379321);var i=r(324586);class n{constructor(){(0,i.A)(this,"promise",void 0),(0,i.A)(this,"state",{stage:"pending"}),this.promise=new Promise(((e,t)=>{switch(this.state.stage){case"resolved":e(this.state.result);break;case"rejected":t(this.state.error);break;default:this.state={stage:"ready",resolve:e,reject:t}}}))}get finished(){switch(this.state.stage){case"resolved":case"rejected":return!0;default:return!1}}resolve(e){"ready"===this.state.stage&&this.state.resolve(e),this.state={stage:"resolved",result:e}}reject(e){"ready"===this.state.stage&&this.state.reject(e),this.state={stage:"rejected",error:e}}}const o=10,s=30,a=1e6,c=Math.floor(1/s*a),l=1e4;class d extends Error{constructor(e,t){super(e),this.originalException=t,this.originalException=t}}function u(e,t,r){return e.subarray(t[r],t[r+1])}const h=new Uint8Array([0,0,0,1]),p=31,m=7,f=8,g=64;let A;async function v(e){const t=new n;t.promise.catch((()=>{}));const r=new VideoEncoder({output:e=>{try{const r=e.byteLength;(void 0===A||A.byteLength<r)&&(A=new Uint8Array(r)),e.copyTo(A);const i=function(e,t){const r=function(e){const t=new Array(e.length).fill(0);let r=0;for(let i=1;i<e.length;++i){for(;r>0&&e[i]!==e[r];)r=t[r-1];e[r]===e[i]&&++r,t[i]=r}return t}(t),i=[];let n=0,o=0;for(;n<e.length;)e[n]===t[o]&&(++n,++o),o===t.length?(i.push(n-o),o=r[o-1]):e[n]!==t[o]&&(0===o?++n:o=r[o-1]);return i}(A,h),n=i.map((e=>A[e+h.length]&p)),o=n.indexOf(m),s=n.indexOf(f);if(-1===o||-1===s)return void t.reject(new Error("Annex-B bitstream does not contain SPS and PPS NALUs"));const a=u(A,i,o),c=u(A,i,s),l=a.byteLength+c.byteLength,d=new Uint8Array(l+g);d.set(a,0),d.set(c,a.byteLength),t.resolve({paddedExtradata:d,extradataLength:l})}catch(e){t.reject(new Error("WebCodecs API for EncodedVideoChunk is broken"))}},error:e=>{const r=e.message??"Video encoder dry-run produced an error";t.reject(new d(r,e))}});try{r.configure(e);const{buffer:i,layout:n}=function(e){const t=e.width+1>>1,r=e.height+1>>1;return{buffer:new Uint8Array(e.width*e.height+2*t*r),layout:void 0}}(e);for(let l=0;l<s;++l){if(t.finished)return await t.promise;const d=new VideoFrame(i,{format:"I420",codedWidth:e.width,codedHeight:e.height,displayWidth:e.width,displayHeight:e.height,timestamp:Math.floor(l/s*a),duration:c,layout:n});r.encode(d),d.close(),await new Promise((e=>setTimeout(e,o)))}return await r.flush(),await t.promise}finally{"closed"!==r.state&&r.close()}}async function y(e){let t;return Promise.race([v(e),new Promise(((e,r)=>{t=self.setTimeout((()=>{r(new Error("Timeout while performing encoder dry-run"))}),l)}))]).finally((()=>{void 0!==t&&clearTimeout(t)}))}},501716:(e,t,r)=>{r.d(t,{AN:()=>i,R_:()=>o,UU:()=>n,Vb:()=>s});const i=4,n=2,o=2,s=52},363155:(e,t,r)=>{r.d(t,{I2:()=>s,Yw:()=>n,mF:()=>a,uj:()=>o});const i=30,n=1/i;function o(e,t=i){return e.metadata.duration,Math.floor(e.metadata.duration*t)}function s(e,t=i){return Math.floor(e*t)}function a(e,t=i){return e/t}},133743:(e,t,r)=>{r.d(t,{c:()=>s});var i=r(324586),n=r(650882),o=r(187974);class s extends n.g9{static fromUnknownError(e,t){const r=n.g9.fromUnknownError(t,"Failed to decode input file",{containerFormat:e.metadata.raw?.format.format_name,videoCodec:e.metadata.raw?(0,o.yL)(e.metadata.raw)?.codec_name:void 0}),i=new s(e.name,r.message,r.context);return(0,n.Op)(i,r),i}constructor(e,t,r){super(t,r),(0,i.A)(this,"name","BrokenFileError"),this.fileName=e}}},15464:(e,t,r)=>{r.d(t,{U:()=>o,t:()=>n});var i=r(324586);class n{constructor(e){(0,i.A)(this,"cancelPromise",void 0),(0,i.A)(this,"cancelled",!1),this.onCancel=e}async cancel(){this.cancelPromise||(this.cancelPromise=this.onCancel()),await this.cancelPromise,this.cancelled=!0}}class o{constructor(){(0,i.A)(this,"cancellable",void 0),(0,i.A)(this,"alreadyCancelled",!1)}get cancelled(){return this.cancellable?this.cancellable.cancelled:this.alreadyCancelled}async cancel(){this.cancellable&&await this.cancellable.cancel(),this.alreadyCancelled=!0}wrap(e){this.cancellable=e,this.alreadyCancelled&&this.cancellable.cancel().catch((e=>console.warn("Failed to cancel task:",e)))}}},957734:(e,t,r)=>{r.d(t,{c:()=>n});var i=r(324586);class n extends Error{constructor(){super("cancelled"),(0,i.A)(this,"time",new Date)}}},944865:(e,t,r)=>{r.d(t,{At:()=>d,BM:()=>s,Q$:()=>l,Zz:()=>n,wW:()=>u}),r(379321),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);var i=r(871287);async function n(e){const t=await fetch(e);if(!t.ok)throw new Error(`Reading ${e} into data buffer returned HTTP/${t.status}: ${t.statusText}`);return t.arrayBuffer()}const o=1048576;async function s(e){const t=new Uint8Array(e.size);for(let r=0;r<e.size;r+=o){const n=e.slice(r,r+o),s=await(0,i.gm)(n);t.set(new Uint8Array(s),r)}return t.buffer}const a=[],c=[];function l(e){-1===c.indexOf(e)&&(c.push(e),a.forEach((t=>e(t))))}function d(e){c.forEach((t=>t(e))),a.push(e)}function u(e){const t=a.indexOf(e);-1!==t&&a.splice(t,1)}},486967:(e,t,r)=>{r.d(t,{f7:()=>c,vq:()=>a});const i="Orientation",n=/(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})/,o=["DateTimeOriginal","DateTimeDigitized","DateTime"];function s(e){const t=e.frames?.[0];return void 0!==t&&"video"===t.media_type&&void 0!==t.tags?t.tags:{}}function a(e,t){const r=function(e){return s(e)[i]?.trim()}(e),n=function(e){switch(e){case"6":return 90;case"3":return 180;case"8":return 270;default:return 0}}(r);return void 0!==t&&void 0!==r&&0!==n&&(t[i]=r),n}function c(e,t){const r=s(e);for(const e of o){const i=r[e]?.trim(),o=i?.match(n);if(!o)continue;void 0!==t&&(t[e]=i);const[s,a,c,l,d,u]=[...o].slice(1).map((e=>Number.parseInt(e)));return new Date(s,a-1,c,l,d,u).toISOString()}}},187974:(e,t,r)=>{function i(e){return e.streams.find((e=>"video"===e.codec_type))}r.d(t,{$g:()=>i,Ic:()=>y,at:()=>a,no:()=>v,oR:()=>h,p0:()=>b,xL:()=>c,xc:()=>g,yL:()=>p}),r(379321),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(854483);const n=/^\s*(-?\d+(?:\.\d+)?)(?:\/(-?\d+(?:\.\d+)?))?\s*$/,o=/^\s*(-?\d+(?:\.\d+)?)(?::(-?\d+(?:\.\d+)?))?\s*$/;function s(e,t){if("number"==typeof e)return e;if("string"==typeof e){const r=t.exec(e);if(r){const e=Number.parseFloat(r[1]),t=Number.parseFloat(r[2]);if(Number.isNaN(t))return e;if(!Number.isNaN(e))return e/t}return Number.NaN}return Number.NaN}function a(e){return s(e,n)}function c(e){return s(e,o)}const l=new Set(["bmp","mjpeg","gif","webp","ico","tiff","png","jpeg2000","svg"]),d=30,u=62208e3;function h(e,t,r=d){const i=t.width*t.height*r;return Math.round(e/u*i)}function p(e){return e.streams.find((e=>{if("video"!==e.codec_type)return!1;if(1===e.disposition?.attached_pic)return!1;if(void 0===e.avg_frame_rate)return!0;if(void 0!==e.nb_frames){if(1===e.nb_frames)return!1;if(e.nb_frames>1)return!0}const t=a(e.avg_frame_rate);return!Number.isNaN(t)&&t>0||!l.has(e.codec_name)}))}const m="https://clipchamp.com",f=["-metadata","comment=Create videos with https://clipchamp.com/en/video-editor - free online video editor, video compressor, video converter.","-metadata","encoding_tool="+m,"-metadata","service_name="+m],g={global:{pixelFormat:"yuv420p"},presets:{createImport:{global:{},formats:{webm:{global:{format:"webm",conditionallyTuneForImport:!0,mapMetadata:!0,strict:-2,audioCodec:"vorbis",audioChannels:2,samplingFrequency:44100,samplingFormat:"fltp",videoCodec:"libvpx",vpxDeadline:"realtime",vpxCpuUsed:-13,crf:20,dynamicBitrate:2e7,vpxStaticThreshold:1e3,vpxAutoAltRef:0}}}},createExport:{global:{},formats:{mp4:{global:{format:"mp4",forceFramerate:!0,metadata:f.filter((e=>!e.startsWith("-metadata"))),mapChapters:"-1",audioCodec:"aac",audioChannels:2,samplingFrequency:44100,samplingFormat:"s16",noAudio:!1,noAfterBurner:!0,audioBitrate:"192k",videoCodec:"libopenh264",openH264Slices:1,openH264Coder:"cabac",dynamicBitrate:2e7,gop:150}},mpegts:{global:{format:"mpegts",conditionallyTuneForImport:!0,noAudio:!0,videoBitstream:"h264_mp4toannexb",videoCodec:"libopenh264",openH264Slices:1,openH264Coder:"cabac",dynamicBitrate:2e7,gop:150}},m4a:{global:{format:"m4a",videoCodec:"copy",audioCodec:"aac",audioChannels:2,samplingFrequency:44100,samplingFormat:"s16",noAudio:!1,noAfterBurner:!0,audioBitrate:"192k"}},gif:{global:{format:"gif",videoCodec:"gif",noAudio:!0,gifLooping:!0,forceFramerate:!0}}}},createTeamsExport:{global:{},formats:{mp4:{global:{format:"mp4",forceFramerate:!0,metadata:f.filter((e=>!e.startsWith("-metadata"))),mapChapters:"-1",audioCodec:"aac",audioChannels:2,samplingFrequency:48e3,samplingFormat:"s16",noAudio:!1,noAfterBurner:!0,audioBitrate:"192k",videoCodec:"libopenh264",openH264Slices:1,openH264Coder:"cabac",dynamicBitrate:25e5,gop:90}},mpegts:void 0,m4a:void 0,gif:{global:{format:"gif",videoCodec:"gif",noAudio:!0,gifLooping:!0,forceFramerate:!0}}}}}},A=g;function v(e){return!g.presets.createExport.formats[e.format].global.noAudio}function y(e){return{...A.global,...A.presets[e.preset]?.global,...A.presets[e.preset]?.formats[e.format]?.global,...e.optionOverrides}}const b={videoCodec:"webcodecs_h264",dynamicBitrate:2e7,noAfterBurner:!0,h264Profile:"baseline",dynamicH264Level:!0,audioBitrate:"192k",gop:150,openH264Slices:void 0,openH264Coder:void 0,openH264ComplexityMode:void 0,openH264Denoise:void 0,qmin:void 0,qmax:void 0}},854483:(e,t,r)=>{r.d(t,{g:()=>o});const i=[{level:"4.1",supported:[{width:1280,height:720,fps:68.3},{width:1920,height:1080,fps:30.1},{width:2048,height:1024,fps:30}]},{level:"4.2",supported:[{width:1280,height:720,fps:145.1},{width:1920,height:1080,fps:64},{width:2048,height:1080,fps:60}]},{level:"5",supported:[{width:1920,height:1080,fps:72.3},{width:2048,height:1024,fps:72},{width:2048,height:1080,fps:67.8},{width:2560,height:1920,fps:30.7},{width:3672,height:1536,fps:26.7}]},{level:"5.1",supported:[{width:1920,height:1080,fps:120.5},{width:2560,height:1920,fps:51.2},{width:3840,height:2160,fps:31.7},{width:4096,height:2048,fps:30},{width:4096,height:2160,fps:28.5},{width:4096,height:2304,fps:26.7}]},{level:"5.2",supported:[{width:1920,height:1080,fps:172},{width:2560,height:1920,fps:108},{width:3840,height:2160,fps:66.8},{width:4096,height:2048,fps:63.3},{width:4096,height:2160,fps:60},{width:4096,height:2304,fps:56.3}]},{level:"6",supported:[{width:3840,height:2160,fps:128.9},{width:7680,height:4320,fps:32.2},{width:8192,height:4320,fps:30.2}]},{level:"6.1",supported:[{width:3840,height:2160,fps:257.9},{width:7680,height:4320,fps:64.5},{width:8192,height:4320,fps:60.4}]},{level:"6.2",supported:[{width:3840,height:2160,fps:300},{width:7680,height:4320,fps:128.9},{width:8192,height:4320,fps:120.9}]}],n=30;function o(e,t=n){const r=i.find((({supported:r})=>r.some((({width:r,height:i,fps:n})=>r>=e.width&&i>=e.height&&n>=t))));return r?r.level:"6.2"}},126714:(e,t,r)=>{r.d(t,{Jq:()=>l,Ms:()=>c,il:()=>o,pe:()=>s,xF:()=>a}),r(379321),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);var i=r(187974);const n=["rgba","argb","bgra","abgr","gbra","ya","yuva","pal"];function o(e){const t=(0,i.$g)(e);return void 0===t?.pix_fmt||n.some((e=>t?.pix_fmt?.startsWith(e)))}function s(e){let t=1;if("string"!=typeof e)return Number.NaN;"-"===e[0]&&(t=-1,e=e.slice(1));const r=e.split(":",3);for(let e=r.length;e<3;e=r.unshift("0"));return t*(36e5*Number.parseInt(r[0])+6e4*Number.parseInt(r[1])+1e3*Number.parseFloat(r[2]))}function a(e){return e.streams.find((e=>"audio"===e.codec_type))}function c(e){const t=(0,i.yL)(e);if(t){const e=Number.parseFloat(t.duration||"");if(!Number.isNaN(e))return e;const r=t.nb_frames,n=(0,i.at)(t.avg_frame_rate)||(0,i.at)(t.r_frame_rate);if(r&&n)return r/n}const r=Number.parseFloat(e.format.duration||"");if(!Number.isNaN(r))return r;const n=Number.parseInt(e.format.size||""),o=Number.parseFloat(e.format.bit_rate||"");return Number.isNaN(n)||Number.isNaN(o)?Number.NaN:n/o*8}function l(e){const t=a(e);if(!t)return Number.NaN;const r=Number.parseFloat(t.duration||"");if(!Number.isNaN(r))return r;const i=Number.parseFloat(e.format.duration||"");return Number.isNaN(i)?Number.NaN:i}},882196:(e,t,r)=>{r.d(t,{e:()=>s});var i=r(735625),n=r(472646);const o=.15;function s(e,t,r=o){if("auto-place"!==e.strategy)return{...e.bounds};e=i.sF.scale(e,r,r);const s=(0,n.I)(e,t),a=e.bounds;return{left:s[0],right:s[0]+a.right-a.left,bottom:s[1],top:s[1]+a.top-a.bottom}}},472646:(e,t,r)=>{function i(e,t){const r=e.bounds,i=r.right-r.left,n=r.top-r.bottom,o=.05,s=o,a=(t-i)/2,c=t-i-o,l=o,d=(1-n)/2,u=1-n-o;switch(e.autoPlacement){case"bottom-left":return[s,l];case"bottom-center":return[a,l];case"bottom-right":return[c,l];case"mid-left":return[s,d];case"mid-center":return[a,d];case"mid-right":return[c,d];case"top-left":return[s,u];case"top-center":return[a,u];case"top-right":return[c,u];default:return[0,0]}}r.d(t,{I:()=>i})},609636:(e,t,r)=>{r.d(t,{O:()=>n,l:()=>o});var i=r(463716);function n(e,t,r){if(!e.crop)return i.d.identity;const{bounds:n,crop:o}=e,[s,a]=n.left<n.right?[n.left,n.right]:[n.right,n.left],[c,l]=n.bottom<n.top?[n.bottom,n.top]:[n.top,n.bottom],d=a-s,u=l-c,h=d*(1-o.right-o.left),p=u*(1-o.bottom-o.top),m=s+o.left*d,f=c+o.bottom*u,g=i.d.scale(2,2).multiply(i.d.translate(-1,-1)).multiply(t).multiply(i.d.translate(1,1)).multiply(i.d.scale(.5,.5)),A=i.d.translate(-m-h/2,-f-p/2).multiply(i.d.scale(1*r,1)).multiply(i.d.rotate(-1*e.rotation)).multiply(i.d.scale(1/(1*r),1)).multiply(i.d.translate(h/2,p/2)).multiply(i.d.scale(1/h,1/p));return g.multiply(A)}function o(e,t,r=1,o=!1){if(o)return n(e,t,r);if(!e.crop)return i.d.identity;const{bounds:s,crop:a}=e,[c,l]=s.left<s.right?[s.left,s.right]:[s.right,s.left],[d,u]=s.bottom<s.top?[s.bottom,s.top]:[s.top,s.bottom],h=l-c,p=u-d,m=h*(1-a.right-a.left),f=p*(1-a.bottom-a.top),g=c+a.left*h,A=d+a.bottom*p,v=i.d.scale(2,2).multiply(i.d.translate(-1,-1)).multiply(t).multiply(i.d.translate(1,1)).multiply(i.d.scale(.5,.5)),y=i.d.translate(-g,-A).multiply(i.d.scale(1/m,1/f));return v.multiply(y)}},204411:(e,t,r)=>{r.d(t,{s:()=>c,v:()=>a});var i=r(869211),n=r(476636),o=r(735625),s=r(882196);function a(e,t,r,i){const n=[e.bounds.left>e.bounds.right?-1:1,e.bounds.bottom>e.bounds.top?-1:1];return(e=o.sF.scale(e,n[0],n[1])).bounds.left*=r,e.bounds.right*=r,e.bounds=o.sF.getTightBounds(e,t),e.bounds=(0,s.e)(e,r,i),e.bounds.left/=r,e.bounds.right/=r,o.sF.scale(e,n[0],n[1])}function c(e,t,r,c=!0,l,d=!1){if(d)return a(e,t,r,l);const u=[e.bounds.left>e.bounds.right?-1:1,e.bounds.bottom>e.bounds.top?-1:1];e=o.sF.scale(e,u[0],u[1]);let h=(0,i.y)(new n.Z(t,1),e.rotation);if(t=h.x/h.y,e.bounds.left*=r,e.bounds.right*=r,e.bounds=o.sF.getTightBounds(e,t),e.bounds=(0,s.e)(e,r,l),c){const t=e.bounds.right-e.bounds.left,r=e.bounds.top-e.bounds.bottom;h=(0,i.y)(new n.Z(t,r),-e.rotation),e=o.sF.scale(e,h.x/t,h.y/r)}return e.bounds.left/=r,e.bounds.right/=r,o.sF.scale(e,u[0],u[1])}},735625:(e,t,r)=>{r.d(t,{DR:()=>c,Ge:()=>u,Km:()=>d,oI:()=>a,sF:()=>h,xs:()=>s});var i=r(476636),n=r(562151),o=r(956502);const s={left:0,right:0,bottom:0,top:0},a={left:0,right:1,bottom:0,top:1},c={strategy:"fit",bounds:a,rotation:0,hasFixedBounds:!1};function l(e,t){return{left:e?.left??t.left,right:e?.right??t.right,bottom:e?.bottom??t.bottom,top:e?.top??t.top}}function d(e){return{...c,...e,bounds:e?.bounds?l(e.bounds,a):c.bounds,crop:e?.crop?l(e.crop,s):void 0}}class u{constructor(e,t,r,i,n){this.mid=e,this.size=t,this.flippedStatus=r,this.crop=i,this.rotation=n}getCropMid(){const{x:e,y:t}=this.mid,{width:r,height:n}=this.size,o=this.crop;return new i.Z(e+r*(o.left-o.right)/2,t+n*(o.bottom-o.top)/2)}flipped(e){const t={...this.flippedStatus};let r=new i.Z(this.mid.x,this.mid.y);const s={...this.crop},{x:a,y:c}=this.getCropMid();let l=e;const d=-n.D/4,h=(0,o.z)(d,n.D),p=(0,o.z)(3*d,n.D);return this.rotation!==h&&this.rotation!==p||(l="horizontal"===l?"vertical":"horizontal"),"horizontal"===l?([s.left,s.right]=[s.right,s.left],t.horizontal=!t.horizontal,r=this.mid.withX(2*a-this.mid.x)):([s.bottom,s.top]=[s.top,s.bottom],t.vertical=!t.vertical,r=this.mid.withY(2*c-this.mid.y)),new u(r,this.size,t,s,this.rotation)}getPlain(){const{x:e,y:t}=this.mid,{width:r,height:i}=this.size;let n=e-r/2,o=e+r/2,s=t-i/2,a=t+i/2;return this.flippedStatus.horizontal&&([n,o]=[o,n]),this.flippedStatus.vertical&&([s,a]=[a,s]),{strategy:"freehand",bounds:{left:n,right:o,bottom:s,top:a},crop:this.crop,rotation:this.rotation,hasFixedBounds:!0}}static from(e){const{left:t,right:r,bottom:n,top:o}=e.bounds??a,c=Math.abs(r-t),l=Math.abs(n-o),d=Math.min(t,r)+c/2,h=Math.min(n,o)+l/2;return new u(new i.Z(d,h),{width:c,height:l},{horizontal:t>r,vertical:n>o},e.crop??s,e.rotation??0)}rotated(e,t){const r=new i.Z(t,1),s=this.getCropMid(),a=this.mid.mul(r),c=s.mul(r),l=a.sub(c).div(new i.Z(t,1)),d=s.add(l),h=(0,o.z)(this.rotation+e,n.D);return new u(d,this.size,this.flippedStatus,this.crop,h)}resetCrop(e){const t=new i.Z(e,1),r=this.getCropMid(),n=this.mid.mul(t),o=r.mul(t).sub(n).rotate(this.rotation).div(new i.Z(e,1)),a=r.sub(o);return new u(a,this.size,this.flippedStatus,s,this.rotation)}}const h={flip:(e,t)=>u.from(e).flipped(t).getPlain(),getTightBounds(e,t){const r={...e.bounds},i=r.right-r.left,n=r.top-r.bottom,o=i/n;if("fill"===e.strategy&&o<t||"fill"!==e.strategy&&o>t){const e=(r.left+r.right)/2,i=n*t;r.left=e-i/2,r.right=e+i/2}else{const e=(r.bottom+r.top)/2,n=i/t;r.bottom=e-n/2,r.top=e+n/2}return r},rotate:(e,t)=>({...e,rotation:(0,o.z)((e.rotation??0)+t,n.D)}),scale(e,t,r){const i={...e.bounds??a},n=[(i.left+i.right)/2,(i.bottom+i.top)/2],o=[(i.right-i.left)*t,(i.top-i.bottom)*r];return i.left=n[0]-o[0]/2,i.right=n[0]+o[0]/2,i.bottom=n[1]-o[1]/2,i.top=n[1]+o[1]/2,{...e,bounds:i}}}},21442:(e,t,r)=>{r.d(t,{nm:()=>o,xD:()=>E});var i=r(602453),n=r(776016);function o(e){return t=>t.type===e}const s=(0,n.t9)({id:n.Kg,provider:(0,n.u)("clipgcloud")}),a=(0,n.t9)({id:n.Kg,provider:(0,n.u)("onedrive")}),c=(0,n.t9)({size:n.Et}),l=(0,n.t9)({duration:n.Et,size:n.Et,raw:(0,n.t9)({format:n.wW,streams:(0,n._j)(n.wW)})}),d=(0,n.t9)({duration:n.Et,height:n.Et,rotation:n.Et,width:n.Et,size:n.Et,raw:(0,n.t9)({format:n.wW,streams:(0,n._j)(n.wW)})}),u=(0,n.t9)({width:n.Et,height:n.Et,rotation:n.Et,size:n.Et,raw:(0,n.t9)({format:n.wW,streams:(0,n._j)(n.wW)})}),h=(0,n.t9)({id:n.Kg,type:(0,n.u)("music","sfx"),order:n.Kg,data:(0,n.t9)({file:(0,n.ey)(s,a),metadata:l,fileName:(0,n.H7)(n.Kg),displayName:(0,n.H7)(n.Kg)})}),p=(0,n.t9)({id:n.Kg,type:(0,n.u)("video"),order:n.Kg,data:(0,n.t9)({file:(0,n.ey)(s,a),metadata:d,fileName:(0,n.H7)(n.Kg),displayName:(0,n.H7)(n.Kg)})}),m=(0,n.t9)({id:n.Kg,type:(0,n.u)("logo","image","graphic"),order:n.Kg,data:(0,n.t9)({file:(0,n.ey)(s,a),metadata:u,fileName:(0,n.H7)(n.Kg),displayName:(0,n.H7)(n.Kg)})}),f=(0,n.t9)({id:n.Kg,type:(0,n.u)("color_palette"),order:n.Kg,data:(0,n.t9)({displayName:n.Kg,colors:(0,n._j)((0,n.t9)({id:n.Kg,hex:n.Kg,order:n.Kg}))})}),g=(0,n.t9)({id:n.Kg,type:(0,n.u)("font"),order:n.Kg,data:(0,n.t9)({displayName:n.Kg,fontName:n.Kg,subtype:(0,n.u)("local","builtin","custom_font")})}),A=(0,n.t9)({id:n.Kg,order:n.Kg,type:(0,n.u)("custom_font"),data:(0,n.t9)({file:(0,n.ey)(s,a),previewSvgSource:n.Kg,fontFamily:n.Kg,fontSubFamily:n.Kg,supportedFontWeight:n.Et,fileName:(0,n.H7)(n.Kg),metadata:c})}),v={description:(0,n.H7)(n.Kg),group:(0,n.H7)(n.Kg),hideLabel:(0,n.H7)(n.Lm),id:n.Kg,label:n.Kg,position:(0,n.VA)(n.Kg,2)},y=(0,n.t9)({type:(0,n.u)("text","textMulti","alignment","font","number","grid","logo","logoUpload","scale","select","hidden","color","range","toggle"),default:n.Kg,...v}),b=(0,n.t9)({alpha:n.Lm,default:(0,n.VA)(n.Et,4),type:(0,n.u)("color"),...v}),w=(0,n.t9)({default:n.Et,type:(0,n.u)("range"),maxValue:n.Et,minValue:n.Et,step:n.Et,...v}),x=(0,n.t9)({default:n.Lm,type:(0,n.u)("toggle"),text:n.Kg,...v}),S=(0,n.t9)({default:n.Kg,type:(0,n.u)("select"),values:(0,n._j)((0,n.t9)({id:n.Kg,displayText:n.Kg})),placeholder:(0,n.H7)(n.Kg),...v}),T=(0,n.t9)({default:(0,n.VA)(n.Et,2),type:(0,n.u)("grid"),...v}),C=(0,n.t9)({data:(0,n.H7)(n.GB),fields:(0,n._j)((0,n.ey)(b,w,x,S,T,y)),inputs:n.Et,thumbnail:(0,n.H7)((0,n.t9)({scale:(0,n.H7)(n.Et),text:(0,n.H7)(n.Kg)}))}),_=(0,n.t9)({pluginUrl:n.Kg,subtype:(0,n.u)(...i.Ar.get("motion-title")??[]),vendorData:(0,n.H7)(C),cost:(0,n.u)(...i.tY),dateModified:n.Et,description:n.Kg,flags:(0,n._j)(n.Kg),keywords:(0,n._j)(n.Kg),previewUrl:n.Kg,slug:n.Kg,stage:(0,n.u)(...i.GG),thumbnailUrl:n.Kg,title:n.Kg,featured:n.Lm,locale:(0,n.u)(...i.Kj),type:(0,n.u)(...i.yw),vendor:(0,n.u)(...i.wC),vendorId:n.Kg,id:n.Kg,addedBy:n.Kg,dateAdded:n.Et,modifiedBy:n.Kg}),k=(0,n.t9)({id:n.Kg,type:(0,n.u)("custom_plugin"),order:n.Kg,data:(0,n.t9)({plugin:_,displayName:n.Kg,file:s})}),E=(0,n.ey)(f,h,p,m,g,A,k)},653907:(e,t,r)=>{r.d(t,{T:()=>n,r:()=>o});var i=r(135232);const[n,o]=(0,i.Q)("BrandKitSupplierSupplier")},566573:(e,t,r)=>{r.d(t,{JF:()=>f,Y0:()=>m,Zm:()=>l,cX:()=>p,hl:()=>o,uF:()=>h,y6:()=>d,yE:()=>u});var i=r(562299),n=r.n(i);const o=()=>{const e=n().getParser(window.navigator.userAgent);return(e=>("desktop"===e.getPlatformType()||""===e.getPlatformType())&&"Blink"===e.getEngine().name)(e)&&((e=>e.satisfies({chrome:">=99"})??!1)(e)||(e=>e.satisfies({edge:">=99"})??!1)(e))},s=()=>{if(window?.navigator?.userAgent)return n().getParser(window.navigator.userAgent)},a=()=>s()?.getOSName(),c=()=>s()?.getPlatformType(),l=()=>{const e=c();return"desktop"===e||""===e},d=()=>"desktop"!==c()&&"iOS"===a(),u=()=>s()?.isBrowser("edge",!0)??!1,h=()=>"Windows"===a(),p=()=>"macOS"===a(),m=()=>s()?.getBrowserName(),f=()=>s()?.getBrowserVersion()},879205:(e,t,r)=>{r.d(t,{Ak:()=>p,KU:()=>u,VB:()=>h,ux:()=>m});var i=r(324586),n=r(626443),o=r(691421),s=r(776016),a=r(225762),c=r(193010),l=r(307391),d=r(867312);async function u(e,t){const r=await fetch(e,{method:"POST",body:JSON.stringify(t),headers:[[c.UD.CONTENT_TYPE,"application/json"]]});if(r.ok){const e=await r.json();if((0,s._j)(o.OY)(e))return e;throw new Error("Unexpected response body structure")}throw new Error(r.statusText??"An error occurred looking up assets in database")}class h extends Error{constructor(e,t){super(e),(0,i.A)(this,"statusCode",void 0),this.statusCode=t}get isSevere(){return this.statusCode===n.v.NOT_FOUND}}async function p(e){const t=await fetch(e,{headers:[[c.UD.RANGE,"bytes=0-0"],[a.DN,"true"]]});if((0,d.KB)(t))throw new l.Jk("Service worker bypassed in cache fetch");if(t.status===n.v.PARTIAL_CONTENT){const e=t.headers.get(c.Wu.CONTENT_RANGE);if(e){const t=a.gb.exec(e);if(t)return{fileSize:Number.parseInt(t[3])}}}throw new h(`Failed to fetch ${e}`,t.status)}async function m(e){const t=await fetch(e,{method:"DELETE"});if(!t.ok)throw new Error(t.statusText??`An error occurred removing ${e} from the cache`)}},867312:(e,t,r)=>{r.d(t,{KB:()=>a,OZ:()=>o,UG:()=>l,Uk:()=>s,ue:()=>c,wO:()=>n}),r(584570),r(82265),r(988124);var i=r(225762);const n="extractAssetIdFromPermanentUrl",o="generatePermanentUrlFromAssetId";function s(e){return`${e}_filmstrip`}function a(e){return!e.headers.get(i.fs)}function c(e){return t=>{const r=new URL(t);if(0!==r.pathname.indexOf(e))throw new Error("Invalid resource URL: "+t);const i=decodeURIComponent(r.pathname.slice(e.length));if(0===i.length)throw new Error("Invald resource URL: "+t);return i}}function l(e,t){return r=>`${e}${t}${encodeURIComponent(r)}`}},307391:(e,t,r)=>{r.d(t,{Jk:()=>o,df:()=>n,xE:()=>i}),Error;class i extends Error{constructor(e){super(e),Object.setPrototypeOf(this,i.prototype)}}class n extends Error{constructor(e){super(e),Object.setPrototypeOf(this,n.prototype)}}class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,o.prototype)}}},689999:(e,t,r)=>{r.d(t,{D:()=>p,i:()=>h});var i,n=r(324586),o=r(815731),s=r(825702),a=r(739367),c=r(573340);const l="ClipchampStorageManager.limit",d="local-cache",u=`/${d}/assets/store`;let h=(0,s.Gr)()(i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[])(i=class{constructor(){(0,n.A)(this,"storageEstimate$",void 0),(0,n.A)(this,"storageEstimate",new o.t(void 0)),this.storageEstimate$=this.storageEstimate.asObservable(),this.updateCacheEstimate()}setCustomStorageLimit(e){window.localStorage.setItem(l,`${e}`)}getCustomStorageLimit(){const e=window.localStorage.getItem(l);return e?Number.parseFloat(e):1}updateCacheEstimate(){navigator.storage.estimate().then((e=>{const t=e.usageDetails?.indexedDB;this.storageEstimate.next({quota:e.quota,usage:t??e.usage??0})})).catch((()=>c.su.error("caching-utils","Quota query error")))}async clearAssetCache(){await this.clearSWAssetDatabase(),indexedDB.deleteDatabase(d),this.storageEstimate.next({...this.storageEstimate.value,usage:0})}async clearSWAssetDatabase(){await fetch(u,{method:"DELETE"})}})||i)||i)||i;function p(){return(0,a.l)(h)}},225762:(e,t,r)=>{r.d(t,{DN:()=>s,Wd:()=>c,fs:()=>a,gb:()=>i,h1:()=>n,ld:()=>o,zK:()=>l});const i=/^bytes\s(\d+)-(\d+)\/(\d+)$/,n="public, immutable, max-age=31536000",o=6e4,s="X-Clipchamp-SkipManualRehydration",a="X-Clipchamp-Serviceworker-Response";let c=function(e){return e.ASSETS_TABLE="assets",e.HANDLES_TABLE="handles",e}({}),l=function(e){return e.AbortError="AbortError",e.ConstraintError="ConstraintError",e.DataCloneError="DataCloneError",e.DataError="DataError",e.InvalidAccessError="InvalidAccessError",e.InvalidStateError="InvalidStateError",e.NotFoundError="NotFoundError",e.QuotaExceededError="QuotaExceededError",e.SyntaxError="SyntaxError",e.ReadOnlyError="ReadOnlyError",e.TransactionInactiveError="TransactionInactiveError",e.UnknownError="UnknownError",e.VersionError="VersionError",e}({})},869655:(e,t,r)=>{r.d(t,{u:()=>c,a:()=>a});var i=r(324586),n=(r(95732),r(225762)),o=r(626443);function s(e){switch(e){case n.zK.SyntaxError:case n.zK.DataError:return o.v.BAD_REQUEST;case n.zK.NotFoundError:return o.v.NOT_FOUND;case n.zK.QuotaExceededError:return o.v.INSUFFICIENT_STORAGE;default:return o.v.SERVICE_UNAVAILABLE}}class a extends DOMException{constructor(e,t){super(e,t??"IDBTransactionError")}asFetchResponse(){return new self.Response(null,{status:s(this.name),statusText:this.message,headers:{[n.fs]:"true"}})}}class c extends Error{constructor(...e){super(...e),(0,i.A)(this,"name","IDBNoResultError")}}},327866:(e,t,r)=>{r.d(t,{Sv:()=>a});var i=r(573340),n=r(650882),o=r(615101);const s={};function a(e,t,r){return s[e]=s[e]||function(e,t,r,s){return new Promise(((a,c)=>{const l=self.indexedDB.open(e,t);l.onupgradeneeded=e=>r(l,e),l.onsuccess=()=>{a(function(e,t){return e.onclose=e=>{i.Vy.error("Database was unexpectedly closed, trashing it",e),t()},e.onerror=r=>{i.su.warn("caching-utils","Transaction error has bubbled up to database, trashing it",r),e.close(),t()},e.onabort=r=>{i.su.warn("caching-utils","Transaction abort has bubbled up to database, trashing it",r),e.close(),t()},e.onversionchange=r=>{i.su.error("caching-utils",`Database '${e.name}' new version(${r.newVersion}) opened in new tab, tashing it.`,r),e.close(),t()},e}(l.result,s))},l.onerror=()=>{i.su.error("caching-utils","Cannot open database",l.error),c(new n.g9((0,o.vU)("Cannot open database"),{originalError:l.error?.message}))}}))}(e,t,r,(()=>s[e]=void 0))}},856422:(e,t,r)=>{r.d(t,{bZ:()=>a});var i=r(573340),n=r(450139),o=r(225762),s=r(869655);async function a(e,t,r,a=o.ld){return(0,n.d)(((n,a)=>{const c=e.transaction([t],"readonly"),l=c.objectStore(t).get(r);l.onsuccess=()=>{l.result?(i.su.info("caching-utils",`\n                        Found resource for ${r} in '${t}' database ObjectStore\n                    `),n(l.result)):(i.su.info("caching-utils",`Could not find ${r} in '${t}' database ObjectStore`),a(new s.u(`Unable to find '${t}' store object for ${r}`)))},c.onerror=()=>{i.su.error("caching-utils",`Error performing database lookup for ${r} in '${t}' database ObjectStore`),a(new s.a(`Error performing '${t}' database get for ${r}`,c.error?.name))},c.onabort=()=>{a(new s.a(`Abort performing '${t}' database get for ${r}`,c.error?.name??o.zK.AbortError))}}),a,"Timeout performing database lookup")}},691421:(e,t,r)=>{r.d(t,{OY:()=>l,TK:()=>p,z:()=>h});var i=r(573340),n=r(776016),o=r(225762),s=r(193010),a=r(856422);const c=51200,l=(0,n.t9)({permanentUrl:s.WV,fileSize:n.Et,fileName:(0,n.H7)(n.Kg)}),d=5e3,u=5e3;function h(e,t){return new Promise(((r,n)=>{const s=function(e){const t=e.reduce(((e,t)=>e+t.blob.size),0),r=Math.floor(t/c);return d+e.length*u+r}(t),a=setTimeout((()=>{i.su.error("caching-utils",`Storing ${t.length} records in cache timed out after ${s}ms`),n(new Error("Database timeout"))}),s),l=e.transaction([o.Wd.ASSETS_TABLE],"readwrite",{durability:"relaxed"}).objectStore(o.Wd.ASSETS_TABLE);!function(e,t,r){e.length<=0&&r([]);for(const r of e)t.put(r);t.transaction.onabort=()=>{const n=t.transaction.error;i.su.error("caching-utils",`Transaction to store ${e.length} assets was aborted`,n),r(new Array(e.length).fill({status:"rejected",error:n??new Error("Transaction was aborted")}))},t.transaction.onerror=()=>{const n=t.transaction.error;i.su.error("caching-utils",`Transaction to store ${e.length} produced error`,n),r(new Array(e.length).fill({status:"rejected",error:n??new Error("Transaction errored out")}))},t.transaction.oncomplete=()=>{r(new Array(e.length).fill({status:"resolved",result:void 0}))}}(t,l,(e=>{clearTimeout(a),r(e)}))}))}async function p(e,t){return(await(0,a.bZ)(e,o.Wd.ASSETS_TABLE,t)).blob}},903277:(e,t,r)=>{function i(){return navigator.storage.estimate()}r.d(t,{x:()=>i})},193010:(e,t,r)=>{r.d(t,{NG:()=>f,UD:()=>c,WV:()=>m,Wu:()=>u,Y2:()=>o,uU:()=>y,uZ:()=>A,v5:()=>g});var i=r(776016),n=r(897868);const o={HydrationLookup:"lookup",FileSystemPermission:"fs-permission",QueryFeatureFlag:"query-feature"},s=Object.values(o),a=(0,i.u)(...s),c={CONTENT_TYPE:"Content-Type",RANGE:"Range"},l=Object.values(c),d=(0,i.u)(...l),u={CONTENT_RANGE:"Content-Range",CONTENT_LENGTH:"Content-Length",CONTENT_TYPE:"Content-Type",CACHE_CONTROL:"Cache-Control",ACCEPT_RANGES:"Accept-Ranges",CLIPCHAMP_CHUNK_ID:"X-Clipchamp-Chunk",CLIPCHAMP_BLOB_SIZE:"X-Clipchamp-Size",LAST_MODIFIED:"Last-Modified"},h=Object.values(u),p=(0,i.u)(...h);function m(e){return(0,i.Kg)(e)}const f=(0,i.t9)({operation:a,request:i.O9}),g=((0,i.t9)({statusCode:i.Et,statusText:(0,i.H7)(i.Kg),responseHeaders:(0,i.H7)((0,i.$H)(p,i.Kg))}),(0,i.t9)({permanentUrl:m,requestHeaders:(0,i.$H)(d,i.Kg),skipManualRehydration:i.Lm}));(0,i.t9)({statusCode:i.Et,statusText:(0,i.H7)(i.Kg),responseHeaders:(0,i.H7)((0,i.$H)(p,i.Kg)),responseContent:function(e,t){const r=e instanceof Blob||null===e;return!r&&(0,n.c)(t)&&t.fail("blob",typeof e),r}});const A=(0,i.t9)({permanentUrl:m,handle:function(e){return e instanceof FileSystemFileHandle}});function v(e){return(0,i.Kg)(e)}(0,i.t9)({statusCode:i.Et,statusText:(0,i.H7)(i.Kg),responseHeaders:(0,i.H7)((0,i.$H)(p,i.Kg)),permission:(0,i.H7)(i.Kg)});const y=(0,i.t9)({feature:v});(0,i.t9)({feature:v,enabled:i.Lm})},71872:(e,t,r)=>{r.d(t,{F:()=>i});const i={fromRgb:e=>(Math.floor(e.red)<<16)+(Math.floor(e.green)<<8)+Math.floor(e.blue),fromString:e=>"#"===e.charAt(0)?Number.parseInt(e.slice(1),16):Number.parseInt(e,16),toRgb:e=>({red:(e=Math.floor(e))>>16&255,green:e>>8&255,blue:255&e}),toString(e){let t=e.toString(16);for(;t.length<6;)t="0"+t;return"#"+t},fromAlphaStringToHexAlpha:e=>"#"===e.charAt(0)?{alpha:Number.parseInt(e.slice(7,9),16)/255,hex:Number.parseInt(e.slice(1,7),16)}:{alpha:Number.parseInt(e.slice(6,8),16)/255,hex:Number.parseInt(e.slice(0,6),16)}}},392844:(e,t,r)=>{r.d(t,{Z:()=>i});const i=["diagonal","horizontal","vertical","radial"]},182073:(e,t,r)=>{r.d(t,{J:()=>a,M:()=>c});var i=r(26985),n=r(653907),o=r(247498),s=r(776016);const a=e=>(0,s.K0)(e,{avg_frame_rate:s.Kg,codec_tag:s.Kg,codec_tag_string:s.Kg,index:s.Et,r_frame_rate:s.Kg,time_base:s.Kg,codec_type:e=>"video"===e,has_b_frames:s.Et,height:s.Et,width:s.Et,level:s.Et,codec_name:s.Kg});function c(e){const{t}=(0,o.Bd)(),r=(0,n.r)();return(0,i.useMemo)((()=>{const i=function(e){return!("status"in e.file)}(e.data)?e.data:void 0;if(i)return r.createBrandImageTypeAsset(e.id,e.data.displayName||t("brandKit.defaultLogoName","Your Image"),e.type,i)}),[e])}},786731:(e,t,r)=>{r.d(t,{Q:()=>a,S:()=>c});var i=r(26985),n=r(653907),o=r(247498),s=r(776016);const a=e=>(0,s.K0)(e,{avg_frame_rate:s.Kg,codec_tag:s.Kg,codec_tag_string:s.Kg,index:s.Et,r_frame_rate:s.Kg,time_base:s.Kg,codec_type:e=>"video"===e,has_b_frames:s.Et,height:s.Et,width:s.Et,level:s.Et,codec_name:s.Kg});function c(e){const{t}=(0,o.Bd)(),r=(0,n.r)();return(0,i.useMemo)((()=>{const i=function(e){return!("status"in e.file)}(e.data)?e.data:void 0;if(i)return r.createBrandVideoAsset(e.id,e.data.displayName||t("brandKit.defaultVideoName","Your video"),i)}),[e])}},307525:(e,t,r)=>{r.d(t,{b:()=>c,q:()=>l});var i=r(26985),n=r(135232),o=r(116980),s=r(277277);const[a,c]=(0,n.Q)("FluentSelectedTheme"),l=({children:e})=>{const t=localStorage.getItem("theme"),r=o.q.find((e=>e.id===t)),[n,c]=(0,i.useState)(r??o.q[1]);return(0,s.jsx)(a,{value:{theme:n,toggleTheme:e=>{c(e),localStorage.setItem("theme",e.id)}},children:e})}},754494:(e,t,r)=>{r.d(t,{x:()=>m});var i=r(247498),n=r(301557),o=r(145481),s=r(682523),a=r(356735),c=r(109492),l=r(766828),d=r(380467),u=r(56352),h=r(277277),p=r(26985);const m=({open:e,onClose:t,canClose:r,dialogHeader:m,dialogTitleText:f,dialogBodyText:g,dialogBody:A,buttons:v})=>{const{t:y}=(0,i.Bd)();return(0,h.jsx)(n.l,{open:e,onClose:t,disableBackdropClick:!0,children:(0,h.jsxs)(l.q,{theme:u.vg,children:[r&&(0,h.jsx)(o.H,{"aria-label":y("export.exportFailed.closeAria","Close dialog"),onClose:t}),m,(0,h.jsx)(s.L,{children:f}),(0,h.jsx)(a.o,{children:g}),A,(0,h.jsx)(c.i,{children:v.map((e=>(0,p.createElement)(d.$,{...e,key:e.buttonText},e.buttonText)))})]})})}},52509:(e,t,r)=>{r.d(t,{a:()=>u});var i=r(766828),n=r(667641),o=r(977751),s=r(440125),a=r(397448),c=r(380467),l=r(56352),d=r(277277);function u({title:e,children:t,action:r,open:u,onClose:h}){return(0,d.jsx)(i.q,{theme:l.vg,children:(0,d.jsxs)(n.lG,{open:u,modalType:"alert",onClose:h,children:[(0,d.jsx)(o.L,{children:e}),(0,d.jsx)(s.C,{children:t}),(0,d.jsx)(a.i,{children:(0,d.jsx)(c.$,{appearance:"primary",onClick:h,children:r})})]})})}},244792:(e,t,r)=>{r.d(t,{WB:()=>c,ec:()=>s,lU:()=>a});var i=r(324586),n=r(573340),o=r(365398);const s="PRODUCT_TOUR_CONFIG",a="productTour";class c{constructor(e){(0,i.A)(this,"initialize",((e,t=3)=>{const{getProductTour:r,setProductTour:i}=o.Pj.getState(),n=r(e);if(!n)return void this.logMissingError(e);const s=this.getTimesShown(e);-1===s||n.isInitialized()||n.hasExpired()||!this.isEnabled(e)||s>=t||(this.setTimesShown(e,s+1),i(e,n.withFirstStep()),this.trackStarted(e,s))})),(0,i.A)(this,"isInitialized",(e=>{const{getProductTour:t}=o.Pj.getState(),r=t(e);return!!r&&r.isInitialized()})),(0,i.A)(this,"nextStep",(e=>{const{getProductTour:t,setProductTour:r}=o.Pj.getState(),i=t(e);if(!i)return void this.logMissingError(e);const n=i.withNextStep();if(r(e,n),n.isFinished())return this.dontShowAgain(e),void this.trackCompleted(e);this.trackNextStep(e,n.currentStep)})),(0,i.A)(this,"dismiss",((e,t)=>{const{getProductTour:r,setProductTour:i}=o.Pj.getState(),n=r(e);n?n.isInitialized()&&!n.isFinished()&&(i(e,n.withFinished()),t&&this.dontShowAgain(e),this.trackDismissed(e,t)):this.logMissingError(e)})),(0,i.A)(this,"getCurrentStep",(e=>{const{getProductTour:t}=o.Pj.getState(),r=t(e);return r?r.currentStep:(this.logMissingError(e),-1)})),(0,i.A)(this,"logMissingError",(e=>{n.Vy.error(new Error(`Tried to access missing product tour with id=${e}`))})),(0,i.A)(this,"dontShowAgain",(e=>{this.setTimesShown(e,-1)})),(0,o.k$)(e)}}},365398:(e,t,r)=>{r.d(t,{k$:()=>a,CD:()=>d,E4:()=>h,GH:()=>u,Sn:()=>l,dL:()=>c,Pj:()=>s});var i=r(831123),n=r(324586);class o{constructor(e,t,r){(0,n.A)(this,"currentStep",void 0),(0,n.A)(this,"numberOfSteps",void 0),(0,n.A)(this,"expiryDate",void 0),this.currentStep=e,this.numberOfSteps=t,this.expiryDate=r}static withSteps(e,t){return new o(0,e,t)}withFirstStep(){return this.withCurrentStep(1)}withNextStep(){const e=this.currentStep+1;return this.isFinished()||e>this.numberOfSteps?this.withFinished():this.withCurrentStep(e)}withFinished(){return this.withCurrentStep(-1)}withCurrentStep(e){return new o(e,this.numberOfSteps,this.expiryDate)}isInitialized(){return 0!==this.currentStep}isFinished(){return-1===this.currentStep}hasExpired(){return this.expiryDate&&new Date>=this.expiryDate}}const s=(0,i.vt)(((e,t)=>({productTours:new Map,setProductTour:(t,r)=>e((e=>({productTours:new Map(e.productTours).set(t,r)}))),getProductTour:e=>t().productTours.get(e)}))),a=e=>{s.setState({productTours:new Map(Object.entries(e).map((([e,{steps:t,expiryDate:r}])=>[e,o.withSteps(t,r)])))})},c=e=>s((t=>t.getProductTour(e)?.numberOfSteps)),l=(e,t)=>s((r=>r.getProductTour(e)?.numberOfSteps===t)),d=(e,t)=>s((r=>r.getProductTour(e)?.currentStep===t)),u=e=>s((t=>t.getProductTour(e)?.isInitialized()??!1)),h=e=>s((t=>t.getProductTour(e)?.isFinished()??!1))},560494:(e,t,r)=>{r.d(t,{V2:()=>d,mt:()=>h,rd:()=>l,uX:()=>u}),r(584570),r(82265),r(988124);var i=r(667017),n=r(545516),o=r(26141),s=r(277277);const a=e=>{if("string"==typeof e)return new URL(e,window.location.origin);let t="";return t+=e.pathname?.startsWith("/")?e.pathname:`/${e.pathname??""}`,e.search&&(t+=e.search.startsWith("?")?e.search:`?${e.search}`),e.hash&&(t+=e.hash.startsWith("#")?e.hash:`#${e.hash}`),new URL(t,window.location.origin)},c=(e,t)=>new URLSearchParams({...Object.fromEntries(e.entries()),...Object.fromEntries(t.entries())}),l=({to:e,...t})=>{const[r]=(0,i.ok)(),o=[...r.entries()].reduce(((e,[t,r])=>(t.startsWith("utm")&&e.set(t,r),e)),new URLSearchParams),l=a(e);let d=c(o,l.searchParams).toString();d&&(d=d.startsWith("?")?d:`?${d}`);let u=l.hash;return u&&(u=u.startsWith("#")?u:`#${u}`),(0,s.jsx)(n.C5,{to:{pathname:l.pathname,search:d,hash:u},...t})};function d(e,t,r){const i=new URL(r.url),n=a(e),s=c(i.searchParams,n.searchParams);return(0,o.V2)(`${n.pathname}?${s.toString()}`,t)}function u(e,t){return({request:r})=>d(e,t,r)}function h(e,t){return()=>(0,o.Sk)(e,t)}},325065:(e,t,r)=>{r.d(t,{G:()=>o,k:()=>n});var i=r(175358);const n=(0,i.mj)("home.metaTitle","Clipchamp - free video editor & video maker"),o=(0,i.mj)("home.metaDescription","Use Clipchamp to make awesome videos from scratch or start with a template to save time. Edit videos, audio tracks and images like a pro without the price tag.")},599038:(e,t,r)=>{r.d(t,{UO:()=>d,c3:()=>h,kG:()=>p});var i=r(26985),n=r(545516),o=r(652213),s=r(529743),a=r(641580),c=r(7089),l=r(650882);async function d(e,t){const r=await fetch(e),i=await r.json();if(t(i))return i;throw new Error("Unexpected response when loading template project")}function u(e){const t=new Map(e.assets.allIds.map((e=>[e,(0,c.u)()]))),r=[...t.values()],i=[...t.keys()].reduce(((r,i)=>{const n=t.get(i);if(void 0===n)throw new Error("Unexpected missing asset ID");const o={...e.assets.byId[i],id:n};return{...r,[n]:o}}),{}),n=e.items.allIds.reduce(((r,i)=>{const n=e.items.byId[i].assetId,o=t.get(n)||n;return{...r,[i]:{...e.items.byId[i],assetId:o}}}),{});return{...e,assets:{...e.assets,allIds:r,byId:i},items:{...e.items,byId:n}}}function h(e,t,r="project",i){return{...u(e),name:i,flavor:"template",firstTemplateId:t,firstTemplateName:i,includesComponentTemplate:"component"===r,includesProjectTemplate:"project"===r,templatesAddedCount:1,templatesAdded:[t],isCloudBackupEnabled:!1}}function p(){const[e,t]=(0,i.useState)("idle"),r=(0,o.q)(),c=(0,n.Zp)(),[d]=(0,a.Vp)("unsupported-project");return{status:e,openTemplateAsync:async(i,n)=>{if("loading"!==e)try{t("loading");const e=await n(i);r.current&&t("success"),c(e)}catch(e){if(r.current&&t("error"),(0,s.x)(e))return void d({unsupportedProject:{type:"template",projectVersion:e.projectVersion,clientVersion:e.clientVersion}});throw new l.g9("Cannot replace project with template",{templateId:i.id,error:e instanceof Error?e.message:"unknown"})}}}}},706558:(e,t,r)=>{r.d(t,{l:()=>i});const i="config"},329524:(e,t,r)=>{r.d(t,{l:()=>i});const i="generateEditorUrls"},730427:(e,t,r)=>{r.d(t,{E:()=>i});const i="logSurveyActivity"},15047:(e,t,r)=>{r.d(t,{L:()=>n,S:()=>o});var i=r(739367);const n="isPowerUser",o=()=>(0,i.l)(n)()},685944:(e,t,r)=>{r.d(t,{E:()=>u});var i,n=r(825702),o=r(600596),s=r(355185),a=r(724226),c=r(597906),l=r(533921),d=r(298552);let u=(0,n.Gr)()((h=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",["undefined"==typeof IContentConfig?Object:IContentConfig])(i=class extends c.KN{constructor(e){super();const t=new o.X(e.contentRepoUrl,e.contentRepoKey);this.supplier=new a.Q(t)}async getAllContent(){return(await Promise.all([this.supplier.getFilters(this.lang),this.supplier.getGraphicElements(this.lang),this.supplier.getMotionTitles(this.lang),this.supplier.getTransitions(this.lang)])).flat(1)}get lang(){const e=(0,l.Xo)();return(0,s.UV)(e)?e:"en"}})||i)||i,i=(0,n.WQ)(d.X)(h,void 0,0)||i))||i;var h},298552:(e,t,r)=>{r.d(t,{X:()=>i});const i="contentConfig"},913677:(e,t,r)=>{r.d(t,{Q:()=>a,m:()=>o});var i=r(140169),n=r(277277);const o="cookie-banner",s=i.I.div`
    width: 100%;
    position: fixed;
    bottom: 0;
    z-index: 10;
`,a=()=>(0,n.jsx)(s,{id:o})},408546:(e,t,r)=>{r.d(t,{S:()=>d,d:()=>l});var i=r(26985),n=r(179315),o=r(913677),s=r(277277);const a=(0,i.createContext)({isConsentRequired:!1,manageCookies:()=>{}});let c;const l=({children:e,action:t,locale:r})=>{const l=(0,n.iT)("tra_wcp_cookie_banner_consumer"),[d,u]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const e=()=>{const e=c.getConsent();t({analytics:e.Analytics,advertising:e.Advertising,socialMedia:e.SocialMedia})};if(l){const t=document.createElement("script");t.src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js",t.async=!0,document.head.appendChild(t),t.onload=()=>{"undefined"!=typeof WcpConsent&&(WcpConsent.init(r,o.m,((e,t)=>{if(void 0!==e)return e;c=t}),e),u(c.isConsentRequired),e())},t.onerror=()=>{console.error("Failed to load the consent script.")}}}),[r,l,t]),(0,s.jsx)(a.Provider,{value:{isConsentRequired:d,manageCookies:()=>c.manageConsent()},children:e})},d=()=>(0,i.useContext)(a)},410040:(e,t,r)=>{r.d(t,{Q:()=>l});var i=r(247498),n=r(977751),o=r(440125),s=r(397448),a=r(380467),c=r(277277);function l({onClose:e}){const{t}=(0,i.Bd)();return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.L,{children:t("error.defaultError.title","Clipchamp has stopped responding")}),(0,c.jsx)(o.C,{children:t("error.defaultError.description","Try refreshing your browser, or if the problem persists, restart your computer.")}),(0,c.jsx)(s.i,{children:(0,c.jsx)(a.$,{appearance:"primary",onClick:e,children:t("error.defaultError.refresh","Refresh")})})]})}},205606:(e,t,r)=>{r.d(t,{D:()=>i});const i="notificationProviders"},593848:(e,t,r)=>{r.d(t,{$C:()=>M,D4:()=>w,Ht:()=>a,JB:()=>s,MO:()=>L,Pr:()=>d,UU:()=>c,W9:()=>P,Wj:()=>I,X7:()=>B,aE:()=>D,co:()=>R,lK:()=>F,pI:()=>A,q5:()=>E,se:()=>N,uf:()=>o});var i=r(762857),n=r(776016);const o="rookie",s="essentials",a="ms365",c="ms365_classic",l=[s,a,c],d=(0,n.u)(...l),u=((0,n.u)(a),[...l]),h=((0,n.u)(...u),(0,n.u)(s),[s]),p=((0,n.u)(...h),[o,...l]),m=((0,n.u)(...p),[o]),f=((0,n.u)(...m),[o,...u]),g=((0,n.u)(...f),[...m]),A=(0,n.u)(...g),v=[...p,...l.map((e=>`${e}_annual`))],y=(0,n.u)(...v),b=[...g,...v],w=(0,n.u)(...b),x=(0,n.u)("Free","Microsoft 365","Microsoft 365 Classic","Essentials","Clipchamp Premium"),S=["unlimited","restricted"],T=(0,n.u)("none","single","multiple"),C=(0,n.u)("standard","premium","ms365"),_=(0,n.u)("standard","premium"),k=(0,n.t9)({export_resolutions:(0,n._j)((0,n.u)(...i.Km)),no_watermark:n.Lm,brand_center:n.Lm,pip:n.Lm,audio_stock:(0,n.u)("half_price","full_price","unlimited"),video_stock:(0,n.u)("half_price","full_price","unlimited"),image_stock:(0,n.u)("half_price","full_price","unlimited"),compression:n.Lm,cloud_backup:n.Lm,content_transition:(0,n.u)(...S),content_filter:(0,n.u)(...S),smartResize:n.Lm,magicAutoRemoval:n.Lm,frameRates:(0,n._j)((0,n.u)(30,60)),identitiesSupported:(0,n._j)((0,n.u)("AAD","MSA")),msAudioStock:C,msVideoStock:C,msImageStock:C,msBrandKit:T,graphics:_}),E=(0,n.t9)({id:(0,n.ey)(A,y),name:x,features:k}),I=((0,n.t9)({id:y,name:x,features:k}),{id:"rookie",name:"Free",features:{export_resolutions:["480p","720p","1080p"],no_watermark:!1,brand_center:!1,pip:!1,audio_stock:"full_price",video_stock:"full_price",image_stock:"full_price",compression:!1,cloud_backup:!1,content_transition:"restricted",content_filter:"restricted",smartResize:!1,magicAutoRemoval:!1,frameRates:[30],identitiesSupported:["MSA"],msAudioStock:"standard",msVideoStock:"standard",msImageStock:"standard",msBrandKit:"none",graphics:"standard"}}),R="CFQ7TTC0Q4F0",F=[R],P="0002",L="0004",N={id:"essentials",name:"Clipchamp Premium",features:{compression:!0,no_watermark:!0,pip:!0,content_transition:"unlimited",content_filter:"unlimited",brand_center:!0,audio_stock:"unlimited",video_stock:"unlimited",image_stock:"unlimited",cloud_backup:!0,export_resolutions:["480p","720p","1080p","4K"],smartResize:!0,magicAutoRemoval:!0,frameRates:[30,60],identitiesSupported:["MSA"],msAudioStock:"premium",msVideoStock:"premium",msImageStock:"premium",msBrandKit:"single",graphics:"premium"}},M={id:"ms365",name:"Microsoft 365",features:{export_resolutions:["480p","720p","1080p"],no_watermark:!0,brand_center:!1,pip:!1,audio_stock:"full_price",video_stock:"full_price",image_stock:"full_price",compression:!1,cloud_backup:!1,content_transition:"unlimited",content_filter:"unlimited",smartResize:!0,magicAutoRemoval:!0,frameRates:[30,60],identitiesSupported:["MSA"],msAudioStock:"standard",msVideoStock:"standard",msImageStock:"standard",msBrandKit:"none",graphics:"premium"}},B={id:"ms365_classic",name:"Microsoft 365 Classic",features:{export_resolutions:["480p","720p","1080p"],no_watermark:!0,brand_center:!1,pip:!0,audio_stock:"full_price",video_stock:"full_price",image_stock:"full_price",compression:!0,cloud_backup:!1,content_transition:"unlimited",content_filter:"unlimited",smartResize:!0,magicAutoRemoval:!0,frameRates:[30,60],identitiesSupported:["MSA"],msAudioStock:"ms365",msVideoStock:"ms365",msBrandKit:"none",msImageStock:"ms365",graphics:"standard"}},D=(0,n.u)("active","inactive")},907057:(e,t,r)=>{r.d(t,{FR:()=>m,QJ:()=>f,Q_:()=>d,X9:()=>p,_U:()=>g,m6:()=>s,mZ:()=>u});var i=r(540076),n=r(593848);const o=["rookie","ms365_classic","ms365","essentials"],s=(e,t)=>{const r=["rookie","ms365","ms365_classic"];for(const i of[r])if(i.includes(e)&&i.includes(t))return 0;const i=o.indexOf(e),n=o.indexOf(t);return i===n?0:i<n?-1:1},a={rookie:"rookie",essentials:"essentials_annual",essentials_annual:"essentials_annual",ms365:"ms365_annual",ms365_annual:"ms365_annual",ms365_classic:"ms365_classic",ms365_classic_annual:"ms365_annual"},c={rookie:"rookie",essentials:"essentials",essentials_annual:"essentials",ms365:"ms365",ms365_annual:"ms365",ms365_classic:"ms365_classic",ms365_classic_annual:"ms365_classic"},l={rookie:"standard",essentials:"premium",essentials_annual:"premium",ms365:"ms365",ms365_annual:"ms365",ms365_classic:"ms365_classic",ms365_classic_annual:"ms365_classic"};function d(e){return c[e]}function u(e){return l[e]}const h={rookie:n.Wj,essentials:n.se,ms365:n.$C,ms365_classic:n.X7};function p(e){return h[d(e)]}function m(e,t){return e.filter((e=>function(e,t){return!(t.exportResolution&&!e.features.export_resolutions.includes(t.exportResolution)||t.brandCenter&&!e.features.brand_center||t.compression&&!e.features.compression||t.stockVideo&&t.stockVideo.length>0&&"unlimited"!==e.features.video_stock||t.stockAudio&&t.stockAudio.length>0&&"unlimited"!==e.features.audio_stock||t.stockImage&&t.stockImage.length>0&&"unlimited"!==e.features.image_stock)}(e,t)))}function f(e,t){switch(t){case"monthly":return d(e);case"annual":return a[e];default:return(0,i.xb)(t,"Impossible billing cycle selected")}}function g(e){const t=function(e){return e.endsWith("_annual")}(e);return{planHandle:d(e),billingCycle:t?"annual":"monthly"}}},969956:(e,t,r)=>{r.d(t,{tB:()=>w,sd:()=>b,JE:()=>v,ew:()=>x});var i=r(515207),n=r(477793),o=r(720291),s=r(811438),a=r(412746),c=r(559755),l=r(177482),d=r(776016),u=r(972070),h=r(573340),p=r(593848);const m=(0,d.t9)({plan:p.q5,status:p.aE,upcoming_backup_deletion_date:(0,d.T)(d.Kg),upgrade_date:(0,d.T)(d.Kg),is_manual:(0,d.H7)(d.Lm),is_copilot_enabled:(0,d.H7)(d.Lm)});var f=r(415208);const g=(0,a.y)((e=>({state:{status:"idle"},setState:t=>{e({state:t})}}))),A=new i.c((e=>{const t=c.j.registerForChanges((t=>{e.next(t)}));return()=>{t()}})),v=()=>{g.getState().setState({status:"idle"})},y=()=>{const e=g.getState();if("loading"===e.state.status)return e.state.promise;const t=(e=>{const{status:t}=e;if("success"===t){const t=e.lastUpdated;if((new Date).getTime()-t.getTime()<6e4)return e.data}})(e.state);if(t)return Promise.resolve(t);if(!c.j.getToken())return Promise.resolve(void 0);const r=(async()=>{try{return e=await u.E.get("/user/entitlements").json(m),(0,p.D4)(e.plan.id)?function(e){return{status:e.status,plan:{id:e.plan.id,name:e.plan.name,features:e.plan.features},isManual:e.is_manual,upgradedAt:e.upgrade_date?new Date(e.upgrade_date):void 0,isCopilotEnabled:e.is_copilot_enabled}}(e):(h.Vy.log(`Could not recognise plan id in subscription response, so returning original subscription response: ${e.plan.id}`),{...e})}catch(e){return void h.Vy.error(e)}var e})();return e.setState({status:"loading",promise:r}),r.then((e=>{g.getState().setState({status:"success",lastUpdated:new Date,data:e})})).catch((e=>{g.getState().setState({status:"error",error:e})})),r};function b(){const e=A.pipe((0,n.n)((e=>e?(0,o.H)(y()):(0,s.of)(void 0)))).subscribe((e=>{(0,d.O9)(e)?(0,f.CP)(e):(0,f.lh)()}));return()=>{e.unsubscribe()}}async function w(){const e=await y();return e?(0,f.CP)(e):(0,f.lh)(),e}function x(){return(0,l.f)(w)}},415208:(e,t,r)=>{r.d(t,{CP:()=>a,hB:()=>u,ir:()=>d,kg:()=>h,lh:()=>c,uV:()=>l});var i=r(415004),n=r(412746);const o={plan:r(593848).Wj,status:"active"},s=(0,n.y)((e=>({state:o,initialised:!1,setSubscription:t=>{e({state:t,initialised:!0})},clearSubscription:()=>{e({state:o})}})));function a(e){s.getState().setSubscription(e)}function c(){s.getState().clearSubscription()}function l(){return s.getState().state}function d(){return s.getState().initialised}function u(){return e=e=>e.state,(0,i.n)(s,e,undefined);var e}function h(e){return s.subscribe(e)}},724226:(e,t,r)=>{r.d(t,{Q:()=>n});class i{}class n extends i{constructor(e){super(),this.client=e}async getContentById(e){return this.client.getById("content",e).result()}async getContentByIds(e){return this.client.getByIds(e).result()}async getTransitions(e){return this.client.getAll("content",{filters:[{type:"eq",field:"type",value:"transition"},{type:"eq",field:"locale",value:e}],sorts:[{field:"featured",order:"desc"},{field:"dateModified",order:"desc"}]}).result()}async getGraphicElements(e){return this.client.getAll("content",{filters:[{type:"eq",field:"type",value:"graphic-element"},{type:"eq",field:"subtype",value:"overlay"},{type:"eq",field:"locale",value:e}]}).result()}async getMotionTitles(e){return this.client.getAll("content",{filters:[{type:"eq",field:"type",value:"motion-title"},{type:"eq",field:"locale",value:e}]}).result()}async getFilters(e){return this.client.getAll("content",{filters:[{type:"eq",field:"type",value:"filter"},{type:"eq",field:"locale",value:e}],sorts:[{field:"featured",order:"desc"},{field:"dateModified",order:"desc"}]}).result()}}},882884:(e,t,r)=>{r.d(t,{Pu:()=>n,xA:()=>i});const i=[{name:"5th Avenue",variants:[{weight:400,filename:"5thAvenue.ttf"}]},{name:"Abel",variants:[{weight:400,filename:"abel-400.ttf"}]},{name:"Abril Fatface",variants:[{weight:400,filename:"abrilfatface-400.ttf"}]},{name:"Alegreya Sans",variants:[{weight:100,filename:"alegreyasans-100.ttf"},{weight:300,filename:"alegreyasans-300.ttf"},{weight:400,filename:"alegreyasans-400.ttf"},{weight:500,filename:"alegreyasans-500.ttf"},{weight:700,filename:"alegreyasans-700.ttf"},{weight:800,filename:"alegreyasans-800.ttf"},{weight:900,filename:"alegreyasans-900.ttf"},{weight:100,feature:"italic",filename:"alegreyasans-italic-100.ttf"},{weight:300,feature:"italic",filename:"alegreyasans-italic-300.ttf"},{weight:400,feature:"italic",filename:"alegreyasans-italic-400.ttf"},{weight:500,feature:"italic",filename:"alegreyasans-italic-500.ttf"},{weight:700,feature:"italic",filename:"alegreyasans-italic-700.ttf"},{weight:800,feature:"italic",filename:"alegreyasans-italic-800.ttf"},{weight:900,feature:"italic",filename:"alegreyasans-italic-900.ttf"}]},{name:"Alfa Slab One",variants:[{weight:400,filename:"alfaslabone-400.ttf"}]},{name:"Allenoire",variants:[{weight:400,filename:"Allenoire.ttf"}]},{name:"Allura",variants:[{weight:400,filename:"Allura-Regular.ttf"}]},{name:"Anton",variants:[{weight:400,filename:"anton-400.ttf"}]},{name:"Arial",variants:[{weight:400,filename:"arial.ttf"},{weight:700,filename:"arialbd.ttf"},{weight:400,feature:"italic",filename:"ariali.ttf"},{weight:700,feature:"italic",filename:"arialbi.ttf"}]},{name:"Arial Black",variants:[{weight:700,filename:"ariblk.ttf"}]},{name:"Arial Narrow",variants:[{weight:400,filename:"ARIALN.ttf"},{weight:700,filename:"ARIALNB.ttf"},{weight:400,feature:"italic",filename:"ARIALNI.ttf"},{weight:700,feature:"italic",filename:"ARIALNBI.ttf"}]},{name:"Arimo",variants:[{weight:400,filename:"arimo[weight].ttf"},{weight:700,filename:"arimo[weight].ttf"},{weight:400,feature:"italic",filename:"arimo-italic[weight].ttf"},{weight:700,feature:"italic",filename:"arimo-italic[weight].ttf"}]},{name:"Arizonia",variants:[{weight:400,filename:"Arizonia-Regular.ttf"}]},{name:"Azeret Mono",variants:[{weight:100,filename:"azeretmono[weight].ttf"},{weight:200,filename:"azeretmono[weight].ttf"},{weight:300,filename:"azeretmono[weight].ttf"},{weight:400,filename:"azeretmono[weight].ttf"},{weight:500,filename:"azeretmono[weight].ttf"},{weight:600,filename:"azeretmono[weight].ttf"},{weight:700,filename:"azeretmono[weight].ttf"},{weight:800,filename:"azeretmono[weight].ttf"},{weight:900,filename:"azeretmono[weight].ttf"},{weight:100,feature:"italic",filename:"azeretmono-italic[weight].ttf"},{weight:200,feature:"italic",filename:"azeretmono-italic[weight].ttf"},{weight:300,feature:"italic",filename:"azeretmono-italic[weight].ttf"},{weight:400,feature:"italic",filename:"azeretmono-italic[weight].ttf"},{weight:500,feature:"italic",filename:"azeretmono-italic[weight].ttf"},{weight:600,feature:"italic",filename:"azeretmono-italic[weight].ttf"},{weight:700,feature:"italic",filename:"azeretmono-italic[weight].ttf"},{weight:800,feature:"italic",filename:"azeretmono-italic[weight].ttf"},{weight:900,feature:"italic",filename:"azeretmono-italic[weight].ttf"}]},{name:"Bangers",variants:[{weight:400,filename:"bangers-400.ttf"}]},{name:"Barrio",variants:[{weight:400,filename:"barrio-400.ttf"}]},{name:"Bebas Neue",variants:[{weight:400,filename:"bebasneue-400.ttf"}]},{name:"Bowlby One",variants:[{weight:400,filename:"bowlbyone-400.ttf"}]},{name:"Bree Serif",variants:[{weight:400,filename:"breeserif-400.ttf"}]},{name:"Bricolage Grotesque",variants:[{weight:100,filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:200,filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:300,filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:400,filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:500,filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:600,filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:700,filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:800,filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:900,filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:100,feature:"italic",filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:200,feature:"italic",filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:300,feature:"italic",filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:400,feature:"italic",filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:500,feature:"italic",filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:600,feature:"italic",filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:700,feature:"italic",filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:800,feature:"italic",filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"},{weight:900,feature:"italic",filename:"BricolageGrotesque-VariableFont_opsz,wdth,wght.ttf"}]},{name:"Bumpo Soft",variants:[{weight:400,filename:"Bumpo-Soft-Regular.ttf"}]},{name:"Cairo",variants:[{weight:200,filename:"cairo[weight].ttf"},{weight:300,filename:"cairo[weight].ttf"},{weight:400,filename:"cairo[weight].ttf"},{weight:500,filename:"cairo[weight].ttf"},{weight:600,filename:"cairo[weight].ttf"},{weight:700,filename:"cairo[weight].ttf"},{weight:800,filename:"cairo[weight].ttf"},{weight:900,filename:"cairo[weight].ttf"}]},{name:"Calibri",variants:[{weight:400,filename:"calibri.ttf"},{weight:700,filename:"calibrib.ttf"},{weight:400,feature:"italic",filename:"calibrii.ttf"},{weight:700,feature:"italic",filename:"calibriz.ttf"}]},{name:"Calistoga",variants:[{weight:400,filename:"Calistoga-Regular.ttf"}]},{name:"Caprasimo",variants:[{weight:400,filename:"Caprasimo-Regular.ttf"}]},{name:"Cardin",variants:[{weight:400,filename:"Cardin-Serif.ttf"}]},{name:"Centrio",variants:[{weight:400,filename:"Centrio-Typeface-Regular.ttf"},{weight:400,feature:"italic",filename:"Centrio-Typeface-Italic.ttf"}]},{name:"Centrio Script",variants:[{weight:400,filename:"Centrio-Script-Typeface.ttf"}]},{name:"Chicle",variants:[{weight:400,filename:"chicle-400.ttf"}]},{name:"Cinzel",variants:[{weight:400,filename:"cinzel[weight].ttf"},{weight:700,filename:"cinzel[weight].ttf"},{weight:900,filename:"cinzel[weight].ttf"}]},{name:"Climate Crisis",variants:[{weight:400,filename:"ClimateCrisis-Regular.ttf"}]},{name:"Comic Sans",variants:[{weight:400,filename:"comic.ttf"},{weight:700,filename:"comicbd.ttf"},{weight:400,feature:"italic",filename:"comici.ttf"},{weight:700,feature:"italic",filename:"comicz.ttf"}]},{name:"Cormorant Garamond",variants:[{weight:300,filename:"cormorantgaramond-300.ttf"},{weight:400,filename:"cormorantgaramond-400.ttf"},{weight:500,filename:"cormorantgaramond-500.ttf"},{weight:600,filename:"cormorantgaramond-600.ttf"},{weight:700,filename:"cormorantgaramond-700.ttf"},{weight:300,feature:"italic",filename:"cormorantgaramond-italic-300.ttf"},{weight:400,feature:"italic",filename:"cormorantgaramond-italic-400.ttf"},{weight:500,feature:"italic",filename:"cormorantgaramond-italic-500.ttf"},{weight:600,feature:"italic",filename:"cormorantgaramond-italic-600.ttf"},{weight:700,feature:"italic",filename:"cormorantgaramond-italic-700.ttf"}]},{name:"Cotford Display",variants:[{weight:400,filename:"Cotford-Display.ttf"},{weight:400,feature:"italic",filename:"Cotford-Display-Italic.ttf"},{weight:100,filename:"Cotford-Display-Thin.ttf"},{weight:100,feature:"italic",filename:"Cotford-Display-Thin-Italic.ttf"},{weight:300,filename:"Cotford-Display-Light.ttf"},{weight:300,feature:"italic",filename:"Cotford-Display-Light-Italic.ttf"},{weight:700,filename:"Cotford-Display-Bold.ttf"},{weight:700,feature:"italic",filename:"Cotford-Display-Bold-Italic.ttf"},{weight:800,filename:"Cotford-Display-XBold.ttf"},{weight:800,feature:"italic",filename:"Cotford-Display-XBold-Italic.ttf"}]},{name:"Courgette",variants:[{weight:400,filename:"courgette-400.ttf"}]},{name:"Cream",variants:[{weight:400,filename:"Cream-Black.ttf"},{weight:400,feature:"italic",filename:"Cream-Black-Italic.ttf"}]},{name:"Creative Vintage",variants:[{weight:400,filename:"CreativeVintage-Regular.ttf"}]},{name:"Creepster",variants:[{weight:400,filename:"creepster-400.ttf"}]},{name:"Crimson Text",variants:[{weight:400,filename:"crimsontext-400.ttf"},{weight:600,filename:"crimsontext-600.ttf"},{weight:700,filename:"crimsontext-700.ttf"},{weight:400,feature:"italic",filename:"crimsontext-italic-400.ttf"},{weight:600,feature:"italic",filename:"crimsontext-italic-600.ttf"},{weight:700,feature:"italic",filename:"crimsontext-italic-700.ttf"}]},{name:"Cutive Mono",variants:[{weight:400,filename:"cutivemono-400.ttf"}]},{name:"Darker Grotesque",variants:[{weight:300,filename:"darkergrotesque-300.ttf"},{weight:400,filename:"darkergrotesque-400.ttf"},{weight:500,filename:"darkergrotesque-500.ttf"},{weight:600,filename:"darkergrotesque-600.ttf"},{weight:700,filename:"darkergrotesque-700.ttf"},{weight:800,filename:"darkergrotesque-800.ttf"},{weight:900,filename:"darkergrotesque-900.ttf"}]},{name:"Days One",variants:[{weight:400,filename:"DaysOne-Regular.ttf"}]},{name:"Dela Gothic One",variants:[{weight:400,filename:"delagothicone-400.ttf"}]},{name:"Delius",variants:[{weight:400,filename:"delius-400.ttf"}]},{name:"DM Sans",variants:[{weight:400,filename:"dmsans-400.ttf"},{weight:500,filename:"dmsans-500.ttf"},{weight:700,filename:"dmsans-700.ttf"},{weight:400,feature:"italic",filename:"dmsans-italic-400.ttf"},{weight:500,feature:"italic",filename:"dmsans-italic-500.ttf"},{weight:700,feature:"italic",filename:"dmsans-italic-700.ttf"}]},{name:"Dosis",variants:[{weight:200,filename:"dosis[weight].ttf"},{weight:300,filename:"dosis[weight].ttf"},{weight:400,filename:"dosis[weight].ttf"},{weight:500,filename:"dosis[weight].ttf"},{weight:600,filename:"dosis[weight].ttf"},{weight:700,filename:"dosis[weight].ttf"},{weight:800,filename:"dosis[weight].ttf"}]},{name:"Ephesis",variants:[{weight:400,filename:"ephesis-400.ttf"}]},{name:"Erica One",variants:[{weight:400,filename:"ericaone-400.ttf"}]},{name:"Exo 2",variants:[{weight:100,filename:"exo2[weight].ttf"},{weight:200,filename:"exo2[weight].ttf"},{weight:300,filename:"exo2[weight].ttf"},{weight:400,filename:"exo2[weight].ttf"},{weight:500,filename:"exo2[weight].ttf"},{weight:600,filename:"exo2[weight].ttf"},{weight:700,filename:"exo2[weight].ttf"},{weight:800,filename:"exo2[weight].ttf"},{weight:900,filename:"exo2[weight].ttf"},{weight:100,feature:"italic",filename:"exo2-italic[weight].ttf"},{weight:200,feature:"italic",filename:"exo2-italic[weight].ttf"},{weight:300,feature:"italic",filename:"exo2-italic[weight].ttf"},{weight:400,feature:"italic",filename:"exo2-italic[weight].ttf"},{weight:500,feature:"italic",filename:"exo2-italic[weight].ttf"},{weight:600,feature:"italic",filename:"exo2-italic[weight].ttf"},{weight:700,feature:"italic",filename:"exo2-italic[weight].ttf"},{weight:800,feature:"italic",filename:"exo2-italic[weight].ttf"},{weight:900,feature:"italic",filename:"exo2-italic[weight].ttf"}]},{name:"Farsan",variants:[{weight:400,filename:"farsan-400.ttf"}]},{name:"Fredericka the Great",variants:[{weight:400,filename:"frederickathegreat-400.ttf"}]},{name:"Fredoka One",variants:[{weight:400,filename:"fredokaone-400.ttf"}]},{name:"Fugaz One",variants:[{weight:400,filename:"fugazone-400.ttf"}]},{name:"Gasoek One",variants:[{weight:400,filename:"GasoekOne-Regular.ttf"}]},{name:"Gazpacho",variants:[{weight:400,filename:"Gazpacho-Regular.ttf"},{weight:900,filename:"Gazpacho-Heavy.ttf"}]},{name:"Gelica",variants:[{weight:400,filename:"Gelica-Black.ttf"},{weight:400,feature:"italic",filename:"Gelica-BlackItalic.ttf"}]},{name:"Genty",variants:[{weight:400,filename:"Genty-Regular.ttf"}]},{name:"Gloock",variants:[{weight:400,filename:"Gloock-Regular.ttf"}]},{name:"GFS Didot",variants:[{weight:400,filename:"GFSDidot-Regular.ttf"}]},{name:"Gidugu",variants:[{weight:400,filename:"gidugu-400.ttf"}]},{name:"Giorgia",variants:[{weight:400,filename:"Giorgia-Regular.ttf"}]},{name:"Gloria Hallelujah",variants:[{weight:400,filename:"GloriaHallelujah-Regular.ttf"}]},{name:"Gluten",variants:[{weight:100,filename:"gluten[italic][weight].ttf"},{weight:200,filename:"gluten[italic][weight].ttf"},{weight:300,filename:"gluten[italic][weight].ttf"},{weight:400,filename:"gluten[italic][weight].ttf"},{weight:500,filename:"gluten[italic][weight].ttf"},{weight:600,filename:"gluten[italic][weight].ttf"},{weight:700,filename:"gluten[italic][weight].ttf"},{weight:800,filename:"gluten[italic][weight].ttf"},{weight:900,filename:"gluten[italic][weight].ttf"},{weight:100,feature:"italic",filename:"gluten[italic][weight].ttf"},{weight:200,feature:"italic",filename:"gluten[italic][weight].ttf"},{weight:300,feature:"italic",filename:"gluten[italic][weight].ttf"},{weight:400,feature:"italic",filename:"gluten[italic][weight].ttf"},{weight:500,feature:"italic",filename:"gluten[italic][weight].ttf"},{weight:600,feature:"italic",filename:"gluten[italic][weight].ttf"},{weight:700,feature:"italic",filename:"gluten[italic][weight].ttf"},{weight:800,feature:"italic",filename:"gluten[italic][weight].ttf"},{weight:900,feature:"italic",filename:"gluten[italic][weight].ttf"}]},{name:"Great Vibes",variants:[{weight:400,filename:"GreatVibes-Regular.ttf"}]},{name:"Gudea",variants:[{weight:400,filename:"gudea-400.ttf"},{weight:700,filename:"gudea-700.ttf"},{weight:400,feature:"italic",filename:"gudea-italic-400.ttf"}]},{name:"Handjet",variants:[{weight:100,filename:"Handjet-VariableFont_ELGR,ELSH,wght.ttf"},{weight:200,filename:"Handjet-VariableFont_ELGR,ELSH,wght.ttf"},{weight:300,filename:"Handjet-VariableFont_ELGR,ELSH,wght.ttf"},{weight:400,filename:"Handjet-VariableFont_ELGR,ELSH,wght.ttf"},{weight:500,filename:"Handjet-VariableFont_ELGR,ELSH,wght.ttf"},{weight:600,filename:"Handjet-VariableFont_ELGR,ELSH,wght.ttf"},{weight:700,filename:"Handjet-VariableFont_ELGR,ELSH,wght.ttf"},{weight:800,filename:"Handjet-VariableFont_ELGR,ELSH,wght.ttf"},{weight:900,filename:"Handjet-VariableFont_ELGR,ELSH,wght.ttf"}]},{name:"Hanken Grotesk",variants:[{weight:100,filename:"HankenGrotesk-VariableFont_wght.ttf"},{weight:200,filename:"HankenGrotesk-VariableFont_wght.ttf"},{weight:300,filename:"HankenGrotesk-VariableFont_wght.ttf"},{weight:400,filename:"HankenGrotesk-VariableFont_wght.ttf"},{weight:500,filename:"HankenGrotesk-VariableFont_wght.ttf"},{weight:600,filename:"HankenGrotesk-VariableFont_wght.ttf"},{weight:700,filename:"HankenGrotesk-VariableFont_wght.ttf"},{weight:800,filename:"HankenGrotesk-VariableFont_wght.ttf"},{weight:900,filename:"HankenGrotesk-VariableFont_wght.ttf"},{weight:100,feature:"italic",filename:"HankenGrotesk-Italic-VariableFont_wght.ttf"},{weight:200,feature:"italic",filename:"HankenGrotesk-Italic-VariableFont_wght.ttf"},{weight:300,feature:"italic",filename:"HankenGrotesk-Italic-VariableFont_wght.ttf"},{weight:400,feature:"italic",filename:"HankenGrotesk-Italic-VariableFont_wght.ttf"},{weight:500,feature:"italic",filename:"HankenGrotesk-Italic-VariableFont_wght.ttf"},{weight:600,feature:"italic",filename:"HankenGrotesk-Italic-VariableFont_wght.ttf"},{weight:700,feature:"italic",filename:"HankenGrotesk-Italic-VariableFont_wght.ttf"},{weight:800,feature:"italic",filename:"HankenGrotesk-Italic-VariableFont_wght.ttf"},{weight:900,feature:"italic",filename:"HankenGrotesk-Italic-VariableFont_wght.ttf"}]},{name:"Heebo",variants:[{weight:100,filename:"heebo[weight].ttf"},{weight:300,filename:"heebo[weight].ttf"},{weight:400,filename:"heebo[weight].ttf"},{weight:500,filename:"heebo[weight].ttf"},{weight:700,filename:"heebo[weight].ttf"},{weight:800,filename:"heebo[weight].ttf"},{weight:900,filename:"heebo[weight].ttf"}]},{name:"Ibarra Real Nova",variants:[{weight:400,filename:"ibarrarealnova[weight].ttf"},{weight:600,filename:"ibarrarealnova[weight].ttf"},{weight:700,filename:"ibarrarealnova[weight].ttf"},{weight:400,feature:"italic",filename:"ibarrarealnova-italic[weight].ttf"},{weight:600,feature:"italic",filename:"ibarrarealnova-italic[weight].ttf"},{weight:700,feature:"italic",filename:"ibarrarealnova-italic[weight].ttf"}]},{name:"IBM Plex Mono",variants:[{weight:100,filename:"ibmplexmono-100.ttf"},{weight:200,filename:"ibmplexmono-200.ttf"},{weight:300,filename:"ibmplexmono-300.ttf"},{weight:400,filename:"ibmplexmono-400.ttf"},{weight:500,filename:"ibmplexmono-500.ttf"},{weight:600,filename:"ibmplexmono-600.ttf"},{weight:700,filename:"ibmplexmono-700.ttf"},{weight:100,feature:"italic",filename:"ibmplexmono-italic-100.ttf"},{weight:200,feature:"italic",filename:"ibmplexmono-italic-200.ttf"},{weight:300,feature:"italic",filename:"ibmplexmono-italic-300.ttf"},{weight:400,feature:"italic",filename:"ibmplexmono-italic-400.ttf"},{weight:500,feature:"italic",filename:"ibmplexmono-italic-500.ttf"},{weight:600,feature:"italic",filename:"ibmplexmono-italic-600.ttf"},{weight:700,feature:"italic",filename:"ibmplexmono-italic-700.ttf"}]},{name:"IBM Plex Serif",variants:[{weight:100,filename:"ibmplexserif-100.ttf"},{weight:200,filename:"ibmplexserif-200.ttf"},{weight:300,filename:"ibmplexserif-300.ttf"},{weight:400,filename:"ibmplexserif-400.ttf"},{weight:500,filename:"ibmplexserif-500.ttf"},{weight:600,filename:"ibmplexserif-600.ttf"},{weight:700,filename:"ibmplexserif-700.ttf"},{weight:100,feature:"italic",filename:"ibmplexserif-italic-100.ttf"},{weight:200,feature:"italic",filename:"ibmplexserif-italic-200.ttf"},{weight:300,feature:"italic",filename:"ibmplexserif-italic-300.ttf"},{weight:400,feature:"italic",filename:"ibmplexserif-italic-400.ttf"},{weight:500,feature:"italic",filename:"ibmplexserif-italic-500.ttf"},{weight:600,feature:"italic",filename:"ibmplexserif-italic-600.ttf"},{weight:700,feature:"italic",filename:"ibmplexserif-italic-700.ttf"}]},{name:"Impact",variants:[{weight:400,filename:"impact.ttf"}]},{name:"Inconsolata",variants:[{weight:200,filename:"inconsolata-200.ttf"},{weight:300,filename:"inconsolata-300.ttf"},{weight:400,filename:"inconsolata-400.ttf"},{weight:500,filename:"inconsolata-500.ttf"},{weight:600,filename:"inconsolata-600.ttf"},{weight:700,filename:"inconsolata-700.ttf"},{weight:800,filename:"inconsolata-800.ttf"},{weight:900,filename:"inconsolata-900.ttf"}]},{name:"Inter",variants:[{weight:100,filename:"inter[italic][weight].ttf"},{weight:200,filename:"inter[italic][weight].ttf"},{weight:300,filename:"inter[italic][weight].ttf"},{weight:400,filename:"inter[italic][weight].ttf"},{weight:500,filename:"inter[italic][weight].ttf"},{weight:600,filename:"inter[italic][weight].ttf"},{weight:700,filename:"inter[italic][weight].ttf"},{weight:800,filename:"inter[italic][weight].ttf"},{weight:900,filename:"inter[italic][weight].ttf"},{weight:100,feature:"italic",filename:"inter[italic][weight].ttf"},{weight:200,feature:"italic",filename:"inter[italic][weight].ttf"},{weight:300,feature:"italic",filename:"inter[italic][weight].ttf"},{weight:400,feature:"italic",filename:"inter[italic][weight].ttf"},{weight:500,feature:"italic",filename:"inter[italic][weight].ttf"},{weight:600,feature:"italic",filename:"inter[italic][weight].ttf"},{weight:700,feature:"italic",filename:"inter[italic][weight].ttf"},{weight:800,feature:"italic",filename:"inter[italic][weight].ttf"},{weight:900,feature:"italic",filename:"inter[italic][weight].ttf"}]},{name:"Josefin Slab",variants:[{weight:100,filename:"josefinslab[weight].ttf"},{weight:300,filename:"josefinslab[weight].ttf"},{weight:400,filename:"josefinslab[weight].ttf"},{weight:600,filename:"josefinslab[weight].ttf"},{weight:700,filename:"josefinslab[weight].ttf"},{weight:100,feature:"italic",filename:"josefinslab-italic[weight].ttf"},{weight:300,feature:"italic",filename:"josefinslab-italic[weight].ttf"},{weight:400,feature:"italic",filename:"josefinslab-italic[weight].ttf"},{weight:600,feature:"italic",filename:"josefinslab-italic[weight].ttf"},{weight:700,feature:"italic",filename:"josefinslab-italic[weight].ttf"}]},{name:"Julius Sans One",variants:[{weight:400,filename:"juliussansone-400.ttf"}]},{name:"Jura",variants:[{weight:300,filename:"jura[weight].ttf"},{weight:400,filename:"jura[weight].ttf"},{weight:500,filename:"jura[weight].ttf"},{weight:600,filename:"jura[weight].ttf"},{weight:700,filename:"jura[weight].ttf"}]},{name:"Kalnia",variants:[{weight:100,filename:"Kalnia-VariableFont_wdth,wght.ttf"},{weight:200,filename:"Kalnia-VariableFont_wdth,wght.ttf"},{weight:300,filename:"Kalnia-VariableFont_wdth,wght.ttf"},{weight:400,filename:"Kalnia-VariableFont_wdth,wght.ttf"},{weight:500,filename:"Kalnia-VariableFont_wdth,wght.ttf"},{weight:600,filename:"Kalnia-VariableFont_wdth,wght.ttf"},{weight:700,filename:"Kalnia-VariableFont_wdth,wght.ttf"},{weight:800,filename:"Kalnia-VariableFont_wdth,wght.ttf"},{weight:900,filename:"Kalnia-VariableFont_wdth,wght.ttf"}]},{name:"Kalufonia",variants:[{weight:400,filename:"Kalufonia-Regular.ttf"}]},{name:"Knewave",variants:[{weight:400,filename:"knewave-400.ttf"}]},{name:"Krona One",variants:[{weight:400,filename:"kronaone-400.ttf"}]},{name:"Lato",variants:[{weight:100,filename:"lato-100.ttf"},{weight:200,filename:"lato-200.ttf"},{weight:300,filename:"lato-300.ttf"},{weight:400,filename:"lato-400.ttf"},{weight:500,filename:"lato-500.ttf"},{weight:600,filename:"lato-600.ttf"},{weight:700,filename:"lato-700.ttf"},{weight:800,filename:"lato-800.ttf"},{weight:900,filename:"lato-900.ttf"},{weight:100,feature:"italic",filename:"lato-italic-100.ttf"},{weight:200,feature:"italic",filename:"lato-italic-200.ttf"},{weight:300,feature:"italic",filename:"lato-italic-300.ttf"},{weight:400,feature:"italic",filename:"lato-italic-400.ttf"},{weight:500,feature:"italic",filename:"lato-italic-500.ttf"},{weight:600,feature:"italic",filename:"lato-italic-600.ttf"},{weight:700,feature:"italic",filename:"lato-italic-700.ttf"},{weight:800,feature:"italic",filename:"lato-italic-800.ttf"},{weight:900,feature:"italic",filename:"lato-italic-900.ttf"}]},{name:"Lexend Exa",variants:[{weight:100,filename:"lexendexa[weight].ttf"},{weight:200,filename:"lexendexa[weight].ttf"},{weight:300,filename:"lexendexa[weight].ttf"},{weight:400,filename:"lexendexa[weight].ttf"},{weight:500,filename:"lexendexa[weight].ttf"},{weight:600,filename:"lexendexa[weight].ttf"},{weight:700,filename:"lexendexa[weight].ttf"},{weight:800,filename:"lexendexa[weight].ttf"},{weight:900,filename:"lexendexa[weight].ttf"}]},{name:"Luckiest Guy",variants:[{weight:400,filename:"luckiestguy-400.ttf"}]},{name:"Manchego",variants:[{weight:400,filename:"Manchego-Black.ttf"}]},{name:"Manrope",variants:[{weight:100,filename:"Manrope-VariableFont_wght.ttf"},{weight:200,filename:"Manrope-VariableFont_wght.ttf"},{weight:300,filename:"Manrope-VariableFont_wght.ttf"},{weight:400,filename:"Manrope-VariableFont_wght.ttf"},{weight:500,filename:"Manrope-VariableFont_wght.ttf"},{weight:600,filename:"Manrope-VariableFont_wght.ttf"},{weight:700,filename:"Manrope-VariableFont_wght.ttf"},{weight:800,filename:"Manrope-VariableFont_wght.ttf"},{weight:900,filename:"Manrope-VariableFont_wght.ttf"}]},{name:"Marine Sikona",variants:[{weight:400,filename:"Marine-Sikona-Regular.ttf"}]},{name:"Mate SC",variants:[{weight:400,filename:"matesc-400.ttf"}]},{name:"Merienda One",variants:[{weight:400,filename:"meriendaone-400.ttf"}]},{name:"Merriweather",variants:[{weight:300,filename:"merriweather-300.ttf"},{weight:400,filename:"merriweather-400.ttf"},{weight:700,filename:"merriweather-700.ttf"},{weight:900,filename:"merriweather-900.ttf"},{weight:300,feature:"italic",filename:"merriweather-italic-300.ttf"},{weight:400,feature:"italic",filename:"merriweather-italic-400.ttf"},{weight:700,feature:"italic",filename:"merriweather-italic-700.ttf"},{weight:900,feature:"italic",filename:"merriweather-italic-900.ttf"}]},{name:"Microsoft Pride",variants:[{weight:400,filename:"microsoft-pride-400.ttf"}]},{name:"Modak",variants:[{weight:400,filename:"modak-400.ttf"}]},{name:"Montserrat",variants:[{weight:100,filename:"montserrat[weight].ttf"},{weight:200,filename:"montserrat[weight].ttf"},{weight:300,filename:"montserrat[weight].ttf"},{weight:400,filename:"montserrat[weight].ttf"},{weight:500,filename:"montserrat[weight].ttf"},{weight:600,filename:"montserrat[weight].ttf"},{weight:700,filename:"montserrat[weight].ttf"},{weight:800,filename:"montserrat[weight].ttf"},{weight:900,filename:"montserrat[weight].ttf"},{weight:100,feature:"italic",filename:"montserrat-italic[weight].ttf"},{weight:200,feature:"italic",filename:"montserrat-italic[weight].ttf"},{weight:300,feature:"italic",filename:"montserrat-italic[weight].ttf"},{weight:400,feature:"italic",filename:"montserrat-italic[weight].ttf"},{weight:500,feature:"italic",filename:"montserrat-italic[weight].ttf"},{weight:600,feature:"italic",filename:"montserrat-italic[weight].ttf"},{weight:700,feature:"italic",filename:"montserrat-italic[weight].ttf"},{weight:800,feature:"italic",filename:"montserrat-italic[weight].ttf"},{weight:900,feature:"italic",filename:"montserrat-italic[weight].ttf"}]},{name:"Monsieur La Doulaise",variants:[{weight:400,filename:"MonsieurLaDoulaise-Regular.ttf"}]},{name:"Montserrat Subrayada",variants:[{weight:400,filename:"montserratsubrayada-400.ttf"},{weight:700,filename:"montserratsubrayada-700.ttf"}]},{name:"Nanum Brush Script",variants:[{weight:400,filename:"nanumbrushscript-400.ttf"}]},{name:"Neue Haas Grotesk Text Pro",variants:[{weight:400,filename:"Neue-Haas-Grotesk-Text-Pro.ttf"},{weight:400,feature:"italic",filename:"Neue-Haas-Grotesk-Text-Pro-Italic.ttf"},{weight:700,filename:"Neue-Haas-Grotesk-Text-Pro-Bold.ttf"},{weight:700,feature:"italic",filename:"Neue-Haas-Grotesk-Text-Pro-Bold-Italic.ttf"}]},{name:"Noland",variants:[{weight:400,filename:"Noland-Regular.ttf"},{weight:700,filename:"Noland-Bold.ttf"}]},{name:"Noto Serif",variants:[{weight:400,filename:"notoserif-400.ttf"},{weight:700,filename:"notoserif-700.ttf"},{weight:400,feature:"italic",filename:"notoserif-italic-400.ttf"},{weight:700,feature:"italic",filename:"notoserif-italic-700.ttf"}]},{name:"Noto Sans",variants:[{weight:100,filename:"notosans-100.ttf"},{weight:200,filename:"notosans-200.ttf"},{weight:300,filename:"notosans-300.ttf"},{weight:400,filename:"notosans-400.ttf"},{weight:500,filename:"notosans-500.ttf"},{weight:600,filename:"notosans-600.ttf"},{weight:700,filename:"notosans-700.ttf"},{weight:800,filename:"notosans-800.ttf"},{weight:900,filename:"notosans-900.ttf"},{weight:100,feature:"italic",filename:"notosans-italic-100.ttf"},{weight:200,feature:"italic",filename:"notosans-italic-200.ttf"},{weight:300,feature:"italic",filename:"notosans-italic-300.ttf"},{weight:400,feature:"italic",filename:"notosans-italic-400.ttf"},{weight:500,feature:"italic",filename:"notosans-italic-500.ttf"},{weight:600,feature:"italic",filename:"notosans-italic-600.ttf"},{weight:700,feature:"italic",filename:"notosans-italic-700.ttf"},{weight:800,feature:"italic",filename:"notosans-italic-800.ttf"},{weight:900,feature:"italic",filename:"notosans-italic-900.ttf"}]},{name:"Noto Sans JP",variants:[{weight:100,filename:"NotoSansJP[weight].ttf"},{weight:200,filename:"NotoSansJP[weight].ttf"},{weight:300,filename:"NotoSansJP[weight].ttf"},{weight:400,filename:"NotoSansJP[weight].ttf"},{weight:500,filename:"NotoSansJP[weight].ttf"},{weight:600,filename:"NotoSansJP[weight].ttf"},{weight:700,filename:"NotoSansJP[weight].ttf"},{weight:800,filename:"NotoSansJP[weight].ttf"},{weight:900,filename:"NotoSansJP[weight].ttf"}]},{name:"Noto Sans SC",variants:[{weight:100,filename:"NotoSansSC[weight].ttf"},{weight:200,filename:"NotoSansSC[weight].ttf"},{weight:300,filename:"NotoSansSC[weight].ttf"},{weight:400,filename:"NotoSansSC[weight].ttf"},{weight:500,filename:"NotoSansSC[weight].ttf"},{weight:600,filename:"NotoSansSC[weight].ttf"},{weight:700,filename:"NotoSansSC[weight].ttf"},{weight:800,filename:"NotoSansSC[weight].ttf"},{weight:900,filename:"NotoSansSC[weight].ttf"}]},{name:"Noto Sans TC",variants:[{weight:100,filename:"NotoSansTC[weight].ttf"},{weight:200,filename:"NotoSansTC[weight].ttf"},{weight:300,filename:"NotoSansTC[weight].ttf"},{weight:400,filename:"NotoSansTC[weight].ttf"},{weight:500,filename:"NotoSansTC[weight].ttf"},{weight:600,filename:"NotoSansTC[weight].ttf"},{weight:700,filename:"NotoSansTC[weight].ttf"},{weight:800,filename:"NotoSansTC[weight].ttf"},{weight:900,filename:"NotoSansTC[weight].ttf"}]},{name:"Noto Serif JP",variants:[{weight:100,filename:"NotoSerifJP[weight].ttf"},{weight:200,filename:"NotoSerifJP[weight].ttf"},{weight:300,filename:"NotoSerifJP[weight].ttf"},{weight:400,filename:"NotoSerifJP[weight].ttf"},{weight:500,filename:"NotoSerifJP[weight].ttf"},{weight:600,filename:"NotoSerifJP[weight].ttf"},{weight:700,filename:"NotoSerifJP[weight].ttf"},{weight:800,filename:"NotoSerifJP[weight].ttf"},{weight:900,filename:"NotoSerifJP[weight].ttf"}]},{name:"Noto Serif SC",variants:[{weight:100,filename:"NotoSerifSC[weight].ttf"},{weight:200,filename:"NotoSerifSC[weight].ttf"},{weight:300,filename:"NotoSerifSC[weight].ttf"},{weight:400,filename:"NotoSerifSC[weight].ttf"},{weight:500,filename:"NotoSerifSC[weight].ttf"},{weight:600,filename:"NotoSerifSC[weight].ttf"},{weight:700,filename:"NotoSerifSC[weight].ttf"},{weight:800,filename:"NotoSerifSC[weight].ttf"},{weight:900,filename:"NotoSerifSC[weight].ttf"}]},{name:"Noto Serif TC",variants:[{weight:100,filename:"NotoSerifTC[weight].ttf"},{weight:200,filename:"NotoSerifTC[weight].ttf"},{weight:300,filename:"NotoSerifTC[weight].ttf"},{weight:400,filename:"NotoSerifTC[weight].ttf"},{weight:500,filename:"NotoSerifTC[weight].ttf"},{weight:600,filename:"NotoSerifTC[weight].ttf"},{weight:700,filename:"NotoSerifTC[weight].ttf"},{weight:800,filename:"NotoSerifTC[weight].ttf"},{weight:900,filename:"NotoSerifTC[weight].ttf"}]},{name:"Oi",variants:[{weight:400,filename:"oi-400.ttf"}]},{name:"Open Sans",variants:[{weight:300,filename:"opensans[weight].ttf"},{weight:400,filename:"opensans[weight].ttf"},{weight:600,filename:"opensans[weight].ttf"},{weight:700,filename:"opensans[weight].ttf"},{weight:800,filename:"opensans[weight].ttf"}]},{name:"Oswald",variants:[{weight:200,filename:"oswald[weight].ttf"},{weight:300,filename:"oswald[weight].ttf"},{weight:400,filename:"oswald[weight].ttf"},{weight:500,filename:"oswald[weight].ttf"},{weight:600,filename:"oswald[weight].ttf"},{weight:700,filename:"oswald[weight].ttf"}]},{name:"Pacifico",variants:[{weight:400,filename:"pacifico-400.ttf"}]},{name:"Pangolin",variants:[{weight:400,filename:"pangolin-400.ttf"}]},{name:"Parisienne",variants:[{weight:400,filename:"Parisienne-Regular.ttf"}]},{name:"Permanent Marker",variants:[{weight:400,filename:"permanentmarker-400.ttf"}]},{name:"Petit Formal Script",variants:[{weight:400,filename:"petitformalscript-400.ttf"}]},{name:"Playball",variants:[{weight:400,filename:"playball-400.ttf"}]},{name:"Playfair Display",variants:[{weight:400,filename:"playfairdisplay[weight].ttf"},{weight:500,filename:"playfairdisplay[weight].ttf"},{weight:600,filename:"playfairdisplay[weight].ttf"},{weight:700,filename:"playfairdisplay[weight].ttf"},{weight:800,filename:"playfairdisplay[weight].ttf"},{weight:900,filename:"playfairdisplay[weight].ttf"},{weight:400,feature:"italic",filename:"playfairdisplay-italic[weight].ttf"},{weight:500,feature:"italic",filename:"playfairdisplay-italic[weight].ttf"},{weight:600,feature:"italic",filename:"playfairdisplay-italic[weight].ttf"},{weight:700,feature:"italic",filename:"playfairdisplay-italic[weight].ttf"},{weight:800,feature:"italic",filename:"playfairdisplay-italic[weight].ttf"},{weight:900,feature:"italic",filename:"playfairdisplay-italic[weight].ttf"}]},{name:"Poiret One",variants:[{weight:400,filename:"poiretone-400.ttf"}]},{name:"Poppins",variants:[{weight:100,filename:"poppins-100.ttf"},{weight:200,filename:"poppins-200.ttf"},{weight:300,filename:"poppins-300.ttf"},{weight:400,filename:"poppins-400.ttf"},{weight:500,filename:"poppins-500.ttf"},{weight:600,filename:"poppins-600.ttf"},{weight:700,filename:"poppins-700.ttf"},{weight:800,filename:"poppins-800.ttf"},{weight:900,filename:"poppins-900.ttf"},{weight:100,feature:"italic",filename:"poppins-italic-100.ttf"},{weight:200,feature:"italic",filename:"poppins-italic-200.ttf"},{weight:300,feature:"italic",filename:"poppins-italic-300.ttf"},{weight:400,feature:"italic",filename:"poppins-italic-400.ttf"},{weight:500,feature:"italic",filename:"poppins-italic-500.ttf"},{weight:600,feature:"italic",filename:"poppins-italic-600.ttf"},{weight:700,feature:"italic",filename:"poppins-italic-700.ttf"},{weight:800,feature:"italic",filename:"poppins-italic-800.ttf"},{weight:900,feature:"italic",filename:"poppins-italic-900.ttf"}]},{name:"Prata",variants:[{weight:400,filename:"Prata-Regular.ttf"}]},{name:"Press Start 2P",variants:[{weight:400,filename:"pressstart2p-400.ttf"}]},{name:"PT Serif",variants:[{weight:400,filename:"ptserif-400.ttf"},{weight:700,filename:"ptserif-700.ttf"}]},{name:"Quicksand",variants:[{weight:300,filename:"quicksand[weight].ttf"},{weight:400,filename:"quicksand[weight].ttf"},{weight:500,filename:"quicksand[weight].ttf"},{weight:600,filename:"quicksand[weight].ttf"},{weight:700,filename:"quicksand[weight].ttf"}]},{name:"Rakkas",variants:[{weight:400,filename:"rakkas-400.ttf"}]},{name:"Raleway",variants:[{weight:100,filename:"Raleway-VariableFont_wght.ttf"},{weight:200,filename:"Raleway-VariableFont_wght.ttf"},{weight:300,filename:"Raleway-VariableFont_wght.ttf"},{weight:400,filename:"Raleway-VariableFont_wght.ttf"},{weight:500,filename:"Raleway-VariableFont_wght.ttf"},{weight:600,filename:"Raleway-VariableFont_wght.ttf"},{weight:700,filename:"Raleway-VariableFont_wght.ttf"},{weight:800,filename:"Raleway-VariableFont_wght.ttf"},{weight:900,filename:"Raleway-VariableFont_wght.ttf"},{weight:100,feature:"italic",filename:"Raleway-Italic-VariableFont_wght.ttf"},{weight:200,feature:"italic",filename:"Raleway-Italic-VariableFont_wght.ttf"},{weight:300,feature:"italic",filename:"Raleway-Italic-VariableFont_wght.ttf"},{weight:400,feature:"italic",filename:"Raleway-Italic-VariableFont_wght.ttf"},{weight:500,feature:"italic",filename:"Raleway-Italic-VariableFont_wght.ttf"},{weight:600,feature:"italic",filename:"Raleway-Italic-VariableFont_wght.ttf"},{weight:700,feature:"italic",filename:"Raleway-Italic-VariableFont_wght.ttf"},{weight:800,feature:"italic",filename:"Raleway-Italic-VariableFont_wght.ttf"},{weight:900,feature:"italic",filename:"Raleway-Italic-VariableFont_wght.ttf"}]},{name:"Ranchers",variants:[{weight:400,filename:"Ranchers-Regular.ttf"}]},{name:"Recoleta Black",variants:[{weight:400,filename:"Recoleta-Alt-Black.ttf"}]},{name:"Red Rose",variants:[{weight:300,filename:"redrose[weight].ttf"},{weight:400,filename:"redrose[weight].ttf"},{weight:700,filename:"redrose[weight].ttf"}]},{name:"Righteous",variants:[{weight:400,filename:"righteous-400.ttf"}]},{name:"Roboto",variants:[{weight:100,filename:"roboto-100.ttf"},{weight:300,filename:"roboto-300.ttf"},{weight:400,filename:"roboto-400.ttf"},{weight:500,filename:"roboto-500.ttf"},{weight:700,filename:"roboto-700.ttf"},{weight:900,filename:"roboto-900.ttf"},{weight:100,feature:"italic",filename:"roboto-italic-100.ttf"},{weight:300,feature:"italic",filename:"roboto-italic-300.ttf"},{weight:400,feature:"italic",filename:"roboto-italic-400.ttf"},{weight:500,feature:"italic",filename:"roboto-italic-500.ttf"},{weight:700,feature:"italic",filename:"roboto-italic-700.ttf"},{weight:900,feature:"italic",filename:"roboto-italic-900.ttf"}]},{name:"Rochester",variants:[{weight:400,filename:"rochester-400.ttf"}]},{name:"Rock Salt",variants:[{weight:400,filename:"rocksalt-400.ttf"}]},{name:"Rokkitt",variants:[{weight:100,filename:"rokkitt[weight].ttf"},{weight:200,filename:"rokkitt[weight].ttf"},{weight:300,filename:"rokkitt[weight].ttf"},{weight:400,filename:"rokkitt[weight].ttf"},{weight:500,filename:"rokkitt[weight].ttf"},{weight:600,filename:"rokkitt[weight].ttf"},{weight:700,filename:"rokkitt[weight].ttf"},{weight:800,filename:"rokkitt[weight].ttf"},{weight:900,filename:"rokkitt[weight].ttf"}]},{name:"Rosarivo",variants:[{weight:400,filename:"rosarivo-400.ttf"},{weight:400,feature:"italic",filename:"rosarivo-italic-400.ttf"}]},{name:"Rozha One",variants:[{weight:400,filename:"rozhaone-400.ttf"}]},{name:"Rubik",variants:[{weight:300,filename:"rubik[weight].ttf"},{weight:400,filename:"rubik[weight].ttf"},{weight:500,filename:"rubik[weight].ttf"},{weight:600,filename:"rubik[weight].ttf"},{weight:700,filename:"rubik[weight].ttf"},{weight:800,filename:"rubik[weight].ttf"},{weight:900,filename:"rubik[weight].ttf"},{weight:300,feature:"italic",filename:"rubik-italic[weight].ttf"},{weight:400,feature:"italic",filename:"rubik-italic[weight].ttf"},{weight:500,feature:"italic",filename:"rubik-italic[weight].ttf"},{weight:600,feature:"italic",filename:"rubik-italic[weight].ttf"},{weight:700,feature:"italic",filename:"rubik-italic[weight].ttf"},{weight:800,feature:"italic",filename:"rubik-italic[weight].ttf"},{weight:900,feature:"italic",filename:"rubik-italic[weight].ttf"}]},{name:"Rufina",variants:[{weight:400,filename:"rufina-400.ttf"},{weight:700,filename:"rufina-700.ttf"}]},{name:"Ruluko",variants:[{weight:400,filename:"ruluko-400.ttf"}]},{name:"Schoolbell",variants:[{weight:400,filename:"schoolbell-400.ttf"}]},{name:"Scope One",variants:[{weight:400,filename:"scopeone-400.ttf"}]},{name:"Segoe UI",variants:[{weight:100,filename:"SegoeUI-VF.ttf"},{weight:200,filename:"SegoeUI-VF.ttf"},{weight:300,filename:"SegoeUI-VF.ttf"},{weight:400,filename:"SegoeUI-VF.ttf"},{weight:500,filename:"SegoeUI-VF.ttf"},{weight:600,filename:"SegoeUI-VF.ttf"},{weight:700,filename:"SegoeUI-VF.ttf"},{weight:800,filename:"SegoeUI-VF.ttf"},{weight:900,filename:"SegoeUI-VF.ttf"}]},{name:"Shadows Into Light",variants:[{weight:400,filename:"shadowsintolight-400.ttf"}]},{name:"Shrikhand",variants:[{weight:400,filename:"shrikhand-400.ttf"}]},{name:"Sofia",variants:[{weight:400,filename:"Sofia-Regular.ttf"}]},{name:"Source Sans Pro",variants:[{weight:200,filename:"sourcesanspro-200.ttf"},{weight:300,filename:"sourcesanspro-300.ttf"},{weight:400,filename:"sourcesanspro-400.ttf"},{weight:600,filename:"sourcesanspro-600.ttf"},{weight:700,filename:"sourcesanspro-700.ttf"},{weight:900,filename:"sourcesanspro-900.ttf"},{weight:200,feature:"italic",filename:"sourcesanspro-italic-200.ttf"},{weight:300,feature:"italic",filename:"sourcesanspro-italic-300.ttf"},{weight:400,feature:"italic",filename:"sourcesanspro-italic-400.ttf"},{weight:600,feature:"italic",filename:"sourcesanspro-italic-600.ttf"},{weight:700,feature:"italic",filename:"sourcesanspro-italic-700.ttf"},{weight:900,feature:"italic",filename:"sourcesanspro-italic-900.ttf"}]},{name:"Space Mono",variants:[{weight:400,filename:"spacemono-400.ttf"},{weight:700,filename:"spacemono-700.ttf"},{weight:400,feature:"italic",filename:"spacemono-italic-400.ttf"},{weight:700,feature:"italic",filename:"spacemono-italic-700.ttf"}]},{name:"Spartan",variants:[{weight:100,filename:"spartan[weight].ttf"},{weight:200,filename:"spartan[weight].ttf"},{weight:300,filename:"spartan[weight].ttf"},{weight:400,filename:"spartan[weight].ttf"},{weight:500,filename:"spartan[weight].ttf"},{weight:600,filename:"spartan[weight].ttf"},{weight:700,filename:"spartan[weight].ttf"},{weight:800,filename:"spartan[weight].ttf"},{weight:900,filename:"spartan[weight].ttf"}]},{name:"Special Elite",variants:[{weight:400,filename:"specialelite-400.ttf"}]},{name:"Spicy Rice",variants:[{weight:400,filename:"spicyrice-400.ttf"}]},{name:"Sree Krushnadevaraya",variants:[{weight:400,filename:"sreekrushnadevaraya-400.ttf"}]},{name:"Sriracha",variants:[{weight:400,filename:"sriracha-400.ttf"}]},{name:"Staatliches",variants:[{weight:400,filename:"Staatliches-Regular.ttf"}]},{name:"Sue Ellen Francisco",variants:[{weight:400,filename:"sueellenfrancisco-400.ttf"}]},{name:"Syne",variants:[{weight:400,filename:"syne[weight].ttf"},{weight:500,filename:"syne[weight].ttf"},{weight:600,filename:"syne[weight].ttf"},{weight:700,filename:"syne[weight].ttf"},{weight:800,filename:"syne[weight].ttf"}]},{name:"Tajawal",variants:[{weight:200,filename:"tajawal-200.ttf"},{weight:300,filename:"tajawal-300.ttf"},{weight:400,filename:"tajawal-400.ttf"},{weight:500,filename:"tajawal-500.ttf"},{weight:700,filename:"tajawal-700.ttf"},{weight:800,filename:"tajawal-800.ttf"},{weight:900,filename:"tajawal-900.ttf"}]},{name:"Tellumo",variants:[{weight:400,filename:"Tellumo.ttf"},{weight:400,feature:"italic",filename:"Tellumo-Italic.ttf"},{weight:100,filename:"Tellumo-Thin.ttf"},{weight:100,feature:"italic",filename:"Tellumo-Thin-Italic.ttf"},{weight:300,filename:"Tellumo-Light.ttf"},{weight:300,feature:"italic",filename:"Tellumo-Light-Italic.ttf"},{weight:500,filename:"Tellumo-Medium.ttf"},{weight:500,feature:"italic",filename:"Tellumo-Medium-Italic.ttf"},{weight:700,filename:"Tellumo-Bold.ttf"},{weight:700,feature:"italic",filename:"Tellumo-Bold-Italic.ttf"},{weight:800,filename:"Tellumo-ExtraBold.ttf"},{weight:800,feature:"italic",filename:"Tellumo-ExtraBold-Italic.ttf"}]},{name:"Thelorin",variants:[{weight:400,filename:"Thelorin.ttf"}]},{name:"Times New Roman",variants:[{weight:400,filename:"times.ttf"},{weight:700,filename:"timesbd.ttf"},{weight:400,feature:"italic",filename:"timesi.ttf"},{weight:700,feature:"italic",filename:"timesbi.ttf"}]},{name:"Ultra",variants:[{weight:400,filename:"ultra-400.ttf"}]},{name:"Work Sans",variants:[{weight:100,filename:"worksans[weight].ttf"},{weight:200,filename:"worksans[weight].ttf"},{weight:300,filename:"worksans[weight].ttf"},{weight:400,filename:"worksans[weight].ttf"},{weight:500,filename:"worksans[weight].ttf"},{weight:600,filename:"worksans[weight].ttf"},{weight:700,filename:"worksans[weight].ttf"},{weight:800,filename:"worksans[weight].ttf"},{weight:900,filename:"worksans[weight].ttf"},{weight:100,feature:"italic",filename:"worksans-italic[weight].ttf"},{weight:200,feature:"italic",filename:"worksans-italic[weight].ttf"},{weight:300,feature:"italic",filename:"worksans-italic[weight].ttf"},{weight:400,feature:"italic",filename:"worksans-italic[weight].ttf"},{weight:500,feature:"italic",filename:"worksans-italic[weight].ttf"},{weight:600,feature:"italic",filename:"worksans-italic[weight].ttf"},{weight:700,feature:"italic",filename:"worksans-italic[weight].ttf"},{weight:800,feature:"italic",filename:"worksans-italic[weight].ttf"},{weight:900,feature:"italic",filename:"worksans-italic[weight].ttf"}]},{name:"Vampiro One",variants:[{weight:400,filename:"vampiroone-400.ttf"}]},{name:"Vina Sans",variants:[{weight:400,filename:"VinaSans-Regular.ttf"}]},{name:"Winner",variants:[{weight:400,filename:"Winner-Bold.ttf"}]},{name:"Yeseva One",variants:[{weight:400,filename:"yesevaone-400.ttf"}]},{name:"Yesteryear",variants:[{weight:400,filename:"yesteryear-400.ttf"}]},{name:"Zeyada",variants:[{weight:400,filename:"Zeyada-Regular.ttf"}]}];function n(e,t){const r=i.find((t=>t.name===e));if(!r)return;const n=r.name.replaceAll(" ","").toLowerCase();return{variants:r.variants,getFile:e=>{const i=r.variants.find((t=>t.weight===e.weight&&t.feature===e.feature));return{id:`${n}-${i?.weight}-${i?.feature??"regular"}`,fetch:async()=>(await fetch(`${t}/${i?.filename}`)).arrayBuffer()}}}}},529616:(e,t,r)=>{r.d(t,{w:()=>l});var i=r(324586);function n(e){const t=new Set(e);return t.delete(" "),[...t]}function o(e){return void 0!==e.unicode}function s(e){return void 0===e.name&&(e.name=`uni${e.unicode?.toString(16).toUpperCase()}`),e}function a(e){return JSON.stringify(new String(e))}async function c(){const{parse:e,Font:t}=await Promise.all([r.e(87182),r.e(70583)]).then(r.bind(r,687182));return{parse:e,Font:t}}r(34456),r(159129),r(940233),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(270818),r(513173),r(205218),r(95732);class l{constructor(){(0,i.A)(this,"_parsedFontCache",new Map)}getParsedFont(e){const t=this._parsedFontCache.get(e.id);if(t)return t;const r=c().then((({parse:t})=>e.fetch().then(t)));return this._parsedFontCache.set(e.id,r),r}async getFontStyle(e,t){if(e.file.localFontName)return`@font-face { font-family: ${a(e.familyName)}; src: local(${a(e.file.localFontName)}); }`;const r=await this.getParsedFont(e.file),i=[" ",...n(t.toLowerCase()+t.toUpperCase())].map((e=>r.charToGlyph(e))).filter(o).map(s),{Font:l}=await c(),d=`data:font/opentype;base64,${function(e){let t="";const r=new Uint8Array(e);for(let e=0;e<r.byteLength;e++)t+=String.fromCharCode(r[e]);return window.btoa(t)}(new l({familyName:e.familyName,styleName:"Normal",descender:r.descender,ascender:r.ascender,unitsPerEm:r.unitsPerEm,glyphs:i}).toArrayBuffer())}`;return`@font-face { font-family: ${a(e.familyName)}; font-weight: ${u=e.weight,Math.floor(u).toString()}; src: url(${d}) format("opentype"); }`;var u}async getFontStyles(e,t){const r=e.map((e=>this.getFontStyle(e,t)));return(await Promise.all(r)).join("\n")}}},953734:(e,t,r)=>{function i(e,t,r){let i;for(const n of t)n.feature&&void 0===r||void 0!==r&&void 0!==n.feature&&n.feature!==r||(void 0===i||Math.abs(n.weight-e)<Math.abs(i.weight-e)||n.weight-e==0&&n.feature===r)&&(i=n);return i}function n(e){const t=new Set,r=[];for(const{familyName:n,font:o,idealWeight:s,idealFeature:a}of e){const e=`${n}-${s}`;if(t.has(e))continue;const c=i(s,o.variants,a);if(!c)continue;const l=o.getFile(c);t.add(e),r.push({familyName:n,weight:s,file:l})}return r}r.d(t,{Z:()=>i,s:()=>n}),r(379321),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997)},133217:(e,t,r)=>{r.d(t,{$2:()=>s,EX:()=>c,Mx:()=>a,yE:()=>l,yZ:()=>d});var i=r(412746);const n={maxResolution:"1080p",audioStock:"standard",imageStock:"standard",videoStock:"standard",filtersAndEffects:"standard",noWatermark:"available",cloudBackup:"none",brandKit:"none",unlimitedImportSize:"none",copilot:"none",graphics:"standard"},o=(0,i.y)(((e,t)=>({state:n,getEntitlements:()=>t().state,setEntitlements:t=>{e({state:t})},updateEntitlements:t=>{e((e=>({...e,state:{...e.state,...t}})))},resetEntitlements:()=>{e({state:n})}})));function s(e){o.getState().setEntitlements(e)}function a(e){o.getState().updateEntitlements(e)}function c(){o.getState().resetEntitlements()}function l(){return o.getState().state}function d(e){return o.subscribe((t=>{e(t.state)}))}},762857:(e,t,r)=>{r.d(t,{Km:()=>i,Qn:()=>a,ok:()=>c,tz:()=>n});const i=["480p","720p","1080p","4K"];function n(e,t){const r=i.indexOf(e),n=i.indexOf(t);return r<n?-1:n<r?1:0}function o(e){return e>>1<<1}function s(e){if(e!==o(e))throw new Error(`Standardized height ${e} is not divisible by 2`);return{"16:9":{width:o(16*e/9),height:e},"1:1":{width:e,height:e},"4:3":{width:o(4*e/3),height:e},"4:5":{width:e,height:o(5*e/4)},"9:16":{width:e,height:o(16*e/9)},"21:9":{width:o(21*e/9),height:e},"2:3":{width:e,height:o(3*e/2)}}}const a={"480p":{id:"480p",label:"Normal",resolutions:{...s(480),"1:1":{width:540,height:540},"9:16":{width:540,height:960}},fps:30,transcodingPreset:"createExport",transcodingFormat:"mp4"},"720p":{id:"720p",label:"High",resolutions:s(720),fps:30,transcodingPreset:"createExport",transcodingFormat:"mp4"},"1080p":{id:"1080p",label:"Very High",resolutions:s(1080),fps:30,transcodingPreset:"createExport",transcodingFormat:"mp4"},"4K":{id:"4K",label:"Ultra High",resolutions:{...s(2160),"21:9":{width:3840,height:1644}},fps:30,transcodingPreset:"createExport",transcodingFormat:"mp4"}},c=(s(240),{id:"gif",label:"GIF",resolutions:s(240),fps:15,transcodingPreset:"createExport",transcodingFormat:"gif"})},92940:(e,t,r)=>{r.d(t,{g:()=>a});var i=r(324586),n=r(854392);const o=(0,r(776016).u)("_dummy_test_operational_config","config__wal__dfc_locale_filter"),s="feature__";class a{constructor(){(0,i.A)(this,"name","ClipchampCacheProvider"),(0,i.A)(this,"isTestSource",!0)}initialize(){return Promise.resolve()}isEnabled(e){const t=window.localStorage.getItem(`${s}${e}`);if(null!=t)return"true"===t}getValue(e){const t=window.localStorage.getItem(`${s}${e}`);if(null!=t)try{return JSON.parse(t)}catch(e){return t}}getAll(e){const t={},r=e||window.localStorage;for(let e=0;e<r.length;e++){const i=r.key(e);if(!i||!i.startsWith(s))continue;const a=i.slice(9),c=this.getValue(a);(0,n.Dd)(a)?t[a]="boolean"==typeof c&&c:o(a)?t[a]="string"==typeof c?c:void 0:t[a]=c}return t}onFeaturesChanged(e){const t=t=>{(null===t.key||t.key.startsWith(s))&&e(this.getAll(t.storageArea))};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)}__reset(){for(let e=0;e<window.localStorage.length;e++){const t=window.localStorage.key(e);t&&t.startsWith(s)&&window.localStorage.removeItem(t)}}}},784603:(e,t,r)=>{r.d(t,{Av:()=>a,Gv:()=>i,Ix:()=>c,lQ:()=>o,yf:()=>s}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);const i=["_dummy_test_experiment","_dummy_test_feature","brand__loader_service_loads_assets","brand__user_generated_templates_in_commercial","cmig__app_launcher","cmig__consumer_app_enabled","cmig__opt_in","cmig__viewer_mode","cmig__viewer_mode_forced","con__3_new_effects","con__brand_kit_in_commercial","con__content_library_is_premium_content_enabled","con__content_library_tab_audio","con__content_library_tab_graphics","con__content_library_tab_images","con__content_library_tab_videos","con__content_library_type_annotation_skip_collections","con__content_library_type_annotation","con__content_library_type_cartoon_people_skip_collections","con__content_library_type_cartoon_people","con__content_library_type_cutout_people_skip_collections","con__content_library_type_cutout_people","con__content_library_type_icon_skip_collections","con__content_library_type_icon","con__content_library_type_illustration_skip_collections","con__content_library_type_illustration","con__content_library_type_shapes_skip_collections","con__content_library_type_shapes","con__content_library_type_sticker_skip_collections","con__content_library_type_sticker","con__crash_zoom_animation","con__discover_draggable_previews","con__discover_tab","con__extra_fonts","con__flash_animation","con__move_animation","con__premium_content_filter","con__premium_filters","con__premium_transitions","con__pulse_animation","con__remove_storyblocks_music","con__rotate_animation","con__spin_animation","con__text_atoms_rotation","con__text_preset_styles","con__timing_panel","con__tts_limit","con__use_getty","core__log_asset_delete_failed","create__audio_recorder","create__clipchat_devtools_autocomp","create__clipchat_devtools","create__discover_tour","create__image_creator","create__new_backgrounds","create__new_screen_record","create__shape_atoms","create__show_legacy_assets","create__text_components_lexical_debug","create__text_style_panel_background","create__text_style_panel_shadow","create__text_style_panel_stroke","create__tts_augloop","create__tts_import_media_panel","create__tts_user_voice","dem__elevate_to_power_user","dem_remixable_exports","editor__background_noise_removal","editor__clicked_item_analytics_event","editor__consumer_1ds_events","editor__container_groups","editor__container_groups_debug","editor__delete_delete","editor__dnd_over_transition","editor__edit_with_behaviour","editor__extend_recording_limit","editor__freehand_menu_text","editor__fullstory_enabled","editor__high_frequency_analytic_events","editor__invalid_dnd_new_track","editor__multi_trim_boundary","editor__new_styled_text_presets","editor__performance_metric_component_render","editor__performance_metric_mouse_trim","editor__performance_metric_scrubbing","editor__performance_metric_single_click_seek","editor__performance_metrics","editor__pixels_assembling_time_tracking","editor_return_when_trimming","editor__right_click_logging","editor__searchbox_filters_and_transitions","editor__slow_input_delay_performance","editor__stage_debug","editor__split_on_transition_indicator","editor__text_atom_replacement","editor__ticks","editor__user_action_metrics","editor__zoom_slider","editor__zoom_to_fit_added_items","tra__disable_google_analytics","fps_monitor","gwy__commercial_prompt_for_aad_users","gwy__enable_integration_logging","gwy__enable_onedrive_via_proxy","gwy__enable_slideshow","gwy__hamburger_menu","gwy__log_braze_control_impressions","gwy__msft_landing_login_hint","gwy__photos_auto_comp","gwy__trim_tool","gwy__xbox_tour","gwy_export_disable_dropbox","gwy_export_disable_googledrive","gwy_export_disable_instagram","gwy_export_disable_linkedin","gwy_export_disable_onedrive","gwy_export_disable_pinterest","gwy_export_disable_tiktok","gwy_export_disable_youtube","gwy_import_disable_dropbox","gwy_import_disable_googledrive","gwy_import_disable_googlephotos","gwy_import_disable_onedrive","gwy_import_disable_xbox","gwy_txt_native_min_ver","iet__external_frame_stream","iet__ffmpeg_relaxed_simd","iet__hardware_video_frames","iet__log_import_errors","iet__webcodecs_allow_hardware_encoding","koala_add_brandkit_graphics_section","koala_add_brandkit_images_section","koala_add_imported_asset_to_timeline","koala_brand_kit_organization_library","koala_brand_kit_recently_used","koala_brand_kit_v2_music","koala_brand_kit_v2_persist_fonts","koala_brand_kit_v2_sfx","koala_brand_kit_v2_videos","koala_enable_brandkit_for_standard_entitlements","koala_honor_stream_soft_trim","magic__augloop_msa_token","magic__autocomp_webnn","magic__auto_composition_debug_menu","magic__auto_cut_camera_magic_edit","magic__auto_cut","magic__background_removal_effects_tab","magic__background_removal_generation_step","magic__background_removal","magic__caption_augloop_backend_use_camera_transcript","magic__caption_item_toggle","magic__caption_style_editor","magic__instinct_demo","magic__log_entitlements","magic__video_builder_from_stock","magic__video_draft_demo","magic__video_draft_devtools","multi__cjk_fonts","multi__consumer_1ds","multi__edgeworth_section","multi__fetch_ocps_policies_for_header","multi__graph_cache_special_folders","multi__landing_page","multi__native_app_header_debug","multi__native_app_header","multi__new_ms365_support","multi__ocv_consumer_editor","multi__onecamera_screen_only","multi__project_load_improvements","multi__recommended_section","multi__request_metrics_sample_rate","multi__rtl_on_fluent_provider","multi__service_worker_loading_message","multi__show_consumer_health_policy","multi__show_feedback_button_debug","multi__show_feedback_button","multi__show_me_control_debug","multi__show_me_control","multi__sw_bypass_mitigation","multi__translate_project_name_on_creation","multi__viewer_mode_forced","multi__viewer_mode","onecamera__enable_dialog_fix","p2__new_billing_cards","portal__graphics_entitlement","portal__use_usage_rights_api_for_licence_check","pst__asset_upload_retry","pst__cloudbackup_fetchhandler","pst__commercial_share_link","pst__tts_ext_data","pst__enable_schema_next_v6a","pst__handle_undefined_mode_log","pst__handle_undefined_mode_throw","pst__log_cache_eviction","pst__log_schema_recovery","pst__project_asset_recovery","pst__project_extractor","pst__project_sync_logging","pst__project_sync_timeout","pst__project_sync_version_mismatch","pst__recover_schema","pst__save_status","pst__schema_brandkit_next_v2","pst__sync_with_retry","pst__load_with_retry_project_schema","ren__babylon_export","ren__babylon_preview","ren__blobs_in_export","ren__consumer_1ds_events","ren__disable_native_hevc_decoder","ren__disable_quantized_ticks","ren__export_sources","ren__stage_playback_metrics","ren__stats_for_nerds","ren__stream_fonts","ren__supermix_export","ren__supermix_preview","ren__teams_16fps_export","reno__milestone_1","texture_leak_error","tra_wcp_cookie_banner_consumer","transcript__based_editing_panel","ui__dir_helmet","ui__theme_toggle","wal__consumer_1ds_upgrade","wal__departmental_purchase_enabled","wal__gdpr_compliant_unauthenticated_events","wal__new_project_landing_page","wal__override_premium_service_plan","wal__proto_has_premium_service_plan","wal__purchase_initiated_events","wal__self_service_trial_enabled","wal__test_departmental_purchase","wal__test_self_service_trial","wal__unlisted_languages","wal__use_edog_ols","wal__use_prv_url_for_dp_and_hft","webgl_error_analytics"],n=new Set(i),o=e=>n.has(e),s=e=>!!e.startsWith("ks_")&&n.has(e.slice(3)),a={_dummy_test_experiment:["control","treatment","baseline"],create__tts_import_media_panel:["control","alpha","bravo"]},c={}},138615:(e,t,r)=>{r.d(t,{AY:()=>a,Ex:()=>d,G7:()=>c,H9:()=>s,N0:()=>p,Us:()=>l,gZ:()=>u,iZ:()=>h,yk:()=>o});var i=r(847269);let n;function o(){return(0,i.sw)(n,"Global flight service has not been set, or is of the wrong type.")}function s(e){n=e}function a(){return o().getAll()}function c(e){const t=o();return t.isEnabled(e)&&!t.isEnabled(`ks_${e}`)}function l(e){return o().isEnabled(e)}function d(e){return o().getValue(e)}function u(e,t){const r=o();if(r.isEnabled(`ks_${e}`))return;const i=r.getValue(e);if(null!=i){if(t&&!t(i))throw new Error("Flight value does not match requested type");return i}}function h(e){const t=u(e,void 0);return"string"==typeof t?t:""}function p(e,t=!1){return o().onFeaturesChanged(e,t)}},854392:(e,t,r)=>{r.d(t,{Dd:()=>s,yP:()=>n}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(784603);const n=["_dummy_test_killswitch","brand_mac_mkv_support","create__tts_voice_sample_ks","koala__automatic_transcript_generation","koala__download_after_recording","koala__exclude_read_only_empty_categories","koala__small_upload_asset_check","koala_brandkit_asset_menu_options","koala_delete_and_rename_menu_update","koala_disable_drag_and_drop","koala_rename_asset_option","ks_brand__rename_brand_kit","ks_brand__slow_load_warning","ks_cmig__export_upload_new_permissions_check","ks_con__bg_track_add","ks_con__export_logging","ks_con__new_content_library_search_bar","ks_create__audio_recording","ks_create__camera_recording","ks_create__log_getty_telemetry_to_hubble","ks_create__log_getty_telemetry_to_kusto","ks_create__new_backgrounds_telemetry","ks_create__screen_camera_recording","ks_create__screen_recording","ks_create__speaker_coach","ks_create__tts_augloop_use_ephemeral","ks_create__tts_create_new","ks_create__tts_property_panel","ks_create__tts_telemetry","ks_create__tts_filter_neuralhd","ks_editor__disable_history_update_on_sync","ks_editor_track_item_for_id_asset_required","ks_gwy__use_edit_with_url_listener_v2","ks_gwy__use_launch_uri","condor_landing_pathRedirect","ks_gyw__edit_with_log_missing_item_id","ks_gyw__open_commercial_in_new_window","ks_magic__caption_extract_audio_timeout","ks_magic__caption_fast_transcription","ks_magic__caption_timeout","ks_magic__check_copilot_service_plan_business","ks_magic__image_background_auto_download","ks_magic__augloop_wait_on_authentication","ks_multi__brandkit_conflict_detection","ks_multi__brandkit_share_link","ks_multi__brandkit_sharelink_import_enabled","ks_multi__check_project_open_by_share_link","ks_multi__cloud_status_disable_uri","ks_multi__consumer_sw_telemetry","ks_multi__disable_auth_default_scope","ks_multi__disable_me_control_observer","ks__multi_disable_service_providers","ks_multi__disable_service_worker_dialog","ks_multi__document_title_rename_permission_check","ks_multi__edgeworth_nav_reset_states_on_reload","ks_multi__empty_token_analytics","ks_multi__export_file_with_unique_name","ks_multi__fix_killSwitch_list","ks_multi__graph_api_cache","ks_multi__graph_api_include_permissions","ks_multi__graph_api_permissions_assume_applicable","ks_multi__handle_redirect_challenges","ks_multi__header_hide_feedback","ks_multi__header_hide_help","ks_multi__hide_premium_features_for_edu","ks_multi__native_app_share_links","ks_multi__native_app_ui","ks_multi__native_token_caching","ks_multi__native_token_locking","ks_multi__ocv_consumer_editor_page","ks_multi__performance_event_refactor","ks_multi__project_rename_unsupported_characters","ks_multi__request_metrics","ks_multi__set_document_title","ks_multi__share_dialog_locale","ks_multi__telemetry_error_forwarding","ks_multi__unhandled_error_message","ks_multi__user_fetch_select","ks_multi__view_only_permissions_bypass","ks_multi__worker_reload_telemetry_flush","ks_p2__hide_m365_plans_link","ks_portal__disable_usagerights_experiment","ks_pst__commercial_always_open_project","ks_pst__disable_bootstrap_ensure_serviceworker","ks_pst__disable_native_project_closing","ks_pst__disable_quota_check","ks_pst__ensure_audio_duration","ks_pst__load_project_content_once","ks_pst__load_project_on_copy","ks_pst__local_source_probe_audio_sep","ks_pst__log_flight_service_no_features","ks_pst__log_import_project_state_error","ks_pst__prepare_storage_options_project_persistence","ks_pst__project_listeners_error_handling","ks_ren__clamp_export_fps","ks_tra__notification_unread_count","ks_use_windows_app_edit_with_navigation","ks_wal__disable_departmental_purchase","ks_wal__disable_license_request_flow_native_only","ks_wal__disable_license_request_flow","ks_wal__disable_ols_query","ks_wal__disable_self_service_purchase_and_trial_native_only","ks_wal__disable_self_service_trial","ks_wal__replace_auth_token_merge","multi__brandkit_add_font_on_import","multi__brandkit_delete_logo","multi__brandkit_telemetry_ks","multi__font-sidebar-loading-indicator-fix","multi__viewonly_personal_exports_ks","pst__disable_video_blocks_repo_update_ks","pst__refetch_internal_folder_meta_ks","wal__log_invalid_msal_grant","wal__reshape_type_error","wal__retry_user_on_type_error"],o=new Set(n),s=e=>(e=>o.has(e))(e)||(0,i.yf)(e)},179315:(e,t,r)=>{r.d(t,{Br:()=>o,U7:()=>a,UJ:()=>l,_u:()=>c,iT:()=>n,vp:()=>s});var i=r(138615);function n(e){const t=(0,i.yk)();return t.useStore(e),t.isEnabled(e)&&!t.isEnabled(`ks_${e}`)}function o(e,t){const r=(0,i.yk)();if(r.useStore(e),r.isEnabled(`ks_${e}`))return;const n=r.getValue(e);if(null!=n){if(t&&!t(n))throw new Error("Flight value does not match requested type");return n}}function s(e){const t=o(e);return!a(`ks_${e}`)&&("boolean"==typeof t||"string"==typeof t)&&t}function a(e){const t=(0,i.yk)();return t.useStore(e),t.isEnabled(e)}function c(e){const t=(0,i.yk)();return t.useStore(),e.every((e=>t.isEnabled(e)&&!t.isEnabled(`ks_${e}`)))}function l(){const e=(0,i.yk)();return e.useStore(),e.getAll()}},999270:(e,t,r)=>{r.d(t,{d:()=>s}),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218),r(95732);const i=["static/fonts/noto-sans-cjk.3baabd09.woff","static/fonts/noto-sans-symbol.ea0a11a5.woff","static/fonts/segoe-ui-emoji.57795ff4.woff","static/fonts/segoe-ui-latin.7702bd19.woff","static/fonts/noto-sans-math.0e38948a.woff","static/fonts/segoe-ui-latin-ext.96066daf.woff","static/fonts/noto-sans-historic.fc122a64.woff","static/fonts/noto-sans-ame.5dcb3455.woff","static/fonts/noto-sans-sa.78bab3ae.woff","static/fonts/segoe-ui-greek.7d737b8e.woff","static/fonts/noto-sans-euam.a16dc765.woff","static/fonts/noto-sans-sc.294cd46b.woff","static/fonts/noto-sans-sea.cb818083.woff","static/fonts/noto-sans-jp.32a8516f.woff","static/fonts/noto-sans-kr.a8164de3.woff","static/fonts/segoe-ui-cyrillic.1b6f608a.woff","static/fonts/segoe-ui-arabic.39f42529.woff","static/fonts/noto-sans-thai.b547663b.woff","static/fonts/noto-sans-ea.caf5ede5.woff","static/fonts/segoe-ui-tibetan.ef68b705.woff","static/fonts/noto-music.c83ad513.woff","static/fonts/noto-sans-sign.f79edf5f.woff"],n="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";let o;function s(e){void 0===o&&(o=Uint8Array.from(atob(n),(e=>e.codePointAt(0)??0)).buffer);const t=function(e,t){let r=0;const i=()=>{let e=0,i=1;for(;;){const n=t.getUint8(r++);if(n<128)return e+=i*n,e;e+=i*(n-128),i*=128}};for(;;){const t=i();if(0!==t){if(1===t)return;return t-2}{const t=i(),n=i();e>t&&(r+=n)}}}(e,new DataView(o,0,o.byteLength));return void 0===t?void 0:i[t]}},135232:(e,t,r)=>{r.d(t,{Q:()=>o});var i=r(26985);class n{}const o=e=>{const t=(0,i.createContext)(new n);return[t.Provider,()=>{const r=(0,i.useContext)(t);if(r instanceof n)throw new Error(`Expected ${e} to be provided`);return r}]}},46517:(e,t,r)=>{r.d(t,{M:()=>n});var i=r(26985);function n(e){return(0,i.useState)(e)[0]}},177482:(e,t,r)=>{r.d(t,{f:()=>a});var i=r(26985),n=r(650882),o=r(652213),s=r(422226);function a(e,t){const[r,a]=(0,i.useState)({status:"idle"}),c=(0,i.useRef)(),l=(0,o.q)(),d=(0,i.useRef)(t);function u(e){if(!l.current)return;const t=(0,n.xM)(e,"An error occurred when dispatching promise");a({status:"error",error:t}),c.current=void 0,d.current?.onError?.(t),d.current?.onSettled?.()}return d.current=t,[r,(0,s.Z)(((...t)=>{if(!c.current)try{const r=e(...t);c.current=r,a({status:"loading"}),r.then((e=>{l.current&&(a({status:"success",data:e}),c.current=void 0,d.current?.onSuccess?.(e),d.current?.onSettled?.())})).catch((e=>{u(e)}))}catch(e){u(e)}}))]}},967108:(e,t,r)=>{r.d(t,{B:()=>o});var i=r(46517);let n=0;const o=()=>`cc-${(0,i.M)((()=>n++))}`},652213:(e,t,r)=>{r.d(t,{q:()=>n});var i=r(26985);function n(){const e=(0,i.useRef)(!1);return(0,i.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),e}},781224:(e,t,r)=>{r.d(t,{A:()=>l,m:()=>c});var i=r(26985),n=r(396159),o=r(357891),s=r(650882),a=r(422226);function c(e,t){const[r,n]=(0,i.useState)(),o=(0,a.Z)((e=>{"function"==typeof t?t(e):t.next?.(e)})),c=(0,a.Z)((e=>{const r=(0,s.xM)(e,"An error ocurred when subscribing to the observable");"function"!=typeof t&&t.error?t.error(r):n(r)})),l=(0,a.Z)((()=>{"function"!=typeof t&&t.complete?.()}));(0,i.useEffect)((()=>{if(r)throw r}),[r]),(0,i.useEffect)((()=>{const t=e?.subscribe({next:o,error:c,complete:l});return()=>{t?.unsubscribe()}}),[e,o,c,l])}function l(e,t){const[r,s]=(0,i.useState)(t);return c((0,i.useMemo)((()=>e?.pipe((0,n.F)(o.x))),[e]),s),r}},422226:(e,t,r)=>{r.d(t,{Z:()=>n});var i=r(26985);function n(e){const t=(0,i.useRef)(e);return t.current=e,(0,i.useCallback)(((...e)=>t.current(...e)),[t])}},298995:(e,t,r)=>{r.d(t,{hF:()=>y,v5:()=>b,GA:()=>k,Wy:()=>w,lk:()=>A,PN:()=>g,L7:()=>E,fL:()=>x,pq:()=>v,H$:()=>C,DD:()=>_});var i=r(650882);const n=422,o=408,s=429,a=404,c=405,l=500,d=400,u=401,h=403,p=502,m=503,f=504;class g extends i.g9{constructor(e,t){super(`NetworkError::${e}::${t?"online":"offline"}`,{errorType:"network",method:e,online:`${t}`}),this.method=e,this.online=t}}class A extends Error{constructor(e){super(`NetworkAbortError::${e}`),this.method=e}}class v extends Error{constructor(e){super(e)}}class y extends Error{constructor(e){super(e)}}class b extends Error{constructor(e){super(e)}}class w extends Error{constructor(e){super(e)}}class x extends Error{constructor(e){super(e)}}const S={[n]:"UnProcessableEntity",[o]:"RequestTimeout",[s]:"TooManyRequests",[a]:"NotFound",[c]:"MethodNotAllowed",[l]:"InternalServerError",[d]:"BadRequestParams",[u]:"Unauthorized",[h]:"Forbidden",[p]:"BadGateway",[m]:"ServiceUnavailable",[f]:"GatewayTimeout"},T={[n]:422,[o]:408,[s]:429,[a]:404,[c]:405,[l]:500,[d]:400,[u]:401,[h]:403,[p]:502,[m]:503,[f]:504};function C(e){return S[e]??"UnknownError"}function _(e){return T[e]??0}class k extends i.g9{constructor(e,t){super(`HTTPError::${e}`,{errorType:"http",method:e,status:t}),this.method=e,this.status=t,this.message=this.getHubbleErrorMessage(t)}getHubbleErrorMessage(e){return C(e)}}class E extends k{constructor(e,t){super(e,t),this.context&&(this.context.errorType="retryable-http")}}},889688:(e,t,r)=>{r.d(t,{W:()=>n,z:()=>o});var i=r(825702);function n(e){return i.kL.resolve(e)}function o(e){return i.kL.resolveAll(e)}},739367:(e,t,r)=>{r.d(t,{l:()=>o});var i=r(26985),n=r(889688);function o(e){return(0,i.useMemo)((()=>(0,n.W)(e)),[e])}},488630:(e,t,r)=>{r.d(t,{H:()=>o,f:()=>n});var i=r(175358);class n extends Error{constructor(e,t){super(e),this.response=t}}class o{constructor(e){this.token=e}fetch(e,t,r){return fetch(e,{...t,headers:{...t?.headers,Authorization:"Bearer "+this.token}}).then((e=>e.status>=400?Promise.reject(new n((0,i.mj)("export.fetchError.generalError","Bad response from server"),e)):204!==e.status?r?e:e.json():void 0))}}},987485:(e,t,r)=>{r.d(t,{o:()=>o});var i=r(324586),n=r(488630);class o{constructor(e,t){(0,i.A)(this,"authFetch",void 0),(0,i.A)(this,"inFlightRequest",void 0),this.url=e,this.authFetch=new n.H(t)}fetch(e){return this.inFlightRequest||(this.inFlightRequest=this.authFetch.fetch(this.url,e).finally((()=>{this.inFlightRequest=void 0}))),this.inFlightRequest}}},479309:(e,t,r)=>{r.d(t,{Dw:()=>k,aU:()=>E,RA:()=>R,Fh:()=>F});var i=r(800668),n=r(26985),o=r(825702),s=r(562229),a=r(719587),c=r(739367),l=r(552740),d=r(99129),u=r(272908),h=r(573340),p=r(488630),m=r(23225),f=r(368288),g=r(620234),A=r(482682),v=r(559755),y=r(917218),b=r(847269),w=r(987485),x=r(542034);const S=new x.L("disconnect-integration");var T=r(650882);const C=new x.L("refresh-access-token");var _;const k="integrationServiceCofig";let E=(0,o.Gr)()(_=function(e){return(0,o.WQ)(l.T)(e,void 0,0)}(_=function(e){return(0,o.WQ)(d.j)(e,void 0,1)}(_=function(e){return(0,o.WQ)(a.yC)(e,void 0,2)}(_=function(e){return(0,o.WQ)(g.qC)(e,void 0,4)}((I=_=Reflect.metadata("design:type",Function)(_=Reflect.metadata("design:paramtypes",[void 0===l.T?Object:l.T,void 0===d.j?Object:d.j,void 0===a.qG?Object:a.qG,void 0===u.e?Object:u.e,void 0===g.$o?Object:g.$o,"undefined"==typeof IIntegrationServiceConfig?Object:IIntegrationServiceConfig])(_=class{constructor(e,t,r,i,n,o){this.appVariantCheckerService=e,this.nativeMessagingService=t,this.msAuthService=r,this.nativeAppCapabilitiesService=i,this.apiFactory=n,this.config=o}async refreshAccessTokenOrFail(e){try{return await this.baseRefreshAccessToken(e)}catch(t){const r=m.v.create({slug:e.slug,connected:!1,accessToken:{subjectId:e.accessToken.subjectId,email:e.accessToken.email}});return this.connectOrFail(r)}}async refreshAccessToken(e){if("onedrive1p"===e.slug)return this.reconnectIntegration(e);try{return await this.baseRefreshAccessToken(e)}catch(t){return this.reconnectIntegration(e)}}reconnectIntegration(e){const t=m.v.create({slug:e.slug,connected:!1,accessToken:{subjectId:e.accessToken.subjectId,email:e.accessToken.email}});return this.connect(t)}async baseRefreshAccessToken(e){const{access_token:t,sub:r,email:i}=await(n=e.slug,o=this.config.apiBaseUrl,(0,y.b)({maxAttempts:3,backOffPolicy:"exponential",catch:e=>{throw h.Vy.error(new T.g9("Failed to refresh integration access token",{originalError:e,data:{slug:n}})),e}})((async({slug:e})=>{const t=v.j.getToken();(0,b.iY)(t,"User has not logged in");const r=await C.get(e+t,(()=>new w.o(`${o}/oauth/refresh/${e}`,t))).fetch();return{...r,sub:r.sub||void 0,email:r.email||void 0}}))({slug:n,apiBaseUrl:o}));var n,o;return e=m.v.create({slug:e.slug,connected:!0,accessToken:{subjectId:r,token:t,email:i}}),f.RY.update(e),e}async connect(e){try{return await this.connectOrFail(e)}catch(t){if(t instanceof A.b2||t instanceof i.jT&&"user_cancelled"===t.errorCode||t instanceof A.Jv)return e;throw t}}async connectOrFail(e){try{const{accessToken:t,sub:r,email:i}=await(0,A.Jq)(e,this.nativeMessagingService,this.appVariantCheckerService,this.msAuthService,this.nativeAppCapabilitiesService),n=m.v.create({slug:e.slug,connected:!0,accessToken:{subjectId:r,token:t,email:i}});return f.RY.update(n),n}catch(t){throw this.softDisconnect(e),t}}async loadUserInfo(e){if(e.userInfo)return e;try{const t=this.apiFactory.create(e.slug,(async t=>{let r=m.v.create(e);return!t&&r.ready||(r=await this.refreshAccessTokenOrFail(r)),r})),r=await t.fetchUserInfo(),i=m.v.create({...e,userInfo:r??{}});return f.RY.update(i),i}catch(t){t instanceof p.f?s.z.logEvent("Error - Integration fetch user",{slug:e.slug,message:t.message,status:t.response.status,payload:t.response.text()}):s.z.logEvent("Error - Integration fetch user",{slug:e.slug,message:t});const r=m.v.create({...e,userInfo:[]});return f.RY.update(r),r}}async disconnect(e){var t,r;await(t=e.slug,r=this.config.apiBaseUrl,(0,y.b)({maxAttempts:3,backOffPolicy:"exponential",catch:e=>{throw h.Vy.error(e),e}})((async({slug:e})=>{const t=v.j.getToken();return(0,b.iY)(t,"User has not logged in"),S.get(e+t,(()=>new w.o(`${r}/oauth/auth/${e}`,t))).fetch({method:"DELETE"})}))({slug:t,apiBaseUrl:r})),this.softDisconnect(e)}softDisconnect(e){const t=m.v.create({slug:e.slug,connected:!1});return f.RY.update(t),t}})||_)||_,_=(0,o.WQ)(k)(I,void 0,5)||_))||_)||_)||_)||_)||_;var I;const R=()=>(0,c.l)(E),F=e=>{const t=(0,f.eL)(e),r=R();return(0,n.useMemo)((()=>t.connected?t.ready?t.userInfo?t:(r.loadUserInfo(t).catch(h.Vy.error),null):(r.refreshAccessToken(t).catch(h.Vy.error),null):(r.connect(t).catch(h.Vy.error),null)),[t,r])}},929359:(e,t,r)=>{r.d(t,{BL:()=>n,F$:()=>s,KP:()=>o});var i=r(776016);const n=["box_edit_in","box","dropbox","gdrive","google_photos","linkedin","onedrive","onedrive1p","pinterest","tiktok","twitter","youtube","zoom","xbox","instagram"],o={box_edit_in:"Box",box:"Box",dropbox:"Dropbox",gdrive:"Google Drive",google_photos:"Google Photos",linkedin:"LinkedIn",onedrive:"OneDrive",onedrive1p:"OneDrive",pinterest:"Pinterest",tiktok:"TikTok",twitter:"Twitter",youtube:"YouTube",zoom:"Zoom",xbox:"Xbox",instagram:"Instagram"},s=(0,i.u)("gdrive","google_photos","youtube")},23225:(e,t,r)=>{r.d(t,{v:()=>o});class i{static create({subjectId:e,token:t,email:r}={}){return void 0===t?Object.freeze({subjectId:e,email:r,valid:!1}):Object.freeze({subjectId:e,email:r,token:t,valid:!0})}}class n{static create(e){return e.map((e=>Object.freeze({...e})))}}class o{static create(e){return!0!==e.connected?Object.freeze({slug:e.slug,connected:!1,accessToken:i.create(e.accessToken),get ready(){return this.accessToken.valid}}):(e.accessToken,Object.freeze({slug:e.slug,connected:!0,accessToken:i.create(e.accessToken),userInfo:e.userInfo&&n.create(e.userInfo),get ready(){return this.accessToken.valid}}))}}},368288:(e,t,r)=>{r.d(t,{rw:()=>A,RY:()=>m,eL:()=>y});var i=r(559755),n=r(573340),o=r(23225),s=r(917218),a=r(987485);const c=new(r(542034).L)("fetch-connected-integrations");var l=r(831123),d=r(929359);class u extends Error{}const h=Object.freeze(d.BL.reduce(((e,t)=>(e[t]=o.v.create({slug:t}),e)),{})),p=(0,l.vt)(((e,t)=>({integrations:h,reset:t=>e({integrations:t}),all:()=>t().integrations,find:e=>t().integrations[e],findConnectedOrFail:e=>{const r=t().find(e);if(!r.connected)throw new u;return r},update:t=>{e((e=>({...e,integrations:{...e.integrations,[t.slug]:t}})))}}))),m=p.getState();let f;const g=async(e,t)=>{if(f!==t)if(f=t,t)try{const t=await(e=>(0,s.b)({maxAttempts:3,backOffPolicy:"exponential",catch:e=>(n.Vy.error(e),Promise.resolve([]))})((async()=>{const t=i.j.getToken();return t?(await c.get(t,(()=>new a.o(`${e}/oauth/integrations`,t))).fetch()).map((e=>({...e,sub:e.sub||void 0,email:e.email||void 0}))):(n.Vy.log("User has not logged in"),[])}))({apiBaseUrl:e}))(e),r={...m.all(),...t.reduce(((e,{provider:t,sub:r,email:i})=>(e[t]=o.v.create({slug:t,connected:!0,accessToken:{subjectId:r,email:i}}),e)),{})};m.reset(r)}catch(e){n.Vy.error(e)}else m.reset(h)},A=e=>{i.j.registerForChanges((()=>g(e)));const t=i.j.getToken();t&&g(e,t).catch(n.Vy.error)},v=(e,t)=>!(e.connected!==t.connected||e.connected&&t.connected&&(e.ready!==t.ready||e.ready&&t.ready&&e.userInfo!==t.userInfo)),y=(e,t=v)=>p((({integrations:t})=>t[e]),t)},620234:(e,t,r)=>{r.d(t,{$o:()=>o,Aw:()=>s,qC:()=>n});var i=r(739367);const n="APIFactory";class o{}const s=()=>(0,i.l)(n)},20431:(e,t,r)=>{r.d(t,{n:()=>p});var i=r(324586),n=r(917218),o=r(225304),s=r(527690),a=r(488630),c=r(562229);class l{parseError(e){return Promise.resolve(e)}}class d{constructor(e,t){this.errorFactory=e,this.provider=t}async handleImportError(e,t){const r=await this.errorFactory.parseError(e,t),i=r.context;return void 0!==i&&(c.z.logEvent("Import - Third Party Import Error",{provider:this.provider,...i,...t}),c.z.logErrorEvent("ThirdPartyImportError",{providerId:this.provider,errorCode:String(i.reason),httpResponseCode:i.httpResponseCode,message:i.message,endpoint:i.endpoint,statusText:i.statusText})),r}async handleExportError(e,t){return await this.errorFactory.parseError(e,t)}}var u=r(175358);class h{fetch(e,t,r){return fetch(e,{...t,headers:{...t?.headers}}).then((e=>e.status>=400?Promise.reject(new a.f((0,u.mj)("export.fetchError.generalError","Bad response from server"),e)):204!==e.status?r?e:e.json():void 0))}}class p{constructor(e,t,r=new l){(0,i.A)(this,"abortController",new AbortController),(0,i.A)(this,"errorHandler",void 0),this.fetchIntegration=e,this.service=t,this.errorFactory=r,this.errorHandler=new d(r,t)}abort(){this.abortController.abort(),this.abortController=new AbortController}async request({endpoint:e,retried:t,options:{params:r,bypassAuth:i=!1,...n}={}}){const o=this.constructQuery(r);let s;if(i)s=new h;else{const e=await this.getIntegration(t);s=new a.H(e.accessToken.token)}return s.fetch(`${e}${o}`,{...n,signal:this.abortController.signal})}requestWithRetry(e){return(0,n.b)({maxAttempts:3,backOffPolicy:"exponential",doRetry:e=>e instanceof a.f||(0,o.PL)(e)})((e=>this.request(e)))(e)}async requestReturnRaw({endpoint:e,retried:t,options:{params:r,bypassAuth:i=!1,...n}={}}){const o=this.constructQuery(r);let s;if(i)s=new h;else{const e=await this.getIntegration(t);s=new a.H(e.accessToken.token)}return s.fetch(`${e}${o}`,{...n,signal:this.abortController.signal},!0)}requestWithRetryReturnRaw(e){return(0,n.b)({maxAttempts:3,backOffPolicy:"exponential",doRetry:e=>e instanceof a.f||(0,o.PL)(e)})((e=>this.requestReturnRaw(e)))(e)}async getIntegration(e){try{return await this.fetchIntegration(e)}catch(e){throw new s.O(e)}}constructQuery(e){return e?(e=>`?${Object.entries(e).map((([e,t])=>`${e}=${t}`)).join("&")}`)(e):""}handleImportError(e){return this.errorHandler.handleImportError(e)}handleExportError(e,t){return this.errorHandler.handleExportError(e,t)}}},122294:(e,t,r)=>{r.d(t,{QV:()=>o,UE:()=>a,aW:()=>s,ng:()=>n});var i=r(650882);const n={ParseText:"PARSE_TEXT",ParseJSON:"PARSE_JSON",ComplianceOmitted:"COMPLIANCE_OMITTED",GeneralError:"GENERAL_ERROR",TypeError:"TYPE_ERROR"};class o extends i.g9{constructor(e,t){super(e,t)}}class s extends o{constructor(e,t){super(e,{reason:n.GeneralError,message:"An error occurred during the export upload process.",...t})}}class a extends s{constructor(e){super("The user aborted a request.",{message:`Upload to ${e} was cancelled.`,reason:"ABORT_ERROR"})}}},482682:(e,t,r)=>{r.d(t,{b2:()=>N,hO:()=>M,Jv:()=>L,Jq:()=>z,bR:()=>O});var i=r(324586),n=r(37344),o=r.n(n),s=r(562229),a=r(972070),c=r(6690),l=r(670814),d=r(776016),u=r(397814);const h=(0,d.u)("gdrive","google_photos","youtube");var p,m,f,g,A,v,y;class b extends u.L{constructor(e,t,r,n,o){super(),(0,i.A)(this,"payload",void 0),this.payload={slug:e,accessToken:t,subjectId:r,expiresIn:n,email:o}}}p=b,(0,i.A)(b,"type","[Integration] Connected to Google"),(0,i.A)(b,"isInstance",(0,d.t9)({type:(0,d.u)(p.type),payload:(0,d.t9)({slug:h,accessToken:d.Kg,subjectId:(0,d.H7)((0,d.gH)(d.Kg)),expiresIn:d.Et,email:(0,d.H7)((0,d.gH)(d.Kg))})}));class w extends u.L{constructor(e,t){super(),(0,i.A)(this,"payload",void 0),this.payload={slug:e,error:t}}}m=w,(0,i.A)(w,"type","[Integration] Connect to Google Failed"),(0,i.A)(w,"isInstance",(0,d.t9)({type:(0,d.u)(m.type),payload:(0,d.t9)({slug:h,error:d.Kg})}));class x extends u.L{constructor(e,t){super(),(0,i.A)(this,"payload",void 0),this.payload={slug:e,authorizationCode:t}}}f=x,(0,i.A)(x,"type","[Integration] Connect to Google"),(0,i.A)(x,"isInstance",(0,d.t9)({type:(0,d.u)(f.type),payload:(0,d.t9)({slug:h,authorizationCode:d.Kg})}));class S extends u.L{constructor(e,t){super(),(0,i.A)(this,"payload",void 0),this.payload={accessToken:e,idToken:t}}}g=S,(0,i.A)(S,"type","[Integration] Connected to OneDrive"),(0,i.A)(S,"isInstance",(0,d.t9)({type:(0,d.u)(g.type),payload:(0,d.t9)({accessToken:d.Kg,idToken:(0,d.H7)(d.Kg)})}));class T extends u.L{}A=T,(0,i.A)(T,"type","[Integration] Connect to OneDrive Canceled"),(0,i.A)(T,"isInstance",(0,d.t9)({type:(0,d.u)(A.type)}));class C extends u.L{constructor(e){super(),(0,i.A)(this,"payload",void 0),this.payload={error:e}}}v=C,(0,i.A)(C,"type","[Integration] Connect to OneDrive Failed"),(0,i.A)(C,"isInstance",(0,d.t9)({type:(0,d.u)(v.type),payload:(0,d.t9)({error:d.Kg})}));class _ extends u.L{constructor(e,t,r){super(),(0,i.A)(this,"payload",void 0),this.payload={scopes:e,accountId:t,loginHint:r}}}y=_,(0,i.A)(_,"type","[Integration] Connect to OneDrive"),(0,i.A)(_,"isInstance",(0,d.t9)({type:(0,d.u)(y.type),payload:(0,d.t9)({scopes:(0,d._j)(d.Kg),accountId:(0,d.H7)(d.Kg),loginHint:(0,d.H7)(d.Kg)})}));var k=r(573340),E=r(175358),I=r(650882),R=r(929359),F=r(542034);class P extends I.g9{}class L extends Error{constructor(){super((0,E.mj)("export.providerContent.failedToOpenOAuthPrompt","Could not show authentication popup window"))}}class N extends P{constructor(){super("Connect to integration cancelled")}}class M extends P{constructor(e,t){super(t=t??(0,E.mj)("export.providerContent.failedToConnect","Failed to connect to {{integration}}")),(0,i.A)(this,"integrationSlug",void 0),this.integrationSlug=e,this.context={integrationSlug:this.integrationSlug}}}const B=(0,d.t9)({links:(0,d.t9)({redirect:d.Kg})}),D=(0,d.t9)({code:d.Kg}),O=async()=>(0,a.E)("/oauth/otc",{method:"POST"}).json(D);class j{constructor(e,t,r,n){(0,i.A)(this,"request",o()((e=>this.requestOAuthThenWait(e)),150,{leading:!0,trailing:!1})),this.msAuthService=e,this.appVariantCheckerService=t,this.nativeMessagingService=r,this.nativeAppCapabilitiesService=n}async requestOAuthThenWait(e){const{slug:t}=e;return"onedrive1p"===t?this.requestForOneDrive(e):this.appVariantCheckerService.satisfies("windows-native")&&(0,R.F$)(t)?this.requestThroughNative(t):this.requestThroughBrowser(t)}async requestThroughNative(e){const{code:t}=await O();return new Promise(((r,i)=>{let n=()=>{},o=()=>{};n=this.nativeMessagingService.listen(b,(async t=>{n(),o();try{const e={provider:t.payload.slug,sub:t.payload.subjectId??"",accessToken:t.payload.accessToken,expiresIn:t.payload.expiresIn,email:t.payload.email??void 0};await(async({provider:e,accessToken:t})=>(0,a.E)(`/oauth/auth/${e}/enable`,{method:"POST",body:{code:t}}))(e),r(e)}catch(t){i(new M(e))}})),o=this.nativeMessagingService.listen(w,(t=>{n(),o(),i(new M(e,t.payload.error))})),this.nativeMessagingService.send(new x(e,t))}))}async requestThroughBrowser(e){const{links:{redirect:t}}=await(async e=>(0,a.E)(`/oauth/auth/${e}/connect`,{method:"POST"}).json(B))(e),r={targetUrl:t,provider:e},i=this.openRequestOAuth(r);if(!i)throw new L;return this.getAuthPopupResult(i,r)}async requestForOneDrive(e){const{session:t}=await this.connectToOneDrive(["email","files.readwrite"],e.accessToken.subjectId,e.accessToken.email);if(!t)throw new M(e.slug,"Failed to get token for OneDrive");const r=`${t.user.accountId}.${t.user.tenantId}`;return await(async(e,t,r)=>(0,a.E)("/oauth/auth/onedrive1p",{method:"PUT",body:{access_token:e,sub:t,email:r}}))(t.accessToken,r,t.user.username),{accessToken:t.accessToken,sub:r,expiresIn:null,email:t.user.username}}async connectToOneDrive(e,t,r){return!0===this.nativeAppCapabilitiesService.capabilities?.gwy__connect_to_onedrive?new Promise(((i,n)=>{const o=[this.nativeMessagingService.listen(S,(e=>{if(o.forEach((e=>e())),!e.payload.idToken||!e.payload.accessToken)return void n(new M("onedrive1p","Unexpected auth result"));const t=(0,c.oL)(e.payload.idToken),r=(0,l.LS)(t),s=decodeURIComponent(e.payload.accessToken);i({session:{accessToken:s,idToken:e.payload.idToken,user:r}})})),this.nativeMessagingService.listen(T,(e=>{o.forEach((e=>e())),n(new M("onedrive1p","Canceled by user"))})),this.nativeMessagingService.listen(C,(e=>{o.forEach((e=>e())),n(new M("onedrive1p",e.payload.error))}))];this.nativeMessagingService.send(new _(e,t,r))})):await this.msAuthService.login({tokenType:"graph",usePopupLogin:!0,scopes:e,forceSelectAccount:!r,accountId:t,loginHint:r,skipActiveUser:!0})}openRequestOAuth({targetUrl:e,provider:t}){return s.z.logEvent("Usage - OAuth login opened",{provider:t}),window.open(e,"_blank","width=600,height=800,centerscreen,menubar=0,toolbar=0,location=0,status=0,personalbar=0,dialog=1")}getAuthPopupResult(e,{provider:t}){return new Promise(((r,i)=>{const n=this.checkPopupClosed(i,e),o=a=>{const c=a.data;if(a.source===e&&a.origin===window.location.origin&&c)if(self.removeEventListener("message",o),e.close(),clearInterval(n),c.success)r(c.payload),s.z.logEvent("Usage - OAuth login successful",{provider:t});else{const e=new M(t,c.message);k.Vy.error(e),i(e),s.z.logEvent("Usage - OAuth login failed",{provider:t})}};self.addEventListener("message",o)}))}checkPopupClosed(e,t){const r=setInterval((()=>{t.closed&&(clearInterval(r),e(new N))}),500);return r}}const U=new F.L("connect-integration"),z=async(e,t,r,i,n)=>U.get(e.slug,(()=>new j(i,r,t,n))).request(e)},542034:(e,t,r)=>{r.d(t,{L:()=>n});var i=r(324586);class n{constructor(e){if(this.serviceKey=e,e in n.registry)throw new Error(`${e} already exists`);n.registry[this.serviceKey]={}}get(e,t){return e in n.registry[this.serviceKey]||(n.registry[this.serviceKey][e]=t()),n.registry[this.serviceKey][e]}}(0,i.A)(n,"registry",{})},552740:(e,t,r)=>{r.d(t,{T:()=>v,L:()=>b});var i=r(324586),n=(r(95732),r(730477)),o=r.n(n),s=r(569227),a=r.n(s),c=r(825702),l=r(138615),d=r(739367),u=r(573340),h=r(650882),p=r(615101),m=r(980493);const f=(0,r(776016).u)("web-app","windows-native","windows-twa","chrome-os-twa");var g,A=r(823518);let v=(0,c.Gr)()((y=g=Reflect.metadata("design:type",Function)(g=Reflect.metadata("design:paramtypes",[void 0===m.zp?Object:m.zp])(g=class{get current(){return this.variant}constructor(e){(0,i.A)(this,"variant",void 0),this.twaTrackingService=e,this.variant=this.detectAppVariant(),this.registerAppVariantInCookie()}satisfies(...e){return e.some((e=>this.satisfiesTarget(this.variant,e)))}outside(...e){return!this.satisfies(...e)}detectAppVariant(){if(this.twaTrackingService.isWindows)return{type:"windows-twa",version:null,windows:null};if(this.twaTrackingService.isChromeOS)return{type:"chrome-os-twa",version:null,windows:null};if(window.chrome?.webview&&window.clipchampWindowsNativeApp){const e=(0,A.E)(window.clipchampWindowsNativeApp.version);let t=null;return window.clipchampWindowsNativeApp.os?.version&&(t=(0,A.E)(window.clipchampWindowsNativeApp.os.version)),{type:"windows-native",version:e,windows:t}}return{type:"web-app",version:null,windows:null}}registerAppVariantInCookie(){const e=btoa(JSON.stringify({type:this.variant.type,version:this.variant.version?.toString()??null,windows:this.variant.windows?.toString()??null}));document.cookie=`app_variant=${e}; Path=/; Secure; SameSite=Strict;`}satisfiesTarget(e,t){if(f(t)&&(t={[t]:!0}),Array.isArray(t)&&(t={[t[0]]:t[1]}),"windows-native"===e.type){const r=t["windows-native"]??!1;if(!0===r||!1===r)return r;if("outdated"===r){const e=(0,l.iZ)("gwy_txt_native_min_ver").trim();return a()(e)===e&&this.satisfiesTarget(this.variant,["windows-native",`<${e}`])}return a()(r)?o()(e.version,r):(u.Vy.error(new h.g9((0,p.vU)(`Range ${r} is not compliant with semver range`))),!1)}return t[e.type]??!1}})||g)||g,g=(0,c.WQ)(m.zp)(y,void 0,0)||g))||g;var y;function b(){return(0,d.l)(v)}},823518:(e,t,r)=>{r.d(t,{E:()=>a,v:()=>c});var i=r(545727),n=r.n(i),o=r(650882),s=r(615101);const a=e=>{const t=n()(e);if(!t)throw new o.g9((0,s.vU)(`Invalid version ${e}`));return t},c=e=>{if("windows-native"!==e.type)return null;const t=e.windows;return null===t?"Unknown":t.major<10?"Unsupported":t.major>10||t.minor>0?"Future":t.patch>=22e3?"Win11":"Win10"}},597808:(e,t,r)=>{r.d(t,{B:()=>o});var i=r(831123),n=r(49533);const o=(0,i.vt)()((0,n.Zr)((e=>({isLaunchedByEditWithHandled:!1,setEditWithLaunchSource:t=>e((e=>"open_with"!==t||e.isLaunchedByEditWithHandled?e:{isLaunchedByEditWithHandled:!1})),setHandled:()=>e({isLaunchedByEditWithHandled:!0})})),{name:"isLaunchedByEditWithHandled",storage:(0,n.KU)((()=>sessionStorage))}))},347262:(e,t,r)=>{r.d(t,{H:()=>u,i:()=>d});var i,n=r(324586),o=r(26985),s=r(815731),a=r(825702),c=r(781224),l=r(739367);let d=(0,a.Gr)()(i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[])(i=class{constructor(){(0,n.A)(this,"assets$",void 0),(0,n.A)(this,"onAssets",new s.t([])),(0,n.A)(this,"postAssets",(e=>{this.onAssets.next(e)})),(0,n.A)(this,"clearAssets",(()=>{this.onAssets.next([])})),(0,n.A)(this,"refreshAssets",(()=>{const e=this.onAssets.getValue();this.onAssets.next(e)})),this.assets$=this.onAssets.asObservable()}})||i)||i)||i;const u=()=>{const e=(0,l.l)(d),[t,r]=(0,o.useState)(new Map);(0,c.m)(e.assets$,(e=>{r((t=>{if(0===e.length)return new Map;const r=new Map(t);return e.forEach((e=>r.set(e.cloud.id,e))),r}))}));const i=(0,o.useCallback)((()=>{e.clearAssets()}),[e]),n=(0,o.useCallback)((()=>{e.refreshAssets()}),[e]);return{assets:[...t.values()],refreshAssets:n,clearAssets:i}}},441910:(e,t,r)=>{r.d(t,{r:()=>i});class i{static get messageType(){throw new Error("Not Implemented")}}},272908:(e,t,r)=>{r.d(t,{M:()=>c,e:()=>a});var i,n=r(324586),o=r(825702),s=r(739367);let a=(0,o.Gr)()(i=class{constructor(){(0,n.A)(this,"_capabilities",void 0)}get capabilities(){return this._capabilities}init(){this._capabilities=window.clipchampWindowsNativeApp?.capabilities||window.clipchampWindowsNativeApp?.features||void 0}})||i;function c(){return(0,s.l)(a).capabilities}},397814:(e,t,r)=>{r.d(t,{L:()=>n});var i=r(324586);class n{constructor(){(0,i.A)(this,"type",void 0),(0,i.A)(this,"payload",void 0),this.type=this.constructor.type}}(0,i.A)(n,"type",void 0),(0,i.A)(n,"isInstance",(e=>{throw new Error("Not Implemented in abstract class.")}))},275848:(e,t,r)=>{r.d(t,{S:()=>a});var i,n=r(324586),o=r(776016),s=r(397814);class a extends s.L{constructor(e){super(),(0,n.A)(this,"payload",void 0),this.payload={id:e}}}i=a,(0,n.A)(a,"type","[Auth] Acquire Delegated token canceled"),(0,n.A)(a,"isInstance",(0,o.t9)({type:(0,o.u)(i.type),payload:(0,o.t9)({id:o.Kg})}))},712362:(e,t,r)=>{r.d(t,{u:()=>a});var i,n=r(324586),o=r(776016),s=r(397814);class a extends s.L{constructor(e,t){super(),(0,n.A)(this,"payload",void 0),this.payload={id:e,error:t}}}i=a,(0,n.A)(a,"type","[Auth] Acquire Delegated token failed"),(0,n.A)(a,"isInstance",(0,o.t9)({type:(0,o.u)(i.type),payload:(0,o.t9)({id:o.Kg,error:o.Kg})}))},879181:(e,t,r)=>{r.d(t,{P:()=>a});var i,n=r(324586),o=r(776016),s=r(397814);class a extends s.L{constructor(){super()}}i=a,(0,n.A)(a,"type","[Infrastructure] Close Application"),(0,n.A)(a,"isInstance",(0,o.t9)({type:(0,o.u)(i.type)}))},148584:(e,t,r)=>{r.d(t,{p:()=>a});var i,n=r(324586),o=r(776016),s=r(397814);class a extends s.L{constructor(e,t,r){super(),(0,n.A)(this,"payload",void 0),this.payload={id:e,accessToken:t,idToken:r}}}i=a,(0,n.A)(a,"type","[Auth] Delegated token acquired"),(0,n.A)(a,"isInstance",(0,o.t9)({type:(0,o.u)(i.type),payload:(0,o.t9)({id:o.Kg,accessToken:o.Kg,idToken:(0,o.H7)(o.Kg)})}))},908860:(e,t,r)=>{r.d(t,{p:()=>a});var i,n=r(324586),o=r(776016),s=r(397814);class a extends s.L{constructor(e){super(),(0,n.A)(this,"payload",void 0),this.payload={error:e}}}i=a,(0,n.A)(a,"type","[Infrastructure] Launch Uri Failed"),(0,n.A)(a,"isInstance",(0,o.t9)({type:(0,o.u)(i.type),payload:(0,o.t9)({error:o.Kg})}))},677252:(e,t,r)=>{r.d(t,{Q:()=>a});var i,n=r(324586),o=r(776016),s=r(397814);class a extends s.L{constructor(e,t){super(),(0,n.A)(this,"payload",void 0),this.payload={uri:e,targetApp:t}}}i=a,(0,n.A)(a,"type","[Infrastructure] Launch Uri"),(0,n.A)(a,"isInstance",(0,o.t9)({type:(0,o.u)(i.type),payload:(0,o.t9)({uri:o.Kg,targetApp:(0,o.H7)(o.Kg)})}))},323051:(e,t,r)=>{r.d(t,{O:()=>a});var i,n=r(324586),o=r(776016),s=r(397814);class a extends s.L{}i=a,(0,n.A)(a,"type","[Auth] Sign In with Microsoft Canceled"),(0,n.A)(a,"isInstance",(0,o.t9)({type:(0,o.u)(i.type)}))},828941:(e,t,r)=>{r.d(t,{W:()=>a});var i,n=r(324586),o=r(776016),s=r(397814);class a extends s.L{constructor(e){super(),(0,n.A)(this,"payload",void 0),this.payload={error:e}}}i=a,(0,n.A)(a,"type","[Auth] Sign In with Microsoft Failed"),(0,n.A)(a,"isInstance",(0,o.t9)({type:(0,o.u)(i.type),payload:(0,o.t9)({error:o.Kg})}))},834486:(e,t,r)=>{r.d(t,{z:()=>l});var i,n=r(324586),o=r(776016),s=r(397814);const a=(0,o.t9)({accountId:(0,o.H7)(o.Kg),loginHint:(0,o.H7)(o.Kg)}),c=(0,o.t9)({fallbackAccounts:(0,o.gH)((0,o.H7)((0,o._j)(a)))});class l extends s.L{constructor(e=void 0){super(),(0,n.A)(this,"payload",void 0),this.payload={fallbackAccounts:e}}}i=l,(0,n.A)(l,"type","[Auth] Sign In with Microsoft with AAD Attempted"),(0,n.A)(l,"isInstance",(0,o.t9)({type:(0,o.u)(i.type),payload:(0,o.H7)(c)}))},795586:(e,t,r)=>{r.d(t,{I:()=>a});var i,n=r(324586),o=r(776016),s=r(397814);class a extends s.L{constructor(e,t){super(),(0,n.A)(this,"payload",void 0),this.payload={accessToken:e,idToken:t}}}i=a,(0,n.A)(a,"type","[Auth] Signed In with Microsoft"),(0,n.A)(a,"isInstance",(0,o.t9)({type:(0,o.u)(i.type),payload:(0,o.t9)({accessToken:o.Kg,idToken:(0,o.H7)(o.Kg)})}))},615535:(e,t,r)=>{r.d(t,{B:()=>a});var i,n=r(324586),o=r(776016),s=r(397814);class a extends s.L{constructor(){super()}}i=a,(0,n.A)(a,"type","[Infrastructure] Uri Launched"),(0,n.A)(a,"isInstance",(0,o.t9)({type:(0,o.u)(i.type)}))},99129:(e,t,r)=>{r.d(t,{j:()=>y,v:()=>w});var i,n=r(324586),o=r(825702),s=r(889688),a=r(739367),c=r(573340),l=r(847269),d=r(552740),u=(r(584570),r(82265),r(988124),r(776016)),h=r(397814);class p extends h.L{constructor(e){super(),(0,n.A)(this,"payload",void 0),this.payload={targetUri:e}}}i=p,(0,n.A)(p,"type","[Infrastructure] Web App Navigate"),(0,n.A)(p,"isInstance",(0,u.t9)({type:(0,u.u)(i.type),payload:(0,u.t9)({targetUri:u.Kg})}));var m,f=r(441910);const g=[(0,o.Gr)()(m=class extends f.r{static get messageType(){return p}handle(e){const t=new URL(e.payload.targetUri);t.origin===window.location.origin?window.location.href=e.payload.targetUri:c.Vy.error("Invalid target URL, unmatched origin",{browserUrl:window.location.origin,targetUrl:t.origin})}})||m];var A,v=r(272908);let y=(0,o.Gr)()(A=function(e){return(0,o.WQ)(d.T)(e,void 0,0)}((b=A=Reflect.metadata("design:type",Function)(A=Reflect.metadata("design:paramtypes",[void 0===d.T?Object:d.T,void 0===v.e?Object:v.e])(A=class{constructor(e,t){(0,n.A)(this,"listeners",new Map),(0,n.A)(this,"allowedMessageTypesWhenAppOutdated",[]),this.appVariantChecker=e,this.nativeAppCapabilitiesService=t}init(e=[],t=[]){if(window.clipchampWebApp={},this.setupGlobalListeners(e),this.allowedMessageTypesWhenAppOutdated=t,!0===this.nativeAppCapabilitiesService.capabilities?.gwy__post_web_message_as_json)return(0,l.iY)(window.chrome?.webview,"Expected the app to be in a WebView2 container"),void window.chrome.webview.addEventListener("message",(e=>{this.handleMessage(e.data).catch(c.Vy.error)}));window.clipchampWebApp.postMessage=e=>{try{if(!e)return;const t=JSON.parse(e);this.handleMessage(t).catch(c.Vy.error)}catch(e){c.Vy.error(e)}}}setupGlobalListeners(e){const t=[...g,...e];for(const e of t)this.listen(e.messageType,e)}listen(e,t){const r=this.listeners.get(e);return r?this.listeners.set(e,[...r,t]):this.listeners.set(e,[t]),()=>{const r=this.listeners.get(e);r&&this.listeners.set(e,r.filter((e=>e!==t)))}}send(e){if(this.shouldStopProcessing(e))return void c.Vy.log(`Stopped sending message of type ${e.type} to outdate native app - type not allowed`);(0,l.iY)(window.chrome?.webview,"Expected the app to be in a WebView2 container");const t=JSON.stringify(e);window.chrome.webview.postMessage(t)}async handleMessage(e){if(this.shouldStopProcessing(e))c.Vy.log("Stopped processing received message from outdate native app - type not allowed");else for(const[t,r]of this.listeners.entries())if(t.isInstance(e)){const t=r.map((async t=>{this.isListenerConstructor(t)?await(0,s.W)(t).handle(e):await t(e)}));try{await Promise.all(t)}catch(e){c.Vy.error(e)}return}}isListenerConstructor(e){return!(!("messageType"in e)||!e.messageType)}shouldStopProcessing(e){if(this.appVariantChecker.outside(["windows-native","outdated"]))return!1;for(const t of this.allowedMessageTypesWhenAppOutdated)if(t.isInstance(e))return!1;return!0}})||A)||A,A=(0,o.WQ)(v.e)(b,void 0,1)||A))||A)||A;var b;function w(){return(0,a.l)(y)}},901627:(e,t,r)=>{r.d(t,{d:()=>h,p:()=>u}),r(379321);var i=r(26985),n=r(179315),o=r(422226),s=r(272908),a=r(677252),c=r(908860),l=r(615535),d=r(99129);const u=()=>{const e=(0,d.v)(),t=(0,s.M)(),r=!0===t?.gwy__launch_uri,i=(0,o.Z)(((t,i,n,o)=>{if(!r)return;const s=[];s.push(e.listen(l.B,(e=>{s.forEach((e=>e())),n&&n(e)})),e.listen(c.p,(e=>{s.forEach((e=>e())),o&&o(e)}))),e.send(new a.Q(t,i))}));return{canLaunchUri:r,launchUri:i}};function h(){const e=(0,s.M)(),t=(0,d.v)(),r=(0,n.U7)("ks_gwy__use_launch_uri"),o=!0===e?.gwy__launch_uri,{launchUri:h}=u(),p=(0,i.useCallback)(((e,r,i,n)=>{if(!o)return window.open(e,r),void(i&&i(new l.B));const s=[];s.push(t.listen(c.p,(e=>{s.forEach((e=>e())),n&&n(e)})),t.listen(l.B,(e=>{s.forEach((e=>e())),i&&i(e)}))),t.send(new a.Q(e))}),[t,o]),m=(0,i.useCallback)(((e,t,r,i)=>{if(!o)return window.open(e,t),void(r&&r(new l.B));h(e,void 0,r,i)}),[o,h]);return r?p:m}},980493:(e,t,r)=>{r.d(t,{zp:()=>a});var i,n=r(324586),o=(r(584570),r(82265),r(988124),r(825702));const s=["twa","chrome-os-twa","windows-twa"];let a=(0,o.Gr)()(i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[])(i=class{constructor(){(0,n.A)(this,"slug",void 0);const e=this.detectQueryString()||this.detectReferrer()||this.detectSession();e&&this.setSlugBySource(e)}detectSession(){return sessionStorage.getItem("utm_source")}detectQueryString(){return new URLSearchParams(window.location.search).get("utm_source")}detectReferrer(){return"app-info://platform/microsoft-store"===document.referrer?"windows-twa":null}isTWASlug(e){return s.includes(e)}get isTWA(){return!!this.slug}get isWindows(){return"windows-twa"===this.slug}get isChromeOS(){return"twa"===this.slug||"chrome-os-twa"===this.slug}setSlugBySource(e){this.isTWASlug(e)&&(this.slug=e,sessionStorage.setItem("utm_source",e))}})||i)||i)||i},667596:(e,t,r)=>{r.d(t,{DQ:()=>d,ES:()=>h,bb:()=>u,zD:()=>l}),r(379321);var i=r(138615),n=r(573340),o=r(553191),s=r(776016),a=r(650882);const c=(0,s.t9)({message:s.Kg});function l(e){var t;return function(e){const t=[...o.Up],r=t.map((e=>e.toLowerCase())),i=e.map((e=>e.toLowerCase())),n=[];for(const e of i){const i=r.indexOf(e);if(-1===i)continue;const o=t[i];n.push(o)}return n}((t=e,(0,s.O9)(t)?t.split(",").map((e=>e.trim())):[]))}function d(e=function(){return l(function(){try{const e=(0,i.gZ)("wal__unlisted_languages",s.Kg);if(!(0,s.O9)(e))return;return e}catch(e){let t;return c(e)&&(t=e.message),void n.Vy.error("Unlisted values is misconfigured",{message:t})}}())}()){return(0,o.Fh)(...e)}class u extends a.g9{constructor(e){super("Unlisted Language attempting to be accessed",{lang:e})}}function h(e){return d().includes(e)}},700227:(e,t,r)=>{r.d(t,{S:()=>l,q:()=>d});var i=r(251260),n=r(798708),o=r(530598),s=r(343314);const a=new i.m,c=new i.m;function l(e){a.next(e)}function d(e){const t=a.asObservable().pipe((0,n.s)((e=>"show"===e.status?(0,o.Y)(0):(0,o.Y)(10))),(0,s.Q)(c.asObservable())).subscribe((t=>{if("hide"===t.status)e.onHide();else{const{loadingText:r,hideFromFullstory:i=!1}=t;e.onShow(r,i)}}));return()=>{t.unsubscribe()}}},411148:(e,t,r)=>{r.d(t,{H:()=>o});var i=r(26985),n=r(700227);const o=({loadingText:e,hideFromFullstory:t=!1})=>{var r;return r={status:"show",loadingText:e,hideFromFullstory:t},(0,i.useEffect)((()=>((0,n.S)(r),()=>{(0,n.S)({status:"hide"})})),[r]),null}},311535:(e,t,r)=>{r.d(t,{TL:()=>o,jB:()=>s});var i=r(324586);const n=["off","error","warn","info","debug"],o="error";class s{constructor(e={}){(0,i.A)(this,"getTagLevelsCopy",(()=>({...this.tagLevels}))),(0,i.A)(this,"setTagLevels",(e=>{this.tagLevels=e})),(0,i.A)(this,"debug",((e,...t)=>{this.shouldLog(e,"debug")})),(0,i.A)(this,"info",((e,...t)=>{this.shouldLog(e,"info")})),(0,i.A)(this,"warn",((e,...t)=>{this.shouldLog(e,"warn")&&console.warn(...t)})),(0,i.A)(this,"error",((e,...t)=>{this.shouldLog(e,"error")&&console.error(...t)})),(0,i.A)(this,"shouldLog",((e,t)=>{return r=t,i=this.tagLevels[e]??o,n.indexOf(r)<=n.indexOf(i);var r,i})),this.tagLevels=e}}},573340:(e,t,r)=>{r.d(t,{Vy:()=>n,su:()=>o});var i=r(311535);const n=new(r(19770).U),o=new i.jB},562151:(e,t,r)=>{r.d(t,{D:()=>i});const i=2*Math.PI},463716:(e,t,r)=>{r.d(t,{d:()=>o});var i,n=r(324586);class o{static rotate(e){const t=Math.cos(e),r=Math.sin(e);return new o([t,-r,0,r,t,0,0,0,1])}static scale(e,t){return new o([e,0,0,0,t,0,0,0,1])}static shear(e,t){return new o([1,t,0,e,1,0,0,0,1])}static translate(e,t){return new o([1,0,e,0,1,t,0,0,1])}constructor(e){this.m=e}add(e){return new o([this.m[0]+e.m[0],this.m[1]+e.m[1],this.m[2]+e.m[2],this.m[3]+e.m[3],this.m[4]+e.m[4],this.m[5]+e.m[5],this.m[6]+e.m[6],this.m[7]+e.m[7],this.m[8]+e.m[8]])}apply2(e){return[this.m[0]*e[0]+this.m[1]*e[1]+this.m[2],this.m[3]*e[0]+this.m[4]*e[1]+this.m[5]]}apply3(e){return[this.m[0]*e[0]+this.m[1]*e[1]+this.m[2]*e[2],this.m[3]*e[0]+this.m[4]*e[1]+this.m[5]*e[2],this.m[6]*e[0]+this.m[7]*e[1]+this.m[8]*e[2]]}equals(e){if(e.m===this.m)return!0;for(let t=0;t<this.m.length;t++)if(e.m[t]!==this.m[t])return!1;return!0}multiply(e){const t=this.m,r=e.m,i=t[0],n=t[1],s=t[2],a=t[3],c=t[4],l=t[5],d=t[6],u=t[7],h=t[8],p=r[0],m=r[1],f=r[2],g=r[3],A=r[4],v=r[5],y=r[6],b=r[7],w=r[8];return new o([p*i+m*a+f*d,p*n+m*c+f*u,p*s+m*l+f*h,g*i+A*a+v*d,g*n+A*c+v*u,g*s+A*l+v*h,y*i+b*a+w*d,y*n+b*c+w*u,y*s+b*l+w*h])}}i=o,(0,n.A)(o,"identity",new i([1,0,0,0,1,0,0,0,1]))},476636:(e,t,r)=>{r.d(t,{Z:()=>i});class i{static max(...e){return new i(Math.max(...e.map((e=>e.x))),Math.max(...e.map((e=>e.y))))}static min(...e){return new i(Math.min(...e.map((e=>e.x))),Math.min(...e.map((e=>e.y))))}constructor(e,t){this.x=e,this.y=t}add(e){return"number"==typeof e?new i(this.x+e,this.y+e):new i(this.x+e.x,this.y+e.y)}sub(e){return"number"==typeof e?new i(this.x-e,this.y-e):new i(this.x-e.x,this.y-e.y)}mul(e){return"number"==typeof e?new i(this.x*e,this.y*e):new i(this.x*e.x,this.y*e.y)}div(e){return"number"==typeof e?new i(this.x/e,this.y/e):new i(this.x/e.x,this.y/e.y)}floor(){return new i(Math.floor(this.x),Math.floor(this.y))}ceil(){return new i(Math.ceil(this.x),Math.ceil(this.y))}negate(){return new i(-this.x,-this.y)}rotate(e){return new i(this.x*Math.cos(e)-this.y*Math.sin(e),this.x*Math.sin(e)+this.y*Math.cos(e))}round(){return new i(Math.round(this.x),Math.round(this.y))}withX(e){return new i(e,this.y)}withY(e){return new i(this.x,e)}norm(){return Math.hypot(this.x,this.y)}dot(e){return this.x*e.x+this.y*e.y}distance(e){return e.sub(this).norm()}normalize(){const e=this.norm();return new i(this.x/e,this.y/e)}asTuple(){return[this.x,this.y]}}},956502:(e,t,r)=>{r.d(t,{z:()=>i});const i=(e,t)=>(e%t+t)%t},869211:(e,t,r)=>{r.d(t,{Qq:()=>c,nv:()=>a,sc:()=>l,tR:()=>s,y:()=>o});var i=r(476636);const n=Math.PI/180;function o(e,t){const r=new i.Z(e.x/2,e.y/2).rotate(t),n=new i.Z(e.x/2,-e.y/2).rotate(t),o=new i.Z(-e.x/2,-e.y/2).rotate(t),s=new i.Z(-e.x/2,e.y/2).rotate(t),a=i.Z.min(r,n,o,s);return i.Z.max(r,n,o,s).sub(a)}function s(e){return e*n}function a(e){return e/n}function c(e,t,r){return e>=t&&e<r}function l(e){return[e[0]/255,e[1]/255,e[2]/255,e[3]]}},986549:(e,t,r)=>{r.d(t,{Z5:()=>g,rV:()=>f,FX:()=>p,z7:()=>m});var i=r(781828),n=r(961722),o=r(324586);r(584570),r(82265),r(988124);let s=function(e){return e[e.Off=0]="Off",e[e.SkypeNS=1]="SkypeNS",e[e.SkypeAEC=2]="SkypeAEC",e[e.SkypeVQE=3]="SkypeVQE",e[e.DeepNS=4]="DeepNS",e[e.DeepVQE=5]="DeepVQE",e}({}),a=function(e){return e[e.Default=0]="Default",e[e.LongRangeSpeaker=1]="LongRangeSpeaker",e[e.Auditorium=2]="Auditorium",e}({}),c=function(e){return e[e.P2P=0]="P2P",e[e.Conference=1]="Conference",e[e.PSTN=2]="PSTN",e[e.BroadcastingConf=2]="BroadcastingConf",e}({}),l=function(e){return e[e.Normal=0]="Normal",e[e.Soc=1]="Soc",e[e.Mobile=2]="Mobile",e[e.NoisyTimestamps=3]="NoisyTimestamps",e}({});const d=async e=>{const t=new URL(r(149677),r.b);try{await e.audioWorklet.addModule(t.href)}catch(e){console.error("Failed to add worklet module",e)}};class u{constructor(e){(0,o.A)(this,"audioContext",void 0),(0,o.A)(this,"source",null),(0,o.A)(this,"effectNode",null),(0,o.A)(this,"vqeConfig",{enableAec:!0,enableVqe:!0,backgroundMode:!1,performanceThresholdMs:10,defaultVqeMode:s.DeepNS,performanceWindowDurationSecs:20,callType:c.Conference,audioUsageMode:a.Default,performanceProfile:l.Normal}),this.audioContext=e}async init(e){await d(this.audioContext),e&&(this.vqeConfig={...this.vqeConfig,...e})}async applyEffect(e,t){return this.source=new AudioBufferSourceNode(t,{buffer:e}),await d(t),this.effectNode=new AudioWorkletNode(t,"vqe-processor",{numberOfInputs:2,processorOptions:{sampleRateHz:t.sampleRate,vqeConfig:this.vqeConfig}}),this.source.connect(this.effectNode),this.effectNode.connect(t.destination),await(()=>new Promise((e=>{if(!this.effectNode)throw new Error("effectNode is null");this.effectNode.port.onmessage=t=>{"started"===t.data.cmd&&e()},this.effectNode.port.postMessage({cmd:"start"})})))(),this.source.start(),await t.startRendering()}}class h{handleGeneration(e,t){if(!e)throw new Error("No file provided for noise removal");return async function(e){const t=new AudioContext,r=await e.arrayBuffer();return await t.decodeAudioData(r)}(e).then((e=>(async e=>{const t=16e3,r=await(async(e,t)=>{const r=new OfflineAudioContext(e.numberOfChannels,e.duration*t,t),i=r.createBufferSource();return i.buffer=e,i.connect(r.destination),i.start(0),await r.startRendering()})(e,t),i=new OfflineAudioContext(r.numberOfChannels,r.duration*t,t),o=new u(i);await o.init();const s=await o.applyEffect(r,i),a=(0,n.I7)(s);return new Blob([a],{type:"audio/wav"})})(e).then((e=>new File([e],"noise-removed.wav"))))).catch((e=>{throw console.error(e),new Error("Failed to remove noise from audio buffer")}))}config(){return Promise.resolve({type:"voice-isolation"})}}async function p(e){let t;try{t=await(0,i.ii)(e,new h)}catch(e){throw console.error(e),new Error("Failed to remove noise from track item")}return t}function m(e){(0,i.VB)(e,h)}function f(e){return(0,i.h0)(e,h)}const g={match:function(e){return"voice-isolation"===e.type},create:()=>new h}},571511:(e,t,r)=>{r.d(t,{S:()=>i});class i extends Error{constructor(e){super(e)}}},505541:(e,t,r)=>{r.d(t,{rj:()=>k,gM:()=>E,h8:()=>R});var i=r(324586),n=(r(379321),r(95732),r(825702)),o=r(706558),s=r(138615),a=r(889688),c=r(739367),l=r(655882),d=r(225304),u=r(549443),h=r(847269),p=r(571511);const m=e=>({Application:"Clipchamp",Scenario:e.scenarioName,ScenarioType:e.scenarioType});class f{constructor(e){this.queryClient=e}async runQuery(e,t,r,i){const n={useCache:!1,clearCache:!1,...i};if(!1===n.useCache||(0,s.Us)("ks_multi__graph_api_cache")){const e=await t();return await r(e)}return!0===n.clearCache&&await this.clearQuery(e),this.queryClient.fetchQuery({queryKey:[e],queryFn:async()=>{const e=await t();return await r(e)},staleTime:6e5})}clearQuery(e){return this.queryClient.invalidateQueries({queryKey:[e],refetchType:"none"})}}var g,A=r(399803),v=r(58767);const y={Prefer:"return=minimal"},b=e=>"root"===e?"root":`items/${e}`,w="getMe",x="getDriveItemChildren",S="getDriveItemChildrenWithFilter",T="getDriveItemChildrenWithSearch",C="downloadDriveItemChunk",_="createDriveItem",k="graphApiFileService";let E=(I=g=Reflect.metadata("design:type",Function)(g=Reflect.metadata("design:paramtypes",[void 0===l.E?Object:l.E])(g=class extends f{constructor(e){super(e),(0,i.A)(this,"invalidCharacters",'"*:<>?/\\|'),(0,i.A)(this,"currentUser",void 0)}async fetchFileContents(e,t,r={scenarioName:"OpenFile",scenarioType:"PO"},i={}){const n=`/drives/${e.parentReference.driveId}/${b(e.id)}/content`;return this.runQuery(n,(()=>(0,u.K4)().get(n,{headers:m(r),extraData:{resourceId:"getDriveItemContents",excludeHeaders:this.graphExcludeHeaders},...i})),t,i)}async fetchFileMetadata(e,t,r={scenarioName:"GetMetaDataFile",scenarioType:"PO"},i={}){const n=`/drives/${e.parentReference.driveId}/${b(e.id)}?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime,media,edits${this.graphItemExpandedFields}`;return this.runQuery(n,(()=>(0,u.K4)().get(n,{headers:m(r),extraData:{resourceId:"getDriveItemMetadata",excludeHeaders:this.graphExcludeHeaders},...i})),t,i)}async readFileContentsAsJson(e,t,r={scenarioName:"OpenFile",scenarioType:"PO"},i={}){return await this.fetchFileContents(e,(e=>e.json(t)),r,i)}async readFileContentsAsString(e,t={scenarioName:"OpenFile",scenarioType:"PO"},r={}){return await this.fetchFileContents(e,(e=>e.text()),t,r)}async readFileContentsAsBlob(e,t={scenarioName:"OpenFile",scenarioType:"PO"},r={}){return await this.fetchFileContents(e,(e=>e.blob()),t,r)}readFileMetadata(e,t={scenarioName:"GetMetaDataFile",scenarioType:"PO"},r={}){return this.fetchFileMetadata(e,(e=>e.json(A.Qj)),t,r)}readProjectFolderMetadata(e,t={scenarioName:"GetMetaDataFile",scenarioType:"PO"},r={}){return this.fetchFileMetadata(e,(e=>e.json(A.PP)),t,r)}async readFilePermissions(e,t={scenarioName:"GetMetaDataFile_Permissions",scenarioType:"PO"},r={}){const i=`/drives/${e.parentReference.driveId}/${b(e.id)}/permissions`;return await this.runQuery(i,(()=>(0,u.K4)().get(i,{headers:m(t),extraData:{resourceId:"getDriveItemPermissions",excludeHeaders:this.graphExcludeHeaders},...r})),(e=>e.json(A.E7)),r)}async searchFilesWithFilters(e,t,r,i={}){const n=`/drives/${e.driveId}/${b(e.parentId)}/children?$filter=${t}&select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime`;try{return await this.runQuery(n,(()=>(0,u.K4)().get(n,{headers:m(r),extraData:{resourceId:S,excludeHeaders:this.graphExcludeHeaders},...i})),(e=>e.json(A.Ij)),i)}catch(e){if(e instanceof d.j$&&404===e.status)return;throw e}}async searchDriveItemsWithFilters(e,t,r={scenarioName:"GetMetaDataFile",scenarioType:"PO"},i={}){const n=`/drives/${e}/items?$filter=${t}`;return await this.runQuery(n,(()=>(0,u.K4)().get(n,{headers:m(r),extraData:{resourceId:S,excludeHeaders:this.graphExcludeHeaders},...i})),(e=>e.json(A.Ij)),i)}async findItemByName(e,t,r,i={}){const n=encodeURIComponent(t);if(!(0,s.Us)("ks_multi__graph_api_include_permissions")){const t=`/drives/${e.driveId}/${b(e.parentId)}:/${n}?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime${this.graphItemExpandedFields}`;try{return await this.runQuery(t,(()=>(0,u.K4)().get(t,{headers:m(r),extraData:{resourceId:"getDriveItemMetadataByPath",excludeHeaders:this.graphExcludeHeaders},...i})),(e=>e.json(A.Qj)),i)}catch(e){if(e instanceof d.j$&&404===e.status)return;throw e}}const o=n.replace("'","''"),a=`/drives/${e.driveId}/${b(e.parentId)}/children?$top=1&$filter=name eq '${o}'&select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime`,c=await this.runQuery(a,(()=>(0,u.K4)().get(a,{headers:m(r),extraData:{resourceId:T,excludeHeaders:this.graphExcludeHeaders},...i})),(e=>e.json(A.Ij)),i);let l;return c.value.length>0&&(l=c.value[0]),l}findBaseItemById(e,t,r={scenarioName:"GetMetaDataFile",scenarioType:"PO"},i={}){return this.fetchFileMetadata({parentReference:{driveId:e},id:t},(e=>e.json(A.PP)),r,i)}findItemById(e,t,r={scenarioName:"GetMetaDataFile",scenarioType:"PO"},i={}){return this.fetchFileMetadata({parentReference:{driveId:e},id:t},(e=>e.json(A.Qj)),r,i)}async searchDriveItemsWithFields(e,t,r,i,n={scenarioName:"GetMetaDataFile",scenarioType:"PO"},o=void 0,s={}){const a=encodeURIComponent(t),c=o||`/drives/${e}/search(q='${a}')?${r}`;return await this.runQuery(c,(()=>(0,u.K4)().get(c,{headers:m(n),extraData:{resourceId:T,excludeHeaders:this.graphExcludeHeaders},...s})),(e=>e.json(i)),s)}async searchItemsInDrive(e,t,r={scenarioName:"GetMetaDataFile",scenarioType:"PO"},i={}){const n=`/drives/${e}/search(q='${encodeURIComponent(t)}')?$select=id,name,webUrl,parentReference`;return await this.runQuery(n,(()=>(0,u.K4)().get(n,{headers:m(r),extraData:{resourceId:T,excludeHeaders:this.graphExcludeHeaders},...i})),(e=>e.json(A.Ij)),i)}async createItem(e,t,r={fileType:"file"},i,n={}){const o=`/drives/${e.driveId}/${b(e.parentId)}/children?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime${this.graphItemExpandedFields}`;if(!(0,s.Us)("ks_multi__graph_api_include_permissions")){const[e,s]=await Promise.all([(0,u.K4)().post(o,{headers:m(i),body:{name:t,description:r.fileDescription,[r.fileType]:{},"@microsoft.graph.conflictBehavior":r.conflictBehavior??"fail"},extraData:{resourceId:_,excludeHeaders:this.graphExcludeHeaders},...n}),this.getSignedInUser()]),a=await e.json(A.PP);return a.permissions=[{id:"",roles:["owner"],grantedTo:{user:{id:s.id,displayName:s.displayName,email:s.userPrincipalName}}}],a}const a=await(0,u.K4)().post(o,{headers:m(i),body:{name:t,description:r.fileDescription,[r.fileType]:{},"@microsoft.graph.conflictBehavior":r.conflictBehavior??"fail"},extraData:{resourceId:_,excludeHeaders:this.graphExcludeHeaders},...n}),c=await a.json(A.Bm);return(0,A.Qj)(c)?c:this.findBaseItemById(e.driveId,c.id,i)}async updateFile(e,t,r={scenarioName:"SaveFile",scenarioType:"PO"},i={}){const n=e.cTag?{"If-Match":e.cTag}:void 0,o={...m(r),...n},s=await(0,u.K4)().put(`/drives/${e.parentReference.driveId}/items/${e.id}/content?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime${this.graphItemExpandedFields}`,{body:t,headers:o,extraData:{resourceId:"updateDriveItemContent",excludeHeaders:this.graphExcludeHeaders},...i});return await s.json(A.Qj)}async createAndUploadFile(e,t,r,i={scenarioName:"SaveFile",scenarioType:"PO"},n={}){const o={...m(i)},s=`/drives/${e.driveId}/items/${e.parentId}:/${this.stripFilename(t)}:/content?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime${this.graphItemExpandedFields}`,[a,c]=await Promise.all([(0,u.K4)().put(s,{body:r,headers:o,extraData:{resourceId:_,excludeHeaders:this.graphExcludeHeaders},...n}),this.getSignedInUser()]),l=await a.json(A.PP);return l.permissions=[{id:"",roles:["owner"],grantedTo:{user:{id:c.id,displayName:c.displayName,email:c.userPrincipalName}}}],l}async createUploadSession(e,t,r="fail",i={scenarioName:"UploadFile",scenarioType:"PO"},n={},o=!1){const s=t?`/drives/${e.driveId}/${b(e.parentId)}:/${this.stripFilename(t)}:/createUploadSession`:`/drives/${e.driveId}/${b(e.parentId)}/createUploadSession`,a=t?"createUploadSessionWithPath":"createUploadSession",c=await(0,u.K4)().post(s,{body:{item:{"@microsoft.graph.conflictBehavior":r}},headers:{...m(i),...o?{Prefer:"autoTranscribe"}:{}},extraData:{resourceId:a},...n});return(await c.json(A.gt)).uploadUrl}async cancelUploadSession(e){await(0,u.K4)().delete(e,{extraData:{resourceId:"deleteUploadSession",excludeHeaders:this.graphExcludeHeaders}})}async uploadSmallFile(e,t,r,i="application/octet-stream",n="rename",o={scenarioName:"UploadFile",scenarioType:"PO"},s={},a=!1){const c=await(0,u.K4)().put(`/drives/${e.driveId}/${b(e.parentId)}:/${this.stripFilename(t)}:/content?@microsoft.graph.conflictBehavior=${n}&select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime${this.graphItemExpandedFields}`,{headers:{"Content-Type":i,...m(o),...a?{Prefer:"autoTranscribe"}:{}},body:r,extraData:{resourceId:"uploadDriveItem",excludeHeaders:this.graphExcludeHeaders},...s});return await c.json(A.Qj)}async resumableUpload(e,t,r,i,n,o={scenarioName:"UploadFile",scenarioType:"PO"},s={}){const a=`bytes ${t}-${r-1}/${i}`,c=`${e}${e.includes("?")?"&":"?"}select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime${this.graphItemExpandedFields}`,l=await(0,u.K4)().put(c,{headers:{"Content-Length":""+(r-t),"Content-Range":a,...m(o)},body:n,extraData:{resourceId:"uploadDriveItemChunk",excludeHeaders:this.graphExcludeHeaders},...s});if(200===l.status||201===l.status){const e=await l.json(A.hs);if(delete Object.assign(e,{"@microsoft.graph.downloadUrl":e["@content.downloadUrl"]})["@content.downloadUrl"],(0,A.Qj)(e))return e;throw new p.S("Uploaded drive item response is not of type ODSPDriveItem")}}async uploadProjectThumbnail(e,t){return(0,u.K4)().put(`/drive/items/${e}/thumbnails/0/source/content`,{headers:{"Content-Type":"application/octet-stream"},body:t,extraData:{resourceId:"createThumbnail",excludeHeaders:this.graphExcludeHeaders}})}async downloadInChunks(e,t,r,i={scenarioName:"DownloadFile",scenarioType:"PO"},n={}){const o=[];let s,a=0;for(;a<t;){const c=Math.min(a+5242880,t),l=await(0,u.K4)().get(e,{headers:{Range:`bytes=${a}-${c-1}`,...m(i)},extraData:{resourceId:C,excludeHeaders:this.graphExcludeHeaders},...n});if(s=l.status,206!==s)break;o.push(await l.blob()),a=c,r&&r(a/t)}return new Blob(o)}async downloadChunk(e,t,r={scenarioName:"DownloadFile",scenarioType:"PO"},i={}){const n=await(0,u.K4)().get(e,{headers:{Range:`bytes=${t.rangeStart}-${t.rangeEnd}`,...m(r),"Cache-Control":"no-cache"},extraData:{resourceId:C,excludeHeaders:this.graphExcludeHeaders},...i});return await n.blob()}async copyItem(e,t,r,i={scenarioName:"CopyFile_OneDrive",scenarioType:"PO"},n={}){const o=e.parentReference.driveId===t.driveId?"@microsoft.graph.conflictBehavior=rename":"",s=(await(0,u.K4)().post(`/drives/${e.parentReference.driveId}/items/${e.id}/copy?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime&${o}`,{headers:{Prefer:"bypass-shared-lock",...m(i)},body:{name:e.name,parentReference:{driveId:t.driveId,id:t.id}},extraData:{resourceId:"copyDriveItem",excludeHeaders:this.graphExcludeHeaders},...n})).headers.get("Location");if(!s)throw new Error(`Copy to Assets folder could not start for asset: ${e.name}`);let a,c=!1,l=!1;this.wait(3e5).then((()=>l=!0));do{if(a=await fetch(s,{headers:{...m(i)}}).then((async e=>await e.json())),"completed"===a.status||"failed"===a.status){if(c=!0,"failed"===a.status)throw new Error(`Copy to Assets folder failed for asset: ${e.name}`)}else await this.wait(1e3);r&&r(a.percentageComplete?a.percentageComplete/100:0)}while(!c&&!l);if(l)throw new Error(`Copy to Assets folder for asset: ${e.name} timed out after 300000ms`);return a.resourceId}wait(e){return new Promise((t=>{setTimeout(t,e)}))}async renameItem(e,t,r,i={scenarioName:"SaveFile_Metadata",scenarioType:"PO"},n={}){if(t===e.name)return e;const o=m(i),s=await(0,u.K4)().patch(`/drives/${e.parentReference.driveId}/items/${e.id}?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime${this.graphItemExpandedFields}`,{headers:o,body:{name:t,"@microsoft.graph.conflictBehavior":r||"rename"},extraData:{resourceId:"updateDriveItemMetadata",excludeHeaders:this.graphExcludeHeaders},...n});return await s.json(A.Qj)}async updateItemDescription(e,t,r,i={scenarioName:"SaveFile_Metadata",scenarioType:"PO"},n={}){let s,c;"consumer"===(0,a.W)(o.l).appName?(s=`/drives/${e}/items/${t}`,c={description:r.replaceAll("<","&lt;").replaceAll(">","&gt;")}):(s=`/drives/${e}/items/${t}/listItem/fields`,c={_ExtendedDescription:r.replaceAll("<","&lt;").replaceAll(">","&gt;")}),await(0,u.K4)().patch(s,{headers:{...m(i),...y},body:c,extraData:{resourceId:"updateDriveItemFields",excludeHeaders:this.graphExcludeHeaders},...n})}async deleteItem(e,t={scenarioName:"DeleteFile",scenarioType:"PO"},r={}){return(0,h.iY)(e.id,"DriveItemId not defined"),(await(0,u.K4)().delete(`/drives/${e.driveId}/items/${e.id}`,{headers:{...m(t),...y},extraData:{resourceId:"deleteDriveItem",excludeHeaders:this.graphExcludeHeaders},...r})).status}async fetchDrives(e,t={}){const r="/me/drives";return(await this.runQuery(r,(()=>(0,u.K4)().get(r,{headers:m(e),extraData:{resourceId:"getPersonalDrives",excludeHeaders:this.graphExcludeHeaders},...t})),(e=>e.json(A.xb)),t)).value}async fetchDriveRoot(e,t,r={}){const i=`/drives/${e}/root`;return await this.runQuery(i,(()=>(0,u.K4)().get(i,{headers:m(t),extraData:{resourceId:"getDriveRoot",excludeHeaders:this.graphExcludeHeaders},...r})),(e=>e.json(A.Ex)),r)}async fetchDefaultDrive(e,t={}){const r="/me/drive";return await this.runQuery(r,(()=>(0,u.K4)().get(r,{headers:m(e),extraData:{resourceId:"getPersonalDefaultDrive",excludeHeaders:this.graphExcludeHeaders},...t})),(e=>e.json(A.TC)),t)}async fetchDriveById(e,t,r={}){const i=`/drives/${e}`;return await this.runQuery(i,(()=>(0,u.K4)().get(i,{headers:m(t),extraData:{resourceId:"getDrive",excludeHeaders:this.graphExcludeHeaders},...r})),(e=>e.json(A.TC)),r)}async fetchDefaultDriveRoot(e,t={}){const r="/me/drive/root";return await this.runQuery(r,(()=>(0,u.K4)().get(r,{headers:m(e),extraData:{resourceId:"getPersonalDriveRoot",excludeHeaders:this.graphExcludeHeaders},...t})),(e=>e.json(A.Ex)),{useCache:(0,s.G7)("multi__graph_cache_special_folders"),...t})}async fetchSpecialFolder(e="approot",t,r={}){const i=`/me/drive/special/${e}?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime`;return await this.runQuery(i,(()=>(0,u.K4)().get(i,{headers:m(t),extraData:{resourceId:`getPersonalDriveFolder_${e}`,excludeHeaders:this.graphExcludeHeaders},...r})),(e=>e.json(A.Qj)),{useCache:(0,s.G7)("multi__graph_cache_special_folders"),...r})}async fetchItemChildren(e,t,r={}){const i=`/drives/${e.driveId}/items/${e.parentId}/children?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime`;return await this.runQuery(i,(()=>(0,u.K4)().get(i,{headers:m(t),extraData:{resourceId:x,excludeHeaders:this.graphExcludeHeaders},...r})),(e=>e.json(A.Ij)),r)}async getSignedInUser(e={useCache:!0}){if((0,s.Us)("ks_multi__user_fetch_select")){if(this.currentUser)return this.currentUser;const t="/me";return this.currentUser=await this.runQuery(t,(()=>(0,u.K4)().get(t,{extraData:{resourceId:w,excludeHeaders:this.graphExcludeHeaders},...e})),(e=>e.json(A.ak)),e),this.currentUser}const t="/me?$select=id,displayName,mail,preferredLanguage,givenName,surname,userPrincipalName";return await this.runQuery(t,(()=>(0,u.K4)().get(t,{extraData:{resourceId:w,excludeHeaders:this.graphExcludeHeaders},...e})),(e=>e.json(A.ak)),e)}async createShareLink(e,t,r={}){const i=`/drives/${e.parentReference.driveId}/items/${e.id}/createLink`;return(await this.runQuery(i,(()=>(0,u.K4)().post(i,{body:{type:"edit",scope:t},extraData:{resourceId:"createShareLink",excludeHeaders:this.graphExcludeHeaders},...r})),(e=>e.json(A._q)),r)).link.webUrl}async isDriveItemReadOnly(e,t){const r={id:t,parentReference:{driveId:e}},[i,n]=await Promise.all([this.readFilePermissions(r),this.getSignedInUser({useCache:!0})]);if(!(0,s.Us)("ks_multi__graph_api_include_permissions")){const e=(0,v.Oh)(i.value,n.id);return"owner"!==e&&"write"!==e}let o=!0;for(const e of i.value)if(e.roles.includes("write")||e.roles.includes("owner")&&e.grantedToV2?.user?.id===n.id){o=!1;break}return o}async getFileOwner(e,t={scenarioName:"GetMetaDataFile_Permissions",scenarioType:"PO"}){const r=(await this.readFilePermissions(e,t)).value.find((e=>e.roles.includes("owner")));if(!r)return;if(!(0,s.Us)("ks_multi__graph_api_include_permissions")){const e=(0,v.Bl)(r);return e.length>0?e[0]:void 0}const i=r?.grantedToV2??r?.grantedToIdentitiesV2?.[0];return i?.siteUser||i?.user}async getDriveItemForShareLink(e){const t="u!"+btoa(e).trimEnd().replaceAll("/","_").replaceAll("+","-"),r=await(0,u.K4)().get(`/shares/${t}/driveItem?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime&${this.graphItemExpandedFields}`,{extraData:{resourceId:"getDriveItemForShareLink",excludeHeaders:this.graphExcludeHeaders}});return await r.json(A.Qj)}async getSharedWithMeItems(e={scenarioName:"GetMetaDataFile",scenarioType:"PO"},t={}){const r="/me/drive/sharedWithMe?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime,remoteItem";return await this.runQuery(r,(()=>(0,u.K4)().get(r,{headers:m(e),extraData:{excludeHeaders:this.graphExcludeHeaders},...t})),(e=>e.json(A.j5)),t)}async getSharedItemChildren(e,t={scenarioName:"GetMetaDataFile",scenarioType:"PO"},r={}){const i=`/drives/${e.driveId}/items/${e.parentId}/children?select=id,name,webUrl,file,folder,root,parentReference,cTag,sharepointIds,size,lastModifiedBy,createdBy,@microsoft.graph.downloadUrl,@microsoft.graph.conflictBehavior,description,lastModifiedDateTime,remoteItem`;return await this.runQuery(i,(()=>(0,u.K4)().get(i,{headers:m(t),extraData:{resourceId:x,excludeHeaders:this.graphExcludeHeaders},...r})),(e=>e.json(A.Ij)),r)}stripFilename(e){const t=new RegExp(`[${this.invalidCharacters}]`,"g"),r=String.fromCharCode(92);return e.replace(t,"").replaceAll(r,"")}})||g)||g,(0,n.WQ)(l.E)(I,void 0,0)||g);var I;function R(){return(0,c.l)(k)}},399803:(e,t,r)=>{r.d(t,{Bm:()=>E,E7:()=>D,Ex:()=>_,Ij:()=>N,PP:()=>S,Qj:()=>C,TC:()=>F,_q:()=>j,ak:()=>O,gt:()=>M,hs:()=>k,j5:()=>z,s1:()=>I,vg:()=>n,xb:()=>P});var i=r(776016);const n={read:0,write:1,owner:2},o=Object.keys(n),s=(0,i.u)("personal","business","documentLibrary"),a=(0,i.u)("normal","nearing","critical","exceeded"),c={driveId:i.Kg,driveType:(0,i.H7)(s),id:(0,i.H7)(i.Kg)},l=(0,i.t9)(c),d=(0,i.t9)({...c,id:i.Kg,path:(0,i.H7)(i.Kg)}),u=(0,i.t9)({listId:i.Kg,listItemId:i.Kg,listItemUniqueId:i.Kg,siteId:i.Kg,siteUrl:i.Kg,tenantId:i.Kg,webId:i.Kg}),h=(0,i.t9)({id:(0,i.H7)(i.Kg),displayName:(0,i.H7)(i.Kg)}),p=(0,i.t9)({user:(0,i.H7)(h)}),m=(0,i.t9)({user:(0,i.H7)(h)}),f=(0,i.t9)({id:(0,i.H7)(i.Kg),displayName:i.Kg}),g=(0,i.t9)({type:(0,i.u)("view","review","edit","embed","blocksDownload","createOnly","addressBar","adminDefault"),scope:(0,i.H7)((0,i.u)("anonymous","organization","users","existingAccess")),webUrl:i.Kg,preventsDownload:(0,i.H7)(i.Lm)}),A=(0,i.t9)({user:(0,i.H7)(f),siteUser:(0,i.H7)(f),group:(0,i.H7)(f)}),v=(0,i.t9)({id:i.Kg,roles:(0,i._j)((0,i.u)(...o)),link:(0,i.H7)(g),grantedTo:(0,i.H7)(A),grantedToIdentities:(0,i.H7)((0,i._j)(A)),grantedToV2:(0,i.H7)(A),grantedToIdentitiesV2:(0,i.H7)((0,i._j)(A))}),y=(0,i.t9)({startFlicks:i.Et,endFlicks:i.Et}),b=(0,i.t9)({hiddenSections:(0,i.H7)((0,i._j)(y))}),w=(0,i.t9)({edits:(0,i.H7)(b)}),x={id:i.Kg,name:i.Kg,webUrl:(0,i.H7)(i.Kg),webDavUrl:(0,i.H7)(i.Kg),parentReference:l,permissions:(0,i.H7)((0,i._j)(v))},S=(0,i.t9)(x),T=(0,i.t9)({id:i.Kg,large:(0,i.t9)({url:i.Kg}),medium:(0,i.t9)({url:i.Kg}),small:(0,i.t9)({url:i.Kg})}),C=(0,i.t9)({...x,parentReference:d,cTag:(0,i.H7)(i.Kg),sharepointIds:(0,i.H7)(u),"@microsoft.graph.downloadUrl":(0,i.H7)(i.Kg),lastModifiedBy:(0,i.H7)(p),createdBy:(0,i.H7)(m),permissions:(0,i.H7)((0,i._j)(v)),media:(0,i.H7)(w),lastModifiedDateTime:(0,i.H7)(i.Kg),thumbnails:(0,i.H7)((0,i._j)(T))}),_=((0,i.t9)({...x,sharepointIds:u,parentReference:d,file:i.Gv}),(0,i.t9)({...x,sharepointIds:(0,i.H7)(u),folder:i.Gv}),(0,i.t9)({...x,folder:i.Gv,root:i.Gv})),k=(0,i.t9)({id:i.Kg,name:i.Kg,cTag:(0,i.H7)(i.Kg),parentReference:d,sharepointIds:(0,i.H7)(u),"@content.downloadUrl":(0,i.H7)(i.Kg)}),E=(0,i.t9)({id:i.Kg,name:i.Kg,cTag:(0,i.H7)(i.Kg),parentReference:d,"@microsoft.graph.downloadUrl":(0,i.H7)(i.Kg)}),I=(0,i.t9)({id:i.Kg,name:i.Kg,cTag:(0,i.H7)(i.Kg),parentReference:d,sharepointIds:(0,i.H7)(u),size:i.Et,"@microsoft.graph.downloadUrl":i.Kg}),R=((0,i.t9)({...x,"@sharePoint.endpoint":(0,i.H7)(i.Kg),"@sharePoint.embedUrl":(0,i.H7)(i.Kg),"@sharePoint.listUrl":(0,i.H7)(i.Kg)}),(0,i.t9)({deleted:i.Et,remaining:i.Et,state:a,total:i.Et,used:i.Et})),F=(0,i.t9)({id:i.Kg,webUrl:(0,i.H7)(i.Kg),driveType:(0,i.H7)(s),quota:R,owner:A}),P=(0,i.t9)({value:(0,i._j)(F)}),L=(0,i.t9)({id:i.Kg,webUrl:(0,i.H7)(i.Kg),driveType:(0,i.H7)(s)}),N=((0,i.t9)({value:(0,i._j)(L)}),(0,i.t9)({value:(0,i._j)(C),"@odata.nextLink":(0,i.H7)(i.Kg)})),M=(0,i.t9)({uploadUrl:i.Kg}),B=(0,i.t9)({id:(0,i.H7)(i.Kg),displayName:i.Kg}),D=((0,i.t9)({value:(0,i._j)(B)}),(0,i.t9)({value:(0,i._j)(v)})),O=(0,i.t9)({id:i.Kg,displayName:i.Kg,mail:(0,i.gH)(i.Kg),preferredLanguage:(0,i.gH)(i.Kg),givenName:(0,i.gH)(i.Kg),surname:(0,i.gH)(i.Kg),userPrincipalName:i.Kg}),j=(0,i.t9)({id:i.Kg,hasPassword:i.Lm,roles:(0,i._j)(i.Kg),link:g,shareId:i.Kg}),U=((0,i.t9)({id:i.Kg,parentReference:l}),(0,i.t9)({...x,remoteItem:S})),z=(0,i.t9)({value:(0,i._j)(U)})},58767:(e,t,r)=>{r.d(t,{Bl:()=>o,Oh:()=>s}),r(379321);var i=r(138615),n=r(399803);function o(e){if(e.grantedToV2?.user)return[e.grantedToV2.user];if(e.grantedTo?.user)return[e.grantedTo.user];if(e.grantedToIdentitiesV2){const t=[];return e.grantedToIdentitiesV2.forEach((e=>e.user&&t.push(e.user))),t}if(e.grantedToIdentities){const t=[];return e.grantedToIdentities.forEach((e=>e.user&&t.push(e.user))),t}return[]}function s(e,t){const r=Array.isArray(e)?e:e.permissions;if(!r||0===r.length)return"read";const s=["read"];for(const e of r){const r=o(e);!(0,i.Us)("ks_multi__graph_api_permissions_assume_applicable")&&e.roles.includes("write")&&s.push("write"),(r.some((e=>e.id===t))||e.link)&&s.push(...e.roles)}return[...s].sort(((e,t)=>n.vg[e]<n.vg[t]?1:-1))[0]}},476807:(e,t,r)=>{function i(e){return"raw"===e.type?e.timestampSeconds:(e.data.timestamp??0)/1e6}function n(e){return"raw"===e.type?e.data.buffer:void 0}function o(e){return"raw"===e.type?{width:e.width,height:e.height}:{width:e.data.displayWidth,height:e.data.displayHeight}}function s(e){"webcodec"===e?.type&&e.data.close()}r.d(t,{KD:()=>s,tm:()=>o,v1:()=>i,vq:()=>n})},941750:(e,t,r)=>{r.d(t,{Ng:()=>i});let i=function(e){return e[e.Yuv420P=0]="Yuv420P",e[e.Yuva420P=33]="Yuva420P",e}({})},964469:(e,t,r)=>{r.d(t,{GI:()=>a,Iv:()=>x,Tj:()=>u,Tw:()=>i,Vz:()=>h,W4:()=>A,ZA:()=>d,cY:()=>o,ch:()=>m,gl:()=>b,jY:()=>n,kY:()=>f,mw:()=>s,nq:()=>c,pd:()=>p,qF:()=>w,rC:()=>l,vX:()=>v,z_:()=>g,zb:()=>y});const i="BootstrapStarted",n="BootstrapCompleted",o="AppStarted",s="EditorLoaded",a="EditorReady",c="ServiceWorkerRegisterStarted",l="ServiceWorkerRegisterCompleted",d="ServiceWorkerInstallStarted",u="ServiceWorkerInstallCompeted",h="ServiceWorkerActivateStarted",p="ServiceWorkerActivateCompleted",m=`${n}${i}Delta`,f=`${o}${n}Delta`,g=`${o}${n}Delta`,A=`${a}${i}Delta`,v=`${a}${o}Delta`,y=`${a}${s}Delta`,b=`${l}${c}Delta`,w=`${u}${d}Delta`,x=`${p}${h}Delta`},439415:(e,t,r)=>{r.d(t,{$f:()=>a,BF:()=>o,hd:()=>s});var i=r(562229),n=r(964469);const o=(e=!0)=>{if(performance.getEntriesByName(n.cY,"mark").length>0)return;performance.mark(n.cY);const t=performance.measure(n.kY,n.jY,n.cY);e&&i.z.logAppLogicEvent("AppStarted",{timeSinceBootstrap:t.duration})},s=(e=!0)=>{if(performance.getEntriesByName(n.mw,"mark").length>0)return;performance.mark(n.mw);const t=performance.measure(n.z_,n.cY,n.mw);e&&i.z.logAppLogicEvent("EditorLoaded",{timeSinceAppLoad:t.duration})},a=(e=!0)=>{if(performance.getEntriesByName(n.GI,"mark").length>0)return;performance.mark(n.GI);const t=performance.measure(n.W4,n.Tw,n.GI),r=performance.measure(n.vX,n.cY,n.GI),o=performance.measure(n.zb,n.mw,n.GI);e&&i.z.logAppLogicEvent("EditorReady",{timeSinceBootstrap:t.duration,timeSinceAppLoad:r.duration,duration:o.duration})}},685421:(e,t,r)=>{r.d(t,{$t:()=>d,dk:()=>u});var i=r(44281),n=r(26985),o=r(508302),s=r(988658),a=r(277277);const c=e=>Math.random()<=Math.min(Math.max(0,e),1);function l({scenario:e,eventName:t,start:r,enabled:l=!0,sampleRate:d,onceOnly:u,callback:h}){const p=(0,n.useRef)(!1);return p.current||((0,i.A)((()=>{if(h)(()=>{if(!1===l||"function"==typeof l&&!l()||d&&!c(d))return;const i=(0,s.Lu)(e,t,r);h?.(i)})();else{const i=r??(0,s.rF)(e,t);void 0!==i&&(0,o.UQ)(e,t,i,l,d,u)}})),p.current=!0),(0,a.jsx)(a.Fragment,{})}function d(e,t,r,i,s){const c=(0,n.useRef)(!1),d=(0,n.useMemo)((()=>(0,o.Xq)(e,t,r,i,s)),[]),u=(0,n.useCallback)((()=>{c.current||(c.current=!0,d())}),[d]);return{MeasurePerformanceEnd:(0,n.useCallback)((({callback:n})=>c.current?(0,a.jsx)(a.Fragment,{}):(c.current=!0,(0,a.jsx)(l,{scenario:e,eventName:t,enabled:r,sampleRate:i,onceOnly:s,callback:n??d}))),[d]),logPerformanceEnd:u}}function u(e,t,r,i,s){(0,n.useMemo)((()=>(0,o.dX)(e,t,r,i,s)),[])}},941604:(e,t,r)=>{r.d(t,{G$:()=>c,GU:()=>a,X1:()=>l,lE:()=>s});var i=r(562229),n=r(138615),o=r(7089);function s(){const e=(0,o.u)(),t=`${e}Start`;return performance.mark(t),e}function a(e){const t=`${e}Start`,r=`${e}End`;return performance.mark(r),performance.measure(e,{start:t,end:r})}function c(e,t){const r=`${e}Start`,i=`${e}ImmediateEnd`;performance.mark(i);const n=performance.measure(e,{start:r,end:i});setTimeout((()=>{const i=`${e}End`;performance.mark(i);const o=performance.measure(e,{start:r,end:i});t(n,o)}))}function l(e,t,r,o="editor__user_action_metrics"){(0,n.G7)(o)&&c(e,((e,n)=>{const o=e.duration,s=n.duration,a={startTimeMs:e.startTime,durationMs:o,durationNextTickMs:s,...r};i.z.logUserActionEvent(t,a)}))}},508302:(e,t,r)=>{r.d(t,{UQ:()=>a,Xq:()=>c,dX:()=>s});var i=r(562229),n=r(988658);function o(e,t,r,o,s,a,c){if(("function"==typeof o?!o():!1===o)||("function"==typeof s?!s():!1===s))return;let l,d;if("number"==typeof r||"mark"===r?.entryType){let i;"function"==typeof o||"boolean"==typeof o?(i=r,d=s):i=o,l=(0,n.Lu)(e,t,r,i)}else"measure"===r?.entryType&&(l=r);l&&(d="number"==typeof a?a:d,c="boolean"==typeof a?a:c,i.z.logAppLogicEvent?.(e,{name:t,endTimeMs:l.startTime+l.duration,startTimeMs:l.startTime,durationMs:l.duration},void 0!==d?{sampleRate:d}:void 0!==c?{onceOnly:c}:void 0))}function s(e,t,r=!0,i,s){const a=(0,n.W7)(e,t);o(e,t,a,a,r,i,s)}function a(e,t,r,i=!0,s,a){o(e,t,r,(0,n.DI)(e,t),i,s,a)}function c(e,t,r=!0,i,o){const s=(0,n.W7)(e,t);return()=>a(e,t,s,r,i,o)}},988658:(e,t,r)=>{function i(e,t){return window.performance.mark(`${e}_${t}_start`)}function n(e,t){return window.performance.mark(`${e}_${t}_end`)}function o(e,t){const r=window.performance.getEntriesByName(`${e}_${t}_start`,"mark");return r.length>0?r.at(-1):void 0}function s(e,t,r,i){let n,s;if("number"==typeof r)n=r;else if(r)n=r.startTime;else{const r=o(e,t);if(!r)return;n=r.startTime}if("number"==typeof i)s=i;else if(i)s=i.startTime;else{const r=o(e,t);if(!r)return;s=r.startTime}return window.performance.measure(`${e}_${t}_measure`,{start:n,end:s})}r.d(t,{DI:()=>n,Lu:()=>s,W7:()=>i,rF:()=>o})},469223:(e,t,r)=>{r.d(t,{YT:()=>m,sh:()=>p});var i=r(544211),n=r(468314),o=r(824378),s=r(788855),a=r(613001),c=r(248142),l=r(650882),d=r(750585),u=r(149690),h=r(10960);class p{constructor(e,t){this.assets=e,this.mutability=t}getAssetByName(e,t){for(const r of Object.values(this.assets))if(r&&r.name===e&&r.type===t)return"mut"===this.mutability?new f(r):new m(r)}getAsset(e){const t=this.assets[e];if(t)return"mut"===this.mutability?new f(t):new m(t)}withAsset(e,t){const r=this.getAsset(e);if(r)return t(r)}getAssetUnchecked(e){const t=this.getAsset(e);if(!t)throw new l.g9("Tried to get asset unchecked but none exists",{assetId:e});return t}}class m{constructor(e){this.asset=e}get trackType(){if(!(0,i.x)(this.asset)&&!(0,n.S)(this.asset))return(0,h.vl)(this.asset)}isType(...e){return e.includes(this.type)}isAtomWithSegment(e){return"procedural"===this.asset.type&&(0,o.r)(this.asset.entities,e)}get hasFiniteLength(){return this.isType("video","audio")&&!this.assetLoops}get assetLoops(){return this.isType("video","audio")&&!!this.value.loop}get fields(){if(this.isType("title"))return this.asset.options.fields}get id(){return this.asset.id}get name(){return this.asset.name}get type(){return this.asset.type}get appearAsType(){return this.asset.appearAsType??this.asset.type}get value(){return this.asset}get duration(){if((0,s.K)(this.asset)&&(0,a.nr)(this.asset))return this.asset.metadata.duration;switch(this.appearAsType){case"overlay":return d.Op;case"image":return d.Dx;default:return d.Pr}}get entities(){if("procedural"===this.asset.type)return this.asset.entities}get extData(){return this.asset.extData}get analyses(){if((0,s.N)(this.value))return this.value.analyses}getCreationTime(){if(u.u.test(this.name))return(0,u.i)(this.name);if((0,s.N)(this.asset)){const e=this.asset.metadata.raw.format.tags?.creation_time;if(e)return new Date(e)}}getCreationOrModificationTime(){if((0,s.N)(this.asset)){const e=this.asset.metadata.raw.format.tags?.lastModified||this.asset.metadata.creationTime;if(e)return new Date(e)}}getCaptions(){return(0,c.or)(this.asset)}}class f extends m{setExtData(e,t){this.asset.extData={...this.asset.extData,[e]:t}}removeExtData(e){this.asset.extData&&delete this.asset.extData[e]}}},210864:(e,t,r)=>{function i(e){return e.metadata?.captions?.profanityFilter||!1}function n(e){return e.metadata?.captions?.recognitionLanguage}r.d(t,{H:()=>n,S:()=>i})},750585:(e,t,r)=>{r.d(t,{Dx:()=>p,Op:()=>m,Pr:()=>h,vI:()=>v,z2:()=>A});var i=r(279541),n=r(89495),o=r(327443),s=r(834533),a=r(644069),c=r(922557),l=r(776016),d=r(7089),u=r(689064);const h=5,p=4,m=1;function f(e,t){const r=(0,n.G)(e,"fillStage")||(0,o.no)(e)&&!(0,l.O9)(e.metadata.preferredHeight)?"fill":"freehand";let a;if("freehand"===r)a=(0,o.F_)(e)?(0,o.gD)(e,t):(0,s.GO)(e,t);else{const n=(0,i.m8)(e);a=(0,u.V3)(t,n,{strategy:r})}return{strategy:"freehand",hasFixedBounds:!0,...a?{bounds:a}:{}}}function g(e){const t=e.cloud?.provider;return!!t&&(0,a.KG)(t)}function A(e,t,r,i,n,o){return{id:(0,d.u)(),asset:e,trim:{from:0,to:0},speed:1,startTime:i,trackId:n,duration:o,rootEntity:t,componentHint:r}}function v(e,t,r,s,a){const l=a??("image"===e.type?p:h);let A;switch(e.type){case"video":A=function(e,t,r,i){const s=(0,o.F_)(e)&&(0,o.Fv)(e.format)&&e.metadata.duration<h,a=(0,n.G)(e,"blendMode"),c={...a&&{blendMode:a}};return{id:(0,d.u)(),asset:e,trim:{from:0,to:0},speed:1,startTime:t,trackId:r,transform:f(e,i),disableCaptions:g(e),duration:s?h:e.metadata.duration,...c}}(e,t,r,s);break;case"image":A=function(e,t,r,i,o){const s=(0,n.G)(e,"blendMode"),a={...s&&{blendMode:s}};return{id:(0,d.u)(),asset:e,trim:{from:0,to:0},speed:1,startTime:t,trackId:r,transform:f(e,o),duration:i,...a}}(e,t,r,l,s);break;case"audio":A=function(e,t,r){return{id:(0,d.u)(),asset:e,trim:{from:0,to:0},speed:1,startTime:t,trackId:r,volume:1,duration:e.metadata.duration,disableCaptions:g(e)}}(e,t,r);break;case"title":A=function(e,t,r,i){return i="overlay"===e.appearAsType?m:i,{id:(0,d.u)(),asset:e,trim:{from:0,to:0},speed:1,startTime:t,trackId:r,fields:e.defaultTrackItemFields??{},duration:i}}(e,t,r,l);break;case"background":A=function(e,t,r,i){return{id:(0,d.u)(),asset:e,trim:{from:0,to:0},speed:1,startTime:t,trackId:r,color:e.color,duration:i}}(e,t,r,l);break;case"procedural":A=function(e,t,r,i){return{id:(0,d.u)(),asset:e,trim:{from:0,to:0},speed:1,startTime:t,trackId:r,entities:e.entities.map((e=>({...e,id:(0,d.u)()}))),duration:i}}(e,t,r,l);break;default:throw new Error("Attempted to create Item from an unsupported Asset type - "+e.type)}return function(e,t){return"logo"===e.asset.appearAsType&&(0,c.n)(e)?function(e,t){const r=(0,i.Sk)(e);return{...e,transform:{hasFixedBounds:!1,...e.transform,strategy:"freehand",bounds:(0,u.V3)(t,r,{...e.transform,strategy:"auto-place",autoPlacement:"top-right"})}}}(e,t):e}(A,s)}},487115:(e,t,r)=>{r.d(t,{NU:()=>h,d3:()=>u,gO:()=>p,jg:()=>c});var i=r(908545),n=r(468314),o=r(776016);function s(e,t){const r=t[e.asset];if(!(0,n.S)(r))throw new Error("Transition is referencing an asset that is not of type transition");return{id:e.id,durationInS:e.durationInS,toId:e.toId,fromId:e.fromId,asset:r}}function a(e,t,r){return e.map((e=>e in t?s(t[e],r):void 0)).filter(o.O9)}function c({assetId:e,filters:t,transitionInId:r,transitionOutId:i,...n},a,c,l){return{...n,asset:c[e],filters:t?.map((e=>({filter:c[e.filterId],filterFields:e.filterFields}))).filter((e=>(0,o.O9)(e.filter))),transitionIn:r&&a[r]?s(a[r],c):void 0,transitionOut:i&&a[i]?s(a[i],c):void 0,trackId:l}}function l(e,t,r,i,n){return e.map((e=>e in t?c(t[e],r,i,n):void 0)).filter(o.O9)}function d(e){return Object.values(e.groups)}function u(e,t){return e.map((e=>e in t?t[e]:void 0)).filter(o.O9)}function h({items:e,...t},r,i,n,s){return{...t,createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt),assets:u(t.assets.allIds,r),tracks:(c=t.tracks.allIds,h=i,p=n,m=s,f=r,c.map(((e,t)=>e in h?function({itemIds:e,transitionIds:t,...r},i,n,o,s){return{...r,items:l(e,i,n,o,r.id),transitions:a(t,n,o),order:s}}(h[e],p,m,f,t):void 0)).filter(o.O9)),groups:d({...t,items:e})};var c,h,p,m,f}function p(e,t){if(e&&e.groups)return h(e,(0,i.n)(e.assets,t),e.tracks.byId,e.items.byId,e.items.transitions)}},444020:(e,t,r)=>{r.d(t,{O:()=>i});class i extends Error{constructor(e){super(`ProjectListenerError: ${e}`),this.errorType=e}}},149690:(e,t,r)=>{r.d(t,{i:()=>n,u:()=>i});const i=/(?<year>\d{4}).*?(?<month>\d{2}).*?(?<day>\d{2}).*?(?<hour>\d{2}).*?(?<minute>\d{2}).*?(?<second>\d{2}).*/;function n(e){if(i.test(e)){const t=i.exec(e)?.groups;if(!t)return;return new Date(Number.parseInt(t.year,10),Number.parseInt(t.month,10)-1,Number.parseInt(t.day,10),Number.parseInt(t.hour,10),Number.parseInt(t.minute,10),Number.parseInt(t.second,10))}}},139572:(e,t,r)=>{function i(e,t){const r=new Set;for(const n of e.tracks.allIds){const o=e.tracks.byId[n];if(o)for(const n of o.itemIds){const o=e.items.byId[n];o&&(t&&!t(o)||(o.fields?.logo&&(i=o.fields.logo,i?.id)?r.add(o.fields.logo.id):r.add(o.assetId)))}}var i;return[...r]}r.d(t,{k:()=>i}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997)},507243:(e,t,r)=>{r.d(t,{CC:()=>Te,DT:()=>ue,FM:()=>R,G7:()=>pe,Hc:()=>we,KN:()=>le,M3:()=>de,M9:()=>P,OP:()=>V,OZ:()=>_e,Qk:()=>te,R9:()=>B,Rg:()=>me,S6:()=>ke,So:()=>he,TO:()=>xe,UE:()=>X,Ul:()=>ae,WY:()=>J,Xh:()=>be,Z$:()=>M,ZH:()=>Se,_b:()=>Ee,ah:()=>O,at:()=>Ae,b2:()=>Q,bV:()=>U,bu:()=>G,c9:()=>E,d3:()=>ce,dR:()=>F,ee:()=>ge,fC:()=>L,gG:()=>Ce,gd:()=>_,ix:()=>Ie,jx:()=>ee,kF:()=>Y,ky:()=>I,lL:()=>k,m:()=>N,nE:()=>H,nN:()=>re,nh:()=>$,o9:()=>W,pW:()=>K,p_:()=>ie,pn:()=>z,q$:()=>oe,qf:()=>ve,sA:()=>Fe,vC:()=>Re,vM:()=>se,vg:()=>j,w3:()=>D,x:()=>ne,x_:()=>fe,zM:()=>q}),r(379321),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(26985),n=r(357891),o=r(562229),s=r(227565),a=r(138615),c=r(179315),l=r(889688),d=r(573340),u=r(345153),h=r(272885),p=r(468314),m=r(834533),f=r(36366),g=r(248142),A=r(623086),v=r(345762),y=r(345563),b=r(776016),w=r(650882),x=r(487115),S=r(139572),T=r(233721),C=r(474107);const _=u.By;function k(e){return _((t=>t[e]))}const E=(e=!0)=>_((t=>t.tracks.allIds.filter((r=>e||!t.tracks.byId[r].hidden))),n.x)??[],I=()=>_((e=>e.items.allIds.length)),R=e=>_((t=>{const r=[];for(const i of e){const e=t.items.byId[i];e&&r.push(e)}return r}),n.x)||[],F=e=>_((t=>{const r={};for(const i of e){const e=t.items.byId[i],n=e?.groupId;n&&(r[i]=n)}return r}),n.x),P=()=>k("id"),L=()=>k("aspectRatio"),N=()=>k("isCloudBackupEnabled"),M=()=>k("metadata")?.captions?.enabled||!1,B=()=>k("metadata")?.captions?.recognitionLanguage,D=()=>k("metadata")?.captions?.hideCaptionsInPreview||!1,O=()=>k("metadata")?.captions?.profanityFilter||!1,j=()=>k("metadata")?.captions?.hasCaptionSurveyBeenCompleted||!1,U=()=>{const e=k("createdAt");if(e)return new Date(e)},z=e=>_((t=>e?t.items.transitions[e]:void 0)),W=e=>_((t=>Object.values(t.items.transitions).filter((t=>e.includes(t.id)))),n.x);function V(){return _((e=>Object.keys(e.items.transitions)),n.x)}const H=e=>_((t=>e?t.tracks.byId[e]:void 0));function G(e){return(0,u.By)((t=>t.tracks.byId[e]?.type))}function q(e){return(0,u.By)((t=>t.tracks.byId[e]?.itemIds),n.x)??[]}const Q=()=>_((e=>Object.values(e.tracks.byId)),n.x)||[],K=e=>(0,u.U1)((t=>t.items.byId[e])),X=e=>(0,u.U1)((t=>t.tracks.byId[e])),Y=e=>_((t=>e?t.items.byId[e]:void 0)),Z=(e,t)=>{const r=e.assetId;if(r)return t.assets.byId[r]},J=e=>((e,t,r)=>(0,u.By)((r=>{if(!e)return;const i=r.items.byId[e];return i?t(i,r):void 0}),r))(e,Z,n.x),$=e=>_((t=>{const r=[];for(const i of Object.values(t.tracks.byId)){if(0===i.itemIds.length||!e&&i.hidden)continue;const n=i.itemIds.at(-1);n&&r.push(t.items.byId[n])}return r}),n.x)||[],ee=()=>_((e=>{const t=new Set(Object.values(e?.extData?.containers.data||{}).filter(T.u_).flatMap((e=>e.items)));return e.items.allIds.filter((e=>!t.has(e)))}),n.x),te=(e,t=!1)=>_((r=>{const i={};if(0!==e.length){for(const n of e){const e=Object.values(r.tracks.byId).find((e=>e.itemIds.includes(n)||t&&e.transitionIds.includes(n)))?.id;e&&(i[n]=e)}return i}}),n.x),re=e=>_((t=>e?t.tracks.allIds.indexOf(e):void 0)),ie=e=>{if(!e)return;const t=(0,u.U1)((t=>t.assets.byId[e])),r=h.Jq.getState().byId[e];return t||r},ne=e=>{const t=_((t=>e?t.assets.byId[e]:void 0)),r=(0,h.Jq)((t=>e?t.byId[e]:void 0));return(0,i.useMemo)((()=>t??r),[t,r])},oe=()=>_((e=>e.assets.byId)),se=()=>_((e=>(0,S.k)(e)),n.x)||[];function ae(e){return(0,u.By)((t=>{if(0!==e.length)return t.items.allIds.filter((t=>e.includes(t))).map((e=>t.items.byId[e].assetId))}),n.x)??[]}function ce(e){return(0,u.By)((t=>{if(0===e.length)return;const r=new Set(Object.values(t.items.transitions).filter((t=>e.includes(t.id))).map((e=>e.asset)));return Object.values(t.assets.byId).filter((e=>(0,p.S)(e)&&r.has(e.id)))}),n.x)??[]}const le=e=>{if(e)return(0,u.U1)((t=>t.entities?.[e]))},de=()=>_((e=>e.tracks.allIds.length>0))??!1;function ue(){return(0,u.U1)((e=>e))}function he(){return(0,x.gO)((0,u.U1)((e=>e)),(0,h.eS)())}function pe(){return ue}function me(){return he}const fe=()=>(0,u.By)((e=>(0,x.d3)(e.assets.allIds,e.assets.byId)),n.x)??[];function ge(){const e=se(),t=oe(),r=(0,h.Jq)((e=>e.byId));return(0,i.useMemo)((()=>{const i={...t,...r};return e.map((e=>i[e])).filter(b.O9)}),[e,t,r])}function Ae(){const e=se(),t=oe();return(0,i.useMemo)((()=>{const r=t??{};return Object.keys({...t}).filter((t=>!e.includes(t))).map((e=>r[e]))}),[e,t])}const ve=()=>ge().some((e=>(0,m.bg)(e)&&(e.metadata.width>1920||e.metadata.height>1920)));function ye(e){let t=0;return e.tracks.allIds.forEach((r=>{const i=e.tracks.byId[r];let n=0;i.itemIds.forEach((t=>{const i=e.items.byId[t];if(i){const e=i.startTime+i.duration;n=Math.max(e,n)}else d.Vy.error(new w.g9("Accessing non-existing track item",{hasProject:!!e,isInList:e.items.allIds.includes(t),isInObject:t in e.items.byId,isInTrack:e.tracks.byId[r].itemIds.includes(t)}))})),t=Math.max(n,t)})),t}const be=()=>_(ye),we=()=>_((e=>{for(const t of Object.values(e.items.byId)){const r=e.assets.byId[t.assetId];if((0,f.S)(r)&&void 0!==(0,g.or)(r)){const i=(0,g.T)(r,t,e.aspectRatio,(0,a.G7)("magic__caption_item_toggle"));if(i&&Object.values(i).length>0)return!0}}return!1}))??!1;function xe(){const e=oe();return!!e&&Object.values(e).some((e=>(0,g.or)(e)))}function Se(e){const t=oe();return t?e.filter((e=>{if(0===e.volume)return!1;const r=t[e.assetId];return r&&(0,A.R)(r)})):[]}function Te(e,t,r){const i={...e};for(const e in t)i[e]=t[e];for(const e of r)delete i[e];return i}const Ce=()=>{const e=(0,c.iT)("magic__caption_item_toggle");return _((t=>{const r=[];for(const i of t.tracks.allIds){const n=t.tracks.byId[i];for(const i of n.itemIds){const n=t.items.byId[i];if(0===n.volume||e&&n.disableCaptions)continue;const o=t.assets.byId[n.assetId];if(!o)continue;const s=(0,g.or)(o);if(void 0!==s){const e=Te(s.source,s.updates,s.deletions),t=n.speed,a=(0,v.n)(e,t),c=n.trim.from/t,l=(0,y.pK)(a,1e3*c,1e3*(c+n.duration));for(const e of Object.values(l)){const t=1e3*(n.startTime-c+e.startTimeMs/1e3);r.push({assetId:o.id,trackItemId:i,original:{...e},rendered:{...e,startTimeMs:t}})}}}}if(0!==r.length)return r.sort(((e,t)=>e.rendered.startTimeMs-t.rendered.startTimeMs)),r}),n.x)||[]},_e=()=>_((e=>{const t={};for(const[r,i]of Object.entries(e.assets.byId)){const e=(0,g.or)(i);void 0!==e&&(t[r]=e.updates)}return t}),n.x)||{},ke=()=>_((e=>{const t={};for(const[r,i]of Object.entries(e.assets.byId)){const e=(0,g.or)(i);void 0!==e&&(t[r]=new Set(e.deletions))}return t}),n.x)||{};function Ee(e,t){e.read((e=>e.getAllAssets())).forEach((e=>{(0,f.S)(e.value)&&(0,g.or)(e.value)&&t.updateUnhandled((0,g.n4)(e.value,void 0))}))}const Ie=()=>{const e=O(),t=(0,C.U)(),r=(0,s.y)();return(0,i.useCallback)((i=>{i!==e&&Ee(t,r),t.update((e=>{e.setCaptionProfanityFilter(i)}))}),[r,e,t])},Re=(e,t=!1)=>{const r=O(),n=B(),a=(0,C.U)(),c=(0,s.y)();return(0,i.useCallback)(((i,s)=>{const l={newState:i,recognitionLanguage:s??"undefined",profanityFilter:r,source:e};o.z.logEvent("AutocaptionToggleInteracted",l),o.z.logUserActionEvent("AutocaptionToggleInteracted",{actionType:"Unknown",...l}),s!==n&&Ee(a,c),a.update((e=>{t&&!e.getCaptioningEnabled()&&e.setHideCaptionsInPreview(!0),e.setCaptioningEnabled(i),s&&e.setCaptionRecognitionLanguage(s)}))}),[e,t,r,a,n,c])},Fe=(e,t)=>{const r=(0,l.W)(C.T),i=K(e);if(i)return r.update((r=>{const n=r.getItem(e),o=r.getAsset(t),s=n?r.getTrack(n.trackId):void 0;if(!n||!o||!s)return;const a=i.trim.from,c=i.trim.to,l=o.duration>=a+c;s.withNearestItems(e,((t,i,d)=>{if(!(!d||l||d.startTime>=n.startTime+(o.duration-a-c))){const t=s.takeItem(e);if(t){const e=r.getTrackIndex(s.id);r.createTrack(s.type,e).addItem(t)}}})),n.changeAsset(o),l&&(a||c)&&(n.addTrim("from",a),n.addTrim("to",c),n.moveTo(n.startTime-a))}))}},441068:(e,t,r)=>{r.d(t,{UW:()=>R,KE:()=>_,ob:()=>I,cr:()=>k});var i=r(324586),n=(r(379321),r(959763)),o=r(882252),s=r.n(o),a=r(362724),c=r(138615),l=r(36366),d=r(248142),u=r(327443),h=r(834533),p=r(403643),m=r(7089),f=r(540076),g=r(776016),A=r(650882),v=r(852601),y=r(689064),b=r(554951);class w{constructor(e){this.segment=e}get id(){return this.segment.id}get type(){return this.segment.type}get properties(){return this.segment.properties}isType(...e){return e.includes(this.type)}}class x extends w{apply(e){Object.assign(this.segment.properties,e)}}function S(e,t){return e.type===t}class T{constructor(e,t){this.entity=e,this.mutability=t}wrapSegment(e){switch(this.mutability){case"ref":return new w(e);case"mut":return new x(e);default:throw new Error(`Expected "mut" or "ref", received ${this.mutability}`)}}get id(){return this.entity.id}get value(){return this.entity}getAllSegments(){return this.entity.segments.map((e=>this.wrapSegment(e)))}getAllSegmentsOf(e){const t=[];for(const r of this.entity.segments)S(r,e)&&t.push(this.wrapSegment(r));return t}forEachSegment(e){for(const t of this.entity.segments)e(this.wrapSegment(t))}forEachSegmentOf(e,t){for(const r of this.entity.segments)S(r,e)&&t(this.wrapSegment(r))}getFirstSegmentOf(e){for(const t of this.entity.segments)if(S(t,e))return this.wrapSegment(t)}withFirstSegmentOf(e,t){const r=this.getFirstSegmentOf(e);if(void 0!==r)return t(r)}apply(e){Object.assign(this.entity,e)}}class C{constructor(e,t){this.document=e,this.mutability=t}wrapEntity(e){return new T(e,this.mutability)}getAllEntities(){return this.document.entities.map((e=>this.wrapEntity(e)))}forEachEntity(e){for(const t of this.document.entities)e(this.wrapEntity(t))}}const _=1/30;class k{constructor(e,t,r){this.item=e,this.asset=t,this.transitions=r}get transitionIn(){const{transitionInId:e}=this.item;return e?this.transitions.getTransition(e):void 0}get transitionOut(){const{transitionOutId:e}=this.item;return e?this.transitions.getTransition(e):void 0}get id(){return this.item.id}get rootEntityId(){return this.item.rootEntity}get assetId(){return this.asset.id}get trackId(){return this.item.trackId}get groupId(){return this.item.groupId}get locked(){return this.item.locked}get speed(){return this.item.speed}get duration(){return this.item.duration}get value(){return this.item}get transformer(){return p.Ge.from(this.value.transform??{})}get autoCompositionExplanation(){return this.item.autoCompositionExplanation}get extData(){return this.item.extData}get originalDuration(){return this.item.duration*this.item.speed+this.item.trim.from+this.item.trim.to}get availableTransitionSpace(){return Math.max(this.originalDuration/this.speed-this.transitionOutDuration-this.transitionInDuration,0)}get startTime(){return this.item.startTime}get endTime(){return this.startTime+this.duration}get transitionInDuration(){return this.transitionIn?.durationInS??0}get transitionOutDuration(){return this.transitionOut?.durationInS??0}get timelineStartTime(){return this.startTime+this.transitionInDuration/2}get timelineEndTime(){return this.endTime-this.transitionOutDuration/2}get startTimePlusTransition(){return this.startTime+this.transitionInDuration}get startTimeMinusTransition(){return this.startTime-this.transitionInDuration}get endTimePlusTransition(){return this.endTime+this.transitionOutDuration}get endTimeMinusTransition(){return this.endTime-this.transitionOutDuration}get transitionInId(){return this.item.transitionInId}get transitionOutId(){return this.item.transitionOutId}get captionTextConfig(){if(!this.isType("procedural")||!(0,a.J9)(this.asset.value))return;const e=s()(this.value.entities?.[0]);if(!e)return;e.id="id-stub",e.segments.forEach((e=>{e.id="id-stub"}));const t=e.segments.find((e=>"com.clipchamp.text"===e.type));return"com.clipchamp.text"===t?.type&&t.properties.content&&t.properties.content.length>0&&(t.properties.content[0].text=""),e}getRenderedCaptions(e){if((0,l.S)(this.asset.value))return(0,d.T)(this.asset.value,this.value,e,(0,c.G7)("magic__caption_item_toggle"))}getTransitions(){return this.transitions}isConnectedTo(e){return this.transitionOutId===e.transitionInId&&this.endTimeMinusTransition<=e.startTime&&e.startTime<=this.endTime}canSplitAt(e){const t=this.startTimePlusTransition+_,r=this.endTimeMinusTransition-_;return t<=e&&e<=r}isPresentAt(e){return this.timelineStartTime<=e&&e<this.timelineEndTime}get minDuration(){return Math.max(_,this.transitionInDuration+this.transitionOutDuration)}isType(...e){return this.asset.isType(...e)}getTrim(e){return this.item.trim[e]/this.speed}get trimFrom(){return this.getTrim("from")}get trimTo(){return this.getTrim("to")}getVerseDocument(){if(!this.asset.isType("procedural"))return;const e=this.value;return new C(e,"ref")}withVerseDocument(e){const t=this.getVerseDocument();if(void 0!==t)return e(t)}clone(){const e=new R({...s()(this.item),id:(0,m.u)()},this.asset,this.transitions);return e.item.entities&&e.item.entities.length>0&&(e.item.entities=e.item.entities.map((e=>({...e,id:(0,m.u)()})))),e.setGroupId(void 0),e.removeTransitionIn(),e.removeTransitionOut(),e}}const E=["id","trim","speed","assetId","startTime","duration","transitionInId","transitionOutId"];class I extends k{setTransform(e){this.value.transform=e}apply(e){"function"==typeof e&&(e=e(this.value)),Object.assign(this.item,function(e){e={...e};for(const t of E)delete e[t];return e}(e))}rotateItemOnStage(e,t){const r={...this.value.transform,...this.transformer.rotated(e,t).getPlain()};this.setTransform(r)}resetCropOnStage(e){const t={...this.value.transform,...this.transformer.resetCrop(e).getPlain()};this.setTransform(t)}flipItemOnStage(e){const t={...this.value.transform,...p.sF.flip(this.item.transform??{},e)};this.setTransform(t)}fitOrFillItemOnStage(e,t,r){const i={hasFixedBounds:!0,...this.value.transform,bounds:(0,y.V3)(t,r,{...this.value.transform,strategy:e})};this.setTransform(i)}fillBounds(e,t,r){const{bounds:i,crop:n}=(0,y.GH)(e,t,r),o={hasFixedBounds:!0,...this.value.transform,bounds:i,crop:n};this.setTransform(o)}pipItemOnStage(e,t,r){const i={hasFixedBounds:!1,...this.value.transform,bounds:(0,y.V3)(e,r,{...this.value.transform,strategy:"auto-place",autoPlacement:t})};this.setTransform(i)}setRootEntityId(e){this.item.rootEntity=e}removeRootEntityId(){delete this.item.rootEntity}setComponentHint(e){this.item.componentHint=e}removeComponentHint(){delete this.item.componentHint}setExtDataMap(e){this.item.extData={...this.item.extData,...e}}setExtData(e,t){this.item.extData={...this.item.extData,[e]:t}}removeExtData(e){this.item.extData&&delete this.item.extData[e]}setTransitionIn(e){if(this.transitionIn)throw new Error("Tried to set transition in but item already had one");if(e.value.toId!==this.id)throw new Error("Expected transition toId to be same as item");this.item.transitionInId=e.id}setTransitionOut(e){if(this.transitionOut)throw new Error("Tried to set transition out but item already had one");if(e.value.fromId!==this.id)throw new Error("Expected transition fromId to be same as item");this.item.transitionOutId=e.id}removeTransitionIn(){if(!this.transitionIn)return;const e=this.transitionIn.durationInS/2;this.item.transitionInId=void 0,this.setTrim("from",this.trimFrom+e)}removeTransitionOut(){if(!this.transitionOut)return;const e=this.transitionOut.durationInS/2;this.item.transitionOutId=void 0,this.setTrim("to",this.trimTo+e)}updateFadeInOut(){if(!this.item.fadeInOut)return;const{fadeInSeconds:e,fadeOutSeconds:t}=this.item.fadeInOut,r=this.item.duration/2;if(e>r||t>r){const i=Number.parseFloat(r.toFixed(1));this.apply((()=>({fadeInOut:{fadeInSeconds:Math.min(e,i),fadeOutSeconds:Math.min(t,i)}})))}}moveTo(e,t,r){this.item.startTime=t&&r?(0,b.R)(e,"MediaTicks",r):e}setInitialPosition({x:e,y:t},r=1){let i;if(this.asset.isType("procedural")&&this.value.entities?.forEach((r=>{r.segments=r.segments.map((r=>"com.clipchamp.place"===r.type?{...r,properties:{...r.properties,framePos:{x:2*e-1,y:2*t-1}}}:{...r}))})),i=(0,u.F_)(this.asset.value)?(0,u.gD)(this.asset.value,r):(0,h.GO)(this.asset.value,r),i){const r=i.top-i.bottom,n=i.right-i.left;this.value.transform={strategy:"freehand",hasFixedBounds:!0,bounds:{top:t+r/2,left:e-n/2,right:e+n/2,bottom:t-r/2}}}}trimToDuration(e,t,r=!1){const i="to"===e?"from":"to",n=this.duration-t,o=this.getTrim(e)+n;if(r&&this.asset.hasFiniteLength&&o<0){const t=this.startTime;this.setTrim(e,0),this.setTrim(i,this.getTrim(i)+o),this.moveTo(t)}else this.setTrim(e,o)}setTrim(e,t){const r=this.item.trim;if(this.asset.hasFiniteLength){const i="to"===e?"from":"to",n=(t=Math.max(t,0))*this.speed,o=this.item.trim[i],s=this.item.trim[e],a=this.duration*this.speed,c=this.minDuration*this.speed,l=Math.max(s+a-c,0),d=Math.min(l,n);this.item.duration=(this.originalDuration-(d+o))/this.speed,"from"===e&&(this.item.startTime+=(d-s)/this.speed),r[e]=d,r[i]=o}else{const i=this.item.duration;this.item.duration=Math.max(this.item.duration-t,this.minDuration),"from"===e&&(this.item.startTime+=i-this.item.duration),r.to=0,r.from=0}}addTrim(e,t){this.setTrim(e,this.getTrim(e)+t)}setSpeed(e){(0,f.vA)(e>0,"Expected speed to be greater than 0");const t=this.originalDuration-this.item.trim.from-this.item.trim.to;(0,f.vA)(t>0,"Trim shouldn't be greater than original duration when setting speed"),this.item.speed=e,this.item.duration=t/e}changeAsset(e){const t=this.asset;if(this.value.assetId=e.id,this.asset=e,this.value.trim={to:0,from:0},e.hasFiniteLength){const t=e.isType("video")||e.isType("audio")?e.duration:5;this.value.duration=t/this.value.speed}if(t.isType("title")){const r={};if(t.fields)for(const e of t.fields)r[e.id]=e.defaultValue;e.isType("title")&&(this.value.fields=(0,y.yy)(this.value.fields,r,e.value.defaultTrackItemFields)),e.isAtomWithSegment("com.clipchamp.text")&&(this.value.entities=(0,y.WG)(this.value.fields,r,e.entities))}if(t.isAtomWithSegment("com.clipchamp.text")){const r=(0,v.CB)(t.entities),i=(0,v.CB)(this.value.entities);if(e.isAtomWithSegment("com.clipchamp.text")){let t=[];r!==i&&(t=(0,v.y6)(this.value.entities)),this.value.entities=(0,y.Yo)(t,e.entities)}if(e.isType("title")){const r=(0,v.CB)(t.entities),i=(0,v.CB)(this.value.entities);this.value.fields=(0,y.Qk)(i,r,e.value.defaultTrackItemFields)}}e.isType("background")&&(this.value.color=e.value.color)}setGroupId(e){if((0,g.O9)(this.item.groupId)&&(0,g.O9)(e))throw new Error("Expected groupId to be undefined before assigning a new groupId");this.item.groupId=e}getVerseDocumentMut(){if(!this.asset.isType("procedural"))return;const e=this.value;return new C(e,"mut")}withVerseDocumentMut(e){const t=this.getVerseDocumentMut();if(void 0!==t)return e(t)}setAutoCompositionExplanation(e){this.item.autoCompositionExplanation=e}applyCaptionAndConfig(e,t){if(!this.isType("procedural")||!(0,a.J9)(this.asset.value))return;const r=this.value.entities?.[0]?.id,i=s()(t)??this.value.entities?.[0];if(!i)return;const o=(0,n.jM)(i,(t=>{t.id=r??("id-stub"===t.id?(0,m.u)():t.id),t.segments.forEach((e=>{e.id="id-stub"===e.id?(0,m.u)():e.id}));const i=t.segments.find((e=>"com.clipchamp.text"===e.type));"com.clipchamp.text"===i?.type&&i.properties.content&&i.properties.content.length>0&&(i.properties.content[0].text=e)}));this.apply({entities:[o]})}UNSAFE__detached(){return new R(this.item,this.asset,this.transitions)}}class R extends I{constructor(...e){super(...e),(0,i.A)(this,"detached",!0)}attachTo(e,t,r){const i=this.id;if(!this.detached)throw new A.g9("Expected track item to be detached",{itemId:i});if(t.allIds.includes(i)||t.byId[i])throw new A.g9("Track item already in item state",{itemId:i});if(e.itemIds.includes(i))throw new A.g9("Track item already exists in track",{itemId:i,trackId:e.id});e.itemIds.splice(r??e.itemIds.length,0,i),t.allIds.push(i),t.byId[i]=this.item,this.item.trackId=e.id,this.detached=!1}}},689064:(e,t,r)=>{r.d(t,{GH:()=>w,Qk:()=>p,V3:()=>b,WG:()=>u,Yo:()=>h,lV:()=>m,yy:()=>d});var i=r(289111),n=r.n(i),o=r(735625),s=r(204411),a=r(562151),c=r(852601);function l(e={},t={}){const r=e??{};for(const[e,i]of Object.entries(r))n()(i,t[e])&&delete r[e];return r}function d(e={},t={},r={}){const i=l(e,t);return""===i.text&&delete i.text,{...r,...i}}function u(e={},t={},r=[]){const i=l(e,t);return"string"==typeof i.text&&""!==i.text?(0,c.oD)(r,i.text):r}function h(e=[],t=[]){return e.length>0?(0,c.oz)(t,e):t}function p(e="",t="",r={}){return e&&e!==t?{...r,text:e}:{...r}}function m(e){if(e.asset.isType("title"))return function(e={},t={}){const r=l(e,t);if("string"==typeof r.text&&""!==r.text)return r.text}(e.value.fields,e.asset.value.defaultTrackItemFields);if(e.asset.isAtomWithSegment("com.clipchamp.text")){const t=(0,c.y6)(e.value.entities);if(t&&t.length>0)return t?.map((e=>e.text)).join("").trim()}}const f=(e,t,r)=>{const{left:i,right:n,top:a,bottom:c}=o.DR.bounds,l={...o.DR,...e,bounds:{left:i,right:n,top:a,bottom:c},rotation:0},{bounds:d}=(0,s.v)(l,t,r);return d},g=(e,t,r,i)=>{if(void 0===e)return o.DR.bounds;const n="fill"===e;let s=1,c=1;if(i&&i%(a.D/2)!=0){const e=1/t;n&&e>=r||!n&&e<r?(s=1/r,c=1/t):(c=r,s=t)}else n&&t<r||!n&&t>=r?c=r/t:s=t/r;return{left:.5-s/2,right:.5+s/2,bottom:.5-c/2,top:.5+c/2}},A=(e,t)=>{const r=e.left>e.right,i=e.bottom>e.top,n=r?t.right:t.left,o=r?t.left:t.right,s=i?t.bottom:t.top;return{left:n,right:o,bottom:i?t.top:t.bottom,top:s}},v=(e,t)=>{const r=e?.crop??o.xs,i=1-r.left-r.right,n=1-r.bottom-r.top,s=(t.right-t.left)/i,a=(t.top-t.bottom)/n;let c=!1,l=!1;e?.bounds&&(c=e.bounds.left>e.bounds.right,l=e.bounds.bottom>e.bounds.top);const d=c?r.right:r.left,u=c?r.left:r.right,h=l?r.bottom:r.top,p=l?r.top:r.bottom;return{left:t.left-d*s,right:t.right+u*s,bottom:t.bottom-p*a,top:t.top+h*a}},y=(e,t)=>{const r=Math.abs(e.right-e.left),i=Math.abs(e.top-e.bottom),n=e.left>e.right,o=e.bottom>e.top,s=n?e.right:e.left,a=n?e.left:e.right,c=o?e.bottom:e.top,l=o?e.top:e.bottom;return{left:s+t.left*r,right:a-t.right*r,top:c-t.top*i,bottom:l+t.bottom*i}};function b(e,t,r){if(void 0===r)return;const i=r.bounds??o.oI,n=r?.crop??o.xs,s=1-n.left-n.right,a=1-n.bottom-n.top;let c,l=t*(s/a);!0===r.hasFixedBounds&&(l=t*(s/a)),c="auto-place"===r?.strategy?f(r,l,e):g(r?.strategy,l,e,r.rotation);const d=A(i,c),{left:u,right:h,top:p,bottom:m}=v(r,d);return{left:u,right:h,bottom:m,top:p}}function w(e,t,r){const i=y(r?.bounds??o.oI,r?.crop??o.xs),n=i.right-i.left,s=i.top-i.bottom,a=n*e/s,c={...o.xs},l={...i};let d=n,u=s;if(t<a){u=a/t*s;const e=i.bottom+s/2;l.top=e+u/2,l.bottom=e-u/2;const r=(u-s)/u;c.top=r/2,c.bottom=r/2}else{d=t*n/a;const e=i.left+n/2;l.left=e-d/2,l.right=e+d/2;const r=(d-n)/d;c.left=r/2,c.right=r/2}return{bounds:l,crop:c}}},860580:(e,t,r)=>{r.d(t,{LH:()=>d,n5:()=>l,zD:()=>u});var i=r(26985),n=r(138615),o=r(781224),s=r(739367),a=r(776016),c=r(274095);const l=()=>(0,s.l)(c.C),d=()=>{const e=l(),[t,r]=(0,i.useState)(!1);return(0,o.m)(e.syncListenerError$,(e=>{r((0,a.O9)(e))})),!(0,n.Us)("ks_pst__project_listeners_error_handling")&&t},u=()=>{const e=l();return(0,i.useCallback)((t=>{e.closeProject(t)}),[e])}},274095:(e,t,r)=>{r.d(t,{C:()=>y,Q:()=>b});var i=r(324586),n=r(37344),o=r.n(n),s=r(217563),a=r(396159),c=r(197761),l=r(343314),d=r(562229),u=r(138615),h=r(875527),p=r(345153),m=r(272885),f=r(776016),g=r(444020),A=r(767983),v=r(489077);const y="projectListenersService";class b{constructor(e){(0,i.A)(this,"initialized",!1),(0,i.A)(this,"onDestroy",new s.B),(0,i.A)(this,"isProjectDirtySubject",new s.B),(0,i.A)(this,"isProjectDirty",this.isProjectDirtySubject.pipe((0,a.F)())),(0,i.A)(this,"debouncedSync",void 0),(0,i.A)(this,"debouncedProjectId",void 0),(0,i.A)(this,"onError",new s.B),(0,i.A)(this,"syncListenerError$",this.onError.asObservable()),this.projectSync=e,this.debouncedSync=o()((e=>this.syncProject(e)),2e3,{trailing:!0,maxWait:2e3})}init(){if(this.initialized)return;let e;this.initialized=!0,(0,v.jN)().pipe((0,c.p)(f.O9),(0,l.Q)(this.onDestroy)).subscribe((async t=>{const r=e;e=t,r&&(0,v.u2)(r,t)&&(0,v.e8)(r,t)&&await this.onProjectModified(t.id)}))}async onProjectModified(e){if((0,h.lE)(),this.debouncedProjectId!==e){let t=0;(0,p.vr)((e=>{t=e.version+1,e.version=t})),t&&((0,A.j)(e,t.toString()),this.logSyncEventEnabled()&&d.z.logEvent("Sync - Project Modified",{id:e,version:t}),d.z.logAppLogicEvent("ProjectSyncModified",{projectVersion:t.toString()}))}const t=(0,p.U1)((e=>e));t?(this.debouncedProjectId&&this.debouncedProjectId!==t.id&&await this.debouncedSync.flush(),this.isProjectDirtySubject.next(!0),this.debouncedProjectId=t.id,await this.debouncedSync(t)):d.z.logWarningEvent("ProjectSyncProjectNotSet",{})}destroy(){this.onDestroy.next(),this.onDestroy.complete()}handleSyncError(e){const t=e instanceof g.O?e.errorType:"Unknown";d.z.logErrorEvent("ProjectSyncError",{errorType:t}),d.z.logEvent("Sync - Project Sync Error",{errorType:t}),this.onError.next(e)}async syncProject(e){d.z.logAppLogicEvent("ProjectSyncPrepare",{}),this.debouncedProjectId=void 0;try{if((0,p.wZ)())throw new g.O("ViewerMode");if(0===e.version)throw new g.O("UnsavedProject");this.isProjectDirtySubject.next(!1);const t=(0,m.eS)(),r=await this.prepareStorageOptions(),i=(0,h.ME)(e,t);this.projectSync.queueUpdate(i,r)}catch(e){this.handleSyncError(e)}}async closeProject(e){(0,p.wk)()&&(await this.debouncedSync.flush(),this.performCloseProject(e))}logSyncEventEnabled(){return(0,u.G7)("pst__project_sync_logging")}}},670324:(e,t,r)=>{r.d(t,{f:()=>o});var i=r(355185),n=r(327443);function o(e){const t=e.cloud.id;return t.startsWith("cc_")||t.startsWith("stryb_")?(0,i.YQ)({...(0,i.QO)(e.cloud.id),locale:"en"}):(0,i.YQ)({vendor:"videoblocks"===e.cloud.provider?"stryb":"cc",type:(0,n.F_)(e)?"element":e.type,vendorId:(0,n.F_)(e)?e.cloud.vendorId:e.cloud.id,locale:"en"})}},767983:(e,t,r)=>{r.d(t,{h:()=>o,j:()=>n});const i="localVersion",n=(e,t)=>{window.localStorage.setItem(`${e}_${i}`,t)},o=e=>{const t=window.localStorage.getItem(`${e}_${i}`);if(t)return Number.parseInt(t,10)}},649079:(e,t,r)=>{r.d(t,{M:()=>l,y:()=>d});var i,n=r(959763),o=r(825702),s=r(739367),a=r(345153),c=r(272885);let l=(0,o.Gr)()(i=class{reset(e,t){switch((0,a.wZ)()?"reset"===t&&(0,a.od)(e):(0,a.od)(e),t){case"save":(0,a.I8)();break;case"reset":(0,a.eU)();break;case"overwrite":(0,a.I8)("overwrite")}}isLoaded(){return(0,a.U1)((e=>void 0!==e))??!1}read(e){const t=(0,a.U1)((e=>e)),r=(0,c.eS)();if(!t)throw new Error("Can't read the project if none exists.");return e(t,r)}update(e,t="save"){const r=(0,a.U1)((e=>e)),i=(0,c.eS)();if(!r)throw new Error("Can't update the project if none exists.");let o={type:"detached"};const s=(0,n.jM)(r,(t=>{o={type:"attached",value:e(t,i)}}));if("detached"===o.type)throw new Error("Produce closure was not run");return s===r||this.reset(s,t),o.value}})||i;function d(){return(0,s.l)(l)}},165346:(e,t,r)=>{r.d(t,{EB:()=>f,FC:()=>m,ny:()=>A,yN:()=>v});var i=r(626443),n=r(26985),o=r(584571),s=r(549281),a=r(673101),c=r(396159),l=r(225304),d=r(781224),u=r(739367),h=r(860580),p=r(483125);function m(){return(0,u.l)(p.II)}const f=()=>{const e=m(),[t,r]=(0,n.useState)(!1),[o,s]=(0,n.useState)(!1),[a,c]=(0,n.useState)(!1);return(0,d.m)(e.syncError$,(e=>{e instanceof l.j$?e.status===i.v.GONE?r(!0):e.status===i.v.CONFLICT||e.status===i.v.PRECONDITION_FAILED?s(!0):c(!0):c(!0)})),{deleted:t,syncConflict:o,syncError:a}},g=()=>{const e=(0,h.n5)(),t=m();return(0,n.useMemo)((()=>(0,o.z)([e.isProjectDirty.pipe((0,s.c)(100)),t.isSyncing]).pipe((0,a.T)((([e,t])=>e||t)),(0,c.F)())),[e,t])},A=()=>{const e=g();return(0,d.A)(e,!1)},v=e=>{const t=g();(0,d.m)(t,e)}},483125:(e,t,r)=>{r.d(t,{A$:()=>m,II:()=>p});var i=r(324586),n=r(626443),o=r(815731),s=r(217563),a=r(197278),c=r(562229),l=r(138615),d=r(225304),u=r(7089);class h extends Error{constructor(){super("Project sync timed out")}}const p="projectSyncService";class m{constructor(e,t){(0,i.A)(this,"syncError$",void 0),(0,i.A)(this,"syncFinished$",void 0),(0,i.A)(this,"nextAction",void 0),(0,i.A)(this,"currentlySyncing",new o.t(!1)),(0,i.A)(this,"onError",new s.B),(0,i.A)(this,"onSyncFinished",new s.B),(0,i.A)(this,"isSyncing",this.currentlySyncing.asObservable()),this.projectBackend=e,this.projectSchemaService=t,this.syncError$=this.onError.asObservable(),this.syncFinished$=this.onSyncFinished.asObservable()}getLastSyncProject$(){return a.w}getLastSyncTime(){}queueUpdate(e,t){this.queueSyncAction(e,t)}logSyncError(e,t){let r,i,o,s;e instanceof d.j$?(r=e.message,void 0!==e.context&&"string"==typeof e.context["body.error_code"]&&(r=e.context["body.error_code"]),i=e.response.statusText,o=e.response.status,s="HTTP"):e instanceof d.Dr?(r=e.message,i=e?.context?.reason,s="Network"):e instanceof h?(r=e.message,s="Timeout"):(r=e.message,s="Unknown"),o===n.v.PRECONDITION_FAILED?c.z.logWarningEvent("ProjectSyncConflict",{errorAlertType:"Warning",correlationId:t}):c.z.logErrorEvent("ProjectSyncError",{errorAlertType:"Fatal",errorCode:o?.toString(),correlationId:t,errorType:s}),this.logSyncEventEnabled()&&c.z.logEvent("Sync - Project Sync Error",{error:r,reason:i,statusCode:o,errorType:s})}handleSyncError(e,t){this.logSyncError(e,t),this.onError.next(e)}queueSyncAction(e,t){const r={storageOptions:t,projectState:e};this.nextAction&&this.isDifferentProject(this.nextAction,r)&&(c.z.logAppLogicEvent("ProjectSyncDiscarded",{discardReason:"DifferentProject"}),c.z.logEvent("Sync - Project Sync Discarded",{version:this.nextAction.projectState.version,newVersion:e.version})),this.nextAction=r,this.sync()}isDifferentProject(e,t){return e.projectState.id!==t.projectState.id}async sync(){if(!this.nextAction)return c.z.logAppLogicEvent("ProjectSyncDiscarded",{discardReason:"EmptyQueue"}),void(this.logSyncEventEnabled()&&c.z.logEvent("Sync - Project Sync Empty Queue",{}));if(this.currentlySyncing.value)return c.z.logAppLogicEvent("ProjectSyncDiscarded",{discardReason:"CurrentlySyncing"}),void(this.logSyncEventEnabled()&&c.z.logEvent("Sync - Project Sync Currently Syncing",{}));this.logSyncEventEnabled()&&c.z.logEvent("Sync - Project Sync Start",{version:this.nextAction.projectState.version});const e=(0,u.u)();c.z.logAppLogicEvent("ProjectSyncStarted",{correlationId:e});const{storageOptions:t,projectState:r}=this.nextAction,{project:i,recovered:n}=await this.recoverProjectSchema(r);if(n&&c.z.logEvent("Schema - Sync Corrupt Project",{id:i.id,version:i.version,schemaVersion:i.schemaVersion,createdAt:i.createdAt}),!await this.validateProjectSchema(i))return void this.handleSyncError(new Error("Schema validation failed"),e);this.currentlySyncing.next(!0),this.nextAction=void 0;const o={projectState:i,storageOptions:t},s=this.projectBackend.updateProject(o);let a=s;if((0,l.G7)("pst__project_sync_timeout")){const e=new Promise(((e,t)=>{setTimeout((()=>t(new h)),6e4)}));a=Promise.race([s,e])}a.then((t=>{this.logSyncEventEnabled()&&c.z.logEvent("Sync - Project Sync Success",{version:i.version}),c.z.logAppLogicEvent("ProjectSyncSuccess",{correlationId:e}),this.onProjectSynced?.(o,t)})).catch((t=>{this.handleSyncError(t,e)})).finally((async()=>{this.currentlySyncing.next(!1),await this.sync()}))}logSyncEventEnabled(){return(0,l.G7)("pst__project_sync_logging")}async validateProjectSchema(e){const t=await this.projectSchemaService.validate(e);return t.result||(c.z.logEvent("Sync - Project Schema Validation Failed",{project:{id:e.id,version:e.version,schemaVersion:e.schemaVersion,createdAt:e.createdAt},deepestErrorPath:t.errors.deepestError?.instancePath,error:t.errors.all}),c.z.logErrorEvent("ProjectSyncSchemaValidationFailed",{clientSchemaVersion:await this.projectSchemaService.getVersion(),deepestErrorPath:t.errors.deepestError?.instancePath??"unknown",errorCount:t.errors.all.length})),t.result}async recoverProjectSchema(e){return(0,l.G7)("pst__recover_schema")?await this.projectSchemaService.recover(e):{project:e,recovered:!1}}}},131512:(e,t,r)=>{r.d(t,{$D:()=>s,LB:()=>c,we:()=>a});var i=r(345153),n=r(272885),o=r(472565);const s=(e,t)=>(0,i.By)((t=>e?(0,o.F)(e,t,(0,n.eS)()):void 0),t),a=e=>{const t=(0,i.U1)((e=>e));return e?(0,o.F)(e,t,(0,n.eS)()):void 0},c=(e,t)=>{const r=e.read((e=>e.getAsset(t)))?.value;if(!r)throw new Error(`Asset with id ${t} not found`);return r}},474107:(e,t,r)=>{r.d(t,{T:()=>u,U:()=>p});var i,n=r(825702),o=r(739367),s=r(908545),a=r(36366),c=r(469223),l=r(233721),d=r(649079);let u=(0,n.Gr)()((h=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[void 0===d.M?Object:d.M])(i=class{constructor(e){this.state=e}ingestProject(e){this.state.reset(e,"reset")}read(e){return this.state.read(((t,r)=>{const i=new c.sh((0,s.n)(t.assets,r),"ref");return e(new l.JD(t,i,"ref"))}))}mutateProject(e,t,r){const i=new c.sh((0,s.n)(e.assets,t),"ref"),n=new l.D8(e,i),o=r(n);return n.removeEmptyTracks(),n.removeOverlapsAcrossTracks(),n.updateContainers(),n.removeEmptyGroups(),n.removeMissingItems(),n.removeUnusedEntities(),n.removeUnusedContainers(),n.cleanUpContainers(),n.forEachTrack((e=>{e.connectOrRemoveTransitions(),e.sort()})),n.removeMissingItems(),n.removeEmptyGroups(),this.hasCaptionableAssets(n)?(n.createCaptionTrack(),n.updateCaptionTrack()):n.removeCaptionTrack(),o}hasCaptionableAssets(e){return e.getAllItems().some((e=>(0,a.S)(e.asset.value)))}update(e,t="save"){return this.state.update(((t,r)=>this.mutateProject(t,r,e)),t)}})||i)||i,i=(0,n.WQ)(d.M)(h,void 0,0)||i))||i;var h;function p(){return(0,o.l)(u)}},233721:(e,t,r)=>{r.d(t,{D8:()=>W,JD:()=>z,u_:()=>O,pd:()=>U}),r(379321),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(959763),n=r(882252),o=r.n(n),s=r(289111),a=r.n(s),c=r(413497),l=r(573340),d=r(825386),u=r(467379),h=r(36366),p=r(776016),m=r(7089),f=r(847269),g=r(650882),A=r(210864);class v{constructor(e){this.group=e}get name(){return this.group.name}get id(){return this.group.id}get itemIds(){return this.group.itemIds}}class y extends v{addItem(e){e.setGroupId(this.id),this.group.itemIds.includes(e.id)||this.group.itemIds.push(e.id)}removeItem(e){e.setGroupId(void 0);const t=this.group.itemIds.indexOf(e.id);-1!==t&&this.group.itemIds.splice(t,1)}}var b=r(441068),w=r(362724),x=r(345563),S=r(897592),T=r(722392),C=r(118221),_=r(750585),k=r(554951),E=r(965184);const I={top:0,left:0,right:1,bottom:.25},R={bgColor:[0,0,0,1],scale:.75},F={startTime:0,duration:_.Pr,trim:{from:0,to:0},speed:1,transitionOutId:void 0,transitionInId:void 0};class P{constructor(e,t,r,i,n){this.track=e,this.items=t,this.assets=r,this.transitions=i,this.mutability=n}get id(){return this.track.id}get type(){return this.track.type}get hidden(){return this.track.hidden}get value(){return this.track}get allTransitions(){return this.transitions}wrapItem(e,t){const r={getTransition:e=>this.getTransition(e)};switch(this.mutability){case"ref":return new b.cr(e,t,r);case"mut":return new b.ob(e,t,r);default:throw new Error(`Expected "mut" or "ref", recieved ${this.mutability}`)}}isSorted(){for(let e=0;e<this.track.itemIds.length-1;e++){const t=this.track.itemIds[e],r=this.track.itemIds[e+1];if((this.getItem(t)?.startTime??0)>(this.getItem(r)?.startTime??0))return!1}return!0}getRenderedCaptions(e){const t={};for(const r of this.getAllItems()){const i=r.getRenderedCaptions(e)||{};for(const e of Object.values(i)){const i=1e3*(r.startTime-r.trimFrom+e.startTimeMs/1e3);t[i]={...e,startTimeMs:i}}}if(Object.keys(t).length>0)return t}getTransition(e){const t=this.transitions[e];if(t)return new E.F(t)}withTransition(e,t){const r=this.getTransition(e);if(r)return t(r)}getAllItems(){return this.track.itemIds.map((e=>this.getItem(e))).filter(p.O9)}getDuration(){return Math.max(0,...this.getAllItems().map((e=>e.endTime)))}getAllGaps(e){const t=[],r=this.getAllItems();let i;return r.forEach(((n,o)=>{(n.startTime>0&&!i||i&&!i.isConnectedTo(n))&&t.push({startTime:i?i.endTime:0,endTime:n.startTime}),e&&o===r.length-1&&n.endTime<e&&t.push({startTime:n.endTime,endTime:e}),i=n})),t}getAllTransitions(){return this.track.transitionIds.map((e=>this.getTransition(e))).filter(p.O9)}forEachItem(e){const t=[...this.track.itemIds];for(const r of t)this.withItem(r,e)}withItem(e,t){const r=this.getItem(e);if(r)return t(r);l.Vy.debug(`Item with id ${e} not found on track ${this.id}`)}withNearestItems(e,t){let r=this.track.itemIds;this.isSorted()||(l.Vy.error(new Error("Expected track to be sorted when getting adjacent items")),r=[...this.track.itemIds],r.sort(this.sortTrackItemIdsCompareFn()));const i=r.indexOf(e),n=this.getItem(e);if(-1===i||!n)return;const o=r[i-1],s=r[i+1];return t(n,o?this.getItem(o):void 0,s?this.getItem(s):void 0)}isEmpty(){return 0===this.track.itemIds.length}getItem(e){if(!this.track.itemIds.includes(e))return;const t=this.items.byId[e];if(!t)return;const r=this.assets.getAsset(t.assetId);return r?this.wrapItem(t,r):void 0}sortTrackItemIdsCompareFn(){return(e,t)=>(this.getItem(e)?.startTime||0)-(this.getItem(t)?.startTime||0)}}class L extends P{sort(){return this.isSorted()||this.track.itemIds.sort(this.sortTrackItemIdsCompareFn()),this}connectOrRemoveTransitions(){const e=this.getAllTransitions();for(const t of e){const e=this.getItem(t.fromId),r=this.getItem(t.toId);e&&r&&e.isConnectedTo(r)?r.moveTo(e.endTimeMinusTransition):this.removeTransition(t.id,{preserveStartTimes:!0})}}doesRangeOverlap(e,t,r){const i=this.getAllItems();for(const n of i)if(!r.includes(n.id)&&e<n.endTime&&n.startTime<t)return!0;return!1}removeInvalidOverlaps(){this.sort();const e=this.getAllItems();e.forEach(((t,r)=>{t.startTime<0&&t.moveTo(0);const i=e[r-1];if(t.transitionInId&&!i?.isConnectedTo(t)&&this.removeTransition(t.transitionInId,{preserveStartTimes:!0}),t.transitionOutId){const i=function(t,r){for(let i=t+1;i<e.length;i++)if(e[i]?.transitionInId===r)return i;return-1}(r,t.transitionOutId),n=e[i];if(!n)return;if(i===r+1)return void(n.startTime<t.endTimeMinusTransition&&n.moveTo(t.endTimeMinusTransition));if(t.isConnectedTo(n))return e.splice(i,1),e.splice(r+1,0,n),void n.moveTo(t.endTimeMinusTransition);this.removeTransition(t.transitionOutId,{preserveStartTimes:!0})}const n=e[r+1];n&&n.startTime<t.endTime&&n.moveTo(t.endTime)}));const t=e.map((e=>e.id));(0,C.h)(this.track.itemIds,t)||(this.track.itemIds=t)}takeItemAndTransitions(e){const t=this.getItem(e);if(!t)return{};const r=t.transitionInId?this.takeTransition(t.transitionInId):void 0,i=t.transitionOutId?this.takeTransition(t.transitionOutId):void 0;return this.removeItemFromState(e),{item:t.UNSAFE__detached(),transitionIn:r,transitionOut:i}}takeItem(e){const t=this.getItem(e);if(t)return t.transitionOutId&&this.removeTransition(t.transitionOutId),t.transitionInId&&this.removeTransition(t.transitionInId),this.removeItemFromState(e),t.UNSAFE__detached()}addItem(e,t){e.attachTo(this.track,this.items,t)}createCaptionItems(e,t){if("caption"!==this.type)return;const r=this.assets.getAsset(w.lP.id);if(!r||!r.isType("procedural"))return;const n=this.getAllItems();if(n.length<e)for(let o=0;o<e-n.length;o++){const e=this.createItem(r);if(t>1){const r=e.value.entities?.[0],n=(0,i.jM)(r,(e=>{const r=e?.segments.find((e=>"com.clipchamp.text"===e.type));e&&"com.clipchamp.text"===r?.type&&(r.properties.wrapWidth=(r.properties.wrapWidth??1)*t)}));n&&e.apply({entities:[n]})}}else if(n.length>e){const t=n.slice(0,n.length-e);for(const e of t)this.removeItem(e.id)}}updateCaptionItems(e,t,r=void 0,i=1){if("caption"!==this.type)return;const n=(0,x.hO)(e);this.createCaptionItems(n.length,i);const s=this.getAllItems();for(let e=0;e<n.length;e++){const t=n[e],i=s[e];(0,p.O9)(i)?(i.moveTo(t.startTimeMs/1e3),i.trimToDuration("to",t.durationMs/1e3,!1),i.applyCaptionAndConfig(t.text,o()(r))):l.Vy.error(new g.g9("Caption track item undefined in updateCaptionItems",{numCaptions:n.length,numTrackItems:s.length}))}}removeItem(e){this.takeItem(e)}replaceItem(e,t){const r=this.getItem(e);if(!r)return;if(r.asset.trackType!==t.trackType)return;const i=r.duration;return r.changeAsset(t),!t.hasFiniteLength||t.duration>i?r.trimToDuration("to",i):t.duration<i&&r.transitionOutId&&this.removeTransition(r.transitionOutId,{preserveStartTimes:!0}),r}removeAllItems(){const e=[...this.track.itemIds];for(const t of e)this.removeItem(t)}withNearestItems(e,t){return this.sort(),super.withNearestItems(e,t)}trimItemToTime(e,t,r){return this.withNearestItems(e,((e,i)=>{if("from"===t?e.trimToDuration("from",e.endTime-r,!1):e.trimToDuration("to",r-e.startTime,!1),"from"===t){const t=i?.endTimeMinusTransition??0;e.moveTo(Math.max(t,e.startTime))}return e}))}addTransition(e){return this.withItem(e.fromId,(t=>this.withItem(e.toId,(r=>(e.attachTo(this.transitions,this.track,t,r),e)))))}createTransition(e,t,r,i=e.value.defaultDurationInS){if(t!==r)return this.withItem(t,(n=>this.withItem(r,(o=>{if(n.transitionOutId||o.transitionInId)return;const s=new E.D({id:(0,m.u)(),asset:e.id,durationInS:i,toId:r,fromId:t});return s.attachTo(this.transitions,this.track,n,o),s}))))}removeTransition(e,t){this.takeTransition(e,t)}takeTransition(e,t={}){const r=this.getTransition(e);if(!r)return;this.withItem(r.toId,(e=>{if(t.preserveStartTimes){const t=e.startTime;e.removeTransitionIn(),e.moveTo(t)}else e.removeTransitionIn()})),this.withItem(r.fromId,(e=>{e.removeTransitionOut()})),delete this.transitions[e];const i=this.track.transitionIds.indexOf(e);return-1!==i&&this.track.transitionIds.splice(i,1),r.UNSAFE__detached()}updateTransition(e,t){const r=this.takeTransition(e);r&&(t(r),this.addTransition(r))}moveItemToAndFit(e,t,r,i){this.withItem(e,(n=>{n.moveTo(r&&i?(0,k.R)(t,"MediaTicks",i):t),this.withNearestItems(e,((e,t,r)=>{if(r){const e=t?.endTime??0,i={startTime:e,duration:r.startTime-e};n.duration>i.duration&&i.duration>=n.minDuration&&(n.moveTo(i.startTime),n.trimToDuration("to",i.duration))}}))}))}addNormalizedItem(e){const t={...F,...e};return this.assets.withAsset(t.assetId,(e=>{const r=this.wrapItem(t,e).UNSAFE__detached();return this.addItem(r),r}))}paste({items:e,transitions:t}){const r=new Map,i=[];for(const{item:t,transitionOutId:n,transitionInId:s}of e){const e=(0,m.u)(),a=this.addNormalizedItem({...o()(t),startTime:t.startTime,id:e});if(n){const t=r.get(n)||{};t.fromId=e,r.set(n,t)}if(s){const t=r.get(s)||{};t.toId=e,r.set(s,t)}if(!a)throw new Error('Expected "pastedItem" to be defined');i.push(a)}for(const e of t){const{fromId:t,toId:i}=r.get(e.id)||{};t&&i&&this.assets.withAsset(e.asset,(r=>{r.isType("transition")&&this.createTransition(r,t,i,e.durationInS)}))}return i}createComponentItem(e,t,r,i){if(!(0,S.Y)(e.value))throw new Error("Asset is not a component");const n=(0,_.z2)(e.value,t,r,0,this.id,i),o=(0,T.o)(n),s=this.wrapItem(o,e).UNSAFE__detached();return this.addItem(s),s}createItem(e,t){const r=(0,_.vI)(e.value,0,this.id,t??1),i=(0,T.o)(r),n=this.wrapItem(i,e).UNSAFE__detached();return this.addItem(n),n}createAndTrimItem(e,t,r){const i=(0,_.vI)(e.value,0,this.id,r??1),n=(0,T.o)(i),o=this.wrapItem(n,e).UNSAFE__detached();let s=o.clone();if(t.length>0&&t.length<6)for(let e=0;e<t.length;e++){const r=t[e],i=s.clone(),n=o.clone(),a=o.endTime;if(0!==r.trimStartTime){this.addItem(i);const e=a-r.trimStartTime;i.addTrim("to",e)}r.trimEndTime!==n.endTime&&(t.length===e+1&&this.addItem(n),n.addTrim("from",r.trimEndTime),s=n,n.moveTo(r.trimEndTime))}}setHidden(e){this.track.hidden=e}trimItemToOffsets(e,t,r){if(0===e.length)return;const i=t.startTime;t.setTrim("from",e[0].from),t.setTrim("to",e[0].to),t.moveTo(i);let n=t;const o=[t];for(const t of e.slice(1)){const e=this.createItem(n.asset,r);e.setTrim("from",t.from),e.setTrim("to",t.to),e.moveTo(n.endTime),o.push(e),n=e}return o}removeItemFromState(e){const t=this.track.itemIds.indexOf(e);-1!==t&&this.track.itemIds.splice(t,1);const r=this.items.allIds.indexOf(e);-1!==r&&this.items.allIds.splice(r,1),delete this.items.byId[e]}}var N=r(324586),M=r(393810);class B{constructor(e,t,r,i){(0,N.A)(this,"getVariable",(e=>{const t=(0,M.UN)(this.entity).find((t=>t.name===e));if(t)return{name:t.name,value:t.value}})),this.entity=e,this._id=t,this.entities=r,this.mutability=i}get id(){return this._id}get variables(){return(0,M.UN)(this.entity)}get fixedWidth(){return(0,M.ts)(this.entity)}get fixedHeight(){return(0,M.qw)(this.entity)}get absolutePosition(){return(0,M.N0)(this.entity)}get absolutePositionAnchor(){return(0,M.ov)(this.entity)}get segments(){return this.entity.segments}}class D extends B{constructor(...e){super(...e),(0,N.A)(this,"setVariable",((e,t)=>{(0,M.BB)({name:e,value:t},this.entity)})),(0,N.A)(this,"setAbsolutePosition",(e=>{(0,M.rV)(e,this.entity)})),(0,N.A)(this,"setFixedWidth",(e=>{(0,M.zj)(e,this.entity)})),(0,N.A)(this,"setFixedHeight",(e=>{(0,M.k$)(e,this.entity)})),(0,N.A)(this,"setRotation",((e,t)=>{(0,M.d_)(e,t??M.f2,this.entity)})),(0,N.A)(this,"setWidth",(e=>{(0,M.zj)(e,this.entity)})),(0,N.A)(this,"setHeight",(e=>{(0,M.k$)(e,this.entity)})),(0,N.A)(this,"setRotationInRad",((e,t)=>{(0,M.x2)(e,t??M.f2,this.entity)})),(0,N.A)(this,"getRotationInRad",(()=>{(0,M.fJ)(this.entity)})),(0,N.A)(this,"setRotationInDeg",((e,t)=>{(0,M.a1)(e,t??M.f2,this.entity)})),(0,N.A)(this,"getRotationInDeg",(()=>(0,M.su)(this.entity))),(0,N.A)(this,"getText",(()=>(0,M.J1)(this.entity))),(0,N.A)(this,"updateContentPlacement",(e=>{(0,M.Cq)(e,this.entity)})),(0,N.A)(this,"updateSegments",(e=>{this.entity.segments=e})),(0,N.A)(this,"updateSegmentsOfType",((e,t)=>{const r=this.entity.segments.filter((e=>!t.includes(e.type)));this.entity.segments=[...r,...e]})),(0,N.A)(this,"setFontStyles",(e=>{this.entity.segments.filter((e=>"displayText"===e.type)).forEach((t=>{t.properties={...t.properties,...e}}))})),(0,N.A)(this,"setText",(e=>{const t=this.entity.segments.find((e=>"displayText"===e.type));t&&(t.properties.text=e)})),(0,N.A)(this,"updateTextSegments",(e=>{const t=this.entity.segments.filter((e=>"displayText"!==e.type));this.entity.segments=[...t,...e]})),(0,N.A)(this,"updateTextSegmentsWithBrushes",(e=>{const t=new Set;e.forEach((({type:e,properties:{highlightBrush:r,brush:i}})=>{"brushHighlight"===e&&void 0!==r&&t.add(r),void 0!==i&&t.add(i)}));const r=this.entity.segments.filter((e=>"displayText"!==e.type&&!t.has(e.properties.brush)));this.entity.segments=[...r,...e]})),(0,N.A)(this,"getSegmentsOfType",(e=>this.entity.segments.filter((t=>t.type===e))))}}(0,p.t9)({id:p.Kg,schemaVersion:(0,p.ey)(p.Et,p.Kg)});const O=e=>e?.id&&e?.items&&void 0!==e?.items?.length&&"string"==typeof e.name,j=["id","aspectRatio","aspectRatioManuallyUpdated","assets","createdAt","flavor","flavorData","groups","items","name","recentColors","schemaVersion","tracks","updatedAt","version","analytics","metadata"];function U(e,t){const r=Math.min(...e.flatMap((e=>e.startTime))),i=Math.max(0,t);e.forEach((e=>{const t=i-r;e.moveTo(e.startTime+t)}))}class z{constructor(e,t,r){this.project=e,this.assets=t,this.mutability=r}get aspectRatio(){return u.l8[this.get("aspectRatio")]}get eligibleForAutoUpdate(){return!this.project.aspectRatioManuallyUpdated&&"template"!==this.project.flavor}get duration(){let e=0;return this.forEachTrack((t=>{let r=0;t.forEachItem((e=>{r=Math.max(e.endTime,r)})),e=Math.max(r,e)})),e}get entities(){return this.project.entities||{}}get trackCount(){return this.project.tracks.allIds.length}get extData(){return this.project.extData}getProjectAnalytics(){return this.project.analytics}getFeatureInteractions(){const e=this.getProjectAnalytics();return e?e?.featureInteractions:void 0}getLastUsedTransitionId(){return this.project.lastUsedConfig?.transition?.id}getLastUsedTransitionDuration(){return this.project.lastUsedConfig?.transition?.duration}getLastUsedConfig(){return this.project.lastUsedConfig}getAssetUnchecked(e){return this.assets.getAssetUnchecked(e)}getAsset(e){return this.assets.getAsset(e)}getAssetByName(e,t){return this.assets.getAssetByName(e,t)}getAllAssets(){return this.project.assets.allIds.map((e=>this.getAsset(e))).filter(p.O9)}getAllTracks(e=!1){return this.project.tracks.allIds.map((e=>this.getTrack(e))).filter(p.O9).filter((t=>!e||!t.hidden))}getCaptionTrack(){return this.getAllTracks().find((e=>"caption"===e.type))}getAllGroups(){return Object.keys(this.project.groups??[]).map((e=>this.getGroup(e))).filter(p.O9)}get containers(){return Object.values(this.project.extData?.containers.data||{}).filter(O)}getContainer(e){const t=this.project.extData?.containers.data[e];if(O(t))return t}getDuration(){return this.getAllItems().reduce(((e,t)=>Math.max(e,t.timelineEndTime)),0)}getTimeSpentEditing(){return this.project.timeSpentEditingMs??0}getAllItems(e=!1){const t=this.getAllTracks(e).flatMap((e=>e.getAllItems()));return t.sort(((e,t)=>e.startTime-t.startTime)),t}getAllItemsWithAssetIds(e){const t=this.getAllItems(),r=[];for(const i of t)e.includes(i.assetId)&&r.push(i);return r}wrapTrack(e){switch(this.mutability){case"ref":return new P(e,this.project.items,this.assets,this.project.items.transitions,this.mutability);case"mut":return new L(e,this.project.items,this.assets,this.project.items.transitions,"mut");default:throw new Error(`Expected "mut" or "ref", recieved ${this.mutability}`)}}wrapEntity(e,t){switch(this.mutability){case"ref":return new B(e,t,this.project.entities||{},this.mutability);case"mut":return new D(e,t,this.project.entities||{},"mut");default:throw new Error(`Expected "mut" or "ref", recieved ${this.mutability}`)}}wrapGroup(e){switch(this.mutability){case"ref":return new v(e);case"mut":return new y(e);default:throw new Error(`Expected "mut" or "ref", recieved ${this.mutability}`)}}forEachTrack(e){const t=[...this.project.tracks.allIds];for(const r of t)this.withTrack(r,e)}getTrack(e){return this.withTrack(e,(e=>e))}getTrackByIndex(e){const t=this.project.tracks.allIds[e];if(t)return this.getTrack(t)}getTrackIndex(e){return this.project.tracks.allIds.indexOf(e)}getTrackWithItem(e){const t=this.project.items.byId[e]?.trackId;if(t)return this.getTrack(t)}getTrackWithTransition(e){for(const t of this.getAllTracks())for(const r of t.getAllTransitions())if(r.id===e)return t}withTrack(e,t){const r=this.project.tracks.byId[e];if(r)return t(this.wrapTrack(r))}getItem(e){return this.getTrackWithItem(e)?.getItem(e)}getEntity(e){const t=(0,M.QH)(e,this.project.entities);if(t)return this.wrapEntity(t,e)}getTransition(e){const t=this.getTrackWithTransition(e);return t?.getTransition(e)}copyItemIds(e){const t=[],r=new Map;return this.containers.forEach((e=>{e.items.forEach((t=>{r.set(t,e.id)}))})),this.forEachTrack((i=>{const n=[],o=[];for(const t of e)i.withItem(t,(e=>{const{clonedItem:t,entities:s}=this.cloneItem(e.id),a=t.value;a.entities?.forEach((e=>e.id=(0,m.u)())),n.push({item:a,groupId:e.groupId,containerId:r.get(e.id),transitionOutId:e.transitionOutId,transitionInId:e.transitionInId,entities:s}),e.transitionOutId&&i.withTransition(e.transitionOutId,(e=>{o.push(e.value)}))}));if(n.length>0){const e={trackId:i.id,type:i.type,items:n,transitions:o};t.push(e)}})),t}cloneItem(e){const t=this.getItem(e);if(!t)throw new Error(`Item with id ${e} not found`);const r=new b.UW({...o()(t.value),id:(0,m.u)()},t.asset,t.getTransitions());return r.value.entities&&r.value.entities.length>0&&(r.value.entities=r.value.entities.map((e=>({...e,id:(0,m.u)()})))),r.setGroupId(void 0),r.removeTransitionIn(),r.removeTransitionOut(),{clonedItem:r,entities:this.getAllEntities(e)}}getAllEntities(e){const t=this.getItem(e),r=t?.value.rootEntity;if(!r)return;const i=(0,M.QH)(r,this.project.entities);if(!i)return;const n=new Set,o=e=>{const t=this.entities[e];(0,p.O9)(t)&&t.children.forEach((e=>{n.add(e),o(e)}))};o(r);const s=[...n].reduce(((e,t)=>({...e,[t]:(0,M.QH)(t,this.project.entities)})),{});return{ROOT_ENTITY:i,...s}}getGroup(e){return this.withGroup(e,(e=>e))}getGroupForItem(e){return this.getAllGroups().find((t=>t.itemIds.includes(e)))}getItemsForGroup(e){return this.getAllItems().filter((t=>t.groupId===e))}withGroup(e,t){const r=this.project.groups?this.project.groups[e]:void 0;if(r)return t(this.wrapGroup(r))}get(e){return this.project[e]}getHideCaptionsInPreview(){return this.project.metadata?.captions?.hideCaptionsInPreview||!1}getCaptionProfanityFilter(){return(0,A.S)(this.project)}getCaptionStyle(){const e=this.project.metadata?.captions?.style||{bounds:{...I},pluginFields:{...R}},{text:t,...r}=e.pluginFields||{};return{...e,pluginFields:r}}getCaptionTextConfig(){return this.project.metadata?.captions?.textConfig}getCaptioningEnabled(){return this.project.metadata?.captions?.enabled??!1}getCaptionRecognitionLanguage(){return(0,A.H)(this.project)}getRenderedCaptions(){let e={};for(const t of this.getAllTracks())e={...e,...t.getRenderedCaptions(this.project.aspectRatio)};return e}getAutoCompositionUsed(){return this.project.metadata?.autoComposition?.enabled??!1}getAutoCompositionConfig(){return this.project.metadata?.autoComposition}}class W extends z{constructor(e,t){super(e,t,"mut")}removeTrack(e){this.withTrack(e,(e=>{e.removeAllItems()})),this.removeTrackFromState(e)}removeEmptyTracks(){this.forEachTrack((e=>{e.isEmpty()&&this.removeTrack(e.id)}))}removeOverlapsAcrossTracks(){this.forEachTrack((e=>e.removeInvalidOverlaps()))}removeAllItemsForAsset(e){for(const t of this.getAllTracks())for(const r of t.getAllItems())r.assetId===e&&t.removeItem(r.id)}createCaptionTrack(){if(this.project.metadata?.captions?.hideCaptionsInPreview||!this.project.metadata?.captions?.enabled)return void this.removeCaptionTrack();let e=this.getCaptionTrack();e||(e=this.createTrack("caption",0));const t=this.project.tracks.allIds.indexOf(e.id);this.project.tracks.allIds=[e.id,...this.project.tracks.allIds.slice(0,t),...this.project.tracks.allIds.slice(t+1)]}removeCaptionTrack(){const e=this.getCaptionTrack();e&&this.removeTrack(e.id)}updateCaptionTrack(){const e=this.getCaptionTrack();if(!e)return;e.setHidden(!0),this.updateCaptionStyle(e),this.updateCaptionTextConfig(e);const t=this.getRenderedCaptions();t&&e.updateCaptionItems(t,this.getCaptionStyle(),this.getCaptionTextConfig(),this.aspectRatio)}syncCaptionTrack(){const e=this.getCaptionTrack();if(!e)return;e.setHidden(!0);const t=this.getRenderedCaptions();t&&e.updateCaptionItems(t,this.getCaptionStyle(),this.getCaptionTextConfig(),this.aspectRatio)}updateCaptionStyle(e){const t={...this.getCaptionStyle()};for(const r of e.getAllItems()){void 0===r.value.bounds&&void 0!==t?.bounds?this.updateCaptionStyleMetadata({bounds:void 0}):r.value.bounds&&JSON.stringify(r.value.bounds)!==JSON.stringify(t?.bounds)&&this.updateCaptionStyleMetadata({bounds:{...r.value.bounds}});const{text:e,...i}=r.value.fields||{};JSON.stringify(i)!==JSON.stringify(t?.pluginFields)&&this.updateCaptionStyleMetadata({pluginFields:{...i}})}}updateCaptionTextConfig(e){const t=this.getCaptionTextConfig();for(const r of e.getAllItems()){const e=r.captionTextConfig;if(!a()(e,t)){this.updateCaptionTextConfigMetadata(e);break}}}createTrack(e,t=0){const r=(0,m.u)(),i={id:r,hidden:!1,type:e,itemIds:[],transitionIds:[]};return this.project.tracks.allIds.splice(Math.max(t,0),0,r),this.project.tracks.byId[r]=i,this.wrapTrack(i)}getTrackIdFromIndex(e){return this.project.tracks.allIds[e]}removeTrackFromState(e){const t=this.project.tracks.allIds.indexOf(e);-1!==t&&this.project.tracks.allIds.splice(t,1),delete this.project.tracks.byId[e]}pasteToNewTracks(e,t){const r=[...e].reverse(),i=[];for(const e of r){const t=this.createTrack(e.type);i.push(...t.paste(e))}return(0,p.O9)(t)&&U(i,t),i}createEntities(e){const t={};for(const[r,i]of Object.entries(e)){t[r]||(t[r]=(0,m.u)());const e=t[r];let n=i.children;n.length>0&&(n=i.children.map((e=>(t[e]||(t[e]=(0,m.u)()),t[e]))));const o={...i,children:n};this.project.entities[e]=o}return t}splitItem(e,t){const r=this.getTrackWithItem(e);if(r)return r.withItem(e,(e=>{if(!e.canSplitAt(t))return;const i=e.transitionOutId,n=i?r.takeTransition(i):void 0,o=t-e.startTime,s=e.endTime-t,{clonedItem:a,entities:c}=this.cloneItem(e.id);if(c){const e=this.createEntities(c).ROOT_ENTITY;a.apply({rootEntity:e})}e.trimToDuration("to",o),a.trimToDuration("from",s),a.moveTo(e.endTime);const l=e.value.fadeInOut;l&&(e.apply({fadeInOut:{fadeInSeconds:l.fadeInSeconds,fadeOutSeconds:0}}),a.apply({fadeInOut:{fadeInSeconds:0,fadeOutSeconds:l.fadeOutSeconds}}));const d=r.getAllItems().map((e=>e.id)).indexOf(e.id);return r.addItem(a,d+1),n&&r.withItem(n.toId,(e=>{n.attachTo(r.allTransitions,r.value,a,e)})),[e,a]}))}cutInterval(e,t,r){const i=this.splitItem(e,t);i&&i[1].addTrim("from",r)}splitAllItems(e){return[...this.project.items.allIds].map((t=>this.splitItem(t,e))).filter(p.O9)}createEntity(e){const t=(0,m.u)();return this.project.entities||(this.project.entities={}),this.project.entities[t]=e,this.wrapEntity(e,t)}removeEntity(e,t){const r=this.project.entities[e];if(r){if(t?.removeChildren&&r.children.length>0)for(const e of r.children)this.removeEntity(e,t);delete this.project.entities[e]}}removeUnusedEntities(){const e=this.getAllItems().map((e=>e.rootEntityId)).filter(p.O9);if(0===e.length)return;const t=new Set(e),r=e=>{const i=this.entities[e];i&&i.children.forEach((e=>{t.add(e),r(e)}))};for(const t of e)r(t);for(const e of Object.keys(this.entities))t.has(e)||this.removeEntity(e,{removeChildren:!1})}removeUnusedContainers(){const e=this.project.extData?.containers.data||{},t=new Set(this.getAllItems().map((e=>e.id)));Object.keys(e||{}).forEach((r=>{t.has(r)||delete e[r]})),this.project.extData?.containers&&(this.project.extData.containers.data=e)}cleanUpContainers(){const e=this.project.extData?.containers.data||{},t=new Set;Object.entries(e).forEach((([r,i])=>{const n=i.items.filter((e=>this.getItem(e)));0===n.length?(t.add(r),delete e[r]):e[r]={...i,items:n}})),this.project.extData?.containers&&(this.project.extData.containers.data=e),t.forEach((e=>{this.getTrackWithItem(e)?.removeItem(e)}))}createGroup(){const e=(0,m.u)(),t={name:`Group ${Object.values(this.project.groups).length+1}`,id:e,itemIds:[]};return this.project.groups[e]=t,this.wrapGroup(t)}removeGroup(e){delete this.project.groups[e]}addItemToGroup(e,t){const r=Object.values(this.project.groups).find((e=>e.itemIds.includes(t))),i=this.getItem(t);if((0,f.iY)(i,"Expected item to be defined when adding to group"),r&&i){const e=this.getGroupForItem(t);(0,f.iY)(e,"Expected group to be defined"),e?.removeItem(i)}const n=this.getGroup(e);(0,f.iY)(n,"Expected group to be defined when adding an item"),n.addItem(i)}removeEmptyGroups(){for(const e of Object.values(this.project.groups))if(e.itemIds.length<=1){const t=e.itemIds;for(const e of t){const t=this.getItem(e);if(t?.groupId){const e=this.getGroup(t.groupId);(0,f.iY)(e,"Expected group to be defined when using groupId to get Group."),e.removeItem(t)}}this.removeGroup(e.id)}Object.values(this.project.extData?.containers||{}).filter(O).forEach((e=>{e.items.length<=1&&delete this.project.extData?.containers[e.id]}))}removeMissingItems(){for(const e of Object.values(this.project.groups))for(const t of e.itemIds)if(!this.project.items.allIds.includes(t)){const r=e.itemIds.indexOf(t);e.itemIds.splice(r,1)}}findNextAvailableContainerName(){const e=new Set(Object.values(this.extData?.containers.data||{}).map((e=>e.name)));let t,r=1;for(;void 0===t;)e.has(`Group ${r}`)?r++:t=`Group ${r}`;return t}createContainer(e,t){const r=new Set;if(e.forEach((e=>{const t=this.getTrackWithItem(e);t&&r.add(t.id)})),t){const e=this.getTrackWithItem(t);e&&r.add(e.id)}const i=[...r].sort(((e,t)=>this.getTrackIndex(t)-this.getTrackIndex(e))),n=[...i].at(-1);(0,f.iY)(n,"Expected trackStartingId to be defined when grouping items.");const o=this.getTrackIndex(n);i.forEach((t=>{const r=new Map,i=this.getTrack(t);(0,f.iY)(i,"Expected track to be defined when grouping items.");const n=this.createTrack(i.type,o);i.getAllItems().filter((t=>e.includes(t.id))).forEach((e=>{const{item:t,transitionIn:o,transitionOut:s}=i.takeItemAndTransitions(e.id);(0,f.iY)(t,"Expected item to be defined when detaching."),n.addItem(t),s&&(n.addTransition(s),r.set(n.id,s)),o&&r.set(n.id,o)})),r.forEach(((e,t)=>{this.getTrack(t)?.addTransition(e)})),i.isEmpty()&&this.removeTrack(i.id)}));const s=[...i].at(0),a=s?this.getTrack(s):void 0,l=e.map((e=>this.getItem(e))),d=Math.min(...l.map((e=>void 0===e?.startTime?Number.MAX_SAFE_INTEGER:e?.startTime))),u=Math.max(...l.map((e=>void 0===e?.endTime?0:e?.endTime))),h={id:(0,m.u)(),startTime:d,duration:u-d,assetId:c.t,componentHint:"container"};let p;if(!a||"video"!==a.type||a?.doesRangeOverlap(d,u,[])){const t=this.createTrack("video",o+e.length);p=t.addNormalizedItem({...h,trackId:t.id})}else p=a.addNormalizedItem({...h,trackId:a.id});return p&&this.setExtData("containers",{version:"0.0.0",data:{...this.extData?.containers.data,[p.id]:{id:p.id,items:e,name:this.findNextAvailableContainerName()}}}),p}removeContainer(e){const t=this.getItem(e);if(!t)return void l.Vy.error(new g.g9("Expected containerItem to be defined when removing from group.",{containerId:e}));const r=this.getTrack(t?.trackId);if(!r)return void l.Vy.error(new g.g9("Expected containerTrack to be defined when removing from group.",{containerId:e}));r.removeItem(t.id);const i=[],n=this.extData?.containers.data;if(n?.[e]&&O(n[e])){const t=n?.[e].items;delete n[e],this.setExtData("containers",{version:"0.0.0",data:{...n}}),i.push(...t)}return i}updateContainers(){const e=(e,t)=>{const r=this.getTrackIndex(e.trackId),i=this.getTrackIndex(t.trackId);return r===i?e.startTime-t.startTime:r-i};this.containers.sort(((t,r)=>{const i=this.getItem(t.id),n=this.getItem(r.id);return i&&n?e(i,n):0})).forEach((t=>{const r=this.getItem(t.id);if(r){const i=t.items.map((e=>this.getItem(e))).filter(p.O9);if(0===i.length)return;const n=Math.min(...i.map((e=>e.startTime))),o=r.startTime-n;0!==o&&i.forEach((e=>e.moveTo(e.startTime+o)));const s=new Set(i.map((e=>e.trackId))),a=i.sort(e);this.project.tracks.allIds=this.project.tracks.allIds.filter((e=>!s.has(e))),this.project.tracks.allIds.splice(Math.max(this.getTrackIndex(r.trackId),0),0,...new Set(a.map((e=>e.trackId))))}}))}setName(e){this.project.name=e}setLastUsedTransitionId(e){this.project.lastUsedConfig={...this.project.lastUsedConfig,transition:{...this.project.lastUsedConfig?.transition,id:e}}}setLastUsedTransitionDuration(e){this.project.lastUsedConfig={...this.project.lastUsedConfig,transition:{...this.project.lastUsedConfig?.transition,duration:e}}}setLastUsedTextToSpeechConfig(e){this.project.lastUsedConfig={...this.project.lastUsedConfig,textToSpeech:e}}setExtData(e,t){this.project.extData={...this.project.extData,[e]:t}}removeExtData(e){this.project.extData&&delete this.project.extData[e]}updateRatio(e){this.project.aspectRatio=e,this.disableAutoRatioUpdates()}disableAutoRatioUpdates(){this.project.aspectRatioManuallyUpdated=!0}logFeatureInteraction(e){this.project.analytics={...this.project.analytics,featureInteractions:{...this.project.analytics?.featureInteractions,[e]:!0}}}apply(e){"function"==typeof e&&(e=e(this.project)),Object.assign(this.project,function(e){e={...e};for(const t of j)delete e[t];return e}(e))}updateCaptionStyleMetadata(e){this.project.metadata||(this.project.metadata={}),this.project.metadata={...this.project.metadata,captions:{...this.project.metadata?.captions,style:{...this.project.metadata?.captions?.style,...e}}}}updateCaptionTextConfigMetadata(e){this.project.metadata||(this.project.metadata={}),this.project.metadata={...this.project.metadata,captions:{...this.project.metadata?.captions,textConfig:e}}}setHideCaptionsInPreview(e){this.project.metadata={...this.project.metadata,captions:{...this.project.metadata?.captions,hideCaptionsInPreview:e}}}setCaptioningEnabled(e){this.project.metadata={...this.project.metadata,captions:{...this.project.metadata?.captions,enabled:e}}}setCaptionRecognitionLanguage(e){this.project.metadata={...this.project.metadata,captions:{...this.project.metadata?.captions,recognitionLanguage:e}}}setCaptionProfanityFilter(e){this.project.metadata={...this.project.metadata,captions:{...this.project.metadata?.captions,profanityFilter:e}}}setHasCaptionSurveyBeenCompleted(e){this.project.metadata={...this.project.metadata,captions:{...this.project.metadata?.captions,hasCaptionSurveyBeenCompleted:e}}}setAssets(e){this.project.assets={allIds:e.map((e=>e.id)),byId:Object.fromEntries(e.map((e=>[e.id,e])))}}updateAutoCompMetadata(e){this.project.metadata=(0,i.jM)(this.project.metadata||{},(t=>{t.autoComposition={...t.autoComposition,...e}}))}updateBrandKitMetadata(e){this.project.metadata=(0,i.jM)(this.project.metadata||{},(t=>{t.brandKit=e}))}incrementTimeSpentEditing(e){void 0===this.project.timeSpentEditingMs&&(this.project.timeSpentEditingMs=0),this.project.timeSpentEditingMs+=e}processHighlights(e,t,r={}){return this.revertHighlightChangesMap(r),this.doProcessHighlights(function(e){const t={};for(const r of e)t[r.trackItemId]||(t[r.trackItemId]=[]),t[r.trackItemId].push(r);return t}(e),t)}doProcessHighlights(e,t){const r={};for(const i of Object.keys(e)){const n=e[i].sort(((e,t)=>e.endTimeS-t.endTimeS));if(0===n.length)continue;const o=this.getItem(i),s=o?.asset.value;if(!o||!(0,h.S)(s))continue;const a=this.getTrack(o?.trackId);if(!a)continue;const c=(0,d.Rb)(o.value,s,n,t),l={originalTrackItemSnapshot:{...o.clone().value,id:o.id},trackSnapshot:{type:a.type},resultingTrackItemIds:[]};if(0===c.length)a.removeItem(o.id),r[i]=l;else{const e=a.trimItemToOffsets(c,o,this.aspectRatio)?.map((e=>e.id));r[i]={...l,resultingTrackItemIds:e??[]}}}return r}revertHighlightChangesMap(e){for(const[t,r]of Object.entries(e))r&&(this.removeHighlightChangesChildItems(r,t),this.restoreHighlightChangesParentItem(r,t))}removeHighlightChangesChildItems(e,t){const r=e.resultingTrackItemIds.filter((e=>e!==t));for(const e of r){const t=this.getItem(e);t&&this.getTrack(t.trackId)?.removeItem(t.id)}}restoreHighlightChangesParentItem(e,t){const r=this.getItem(t);if(r)r.setTrim("from",e.originalTrackItemSnapshot.trim.from),r.setTrim("to",e.originalTrackItemSnapshot.trim.to),r.moveTo(e.originalTrackItemSnapshot.startTime);else{let r=this.getTrack(e.originalTrackItemSnapshot.trackId);r||(r=this.createTrack(e.trackSnapshot.type)),r.addNormalizedItem(e.originalTrackItemSnapshot)||l.Vy.error(`Failed to restore original track item with id ${t}.`)}}}},554951:(e,t,r)=>{function i(e,t,r){return r.ticksToSeconds("DurationTicks"===t?r.durationSecondsToTicks(e):r.mediaSecondsToTicks(e))}r.d(t,{R:()=>i})},656717:(e,t,r)=>{r.d(t,{a8:()=>m,l0:()=>g});var i,n,o=r(324586),s=r(725874),a=r(825702),c=r(562229),l=r(138615),d=r(739367),u=r(776016),h=r(956074);let p=(0,a.Gr)()(i=class{constructor(){(0,o.A)(this,"releaseTarget",void 0),(0,o.A)(this,"validator",void 0),(0,o.A)(this,"logMismatchOnce",!1),(0,o.A)(this,"forceNextModule",!1)}getReleaseTarget(){const e=this.forceNextModule||this.getUseSchemaNext()?"next":"stable";return!(0,u.O9)(this.releaseTarget)||this.forceNextModule?this.releaseTarget=e:this.releaseTarget===e||this.logMismatchOnce||(this.logMismatchOnce=!0,c.z.logEvent("Project - Schema Module Release Target Mismatch",{current:this.releaseTarget,next:e})),this.releaseTarget}async lazyLoadModule(){return this.getUseLoadWithRetrySchema()?await(0,h.V)((()=>this.importProjectSchemaModule()))():this.importProjectSchemaModule()}async importProjectSchemaModule(){return"stable"===this.getReleaseTarget()?r.e(76274).then(r.bind(r,585569)):r.e(99176).then(r.bind(r,614876))}forceNext(){this.forceNextModule=!0,this.getUseSchemaNext()||(c.z.logEvent("Project - Force Schema Module Next"),c.z.logAppLogicEvent("ProjectSchemaModuleForceNext",{stableVersion:"6.3.10",nextVersion:"6.4.0"}))}getUseSchemaNext(){return(0,l.G7)("pst__enable_schema_next_v6a")}getUseLoadWithRetrySchema(){return(0,l.G7)("pst__load_with_retry_project_schema")}getSchemaVersion(){return this.lazyLoadModule().then((({CURRENT_PROJECT_SCHEMA_VERSION:e})=>e))}getUnknownProjectGuard(){return this.lazyLoadModule().then((({isUnknownProject:e})=>e))}getUnsupportedProjectError(){return this.lazyLoadModule().then((({UnsupportedProjectError:e})=>e))}async getCreateEmptyProjectSchema(){return{createEmptyProjectSchema:(await this.lazyLoadModule()).createEmptyProjectSchema}}lazyInitValidator(){return this.lazyLoadModule().then((({ProjectSchemaValidator:e})=>new e))}async getValidator(){return(0,u.O9)(this.validator)||(this.validator=await this.lazyInitValidator()),this.validator}getMigrator(){return this.lazyLoadModule().then((({migrateProject:e})=>({migrateProject:e})))}getRecovery(){return this.lazyLoadModule().then((({recoverProjectSchema:e})=>({recoverProjectSchema:e})))}})||i,m=(0,a.Gr)()((f=n=Reflect.metadata("design:type",Function)(n=Reflect.metadata("design:paramtypes",[void 0===p?Object:p])(n=class{constructor(e){this.projectSchemaModuleFactory=e}getAvailableModuleVersions(){return{stableVersion:"6.3.10",nextVersion:"6.4.0"}}getVersion(){return this.projectSchemaModuleFactory.getSchemaVersion()}getUnknownProjectGuard(){return this.projectSchemaModuleFactory.getUnknownProjectGuard()}async createUnsupportProjectError(e,t){return new(await this.projectSchemaModuleFactory.getUnsupportedProjectError())(e,t)}async migrate(e){this.checkForNextVersion(e);const t=(0,l.G7)("pst__recover_schema");return(await this.projectSchemaModuleFactory.getMigrator()).migrateProject(e,{runRecovery:t,logger:this.recoveryLogger()})}async recover(e){return(await this.projectSchemaModuleFactory.getRecovery()).recoverProjectSchema(e,{logger:this.recoveryLogger()})}async validate(e){return(await this.projectSchemaModuleFactory.getValidator()).validate(e)}async createEmptyProjectSchema(e="New Project",t){return(await this.projectSchemaModuleFactory.getCreateEmptyProjectSchema()).createEmptyProjectSchema(e,t)}checkForNextVersion(e){(0,u.Kg)(e.schemaVersion)&&(0,s.major)(e.schemaVersion)===(0,s.major)("6.4.0")&&(0,s.major)("6.4.0")>(0,s.major)("6.3.10")&&this.projectSchemaModuleFactory.forceNext()}recoveryLogger(){return(0,l.G7)("pst__log_schema_recovery")?(e,t)=>{c.z.logEvent(e,t)}:void 0}})||n)||n,n=(0,a.WQ)(p)(f,void 0,0)||n))||n;var f;const g=()=>(0,d.l)(m)},529743:(e,t,r)=>{r.d(t,{x:()=>o});var i=r(776016);const n=(0,i.t9)({message:(0,i.u)("Project schema is an unsupported version"),projectVersion:(0,i.ey)(i.Kg,i.Et),clientVersion:i.Kg,minimumVersion:(0,i.H7)(i.Kg)});function o(e){return e instanceof Error&&n(e)}(0,i.t9)({message:(0,i.u)("Project schema is an invalid structure"),action:(0,i.u)("downgrade","migrated"),projectVersion:(0,i.ey)(i.Kg,i.Et),clientVersion:i.Kg,deepestErrorPath:(0,i.H7)(i.Kg),errorCount:(0,i.H7)(i.Et)})},489077:(e,t,r)=>{r.d(t,{Eu:()=>f,FS:()=>m,e8:()=>h,jN:()=>u,u2:()=>p});var i=r(289111),n=r.n(i),o=r(345153),s=r(272885),a=r(588831),c=r(637519),l=r(487115),d=r(472565);function u(){return(0,o.sl)((e=>(0,l.gO)(e,(0,s.eS)())))}const h=(e,t)=>!((e,t)=>{const r=["version","updatedAt",...a.v];return n()((0,c.c)(e,r),(0,c.c)(t,r))})(e,t),p=(e,t)=>e.id===t.id;function m(e){if(!e)return;const t=(0,o.U1)((e=>e)),r=(0,s.eS)();return(0,d.F)(e,t,r)}function f(){return(0,o.sl)((e=>e?(0,l.d3)(e.assets.allIds,e.assets.byId):[]))}},10960:(e,t,r)=>{r.d(t,{CF:()=>a,t6:()=>c,u0:()=>o,vl:()=>s});var i=r(165620),n=r(824378);const o=e=>e?.type&&("image"===e.type||"video"===e.type||"background"===e.type||"title"===e.type||"audio"===e.type||"procedural"===e.type||"component"===e.type);function s(e,t){const r={video:"video",background:"video",image:"video",title:"title",procedural:"video",overlay:"title",audio:"audio",logo:"logo",watermark:"watermark",caption:"caption",component:"title"};if("text-to-speech"===t)return"audio";if(t&&(0,i.cL)(t))return"title";if("background-smart-group"===t)return"video";if("shape"===t)return"video";if("container"===t)return"video";if((0,n.u)(e))return(0,n.r)(e.entities,"com.clipchamp.text")?"title":"video";if(e.appearAsType){if("filter"===e.appearAsType)throw new Error("Filters cannot become tracks");if("transition"===e.appearAsType)throw new Error("Transitions cannot become tracks");return r[e.appearAsType]}return r[e.type]}function a(e){return e.reduce(((e,t)=>{if(0===t.items.length||t.hidden)return e;const r=t.items.at(-1);return Math.max(e,r.startTime+r.duration)}),0)}function c(e){let t=0;for(const r of e)t=Math.max(t,r.startTime+r.duration);return t}},472565:(e,t,r)=>{r.d(t,{F:()=>a});var i=r(138615),n=r(908545),o=r(650882),s=r(487115);function a(e,t,r){if(!t)return;const a=t.items.byId[e];if(!a)return;const c=Object.values(t.tracks.byId).filter((e=>e.itemIds.includes(a.id)));if(1!==c.length)throw new o.g9("TrackItem is missing, or owned by multiple tracks",{id:e,containingTrackItems:c.length});const l=c[0].id,d=(0,n.n)(t.assets,r);return(0,i.Us)("ks_editor_track_item_for_id_asset_required")||d[a.assetId]&&t.items.allIds.includes(a.id)?(0,s.jg)(a,t.items.transitions,d,l):void 0}},965184:(e,t,r)=>{r.d(t,{D:()=>s,F:()=>o});var i=r(324586);r(379321);const n=.25;class o{constructor(e){this.transition=e}get id(){return this.transition.id}get value(){return this.transition}get durationInS(){return this.transition.durationInS}get toId(){return this.transition.toId}get fromId(){return this.transition.fromId}UNSAFE__detached(){return new s(this.transition)}}class s extends o{constructor(...e){super(...e),(0,i.A)(this,"detached",!0)}setDuration(e){this.transition.durationInS=e}setAsset(e){this.transition.asset=e.id}attachTo(e,t,r,i){const o=this.id;if(!this.detached)throw new Error("Expected transition to be detached");if(r.id===i.id)throw new Error("Cannot add transition when both items are the same");if(r.trackId!==t.id||i.trackId!==t.id)throw new Error("Expected items to belong to the same track");if(e[o])throw new Error("Transition already exists in transition state");if(t.transitionIds.includes(o))throw new Error("Track already references transition");if(i.availableTransitionSpace<n||r.availableTransitionSpace<n)return;this.detached=!1,this.transition.toId=i.id,this.transition.fromId=r.id,t.transitionIds.push(o),e[o]=this.transition;const s=Math.max(Math.min(i.availableTransitionSpace,r.availableTransitionSpace,this.durationInS),n),a=s/2;let c=r.duration+a,l=i.duration+a;const d=r.originalDuration/r.speed,u=i.originalDuration/i.speed;r.asset.hasFiniteLength&&d<c&&(l+=c-d,c=d),i.asset.hasFiniteLength&&u<l&&(c+=l-u,l=u),r.trimToDuration("to",c,!0),i.trimToDuration("from",l,!0);const h=Math.min(r.duration,i.duration,s);i.moveTo(r.endTime-h),this.transition.durationInS=h,i.setTransitionIn(this),r.setTransitionOut(this)}}},393810:(e,t,r)=>{r.d(t,{BB:()=>d,Cq:()=>v,J1:()=>C,Ln:()=>a,N0:()=>f,QH:()=>n,UN:()=>c,a1:()=>w,d_:()=>y,f2:()=>o,fJ:()=>S,k$:()=>h,kn:()=>s,ov:()=>g,qw:()=>m,rV:()=>A,su:()=>T,ts:()=>p,x2:()=>b,zj:()=>u}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(869211);function n(e,t){return t[e]}const o={x:.5,y:.5};function s(e,t){return t.segments.find((t=>t.type===e))}function a(e,t){return t.segments.filter((t=>t.type===e))}function c(e){const t=e=>({name:e.properties.name,value:e.properties.value});return Array.isArray(e)?e.flatMap((e=>a("variableDefine",e).map(t))):a("variableDefine",e).map(t)}const l=(e,t)=>(e.segments.map(t),e);function d(e,t){return l(t,(t=>{"variableDefine"===t.type&&t.properties.name===e.name&&(t.properties.value=e.value)}))}function u(e,t){return l(t,(t=>{"contentFixedWidth"===t.type&&(t.properties.width=e)}))}function h(e,t){return l(t,(t=>{"contentFixedHeight"===t.type&&(t.properties.height=e)}))}function p(e){const t=s("contentFixedWidth",e);return t?.properties.width??0}function m(e){const t=s("contentFixedHeight",e);return t?.properties.height??0}function f(e){const t=s("layoutAbsolute",e);return t?.properties.targetPos??o}function g(e){const t=s("layoutAbsolute",e);return t?.properties.anchorPos??o}function A(e,t){return l(t,(t=>{"layoutAbsolute"===t.type&&(t.properties.targetPos=e)}))}function v(e,t){return l(t,(t=>{"contentPlacement"===t.type&&(t.properties={...t.properties,...e.properties})}))}function y(e,t,r){return l(r,(r=>{"transformRotate"===r.type&&(r.properties.rotation=e,r.properties.origin=t)}))}function b(e,t,r){return y(e,t,r)}function w(e,t,r){return b((0,i.tR)(e),t,r)}function x(e){const t=s("transformRotate",e);if(t){const{rotation:e,origin:r}=t.properties;return{rotation:e,origin:r}}return{rotation:0,origin:o}}function S(e){return x(e)}function T(e){const t=x(e);return{...t,rotation:(0,i.nv)(t.rotation??0)}}function C(e){return a("displayText",e).map((e=>e.properties.text)).join("").trim()??""}},751108:(e,t,r)=>{r.d(t,{SX:()=>s,jy:()=>c});var i=r(655882),n=r(825702),o=r(776016);function s(){const e=n.kL.resolve(i.E);if(!(0,o.O9)(e))throw new Error("QueryClient is not registered");return e}function a(){return new i.E({defaultOptions:{queries:{retry:3,refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:36e5}}})}function c(){n.kL.register(i.E,{useFactory:(0,n.TS)(a)})}},925440:(e,t,r)=>{r.d(t,{$:()=>j,L:()=>O});var i=r(279541),n=r(571056),o=r(889688),s=r(573340),a=r(707050),c=r(650882),l=r(615101),d=r(324586),u=r(80801),h=r(677763);class p{constructor(e,t){(0,d.A)(this,"frameBuffer",void 0),(0,d.A)(this,"audioNode",void 0),this.root=e,this.audioContext=t}setConfig(){}updatePlayback(){}pollRead(e,t,r,i){return(0,u.Y)(t,i,{video:()=>this.pollReadVideo(),audio:()=>this.pollReadAudio()})}destroy(){this.frameBuffer?.free(),this.audioNode?.disconnect()}pollReadVideo(){return this.frameBuffer||(this.frameBuffer=this.root.allocImage(!1,1,1),this.frameBuffer.value.clear({red:.25,green:.25,blue:.25,alpha:1})),(0,h.eO)(this.frameBuffer)}pollReadAudio(){if(!this.audioContext)throw new Error("ErrorSource was created without an AudioContext");return this.audioNode||(this.audioNode=this.audioContext.createGain()),(0,h.eO)(this.audioNode)}}function m(e,t){return e.preferredWidth===t.preferredWidth&&e.preferredHeight===t.preferredHeight}class f{constructor(e,t,r){(0,d.A)(this,"bitmapSource",void 0),(0,d.A)(this,"frame",void 0),(0,d.A)(this,"waker",void 0),(0,d.A)(this,"lastParams",void 0),(0,d.A)(this,"isDestroyed",!1),(0,d.A)(this,"waitingForIdle",!1),this.root=r,this.bitmapSource=function(e,t){return"bitmap"===t?fetch(e).then((e=>e.blob())):new Promise(((t,r)=>{const i=document.createElementNS("http://www.w3.org/2000/svg","image");i.setAttribute("href",e),i.onload=()=>t(i),i.onerror=()=>r(new Error("Failed to load SVG image"))}))}(e,t),this.bitmapSource.then((async e=>{const t=await createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"premultiply"});this.isDestroyed||(this.frame=this.frame??this.root.allocCopyImage(),this.frame.value.upload(t,{isAlreadyPremult:!0,yFlipped:!0})),t.close()})).catch((e=>console.error("Failed to load original bitmap source on construction",e)))}destroy(){this.isDestroyed=!0,this.lastParams=void 0,this.frame?.free()}updatePlayback(){}setConfig(){}async resizeBitmap(){const e=this.lastParams;if(void 0===e)return;const t=await this.bitmapSource,r=await createImageBitmap(t,{imageOrientation:"flipY",premultiplyAlpha:"premultiply",resizeWidth:e.preferredWidth,resizeHeight:e.preferredHeight,resizeQuality:"medium"});if(!this.isDestroyed&&void 0!==this.lastParams&&m(e,this.lastParams)){const e=this.frame??this.root.allocCopyImage();e.value.upload(r,{isAlreadyPremult:!0,yFlipped:!0}),this.frame=e,this.waker?.wake(),this.waker=void 0}r.close()}resizeBitmapSync(){this.resizeBitmap().catch((e=>console.error("Failed to load and resize the bitmap:",e)))}pollReadVideo(e,t){this.waker=e;const r=this.lastParams;return this.lastParams=t,void 0===r?this.resizeBitmapSync():this.waitingForIdle||m(t,r)||(this.waitingForIdle=!0,requestIdleCallback((()=>{this.waitingForIdle=!1,this.resizeBitmapSync()}))),void 0===this.frame?h.eG:(0,h.eO)(this.frame)}pollRead(e,t,r,i){return(0,u.Y)(t,i,{video:t=>this.pollReadVideo(e,t)})}}var g=r(104173),A=r(736965);class v{constructor(e,t,r,i,n){(0,d.A)(this,"element",void 0),(0,d.A)(this,"audioNode",void 0),(0,d.A)(this,"frameBuffer",void 0),(0,d.A)(this,"currentVideoWaker",void 0),(0,d.A)(this,"lastSeek",{type:"paused",mediaTime:(0,g.H)(0),canBeInaccurate:!1}),(0,d.A)(this,"isInaccurate",!1),(0,d.A)(this,"isWaiting",!0),this.root=r,this.clock=n,this.element=document.createElement("video"),this.element.preload="auto",this.element.crossOrigin="anonymous",this.element.playsInline=!1,this.element.src=e,i&&t.has("audio")?this.audioNode=new MediaElementAudioSourceNode(i,{mediaElement:this.element}):this.element.muted=!0;const o=()=>{this.isWaiting=!0};this.element.onwaiting=o,this.element.onseeking=o,this.element.oncanplay=()=>{this.isWaiting=!1,0!==this.element.videoWidth&&0!==this.element.videoHeight&&t.has("video")&&this.handleVideoFrame()};const s=()=>{this.handleVideoFrame(),this.element.requestVideoFrameCallback(s)};t.has("video")&&this.element.requestVideoFrameCallback(s)}updatePlayback(e){"paused"!==e.type||this.element.paused||this.element.pause();const t=this.getSeekTimeIfRequired(e);if(void 0!==t&&(this.isWaiting=!0,this.element.currentTime=this.convertToMediaTime(t)),"playing"!==e.type||!this.element.paused||!this.element.loop&&this.element.ended||this.element.play().catch((()=>{})),"paused"===e.type&&void 0===t){const t=(0,A._)(this.lastSeek,this.clock);this.lastSeek={type:"paused",mediaTime:t,canBeInaccurate:e.canBeInaccurate}}else this.lastSeek=e;this.isInaccurate="paused"===e.type&&e.canBeInaccurate}setConfig(e){if((this.element.loop!==e.loop||this.element.playbackRate!==e.playbackRate)&&(this.element.loop=e.loop,this.element.playbackRate=e.playbackRate,void 0!==this.lastSeek&&!this.isInaccurate)){const e=(0,A._)(this.lastSeek,this.clock);this.element.currentTime=this.convertToMediaTime(e)}}pollRead(e,t,r,i){return(0,u.Y)(t,i,{video:()=>this.pollReadVideo(e),audio:()=>this.pollReadAudio()})}destroy(){this.element.pause(),this.element.src="",this.element.srcObject=null,this.element.remove(),this.frameBuffer?.free()}convertToMediaTime(e){let t=this.clock.ticksToSeconds(e)*this.element.playbackRate;const r=this.element.duration;return this.element.loop&&Number.isFinite(r)&&r>0&&(t%=r),t}pollReadVideo(e){return this.currentVideoWaker=e,this.isWaiting||!this.frameBuffer?h.eG:(0,h.eO)(this.frameBuffer)}pollReadAudio(){if(!this.audioNode)throw new Error("Audio Node was not created");return(0,h.eO)(this.audioNode)}handleVideoFrame(){this.isWaiting||(void 0===this.frameBuffer||this.frameBuffer.value.pixelWidth===this.element.videoWidth&&this.frameBuffer.value.pixelHeight===this.element.videoHeight||(this.frameBuffer.free(),this.frameBuffer=void 0),this.frameBuffer??=this.root.allocCopyImage(),this.frameBuffer.value.upload(this.element,{isAlreadyPremult:!1,yFlipped:!1}),this.currentVideoWaker?.wake())}getSeekTimeIfRequired(e){const t=(0,A._)(e,this.clock);if("paused"===e.type)return e.canBeInaccurate?void 0:t;const r=Math.floor((0,A._)(this.lastSeek,this.clock));return Math.floor(t)!==r?t:void 0}}var y=r(126714),b=r(941750),w=r(668359),x=r(708451),S=(r(379321),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218),r(133743)),T=r(777689),C=r(476807),_=r(647306),k=r(641306),E=r(540076),I=r(152848),R=r(839718),F=r(118545);class P{constructor(e){(0,d.A)(this,"availableBuffers",[]),(0,d.A)(this,"frameData",void 0),(0,d.A)(this,"rgbTexture",void 0),this.root=e}getFrameData(){return this.frameData??=R.m.create(this.root),this.frameData}getRgbTexture(e=0,t=0){const r=this.rgbTexture;return void 0!==r&&r.value.relativeWidth===e&&r.value.relativeHeight===t?r:(this.rgbTexture?.free(),this.rgbTexture=0===e&&0===t?this.root.allocCopyImage():this.root.allocImage(!1,e,t),this.rgbTexture)}destroy(){this.frameData?.free(),this.rgbTexture?.free()}}class L{constructor(e,t,r){(0,d.A)(this,"type","data"),this.frame=e,this.sharedData=t,this.startTime=r}value(){return"raw"===this.frame.type?this.renderRaw(this.frame):this.renderWebCodec(this.frame)}destroy(){"raw"===this.frame.type?this.sharedData.availableBuffers.push(this.frame.data.buffer):this.frame.data.close()}renderWebCodec(e){const t=this.sharedData.getRgbTexture();return t.value.upload(e.data,{isAlreadyPremult:!1,yFlipped:!1}),t}renderRaw(e){const{width:t,height:r}=(0,C.tm)(e),i=this.sharedData.getRgbTexture(t,r),n=this.sharedData.getFrameData(),o={width:t,height:r};n.value.uploadFrame((0,F.v)(e.data,o,e.format===b.Ng.Yuva420P));const s=this.sharedData.root.ctx.renderers.get(I.C);return n.value.bindToRenderer(s,{frameResolution:o,verticalOffset:0,trackItemId:"peppermint"}),s.renderTo(i),i}}class N{constructor(e){(0,d.A)(this,"availableBuffers",[]),(0,d.A)(this,"startTime",0),(0,d.A)(this,"activeValue",void 0),this.config=e}seek(e){this.startTime=e}nextStartTime(){const e=(0,g.H)(this.startTime);return this.startTime+=1,e}setActiveValue(e){this.activeValue?.destroy(),this.activeValue=e}}class M{constructor(e,t){(0,d.A)(this,"type","data"),(0,d.A)(this,"startTime",void 0),(0,d.A)(this,"refCount",1),this.audio=e,this.sharedData=t,this.startTime=t.nextStartTime()}value(){return this.refCount+=1,this.sharedData.setActiveValue(this),this.audio.data}destroy(){this.refCount-=1,0===this.refCount&&this.sharedData.availableBuffers.push(this.audio.data.buffer)}}class B{constructor(e,t,r,i){(0,d.A)(this,"streams",[]),(0,d.A)(this,"playbackRate",1),(0,d.A)(this,"frameData",void 0),(0,d.A)(this,"audioData",void 0),this.demuxer=e,this.asset=t,this.clock=i,void 0!==e.config.video&&(this.frameData=new P(r),this.streams.push("video"));const n=e.config.audio;void 0!==n&&((0,E.vA)(n.samplesPerChunk===n.sampleRate/i.timebase),this.audioData=new N(n),this.streams.push("audio"))}readNext(e){const{frameData:t,audioData:r}=this;return(0,_.y)(e,{video:t?()=>this.readNextVideo(t):void 0,audio:r?()=>this.readNextAudio(r):void 0})}handleError(e){if(e instanceof T.DP)return k.K;if(e instanceof T.qB)return k.y;throw S.c.fromUnknownError(this.asset,e)}async readNextVideo(e){const t=e.availableBuffers.pop();let r;try{r=await this.demuxer.decodeVideo(t)}catch(e){return this.handleError(e)}const i=(0,C.v1)(r),n=this.clock.mediaSecondsToTicks(i/this.playbackRate);return new L(r,e,n)}async readNextAudio(e){const t=e.availableBuffers.pop();let r;try{r=await this.demuxer.decodeAudio(t)}catch(t){const i=this.handleError(t);return"end"===i.type?(r={type:"raw",data:new Float32Array(e.config.samplesPerChunk*e.config.channelCount)},{type:"end",lastData:new M(r,e)}):i}return new M(r,e)}seek(e){const t=this.clock.ticksToSeconds(e)*this.playbackRate;this.demuxer.seek(t).catch((e=>s.Vy.error(e))),this.audioData?.seek(e)}setConfig(e){const t=this.demuxer.config.audio;if(void 0!==t&&(t?.playbackRate??1)!==e.playbackRate)throw new Error("Changing Peppermint audio playback-rate currently unsupported");this.playbackRate=e.playbackRate}destroy(){this.demuxer.destroy().catch((e=>s.Vy.error(e))),this.frameData?.destroy()}}class D extends w.K{constructor(e,t,r,i,n,o,s){super(),this.inputFile=e,this.asset=t,this.root=r,this.clock=i,this.peppermintConfig=n,this.enabledStreams=o,this.config=s,this.setInner(this.createPeppermintSource())}setConfig(e){this.config.playbackRate!==e.playbackRate&&(this.config=e,this.enabledStreams.has("audio")&&this.setInner(this.createPeppermintSource())),super.setConfig(e)}createPeppermintSource(){const{inputFile:e,asset:t,enabledStreams:r,peppermintConfig:i,root:n,clock:o}=this;return new a._((async()=>{const s={inputFile:e};if(r.has("video")){const e=(0,y.il)(t.metadata.raw)?b.Ng.Yuva420P:b.Ng.Yuv420P;s.video={pixelFormat:e}}r.has("audio")&&(this.updatePlaybackRate(),s.audio=i.audio);const a=await i.manager.createFormatDemuxer(s),c=new B(a,t,n,o);return(0,x.I)(c,o,{maxLookAheadDuration:o.durationSecondsToTicks(i.maxLookAheadSeconds),loopDuration:o.durationSecondsToTicks(t.metadata.duration)})})())}updatePlaybackRate(){this.enabledStreams.has("audio")&&this.peppermintConfig.audio&&this.peppermintConfig.audio.playbackRate!==this.config.playbackRate&&(this.peppermintConfig.audio={...this.peppermintConfig.audio,playbackRate:this.config.playbackRate})}}function O(e,t,r,d){const u=(0,o.W)(n.e);return(n,o)=>new a._((async(n,o)=>{const s=d(n);if(void 0===s)throw new c.g9((0,l.vU)("Unresolved asset"),{assetId:n});if("filter"===s.type&&void 0!==s.preset.lutSrc)return new f(s.preset.lutSrc,"bitmap",e);const a=(await u.fetch(s)).permanentUrl,h=d(s.id)??s;switch(h.type){case"audio":case"video":return new v(a,o,e,t,r);case"image":return new f(a,(0,i.JZ)(h.metadata)?"vector":"bitmap",e);default:throw new c.g9((0,l.vU)("Unsupported asset type"),{type:h.type})}})(n,o).catch((r=>(s.Vy.error(r),new p(e,t)))))}function j(e,t,r,s){const d=(0,o.W)(n.e);return(n,o,u)=>new a._((async(n,o,a)=>{const u=s(n);if(void 0===u)throw new c.g9((0,l.vU)("Unresolved asset"),{assetId:n});if("filter"===u.type&&void 0!==u.preset.lutSrc)return new f(u.preset.lutSrc,"bitmap",e);const h=await d.fetch(u),p=h.getTranscoderInputFile(),m=s(u.id)??u;switch(m.type){case"video":case"audio":return function(e,t,r,i,n,o,s){return new D(e,t,r,i,n,o,s)}(p,m,e,t,r,o,a);case"image":return new f(h.permanentUrl,(0,i.JZ)(m.metadata)?"vector":"bitmap",e);default:throw new c.g9((0,l.vU)("Unsupported asset type"),{type:m.type})}})(n,o,u))}},764662:(e,t,r)=>{r.d(t,{A4:()=>d,T7:()=>c,VE:()=>l,a:()=>a});var i=r(324586),n=r(211854),o=r(573432),s=r(104173);class a extends o.z{constructor(e){super(!0,e)}getTime(){return(0,s.Ny)(n.S0.Now/1e3*this.timebase)}mediaSecondsToTicks(e){return(0,s.H)(e*this.timebase)}durationSecondsToTicks(e){return(0,s.z1)(e*this.timebase)}}class c extends o.z{constructor(e){super(!0,e)}getTime(){return(0,s.Ny)(performance.now()/1e3*this.timebase)}mediaSecondsToTicks(e){return(0,s.H)(e*this.timebase)}durationSecondsToTicks(e){return(0,s.z1)(e*this.timebase)}}class l extends o.z{constructor(e){super(!0,e)}getTime(){return(0,s.Ny)(Math.floor(performance.now()/1e3*this.timebase))}}class d extends o.z{constructor(e){super(!1,e),(0,i.A)(this,"currentTick",(0,s.Ny)(0))}getTime(){return this.currentTick}nextTick(){this.currentTick=(0,s.Ny)(this.currentTick+1)}}},225304:(e,t,r)=>{r.d(t,{Dr:()=>s,PL:()=>u,RG:()=>c,Xb:()=>d,iC:()=>p,j$:()=>l,l0:()=>m,vt:()=>a,yI:()=>h});var i=r(650882),n=r(776016),o=r(728306);class s extends i.g9{constructor(e,t,r,i){super(`NetworkError::${t}::${r?"online":"offline"}`,{errorType:"network",resource:e,method:t,online:`${r}`},!0),this.resource=e,this.method=t,this.online=r,this.originalError=i,i instanceof Error&&this.context&&(this.context.reason=i.message)}get errorCode(){return"NetworkError"}}class a extends i.g9{constructor(e,t){super(`NetworkAbortError::${t}`,{},!0),this.resource=e,this.method=t}get errorCode(){return"NetworkAbortError"}}class c extends i.g9{constructor(e,t,r){super("NetworkTypeError",{},!0),this.resource=e,this.method=t,this.originalError=r,r instanceof Error&&this.context&&(this.context.reason=r.message)}get errorCode(){return"NetworkTypeError"}}class l extends i.g9{constructor(e,t,r,i,o){if(super(`HTTPError::${t}`,{errorType:"http",resource:e,method:t,status:r,reason:i.statusText},!0),this.resource=e,this.method=t,this.status=r,this.response=i,this.body=o,this.context&&(0,n.Gv)(o))for(const[e,t]of Object.entries(o))((0,n.Kg)(t)||(0,n.Et)(t))&&(this.context[`body.${e}`]=t)}get errorCode(){return(0,o.j)(this.response)?`${this.response.requestInfo.apiType}-${this.response.requestInfo.resourceId}-${this.status}`:this.status.toString()}}class d extends l{constructor(e,t,r,i,n){super(e,t,r,i,n),this.context&&(this.context.errorType="retryable-http")}get errorCode(){return"RetryableHttpError"}}function u(e){return e instanceof d}const h=e=>e instanceof s||u(e);class p extends i.g9{constructor(e,t,r,i){super(`JsonParseError::${t}::${e.url}`,{response:e,method:t,requestBody:r,responseBody:i}),this.response=e,this.method=t,this.requestBody=r,this.responseBody=i}get errorCode(){return"JsonParseError"}}class m extends i.g9{constructor(e,t,r,i){super(`UnexpectedResponseBody::${t}::${e.url}`,{errors:i}),this.response=e,this.method=t,this.requestBody=r,this.errors=i}get errorCode(){return(0,o.j)(this.response)?`${this.response.requestInfo.apiType}-${this.response.requestInfo.resourceId}`:"UnexpectedResponseBody"}get errorContext(){const e=this.context?.errors;if(e)return e.join(", ")}}},431232:(e,t,r)=>{r.d(t,{H:()=>h}),r(95732);var i=r(138615),n=r(897868),o=r(728306),s=r(917218),a=r(225304);async function c(e,t,r){const{method:n,extraData:o,headers:s,retryableHttpCodes:c,signal:l}=r,d=r.body instanceof Blob||r.body instanceof FormData?r.body:JSON.stringify(r.body);let u;try{u=await e(t,{method:n,body:d,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",...s},signal:l},o)}catch(e){const n=e instanceof DOMException?e:e.cause;if(n&&"AbortError"===n.name)throw new a.vt(t,r.method);if(!(0,i.Us)("wal__reshape_type_error")&&e instanceof Error&&"TypeError"===e.name)throw new a.RG(t,r.method,e);throw new a.Dr(t,r.method,navigator.onLine,e)}if(!u.ok){const e=await u.json().catch((()=>{}));if(c?.some((e=>e===u.status)))throw new a.Xb(t,n,u.status,u,e);throw new a.j$(t,n,u.status,u,e)}return u}async function l(e,t,r){const i=r.retryPolicy||{maxAttempts:1,doRetry:()=>!1},n=(0,s.b)(i);return await n((async()=>await c(e,t,r)))()}const d=e=>Object.assign(e,{json:t=>e.then((e=>e.json(t)))}),u=(e,t)=>e.retryPolicy||t.retryPolicy?{maxAttempts:3,...e.retryPolicy,...t.retryPolicy}:void 0;function h(e,t={}){const r=(r,i={method:"GET"})=>{const s=async function(e,t,r){const{method:i}=r,s=r.retryPolicy?l:c;let d;try{d=await s(e,t,r),r.onSuccess&&(0,o.j)(d)&&r.onSuccess(d.requestInfo)}catch(e){throw r.onError&&e instanceof a.j$&&(0,o.j)(e.response)&&r.onError(e,e.response.requestInfo),e}const u=d.clone(),h=d.json.bind(d),p={json:async e=>{const t=r.body instanceof Blob?r.body:JSON.stringify(r.body),o=await h().catch((()=>{throw new a.iC(u,i,t,async function(e){try{return await e.clone().text()}catch{return""}}(d))})),s=new n.q("JsonGuard");if(!e(o,s))throw new a.l0(d,i,t,s.errors());return o}};return Object.assign(d,p)}(e,r,{...t,...i,retryPolicy:u(t,i)});return d(s)},i=o.I.reduce(((e,t)=>(e[t.toLowerCase()]=function(e,t){return(r,i)=>e(r,{...i,method:t})}(r,t),e)),{});return Object.assign(r,i)}},91436:(e,t,r)=>{r.d(t,{BR:()=>o,O6:()=>s,eC:()=>n});var i=r(26985);const n=(0,r(831123).vt)((()=>({offline:!navigator.onLine}))),o=e=>n.setState({offline:e}),s=()=>{(0,i.useEffect)((()=>{const e=()=>{o(!0)},t=()=>{o(!1)};return o(!navigator.onLine),window.addEventListener("offline",e),window.addEventListener("online",t),()=>{window.removeEventListener("offline",e),window.removeEventListener("online",t)}}),[])}},298060:(e,t,r)=>{r.d(t,{L:()=>l,S:()=>c});var i=r(225304),n=r(917218),o=r(91436);const s=(0,r(831123).vt)((()=>({retryState:"none",retrySubject:"sync",onRetry:()=>{}}))),a=e=>s.setState({retryState:e}),c=e=>(e instanceof i.Dr&&"none"===s.getState().retryState&&(0,o.BR)(!0),e instanceof i.Dr||(0,i.PL)(e)),l=(e,t="sync",r={maxAttempts:100,exponentialOption:{maxInterval:5e3,multiplier:0},backOff:0,backOffPolicy:"fixed",doRetryCondition:e=>e instanceof i.Dr})=>{const{doRetryCondition:c,...l}=r,d=(0,n.b)({...l,doRetry:e=>{return c?.(e)||e instanceof i.Dr?((0,o.BR)(!1),a("prompt"),r=t,s.setState({retrySubject:r}),new Promise((e=>s.setState({onRetry:t=>{s.setState({retryState:"retrying"}),e(t)},retryState:"prompt"})))):Promise.resolve(!1);var r}});return()=>d(e)().then((e=>(a("none"),(0,o.BR)(!1),e)))}},271716:(e,t,r)=>{function i(e){const t=e.trim().split(/[\n\r]+/),r={};for(const e of t){const t=e.split(": "),i=t.shift(),n=t.join(": ");void 0!==i&&i.trim().length>0&&(r[i]=n.trim())}return r}r.d(t,{r:()=>n});const n=(0,r(431232).H)(((e,t,r)=>{const n=new XMLHttpRequest;function o(){n.abort()}n.open(t.method,e,!0),r?.excludeHeaders&&r?.excludeHeaders.forEach((e=>{delete t.headers[e]}));for(const[e,r]of Object.entries(t.headers))n.setRequestHeader(e,r);return r&&(r?.responseType&&(n.responseType=r?.responseType),r.onProgress&&(void 0!==t.body&&(n.upload.onprogress=r.onProgress),n.onprogress=r.onProgress),t.signal&&t.signal.addEventListener("abort",o,{once:!0})),new Promise(((e,s)=>{if(n.onload=async()=>{let s=n.response;return"json"===r?.responseType&&(s=JSON.stringify(s)),t?.signal?.removeEventListener("abort",o),e(new Response(s,{status:n.status,statusText:n.statusText,headers:i(n.getAllResponseHeaders())}))},n.onerror=()=>{t?.signal?.removeEventListener("abort",o),s(n.statusText)},n.onabort=()=>{s("cancelled")},t?.signal?.aborted)return s("cancelled");n.send(t.body)}))}))},728306:(e,t,r)=>{r.d(t,{I:()=>i,j:()=>n});const i=["GET","POST","PUT","PATCH","DELETE","HEAD"],n=e=>void 0!==e.requestInfo},527690:(e,t,r)=>{r.d(t,{O:()=>n});var i=r(650882);class n extends Error{constructor(e){for(;e instanceof n;)e=e.innerError;let t;e instanceof Error&&(t=e.message),super(t),this.innerError=e,e instanceof Error&&(0,i.Op)(this,e)}}},720315:(e,t,r)=>{r.d(t,{P:()=>s});var i=r(650882),n=r(527690);const o=async(e,t,r,{maxAttempts:s,backOff:a,backOffPolicy:c,exponentialOption:l,getManualBackOff:d,doRetry:u})=>{try{return await t.apply(e,r)}catch(p){if(p instanceof n.O)throw p.innerError;const m=(0,i.xM)(p,"Error retrying");if(--s<=0)throw m;const f=await u.apply(e,[m,...r]);if(!f)throw m;let g;return Array.isArray(f)&&(r=f),a&&await(h=a,new Promise((e=>setTimeout(e,h)))),d&&(g=d(m)),g||"exponential"!==c||(g=a*l.multiplier),g&&(a=Math.min(g,l.maxInterval)),o(e,t,r,{maxAttempts:s,backOff:a,backOffPolicy:c,exponentialOption:l,doRetry:u})}var h},s=({maxAttempts:e,backOffPolicy:t="fixed",backOff:r=0,getManualBackOff:i,doRetry:n=function(){return!0},exponentialOption:s={maxInterval:2e3,multiplier:2}})=>{const a={maxAttempts:e,backOffPolicy:t,backOff:r,doRetry:n,getManualBackOff:i,exponentialOption:s};return"exponential"!==a.backOffPolicy||a.backOff||(a.backOff=1e3),(e,t,r)=>{const i=r.value;if(!i)throw new Error("Wrapped function/method is undefined");return r.value=async function(...e){return o(this,i,e,a)},r}}},917218:(e,t,r)=>{r.d(t,{b:()=>s});var i=r(650882),n=r(527690);const o=async(e,t,{maxAttempts:r,backOff:s,backOffPolicy:a,exponentialOption:c,getManualBackOff:l,doRetry:d,catch:u,retried:h=!1,retryCount:p=0})=>{try{return await e({...t,retried:h,retryCount:p})}catch(h){if(h instanceof n.O)return u((0,i.xM)(h.innerError,"Error retrying"),t);const f=(0,i.xM)(h,"Error retrying");if(--r<=0)return u(f,t);const g=await d(f,t);if(!1===g)return u(f,t);let A;return!0!==g&&(t=g),s&&await(m=s,new Promise((e=>setTimeout(e,m)))),l&&(A=l(f,p)),A||"exponential"!==a||(A=s*c.multiplier),A&&(s=Math.min(A,c.maxInterval)),o(e,t,{maxAttempts:r,backOff:s,backOffPolicy:a,exponentialOption:c,doRetry:d,catch:u,retried:!0,retryCount:p++})}var m},s=({maxAttempts:e=3,backOffPolicy:t="fixed",backOff:r=0,getManualBackOff:i,doRetry:n=()=>!0,catch:s=e=>{throw e},exponentialOption:a={maxInterval:2e3,multiplier:2}})=>c=>{const l={maxAttempts:e,backOffPolicy:t,backOff:r,getManualBackOff:i,doRetry:n,exponentialOption:a,retried:!1,retryCount:0,catch:s};return"exponential"!==l.backOffPolicy||l.backOff||(l.backOff=1e3),async e=>o(c,e,l)}},549443:(e,t,r)=>{r.d(t,{K4:()=>u,iu:()=>d,gW:()=>c});var i=r(431232),n=r(53338),o=r(776016),s=r(7089);const a=(0,n.r)("https://graph.microsoft.com","https://graph.microsoft-ppe.com"),c=(0,o.u)(...a);let l;const d=(e,t="https://graph.microsoft.com",r={})=>{l=function(e,t,r={}){return(0,i.H)((async(r,i,n)=>{const o=await e(n),a=(0,s.u)(),c=new Headers({Authorization:`Bearer ${o}`,"client-request-id":a,...i?.headers});n?.excludeHeaders?.forEach((e=>c.delete(e)));let l=r;var d;(e=>new RegExp("^(?:[a-z+]+:)?//","i").test(e))(r)||(l=`${t}/${n?.version||"v1.0"}${d=r,d.startsWith("/")?d:"/"+d}`);const u=window.performance.now(),h=Date.now(),p=await fetch(l,{...i,headers:c}),m=p.headers.get("request-id")||void 0,f=window.performance.now()-u,g={apiType:"graph",requestId:a,responseId:m,resourceId:n?.resourceId,method:i.method,status:p.status,requestTimestamp:h,durationMs:f,correlationId:n?.correlationId};return Object.assign(p,{requestInfo:g})}),r)}(e,t,r)},u=()=>{if(!(0,o.O9)(l))throw new Error("[Request Graph API] Request Graph API has not been initialised");return l}},773395:(e,t,r)=>{r.d(t,{f:()=>s});var i=r(324586),n=r(902851),o=r(268161);class s{constructor(e){if((0,i.A)(this,"_store",void 0),e<0)throw new Error("capacity must be >= 0");this._store={inputGeneration:0,currentCycle:0,capacity:e,derived:new Map,list:[],inputValues:new WeakMap}}getCapacity(){return this._store.capacity}getSize(){return this._store.list.length}clear(){for(const e of this._store.list)(0,n.z)(e.value);this._store.inputGeneration=0,this._store.currentCycle=0,this._store.derived.clear(),this._store.list.length=0}read(e,...t){return this._store.currentCycle++,e({_store:this._store,_dependencies:[]},...t)}set(e,t){const r=this._store.inputValues.get(e._key);void 0!==r||(0,o.n4)(e._initial,t)||this._store.inputValues.set(e._key,{value:t,valueGeneration:1}),void 0===r||(0,o.n4)(r.value,t)||(r.value=t,r.valueGeneration++),this._store.inputGeneration++}}},902851:(e,t,r)=>{r.d(t,{S:()=>i,z:()=>n});const i=Symbol();function n(e){if(null==e)return;const t=e;t[i]&&t[i]()}},268161:(e,t,r)=>{r.d(t,{LC:()=>k,Zd:()=>E,n4:()=>N,tW:()=>_}),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);const i=2147483647,n=2147483646,o=new ArrayBuffer(8),s=new Float64Array(o),a=new Uint32Array(o),c=Object.prototype.toString,l="[object Arguments]",d="[object Array]",u="[object Map]",h="[object Set]",p="[object ArrayBuffer]",m="[object DataView]",f="[object Float32Array]",g="[object Float64Array]",A="[object Int8Array]",v="[object Int16Array]",y="[object Int32Array]",b="[object BigInt64Array]",w="[object Uint8Array]",x="[object Uint8ClampedArray]",S="[object Uint16Array]",T="[object Uint32Array]",C="[object BigUint64Array]",_=Symbol(),k=Symbol();function E(e){return I(1,e)}function I(e,t){if(void 0===t)return F(e,i);if(null===t)return F(e,n);const r=t;if(r[_])return P=e,r[_](L),P;switch(typeof t){case"boolean":return F(e,t?1:0);case"number":return s[0]=t,e=F(e,a[0]),F(e,a[1]);case"bigint":do{e=F(e,Number(BigInt.asUintN(32,t))),t>>=32n}while(0n!==t);return e;case"string":for(let r=0;r<t.length;r++)e=F(e,t.charCodeAt(r));return e;case"symbol":throw new Error("cannot hash symbol");case"function":throw new Error("cannot hash function")}const o=c.call(t);if(o===l||o===d){const r=t;e=F(e,r.length);for(let t=0;t<r.length;t++)e=I(e,r[t]);return e}if(o===m)return R(e,t);if(o===p)return R(e,new DataView(t));if(o===f||o===g||o===A||o===v||o===y||o===b||o===w||o===x||o===S||o===T||o===C){const r=t;return R(e,new DataView(r.buffer,r.byteOffset,r.byteLength))}if(o===h){const r=t;e=F(e,r.size);for(const t of r)e=I(e,t);return e}if(o===u){const r=t;e=F(e,r.size);for(const[t,i]of r)e=I(e,t),e=I(e,i);return e}const k=Object.keys(t);e=F(e,k.length);for(const r of k)e=I(e,r),e=I(e,t[r]);return e}function R(e,t){let r=0;for(;r<=t.byteLength-4;r+=4)e=F(e,t.getUint32(r));return r<=t.byteLength-2&&(e=F(e,t.getUint16(r)),r+=2),r<=t.byteLength-1&&(e=F(e,t.getUint8(r))),e}function F(e,t){return Math.imul((e>>>0<<5|e>>>27)>>>0^t>>>0,2654435769)>>>0}let P=0;function L(e){P=I(P,e)}function N(e,t){if(Object.is(e,t))return!0;if(null===e||"object"!=typeof e||null===t||"object"!=typeof t)return!1;const r=e;if(r[k])return r[k](t);let i=c.call(e);if(i!==c.call(t))return!1;if(i===l||i===d){const r=e,i=t;if(r.length!==i.length)return!1;for(let e=0;e<r.length;e++)if(!N(r[e],i[e]))return!1;return!0}if(i===m){i=w;const r=e,n=t;e=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),t=new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}if(i===p&&(i=w,e=new Uint8Array(e),t=new Uint8Array(t)),i===f||i===g||i===A||i===v||i===y||i===b||i===w||i===x||i===S||i===T||i===C){const r=e,i=t;if(r.length!==i.length)return!1;for(let e=0;e<r.length;e++)if(!Object.is(r[e],i[e]))return!1;return!0}if(i===h){const r=e,i=t;if(r.size!==i.size)return!1;for(const e of r)if(!i.has(e))return!1;return!0}if(i===u){const r=e,i=t;if(r.size!==i.size)return!1;for(const[e,t]of r){if(!i.has(e))return!1;if(!N(t,i.get(e)))return!1}return!0}const n=e,o=t,s=Object.keys(n),a=Object.keys(o);if(s.length!==a.length)return!1;for(const e of s){if(!(e in o))return!1;if(!N(n[e],o[e]))return!1}return!0}},310120:(e,t,r)=>{r.d(t,{u:()=>l}),r(379321);var i=r(268161),n=r(902851),o=r(324586);class s{constructor(){(0,o.A)(this,"_m",new Map)}set(e,t){const r=(0,i.Zd)(e),n=this._m.get(r);if(void 0!==n){for(let r=0;r<n.length;r++)if((0,i.n4)(e,n[r].key))return void(n[r].value=t);n.push({key:e,value:t})}else this._m.set(r,[{key:e,value:t}])}get(e){const t=(0,i.Zd)(e),r=this._m.get(t);if(void 0!==r)for(let t=0;t<r.length;t++)if((0,i.n4)(e,r[t].key))return r[t].value}delete(e){const t=(0,i.Zd)(e),r=this._m.get(t);if(void 0!==r)for(let n=0;n<r.length;n++){if(!(0,i.n4)(e,r[n].key))continue;if(1===r.length)return void this._m.delete(t);const o=r.pop();n<r.length&&(r[n]=o)}}}function a(e,t,r){let o=e.derived.get(t);const c=o?.get(r);if(void 0===c){const i={_store:e,_dependencies:[]},a=t(i,...r);!function(e){if(!(e.list.length<e.capacity)){for(let t=0;t<e.list.length;t++){const r=e.list[t];if(!(r.lastReadCycle>=e.currentCycle)){try{(0,n.z)(r.value)}finally{const i=e.derived.get(r.query);void 0!==i&&i.delete(r.args),e.list.splice(t,1)}return}}e.capacity=Math.max(1,2*e.capacity)}}(e);const c={query:t,args:r,value:a,dependencies:i._dependencies,lastScanGeneration:e.inputGeneration,lastUpdateGeneration:e.inputGeneration,lastReadCycle:e.currentCycle};return void 0===o&&(o=new s,e.derived.set(t,o)),o.set(r,c),e.list.push(c),c}if(c.lastReadCycle=e.currentCycle,c.lastScanGeneration>=e.inputGeneration)return c;c.lastScanGeneration=e.inputGeneration;let l=!0;for(const t of c.dependencies){let r;if(r=t.isDerived?a(e,t.query,t.args).lastUpdateGeneration:e.inputValues.get(t.key)?.valueGeneration??0,r>t.generation){l=!1;break}}if(l)return c;c.dependencies.length=0;const d=t({_store:e,_dependencies:c.dependencies},...r);return(0,i.n4)(c.value,d)||(c.lastUpdateGeneration=e.inputGeneration),(0,n.z)(c.value),c.value=d,c}let c=0;function l(e){const t=c++,r=(t,...r)=>{const i=a(t._store,e,r);return t._dependencies.push({isDerived:!0,query:e,args:r,generation:i.lastUpdateGeneration}),i.value};return Object.defineProperties(r,{[i.tW]:{value:e=>{e(t)}},[i.LC]:{value:e=>r===e}}),r}},595781:(e,t,r)=>{r.d(t,{h:()=>o}),r(379321);var i=r(268161);let n=0;function o(e){const t=n++,r={},o=t=>{const i=t._store.inputValues.get(r);return void 0===i?(t._dependencies.push({isDerived:!1,key:r,generation:0}),e):(t._dependencies.push({isDerived:!1,key:r,generation:i.valueGeneration}),i.value)};return Object.defineProperties(o,{_key:{value:r},_initial:{value:e},[i.tW]:{value:e=>{e(t)}},[i.LC]:{value:e=>o===e}}),o}},315612:(e,t,r)=>{r.d(t,{Sz:()=>a,n4:()=>s,or:()=>o});var i=r(248142),n=r(776016);function o(e){return(0,i.or)(e)}function s(e,t){return(0,i.n4)(e,t)}function a(e,t){const r=o(e);if(r)return r;if(!(0,n.O9)(t))return;const i=t.analysis.find((e=>(0,n.O9)(e.transcript)));return i?.transcript}},597906:(e,t,r)=>{r.d(t,{J6:()=>h,KN:()=>u,ug:()=>d});var i=r(324586),n=r(739367),o=r(272885),s=r(668388),a=r(847269),c=r(956074),l=r(396864);const d="assetCollectServiceToken";class u{constructor(){(0,i.A)(this,"loadedContentLang",void 0),(0,i.A)(this,"_supplier",void 0)}set supplier(e){this._supplier=e}get supplier(){return(0,a.sw)(this._supplier,"Expected supplier to be defined")}getContentById(e){return this.supplier.getContentById(e)}getContentByIds(e){return this.supplier.getContentByIds(e)}async loadIfNecessary(){return this.loadedContentLang!==this.lang&&(await this.loadContent(),this.loadedContentLang=this.lang),this.loadedContentLang}async getAssetById(e){const t=await this.getContentById(e);return(0,l.$o)((0,a.sw)(t,"Expect content to be defined"),0).asset}loadContent(e=[]){const t=0===e.length?this.getAllContent():this.getContentByIds(e);return(0,c.V)((()=>t))().then((e=>{(0,o.AH)(this.processContent(e))}))}processContent(e){let t=s.HF;return e.filter((e=>!!e)).flatMap((e=>{const{asset:r,filterIndex:i}=(0,l.$o)(e,t);return t=i,[r,...(0,l.oC)(e)]})).filter((e=>!!e))}}function h(){return(0,n.l)(d)}},396864:(e,t,r)=>{r.d(t,{$o:()=>x,oC:()=>S});var i=r(602453),n=r(327443),o=r(914023),s=r(467379),a=r(776016),c=r(650882),l=r(615101),d=r(7089),u=r(847269);function h(e,t=!1){if("download_format_details"in e)return e.download_format_details[Object.keys(e.download_format_details)[0]];if("download_formats"in e){const t=Object.keys(e.download_formats),i=e.download_formats[t[0]];return r=i,(0,a.Gv)(r)&&"width"in r&&"height"in r&&"file_size_bytes"in r?i:i[Object.keys(i)[0]]}var r;if(t&&"size"in e)return{...e,file_size_bytes:e.size};throw new c.g9((0,l.vU)("Unexpected vendor data format when creating stock asset"),{vendorData:e})}function p(e){switch(e){case"title":return"Title";case"twoline":return"TwoLine";case"caption":return"Caption";case"special":return"Special";case"intro/outro":return"IntroOutro";default:return"Clipchamp"}}const m={cc:"clipchamp_stock",stryb:"videoblocks"};function f(e){return m[e.vendor]}function g(e){return!0===e.vendorData.isAudio}function A(e){if(!(0,i.Nk)(e))throw new Error("Cannot create audio stock asset from non-stock item.");if(!g(e))throw new Error("Cannot create audio stock asset from non-Clipchamp curated audio item.");const t=function(e){if("isAudio"in e&&e.isAudio){const t=e?.streams?.[0];let r={};return t&&(r={bit_rate:t.bit_rate?.toString(),duration:t.duration?.toString(),format_name:t.codec_name?.toString(),size:e.size.toString()}),{...e,isAudio:!0,duration:e.duration,bitRate:e.bitRate,channels:e.channels,sampleRate:e.sampleRate,size:e.size,raw:{format:r,streams:e.streams??[]}}}throw new c.g9("Unexpected audio vendor data format when creating audio stock asset",{vendorData:e})}(e.vendorData);return{id:(0,d.u)(),type:e.type,name:e.title,hidden:!1,cloud:{provider:f(e),id:""+e.vendorId},metadata:t,thumbnailUrl:e.thumbnailUrl,previewUrl:e.previewUrl}}function v(e,t){if(!(0,i.JI)(e))throw new Error("Cannot create stock asset from non-stock item.");if((0,a.O9)(t)||!(0,i.gO)(e)&&!(0,i.Nk)(e)||(t=e.duration),g(e))return A(e);const r=h(e.vendorData);return{id:(0,d.u)(),type:e.type,name:e.title,hidden:!1,cloud:{provider:f(e),id:""+e.vendorId},metadata:{size:r?.file_size_bytes,rotation:0,width:r?.width,height:r?.height,duration:t,raw:{format:{},streams:[]}},thumbnailUrl:e.thumbnailUrl,previewUrl:e.previewUrl}}function y(e,t){if(!(0,i.vq)(e))throw new Error("Cannot create element asset from non-element item.");const r=h((0,u.sw)(e.vendorData,`Element ${e.id} without vendorData provided.`),"svg"===e.format),o={id:(0,d.u)(),isElement:!0,subtype:e.subtype,name:e.title,hidden:!1,cloud:{provider:"clipchamp_stock",id:e.id,vendorId:e.vendorId},metadata:{size:r?.file_size_bytes,rotation:0,width:r?.width,height:r?.height,preferredHeight:e.vendorData?.preferredHeight??(0,n.XF)(e.subtype),raw:{format:{},streams:[]}},thumbnailUrl:e.thumbnailUrl,previewUrl:e.previewUrl};return(0,n.vP)(e.format)?{...o,type:"image",format:e.format}:{...o,type:"video",format:e.format,loop:!0,metadata:{...o.metadata,duration:t??0}}}function b(e){switch(e.type){case"motion-title":return{options:{...e.vendorData,inputs:e.vendorData?.inputs??0,pluginSrc:e.pluginUrl,fields:e.vendorData?.fields?.map((({default:e,...t})=>({...t,defaultValue:e})))??[]},type:"title",name:e.title,hidden:!1,id:e.id,locale:e.locale,deletable:!1,thumbnailUrl:e.thumbnailUrl,previewUrl:e.previewUrl,category:p(e.subtype),dateAdded:e.dateAdded,dateModified:e.dateModified};case"graphic-element":return{options:{...e.vendorData,inputs:e.vendorData?.inputs??0,pluginSrc:e.pluginUrl,fields:e.vendorData?.fields?.map((({default:e,...t})=>({...t,defaultValue:e})))??[]},type:"title",name:e.title,hidden:!1,id:e.id,locale:e.locale,deletable:!1,thumbnailUrl:e.thumbnailUrl,previewUrl:e.previewUrl,category:"Special",appearAsType:"overlay",dateAdded:e.dateAdded,dateModified:e.dateModified};default:throw new Error("Unsupported type")}}function w(e){const t=new o.g$(e.title,e.id,e.subtype??"colour-filter");return t.renderOrder="number"==typeof e.renderOrder?e.renderOrder:"effect-filter"===t.subtype?o.Ju:o.uo,t.uiOrder="number"==typeof e.uiOrder?e.uiOrder:o.BJ,t.lutSrc=e.filterDataUrl,t.lutIntensity=1,{type:"filter",name:e.title,hidden:!1,id:e.id,hasTransparency:!1,preset:t,options:{fields:[{id:"lutIntensity",defaultValue:1,label:"editor.propertyPanel.filterLutIntensity",type:"range",maxValue:2,minValue:0,step:.01,position:["span","left"]}]}}}function x(e,t){if((0,i.qD)(e))return{asset:b(e),filterIndex:t};if((0,i.ON)(e))return{asset:w(e),filterIndex:t+1};if((0,i.qb)(e))return{asset:(r=e,{type:"transition",name:r.title,hidden:!1,id:r.id,defaultDurationInS:r.defaultDuration||1,transitionType:"mask",thumbnailUrl:r.thumbnailUrl,previewUrl:r.previewUrl,fields:[{name:"maskSources",label:"Mask sources",description:"",defaultValue:r.vendorData?.aspectRatioMasks}],maskAssets:Object.keys(r.vendorData?.aspectRatioMasks??{}).map((e=>({idealAspectRatio:s.l8[e],assetId:`${r.id}_${e}`})))}),filterIndex:t};var r;if((0,i.JI)(e))return g(e)?{asset:A(e),filterIndex:t}:{asset:v(e),filterIndex:t};if((0,i.vq)(e))return{asset:y(e),filterIndex:t};throw new Error(`Cannot determine type of content repo asset. Content: ${JSON.stringify(e,void 0,0)}`)}function S(e){if(!(0,i.qb)(e))return[];const t=e.vendorData?.aspectRatioMasks,r=e.vendorData?.maskVendorData;return t&&r?Object.entries(t).map((([t,i])=>{const n=r[t],o=h(n);return{type:"video",hidden:!0,id:`${e.id}_${t}`,name:`${e.title} ${t}`,cloud:{provider:"url",id:i},metadata:{duration:n.duration,size:o.file_size_bytes,width:o.width,height:o.height,rotation:0,raw:{format:{},streams:[]}}}})):[]}},149698:(e,t,r)=>{r.d(t,{L:()=>n,W:()=>i});class i{}const n="assetThumbnailJobFactory"},154942:(e,t,r)=>{r.d(t,{$h:()=>v,B_:()=>b,Vg:()=>w,jr:()=>S,kv:()=>T});var i,n=r(324586),o=r(651531),s=r(230608),a=r(560162),c=r(421054),l=r(815731),d=r(321450),u=r(197761),h=r(825702),p=r(138615),m=r(739367),f=r(573340),g=r(7089),A=r(332344);const v=["Local","Test","Int","Dogfood","MSIT","Production"],y={Local:"http://localhost:11040",Test:"https://test.augloop.svc.cloud.dev.microsoft",Int:"https://int.augloop.svc.cloud.dev.microsoft",Dogfood:"https://dogfood.augloop.svc.cloud.microsoft",MSIT:"https://msit.augloop.svc.cloud.microsoft",Production:"https://augloop.svc.cloud.microsoft"},b="augloopConfiguration";let w=(0,h.Gr)()((x=i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",["undefined"==typeof AugloopConfiguration?Object:AugloopConfiguration])(i=class{constructor(e){(0,n.A)(this,"serviceUrl",void 0),(0,n.A)(this,"getAuthToken",void 0),(0,n.A)(this,"flights",void 0),(0,n.A)(this,"configOverride",void 0),(0,n.A)(this,"sessionPromise",void 0),(0,n.A)(this,"runtimePromise",void 0);const t=y[e.augloopEnvironment];this.serviceUrl=t,this.getAuthToken=e.getAuthToken,this.flights=e.flights}getServiceUrl(){return this.configOverride?.augloopEnvironment&&y[this.configOverride.augloopEnvironment]||this.serviceUrl}getFlightsString(){const e=this.configOverride?.flights||this.flights;return e?.join(";")||""}async getSession(){return this.sessionPromise||(this.sessionPromise=new Promise((e=>this.initializeRuntime().then((async t=>{const r=(0,p.Us)("ks_magic__augloop_wait_on_authentication"),i=new l.t(o.f.Authenticated),n=await t.createSession({onSessionConnect:e=>{if(e){const e=new a.Xr({parentPath:["session"],items:[{id:"doc",body:new c.yo({isReadonly:!1})}]});n.submitSeedOperations([e])}},onServerAuthenticationStateChangeCallback:e=>{i.next(e)}});r||await(0,d._)(i.pipe((0,u.p)((e=>e===o.f.Authenticated)))),setInterval((()=>n.submitCustomMessage(new s.PR)),12e5),e(n)}))))),this.sessionPromise}async getAnnotation(e,t,r){const i={annotationType:[e],maxDelayMs:r,transientItems:[t]},n=(await this.getSession()).getAnnotations(i);for await(const e of n){const{content:t,error:r}=e;if(t.length>0)return{annotation:t[0].body};const i=(0,A.dj)(r);if(i)return{error:i};if(0===t.length)return{error:new Error("Annotation response returned no content")}}return{error:new Error("Get annotations responded with no annotations")}}async withEphemeralSession(e,t,r){const i=await this.initializeRuntime(),n=await i.createSession({documentId:(0,g.u)(),docSessionId:(0,g.u)(),onSessionConnect:e=>{if(e){const e=new a.Xr({parentPath:["session"],items:[{id:"doc",body:new c.yo({isReadonly:!1})}]});n.submitSeedOperations([e])}}}),o=t?t(n):{},s=await(0,A.My)(n,o);try{await Promise.race([e(n),new Promise((e=>r?.addEventListener("abort",e)))])}finally{s.forEach((e=>{n.releaseAnnotation(e).catch((e=>{f.Vy.error(e)}))})),n.close()}}async authCallback(e){const t=this.configOverride?.getAuthToken||this.getAuthToken;return{Token:await t(e)}}async initializeRuntime(){return this.runtimePromise||(this.runtimePromise=Promise.all([r.e(89048),r.e(10907)]).then(r.bind(r,315163)).then((({runtime:e})=>e.init(this.getServiceUrl(),{appName:"Clipchamp",appPlatform:"Web",appVersion:"9f3dcec",flights:this.getFlightsString()},{requestAuthToken:e=>this.authCallback(e),sendTelemetryEvent:()=>Promise.resolve(),isFeatureEnabled:(e,t)=>Promise.resolve(!0),areLicenseFeaturesEnabled:()=>Promise.resolve(!1)},{telemetryAggregationIntervalSec:30}).then((()=>e))))),this.runtimePromise}overrideConfig(e){this.configOverride=e,this.runtimePromise=void 0,this.sessionPromise=void 0}})||i)||i,i=(0,h.WQ)(b)(x,void 0,0)||i))||i;var x;function S(){return(0,m.l)(b)}function T(){return(0,m.l)(w)}},332344:(e,t,r)=>{r.d(t,{My:()=>n,dj:()=>a,iz:()=>o});var i=r(324586);async function n(e,t){const r=[];for(const[i,n]of Object.entries(t)){const{token:t}=await e.activateAnnotation(i,{callback:n});r.push(t)}return r}r(379321);class o extends Error{constructor(e,t){super(t.map((t=>`[${e}]${t.code?`[${t.code}]`:""} ${t.error}`)).join(", ")),(0,i.A)(this,"errorType",void 0),(0,i.A)(this,"errorMessages",void 0),this.errorType=e,this.errorMessages=t,Object.setPrototypeOf(this,o.prototype)}}function s(e,t){return new o(e,[{code:t.code,error:t.error,retryable:t.retryable}])}function a(e){if(void 0!==e)return void 0!==e.clientError?s("client",e.clientError):void 0!==e.serverError?s("server",e.serverError):void 0!==e.workflowError&&e.workflowError.length>0?new o("workflow",e.workflowError.map((e=>({code:e.code,error:e.error})))):void 0}},577955:(e,t,r)=>{r.d(t,{b:()=>h,_:()=>u});var i=r(596254),n=r(972070),o=r(751108),s=r(776016);const a=(0,s.t9)({access_token:s.Kg,region:s.Kg}),c=["azureCognitiveToken"],l=()=>(0,n.E)("/azure-cognitive/auth-token").json(a),d={staleTime:6e5},u=()=>(0,i.I)(c,l,d);function h(){return(0,o.SX)().fetchQuery({queryFn:l,queryKey:c,...d})}},594464:(e,t,r)=>{r.d(t,{V:()=>L});var i=r(836936),n=r(560162),o=r(584394),s=r(977836),a=r(153909),c=r(802231),l=r(428726),d=r(562229),u=r(573340),h=r(491457),p=r(776016),m=r(540076);function f(e,t){return new File([e],t,{type:"image/png"})}function g(e,t){const r=e.getContext("2d");if(!r)throw new Error("Unable to get canvas context");r.drawImage(t,0,0,e.width,e.height)}function A(e){const t=e.getContext("2d");if(!t)throw new Error("Unable to get canvas context");return t.getImageData(0,0,e.width,e.height)}function v(e,t){const r=document.createElement("canvas");return r.width=e,r.height=t,r}r(34456),r(159129),r(940233),r(270818),r(513173),r(205218),r(95732);var y,b,w,x,S=r(650882);class T extends S.g9{constructor(){super("Augloop workflow returned undefined results.")}}class C extends S.g9{constructor(e){super("ACS Background Removal Workflow Failed With Details",{...e})}}class _ extends S.g9{constructor(){super("No canvas context to reconstruct background removal result")}}const k=async(e,t)=>await(e?.requestBinaryDataForBlob(t));function E(e){const t="BackgroundRemovalSubRoutineCompleted";d.z.logEvent(t,e),d.z.logAppLogicEvent(t,e)}function I(e,t){const r="BackgroundRemovalFailed";t instanceof Error&&(e.message=t.message,e.stack=t.stack),d.z.logEvent(r,e),d.z.logErrorEvent(r,e),u.Vy.error(t)}const R=(0,h.h0)((async function(e,t,r){return async function(e,t=224,r=224){const i=new OffscreenCanvas(t,r),n=i.getContext("2d"),o=Math.max(t,r),s=Math.min(t,r);if(o>1200){const e=1200/o,n=Math.ceil(t*e),s=Math.ceil(r*e);i.width=n,i.height=s,t=n,r=s}if(s<120){const e=120/s,n=Math.ceil(t*e),o=Math.ceil(r*e);i.width=n,i.height=o,t=n,r=o}"type"in e?"webcodec"===e.type?n?.drawImage(e.data,0,0,t,r):n?.putImageData(function(e,t,r){const i=new Uint8ClampedArray(t*r*4),n=t*r,o=t*r+t*r/4;for(let s=0;s<r;s++)for(let r=0;r<t;r++){const a=(r>>1)+(s>>1)*t/2+n,c=(r>>1)+(s>>1)*t/2+o,l=e[r+s*t+0],d=e[a]-128,u=e[c]-128,h=l+1.371*u,p=l-.698*u-.336*d,m=l+1.732*d,f=4*r+t*s*4;i[0+f]=h,i[1+f]=p,i[2+f]=m,i[3+f]=255}return new ImageData(i,t,r)}(e.data,e.width,e.height),0,0):n?.drawImage(e,0,0,t,r);const a=n?.getImageData(0,0,t,r);if("close"in e&&e.close(),!a)throw new Error("Could not get image data");const c=i.convertToBlob({type:"image/jpeg",quality:.95}),l=await c;return new Uint8Array(await l.arrayBuffer())}(await createImageBitmap(e),t,r)}),{runOnFulfilled:e=>{E({durationMs:e,stage:"encoding"})},runOnRejected:(e,t,r)=>{I({durationMs:e,stage:"encoding"},r)}}),F=(0,h.h0)((async function(e,t,r,i,{augloop:d}){let u=e=>{},h=e=>{};const f=new Promise(((e,t)=>{u=e,h=t}));return await d.withEphemeralSession((async c=>{c.submitOperation(new n.Xr({parentPath:["asset","ACS_image_transform_inputs","BGR_inputs"],items:[{id:`${e}-acs-background-removal-signal`,body:new s.i({mode:a.C.BackgroundRemoval,apiVersion:"2023-02-01-preview",timeoutInMs:6e4,image:{contents:[{format:o.f.Png,size:o.h.Medium,id:e,sizeBytes:i.length,data:[...i]}],widthPx:t,heightPx:r}})}]})),await f}),(e=>({[c.d.getTypeName()]:async t=>{for(const r of t.items){if(!(0,p.O9)(r.body))continue;const t=r.body;if(c.d.typeGuard(t)){if(t.status===l.Q.Failure){const e=t.errorDetails;return void h(new C(e))}if(t.status===l.Q.Success){if(!(0,p.O9)(t.blob))return void h(new T);const r=await k(e,t.blob);return void u(r)}(0,m.xb)(t.status)}}}}))),f}),{runOnFulfilled:e=>{E({durationMs:e,stage:"augloop"})},runOnRejected:(e,t,r)=>{I({durationMs:e,stage:"augloop"},r)}}),P=(0,h.h0)((async function(e,t,r,i){if(Math.max(e,t)<=1200)return f(new Blob([i],{type:"image/png"}),"background-removed.png");const n=v(e,t);if(!n.getContext("2d"))throw new _;const o=new Blob([r],{type:"image/png"});g(n,await createImageBitmap(o));const s=A(n),a=v(e,t);!function(e){const t=e.getContext("2d");if(!t)throw new Error("Unable to get canvas context");const r=e.style;(0,p.O9)(r)&&(r.imageRendering="high-quality",t.imageSmoothingEnabled=!0)}(a);const c=new Blob([i],{type:"image/png"});g(a,await createImageBitmap(c));const l=A(a);for(let e=0;e<s.data.length;e+=4){const t=l.data[e+3];s.data[e+3]=t,t<240&&(s.data[e]=l.data[e],s.data[e+1]=l.data[e+1],s.data[e+2]=l.data[e+2])}return function(e,t){const r=e.getContext("2d");if(!r)throw new Error("Unable to get canvas context");return r.clearRect(0,0,e.width,e.height),r.putImageData(t,0,0),f(function(e){const t=e.split(","),r=t[0].match(/:(.*?);/),i=r?r[1]:"",n=atob(t[1]);let o=n.length;const s=new Uint8Array(o);for(;o--;)s[o]=n.charCodeAt(o);return new Blob([s],{type:i})}(e.toDataURL("image/png")),"background-removed.png")}(n,s)}),{runOnFulfilled:e=>{E({durationMs:e,stage:"postprocessing"})},runOnRejected:(e,t,r)=>{I({durationMs:e,stage:"postprocessing"},r)}});let L=(y=(0,h.AR)({runOnFulfilled:e=>{const t="BackgroundRemovalCompleted",r={durationMs:e};d.z.logEvent(t,r),d.z.logAppLogicEvent(t,r)},runOnRejected:(e,t,r)=>{I({durationMs:e,stage:"analyse"},r)}}),b=Reflect.metadata("design:type",Function),w=Reflect.metadata("design:paramtypes",["undefined"==typeof Blob?Object:Blob,String,Number,Number,"undefined"==typeof AnalysisOnProgressFn?Object:AnalysisOnProgressFn]),x=class{constructor(e){this._augloopService=e}async analyse(e,t,r,i,n){const o=await R(e,r,i),s=await F(t,r,i,o,{augloop:this._augloopService}),a=await P(r,i,o,s);return n?.(100),a}},(0,i.A)(x.prototype,"analyse",[y,b,w],Object.getOwnPropertyDescriptor(x.prototype,"analyse"),x.prototype),x)},907315:(e,t,r)=>{r.d(t,{S:()=>s,g:()=>c});var i=r(776016),n=r(7089);const o=(0,i.t9)({type:(0,i.u)("com.clipchamp.backgroundImageRemove"),version:(0,i.u)("1.0.0"),properties:(0,i.t9)({width:i.Et,height:i.Et})});class s{constructor(e,t,r){this.augloopService=e,this.width=t,this.height=r}static fromConfig(e,t){const r=t;return new s(e,r.properties.width,r.properties.height)}handleGeneration(e,t){if(!e)return Promise.reject(new Error("No file provided"));const{onProgress:r}=t;return this.augloopService.analyse(e,(0,n.u)(),this.width,this.height,r?e=>r({type:"downloading",value:e}):void 0)}config(){return Promise.resolve({type:"com.clipchamp.backgroundImageRemove",version:"1.0.0",properties:{width:this.width,height:this.height}})}}const a=o,c=e=>({match:a,create:s.fromConfig.bind(null,e)})},929348:(e,t,r)=>{r.d(t,{M:()=>T});var i,n,o,s,a,c,l,d,u=r(324586),h=r(836936),p=r(466287),m=r(961722),f=r(573340),g=r(720315),A=r(704613),v=r(956074),y=r(577955),b=r(352849),w=r(534362);const x=(0,v.V)((async()=>{const{SpeechConfig:e,OutputFormat:t,ProfanityOption:i,SpeechRecognizer:n,AudioConfig:o,AudioInputStream:s,PropertyId:a,CancellationErrorCode:c,CancellationReason:l}=await Promise.all([r.e(99051),r.e(59393)]).then(r.t.bind(r,399051,23));return{SpeechConfig:e,OutputFormat:t,ProfanityOption:i,SpeechRecognizer:n,AudioConfig:o,AudioInputStream:s,PropertyId:a,CancellationErrorCode:c,CancellationReason:l}}),10,3e3),S={recognitionLanguage:"en-US",enableProfanityFilter:!1};let T=(i=(0,g.P)({maxAttempts:6,backOffPolicy:"exponential"}),n=Reflect.metadata("design:type",Function),o=Reflect.metadata("design:paramtypes",[void 0===A.CaptionRecognitionLanguage?Object:A.CaptionRecognitionLanguage,Boolean]),s=(0,g.P)({maxAttempts:6,backOffPolicy:"exponential"}),a=Reflect.metadata("design:type",Function),c=Reflect.metadata("design:paramtypes",["undefined"==typeof AudioBuffer?Object:AudioBuffer]),d=class e{constructor(e){(0,u.A)(this,"name","AzureCognitiveServices"),(0,u.A)(this,"_config",void 0),(0,u.A)(this,"_captions",{}),(0,u.A)(this,"_resultPromise",void 0),(0,u.A)(this,"_resolve",(e=>{})),(0,u.A)(this,"_reject",(e=>{})),(0,u.A)(this,"_recognizer",void 0),(0,u.A)(this,"_running",!1),(0,u.A)(this,"_cancelled",!1),this._config={...S,...e},this._resultPromise=new Promise(((e,t)=>{this._resolve=t=>(this._running=!1,e(t)),this._reject=e=>(this._running=!1,t(e))}))}async generateCaptions(e){try{return await this.doGenerateCaptions(e)}catch(e){try{await this.cancel()}catch(e){f.Vy.error(e)}throw e}}async doGenerateCaptions({audio:e,onProgress:t}){this.reset();const{CancellationErrorCode:r,CancellationReason:i}=await this.loadSpeechSdk(),[n,o]=await Promise.all([this.getSpeechConfig(this._config.recognitionLanguage,this._config.enableProfanityFilter),this.makeAudioConfig(e)]);return this._recognizer=await this.makeSpeechRecognizer(n,o),this._recognizer.recognizing=(e,r)=>{this._running&&t(this.offsetToMs(r.result.offset+r.result.duration)/1e3)},this._recognizer.recognized=(e,r)=>{if(this._running)if(t(this.offsetToMs(r.result.offset+r.result.duration)/1e3),r.result.errorDetails)this._running=!1,this._reject(new w.t(r.result.errorDetails,"acs.generateCaptions.recognized.resultError"));else{const e=JSON.parse(r.result.json);this._captions={...this._captions,...(0,b.GD)(r.result.text,e)}}},this._recognizer.speechEndDetected=()=>{this._running&&t(e.duration)},this._recognizer.sessionStarted=()=>{this._running&&t(0)},this._recognizer.sessionStopped=()=>{this._running&&this._resolve(this._captions)},this._recognizer.canceled=(e,t)=>{this._running&&t.errorCode!==r.NoError&&t.reason!==i.EndOfStream&&this._reject(new w.t(t.errorDetails,"acs.generateCaptions.canceled",{errorCode:r[t.errorCode],reason:i[t.reason]}))},this._running=!0,this._recognizer.startContinuousRecognitionAsync(void 0,(e=>{this._running=!1,this._reject(new w.t(e,"acs.generateCaptions.startContinuousRecognitionAsync"))})),this._resultPromise}async cancel(){if(!this._cancelled)return this._running=!1,this._cancelled=!0,new Promise(((e,t)=>{this._recognizer?this._recognizer.stopContinuousRecognitionAsync((()=>{this._recognizer?this._recognizer.close((()=>{e()}),(e=>{t(new w.t(e,"acs.cancel.close"))})):e()}),(e=>{t(new w.t(e,"acs.cancel.stopContinuousRecognitionAsync"))})):e()})).then((()=>this._resolve(void 0))).catch((e=>this._reject(e)))}async getSpeechConfig(e,t){const{SpeechConfig:r,OutputFormat:i,ProfanityOption:n,PropertyId:o}=await this.loadSpeechSdk().catch((e=>{throw new w.t(e.message,"acs.getSpeechConfig.loadSpeechSdk")})),{access_token:s,region:a}=await(0,y.b)().catch((()=>{throw new Error("Failed to get Azure Cognitive Services auth token")})),c=r.fromAuthorizationToken(s,a);return c.setProfanity(!0===t?n.Masked:n.Raw),c.requestWordLevelTimestamps(),c.outputFormat=i.Detailed,c.speechRecognitionLanguage=e,c.setProperty(o.WebWorkerLoadType,"off"),c}async makeAudioConfig(t){const{AudioConfig:r,AudioInputStream:i}=await this.loadSpeechSdk().catch((()=>{throw new Error("Failed to load the speech SDK")})),n=await(0,p.D)({audioBuffer:t,newNumChannels:1,newSampleRate:e.AUDIO_INPUT_SAMPLE_RATE}),o=(0,m.vg)((0,m.X)(n),e.AUDIO_INPUT_SAMPLE_RATE),s=i.createPushStream();return s.write(o),s.close(),r.fromStreamInput(s)}async makeSpeechRecognizer(e,t){const{SpeechRecognizer:r}=await this.loadSpeechSdk().catch((()=>{throw new Error("Failed to load the speech SDK")}));return new r(e,t)}reset(){this._running=!1,this._cancelled=!1}offsetToMs(e){return e/b.Z2}async loadSpeechSdk(){return await x()}},(0,u.A)(d,"AUDIO_INPUT_SAMPLE_RATE",16e3),l=d,(0,h.A)(l.prototype,"getSpeechConfig",[i,n,o],Object.getOwnPropertyDescriptor(l.prototype,"getSpeechConfig"),l.prototype),(0,h.A)(l.prototype,"makeAudioConfig",[s,a,c],Object.getOwnPropertyDescriptor(l.prototype,"makeAudioConfig"),l.prototype),l)},534362:(e,t,r)=>{r.d(t,{t:()=>n});var i=r(324586);class n extends Error{constructor(e,t,r){super(e),(0,i.A)(this,"error",void 0),(0,i.A)(this,"context",void 0),(0,i.A)(this,"details",void 0),this.error=e,this.context=t,this.details=r}}},637402:(e,t,r)=>{r.d(t,{J:()=>P});var i=r(324586),n=r(836936),o=r(562229),s=r(571056),a=r(905470);r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);var c,l,d,u,h,p,m,f,g,A=r(126714),v=r(187974),y=r(138615),b=r(889688),w=r(573340),x=r(720315),S=r(704613),T=r(491457),C=r(650882),_=r(360747),k=r(776016),E=r(352849),I=r(534362),R=r(500018);function F(e){const t=(0,A.Jq)(e.metadata.raw);return isNaN(t)?e.metadata.duration:t}let P=(c=(0,x.P)({maxAttempts:6,backOffPolicy:"exponential"}),l=Reflect.metadata("design:type",Function),d=Reflect.metadata("design:paramtypes",["undefined"==typeof AudioBuffer?Object:AudioBuffer]),u=(0,T.AR)({runOnRejected:(e,[t],r)=>{const i={message:(0,C.xM)(r,"Failed to extract audio").message,assetAudioCodec:(0,A.xF)(t.metadata.raw)?.codec_name,assetOrigin:t.metadata.origin,assetSizeBytes:t.metadata.size,assetVideoCodec:(0,v.yL)(t.metadata.raw)?.codec_name};o.z.logEvent("AutocaptionExtractAudioFailed",i),o.z.logErrorEvent("AutocaptionExtractAudioFailed",i),w.Vy.error(r)}}),h=(0,x.P)({maxAttempts:6,backOffPolicy:"exponential"}),p=(0,_.w)({timeoutS:([e])=>Math.max(30,3*e.metadata.duration),makeError:(e,[t])=>new I.t("timeout","CaptionRecognizer.extractAudio.timeout",{timeoutS:e.toString(),audioDurationS:t.metadata.duration.toString()}),bypassTimer:()=>(0,y.Us)("ks_magic__caption_extract_audio_timeout")}),m=Reflect.metadata("design:type",Function),f=Reflect.metadata("design:paramtypes",[void 0===S.AVAsset?Object:S.AVAsset,Number,Number]),g=class{constructor(e){(0,i.A)(this,"running",!1),(0,i.A)(this,"cancelled",!1),(0,i.A)(this,"progressEstimator",void 0),(0,i.A)(this,"audioBufferPlaybackRatio",1),(0,i.A)(this,"captionPromise",void 0),(0,i.A)(this,"assetResolver",(0,b.W)(s.e)),this.params=e}get assetId(){return this.params.asset.id}get backendName(){return this.params.backend.name}isRunning(){return this.running}wasCancelled(){return this.cancelled}async generateCaptions(){return this.cancelled=!1,this.captionPromise||(this.captionPromise=new Promise(((e,t)=>{this.doGenerateCaptions().then((t=>e(t))).catch((e=>{this.params.reportProgress(this.params.asset,"error"),t(e)}))}))),this.captionPromise}async cancel(){try{await this.params.backend.cancel()}catch(e){this.params.reportProgress(this.params.asset,"error"),e instanceof I.t?this.failWithError(e.message,e.context):e instanceof Error?this.failWithError(e.message,"CaptionRecognizer.cancel.unknownError"):this.failWithError(JSON.stringify(e),"CaptionRecognizer.cancel.unknownError")}this.running=!1,this.cancelled=!0,this.params.reportProgress(this.params.asset,"cancelled")}async doGenerateCaptions(){this.running=!0;const e=await this.extractAudio(this.params.asset,this.params.startTimeS,this.params.endTimeS);this.progressEstimator=new R.Y({total:1,minIntervalMs:1200,smoothing:.1});const t=performance.now(),r=await this.doCallCaptionBackend(e);if(!this.running)return;const i=(performance.now()-t)/1e3,n=i/this.params.asset.metadata.duration,s={assetType:this.params.asset.type,durationS:this.params.asset.metadata.duration,recognitionTimeS:i,recognitionTimeDurationRatio:n,recognitionLanguage:this.params.config.recognitionLanguage,profanityFilter:this.params.config.enableProfanityFilter,captionBackend:this.backendName,wordCount:r?Object.values(r).length:0};return o.z.logEvent("AutocaptionGenerateCompleted",s),o.z.logAppLogicEvent("AutocaptionGenerateCompleted",s),this.params.reportProgress(this.params.asset,"complete",1,0),this.running=!1,r}async doCallCaptionBackend(e){try{const t=async()=>{const t=t=>{const r=e.duration;if((0,k.O9)(t)&&t>0){const e=t/r;this.progressEstimator?.updateWithN(e),this.params.reportProgress(this.params.asset,"recognizeSpeech",e,this.progressEstimator?.estimatedTimeRemaining)}};if((0,y.Us)("ks_magic__caption_timeout"))return this.params.backend.generateCaptions({audio:e,onProgress:t});const{resetTimer:r,timerCompletionMs:i,cancelTimer:n}=function(e){const t=performance.now();let r,i;const n=()=>{r=setTimeout((()=>{i(performance.now()-t)}),1e3*e)},o=()=>{clearTimeout(r)};return{resetTimer:()=>{o(),n()},timerCompletionMs:new Promise((e=>{i=e,n()})),cancelTimer:o}}(Math.max(30,3*e.duration)),o=e=>{t(e),r()};try{return await Promise.race([this.params.backend.generateCaptions({audio:e,onProgress:o}),i.then((t=>{throw r=.001*t,new I.t("Caption generation timeout exceeded","CaptionRecognizer.doCallCaptionBackend.timeout",{timeoutS:r.toString(),audioDurationS:e.duration.toString()});var r}))])}finally{n()}},r=await t();if(!r)return;return(0,E.MV)(r,this.audioBufferPlaybackRatio)}catch(e){return void(e instanceof I.t?this.failWithError(e.error,e.context,e.details):this.failWithError(e instanceof Error?e.message:`${e}`,"CaptionRecognizer.doCallCaptionBackend.unknownError"))}}async extractAudio(e,t,r){const i=await(0,a.M)({asset:e,audioContext:this.makeAudioContext(),assetResolver:this.assetResolver}),n=F(e);return i.duration!==n&&w.Vy.warn(`AudioBuffer reports different duration to AudioAsset, correcting |${i.duration}|${n}|`),this.audioBufferPlaybackRatio=n/i.duration,function({audio:e,startTimeS:t,endTimeS:r}){t||(t=0),r||(r=e.duration);const i=r-t,n=new AudioBuffer({length:e.sampleRate*i,numberOfChannels:e.numberOfChannels,sampleRate:e.sampleRate}),o=new Float32Array(Math.round(e.sampleRate*i));for(let r=0;r<e.numberOfChannels;r++)e.copyFromChannel(o,r,t*e.sampleRate),n.copyToChannel(o,r,0);return n}({audio:i,startTimeS:Math.max(t??0,0),endTimeS:Math.min(r??i.duration,i.duration)})}failWithError(e,t,r){const i={message:e,captionErrorContext:t,recognitionLanguage:this.params.config.recognitionLanguage,profanityFilter:this.params.config.enableProfanityFilter,captionBackend:this.backendName,...r};throw o.z.logEvent("AutocaptionGenerateFailed",i),o.z.logErrorEvent("AutocaptionGenerateFailed",i),new Error(`Failed to convert speech to text (context=${t}): ${e}`,{cause:{error:e,context:t,...r}})}makeAudioContext(){const e=(0,A.xF)(this.params.asset.metadata.raw)?.sample_rate??"16000",t=F(this.params.asset),r=Number.parseInt(e);return new OfflineAudioContext({sampleRate:r,length:Math.ceil(t*r)})}},(0,n.A)(g.prototype,"doCallCaptionBackend",[c,l,d],Object.getOwnPropertyDescriptor(g.prototype,"doCallCaptionBackend"),g.prototype),(0,n.A)(g.prototype,"extractAudio",[u,h,p,m,f],Object.getOwnPropertyDescriptor(g.prototype,"extractAudio"),g.prototype),g)},625902:(e,t,r)=>{r.d(t,{Zy:()=>ae,my:()=>le,hZ:()=>ce,cw:()=>he,JM:()=>de,iX:()=>ue});var i=r(324586),n=r(836936),o=r(815731),s=r(673101),a=r(825702),c=r(562229),l=r(126714),d=r(138615),u=r(739367),h=r(573340),p=r(154942),m=r(704613),f=r(491457),g=r(776016),A=r(315612),v=r(534362),y=r(230608),b=r(105445),w=r(48303),x=r(605428),S=r(847602),T=r(347983),C=r(645459),_=r(466287),k=r(961722),E=r(352849);const I={recognitionLanguage:"en-US"};class R{constructor(e,t){(0,i.A)(this,"name","Augloop"),(0,i.A)(this,"_resultPromise",void 0),(0,i.A)(this,"_captions",{}),(0,i.A)(this,"_resolve",(e=>{})),(0,i.A)(this,"_reject",(e=>{})),(0,i.A)(this,"_dictationSettings",void 0),(0,i.A)(this,"_seq",0),(0,i.A)(this,"_totalNumChunks",0),(0,i.A)(this,"_allChunksSent",!1),this._augloopService=e;const r={...I,...t};this._resultPromise=new Promise(((e,t)=>{this._resolve=t=>e(t),this._reject=e=>t(e)})),this._dictationSettings={dictationLanguage:r.recognitionLanguage,useAutoPunctuation:"Intelligent",properties:{wordLevelTimestamps:"true"}}}async generateCaptions(e){let t;return await this._augloopService.withEphemeralSession((async r=>{const i=(await this.prepareAudio(e.audio)).getFrames(R.SAMPLES_PER_FRAME);this._seq=0,this._totalNumChunks=i.length+1,await this.submitAudioChunk(r,void 0);for(let e=0;e<i.length;e++)await this.submitAudioChunk(r,i[e]);this._allChunksSent=!0,t=await this._resultPromise}),(t=>({[b.D_.getTypeName()]:t=>this.onAnnotation(e,t),[b.mh.getTypeName()]:t=>this.onAnnotation(e,t),[b.ZF.getTypeName()]:t=>this.onAnnotation(e,t),[b.lM.getTypeName()]:t=>this.onAnnotation(e,t)}))),t}async cancel(){this._resolve(void 0)}onAnnotation(e,t){for(const r of t.items)r.body&&(b.D_.typeGuard(r.body)?this.onSpeechSessionEvent(e,r.body):b.mh.typeGuard(r.body)?this.onSpeechToTextFinalResult(e,r.body):b.ZF.typeGuard(r.body)?this.onSpeechToTextPartialResult(e,r.body):b.lM.typeGuard(r.body)&&this.onSpeechErrorEvent(e,r.body))}onSpeechSessionEvent(e,t){if(t.eventId===w.P_.SpeechSessionStopped){if(!this._allChunksSent)return void function(e,t){const r={chunksSent:e,totalNumChunks:t};c.z.logEvent("AutocaptionAugloopIncompleteSequence",r),c.z.logWarningEvent("AutocaptionAugloopIncompleteSequence",r)}(this._seq,this._totalNumChunks);this._resolve(this._captions)}else t.eventId===w.P_.SpeechSessionStarted&&e.onProgress(0)}onSpeechToTextFinalResult(e,t){const r=this.offsetToMs(t.properties.JsonResult?.Offset??0),i=this.offsetToMs(t.properties.JsonResult?.Duration??0);if(r&&i){const e=function(e){const t=e.text.split(/\s+/),r=e.durationMs/t.length,i={};for(let n=0;n<t.length;n++){let o=t[n];n!==t.length-1&&(o+=" ");const s=e.startTimeMs+r*n;i[s]={startTimeMs:s,durationMs:r,text:o}}return i}({durationMs:i,startTimeMs:r,text:t.text});this._captions={...this._captions,...e}}}onSpeechToTextPartialResult(e,t){const r=this.offsetToMs(t.properties.JsonResult?.Offset??0),i=this.offsetToMs(t.properties.JsonResult?.Duration??0);e.onProgress((r+i)/1e3)}onSpeechErrorEvent(e,t){t.ErrorState===x.o2.FINAL?this._reject(new v.t("Received error event from augloop","augloop.generateCaptions.speechErrorEvent",{errorCode:t.ErrorCode})):h.Vy.warn(t)}offsetToMs(e){return e/E.Z2}async prepareAudio(e){const t=await(0,_.D)({audioBuffer:e,newNumChannels:1,newSampleRate:R.AUDIO_INPUT_SAMPLE_RATE}),r=(0,k.vg)((0,k.X)(t),R.AUDIO_INPUT_SAMPLE_RATE);return new C.RiffWav(Buffer.from(r),!1)}async submitAudioChunk(e,t){const r=await e.submitCustomMessage(new y.VR({item:{id:`${this._seq}`,body:new S.jP({useFrontdoorWorkflow:!0,data:t,sampleRate:R.AUDIO_INPUT_SAMPLE_RATE,seq:this._seq,speechToTextProfile:T.A.Transcription,responseVersion:x.wM.version2,dictationSettings:this._dictationSettings})}}));return this._seq++,r}}(0,i.A)(R,"AUDIO_INPUT_SAMPLE_RATE",16e3),(0,i.A)(R,"SAMPLES_PER_FRAME",4e3);var F=r(560162),P=r(975107),L=r(871884),N=r(396641),M=r(450626),B=r(7089);class D{constructor(e,t,r){this.hours=e,this.minutes=t,this.seconds=r}asMilliseconds(){return 1e3*(60*this.hours*60+60*this.minutes+this.seconds)}static parse(e){const t=e.toUpperCase().split("T")[1];if(!t)throw new Error("missing time value in input string");const r=t.indexOf("H"),i=t.indexOf("M"),n=t.indexOf("S");let o=Number.NaN,s=Number.NaN,a=Number.NaN;if(r>0&&(o=Number.parseFloat(t.slice(0,Math.max(0,r)))),i>0&&(s=Number.parseFloat(t.substring(Math.max(0,r+1),i))),n>0&&(a=Number.parseFloat(t.substring(Math.max(0,r+1,i+1),n))),isNaN(o)&&isNaN(s)&&isNaN(a))throw new Error("invalid format");return new D(o||0,s||0,a||0)}}class O{constructor(e){(0,i.A)(this,"name","AugloopCameraTranscript"),(0,i.A)(this,"_resultPromise",void 0),(0,i.A)(this,"_resolve",(e=>{})),(0,i.A)(this,"_reject",(e=>{})),(0,i.A)(this,"_seq",0),(0,i.A)(this,"_audioChunks",void 0),(0,i.A)(this,"_session",void 0),this._augloopService=e,this._resultPromise=new Promise(((e,t)=>{this._resolve=t=>e(t),this._reject=e=>t(e)}))}async generateCaptions(e){let t;return await this._augloopService.withEphemeralSession((async r=>{this._session=r;const i=await this.prepareAudio(e.audio);this._audioChunks=i.getFrames(O.SAMPLES_PER_FRAME),this.submitNextAudioChunk(e),t=await this._resultPromise}),(t=>({[P.xj.getTypeName()]:t=>this.onAnnotation(e,t),[P.eW.getTypeName()]:t=>this.onAnnotation(e,t)}))),t}async cancel(){this._session?.close(),this._resolve(void 0)}onAnnotation(e,t){for(const r of t.items)r.body&&(P.xj.typeGuard(r.body)?this.onCameraTranscriptFullAnswerV2(e,r.body):P.eW.typeGuard(r.body)&&this.onCameraTranscriptClientAck(e,r.body))}onCameraTranscriptFullAnswerV2(e,t){t.status===M.lC.Success?this._resolve(this.cameraTranscriptEntriesToCaptionMap(t.entries)):this._reject(new v.t(`generation failure ${t.status}`,"augloopCameraTranscript.generateCaptions.captionError"))}onCameraTranscriptClientAck(e,t){t.isSuccessful?this.submitNextAudioChunk(e):this._reject(new v.t(`failed to upload chunk ${this._seq} out of ${this._audioChunks?.length}`,"augloopCameraTranscript.generateCaptions.dataUploadError"))}async prepareAudio(e){const t=await(0,_.D)({audioBuffer:e,newNumChannels:1,newSampleRate:O.AUDIO_INPUT_SAMPLE_RATE}),r=(0,k.vg)((0,k.X)(t),O.AUDIO_INPUT_SAMPLE_RATE);return new C.RiffWav(Buffer.from(r),!1)}submitNextAudioChunk(e){if(!this._session||!this._audioChunks)return void this._reject(new v.t("not properly initialized before calling submitNextAudioChunk","augloopCameraTranscript.submitNextAudioChunk.notInitializedError"));const t=this._audioChunks[this._seq],r=new L.q({order:this._seq,data:t,durationMs:e.audio.duration,wavFileSampleRate:O.AUDIO_INPUT_SAMPLE_RATE,signalType:void 0===t?N.S.Generate:N.S.Upload});this._session.submitOperation(new F.Xr({parentPath:["session","doc"],items:[{id:(0,B.u)(),body:r}]})),this._seq++}cameraTranscriptEntriesToCaptionMap(e){const t={};for(const r of e){const e=r.text.includes(" ");for(let i=0;i<r.words.length;i++){const n=r.words[i],o=D.parse(n.startOffset).asMilliseconds(),s=D.parse(n.endOffset).asMilliseconds()-o;t[o]={startTimeMs:o,durationMs:s,text:i<r.words.length-1&&e?`${n.text} `:n.text}}}return t}}(0,i.A)(O,"AUDIO_INPUT_SAMPLE_RATE",16e3),(0,i.A)(O,"SAMPLES_PER_FRAME",8e4);var j=r(929348),U=(r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(217563)),z=r(530598),W=r(713976),V=r(271716),H=r(972070);const G=(0,g.t9)({timestamp:g.Kg,durationInTicks:g.Et,recognizedPhrases:(0,g._j)((0,g.t9)({recognitionStatus:g.Kg,offsetInTicks:g.Et,durationInTicks:g.Et,nBest:(0,g._j)((0,g.t9)({display:g.Kg,displayWords:(0,g._j)((0,g.t9)({displayText:g.Kg,offsetInTicks:g.Et,durationInTicks:g.Et}))}))}))}),q=(0,g.t9)({token:g.Kg,url:g.Kg});function Q(e){return e/1e4}function K(e){const t=e.match(/<(.+?)>(.+)<\/\1>/);return t?[t[2],t[1]]:[e,void 0]}class X{constructor(e){(0,i.A)(this,"name","AzureFastTranscription"),(0,i.A)(this,"abortController",new AbortController),this.config=e}async generateCaptions(e){if(this.abortController.signal.aborted)return;const t=await(0,_.D)({audioBuffer:e.audio,newNumChannels:1,newSampleRate:X.AUDIO_SAMPLE_RATE}),r=(0,k.vg)((0,k.X)(t),X.AUDIO_SAMPLE_RATE),i={inputLocales:[this.config.recognitionLanguage],channels:[0],profanityFilterMode:this.config.enableProfanityFilter?"Masked":"Tags",wordLevelTimestampsEnabled:!0,customProperties:{disfluencyTaggingEnabled:this.config.enableDisfluencyTagging?"true":"false"}};"en-US"===this.config.recognitionLanguage&&(i.modelMapping={"en-US":"https://eastus.api.cognitive.microsoft.com/speechtotext/v3.2/models/base/d64d83b7-5222-45ad-a9b0-7133bf28233a"});const n=new FormData;n.append("audio",new File([r],"audio.wav")),n.append("definition",JSON.stringify(i));const{token:o,url:s}=await async function(){return await H.E.get("/azure-cognitive-api/auth-token").json(q)}(),a=await this.doFetch(s,o,n,(t=>{const r=e.audio.duration*t;e.onProgress(r)}),e.audio.duration);if(!a)return;if(200!==a.status)throw new v.t(`syncTranscription failed with response code ${a.status}: ${await a.text()}`,"fastTranscription.generateCaptions.badResponseCode");const c=await a.json(G);if(!G(c))throw new v.t("Invalid response from backend","fastTranscription.generateCaptions.invalidResponse",{url:s});return function(e){const t={};for(const r of e.recognizedPhrases){const e=r.nBest.at(0);if(!e)continue;const i=e.display.includes(" "),n=r.nBest.at(0)?.displayWords||[];for(let e=0;e<n.length;e++){const r=n[e],[o,s]=K(r.displayText),a=Q(r.offsetInTicks),c=Q(r.durationInTicks),l=e===n.length-1;t[a]={startTimeMs:a,durationMs:c,text:l||!i?o:`${o} `,metadata:{isProfanity:"profanity"===s?.toLowerCase(),isDisfluency:"disfluency"===s?.toLowerCase()}}}}return t}(c)}async doFetch(e,t,r,i,n){const o=new U.B,s=performance.now(),a=(0,z.Y)(1e3).pipe((0,W.E)(o)).subscribe((()=>{const e=performance.now();i(.75+(e-s)/1e3/(2.5*n)*.25)}));try{return await(0,V.r)(`${e}/speechtotext/v3.2_internal.1/syncTranscriptions`,{method:"POST",headers:{Authorization:`Bearer ${t}`},body:r,signal:this.abortController.signal,extraData:{excludeHeaders:["Content-Type"],responseType:"json",onProgress:e=>{e.lengthComputable&&(i(e.loaded/e.total*.75),e.loaded===e.total&&o.next())}}})}catch(e){if(this.abortController.signal.aborted)return;throw new v.t(`syncTranscription call failed: ${e}`,"fastTranscription.doFetch.fetchError")}finally{a.unsubscribe()}}async cancel(){this.abortController.abort("cancelled")}}(0,i.A)(X,"AUDIO_SAMPLE_RATE",16e3),(0,i.A)(X,"SUPPORTED_LANGUAGES",new Set(["en-US","es-ES","es-MX","fr-FR","hi-IN","it-IT","ja-JP","ko-KR","pt-BR","zh-CN"]));var Y,Z,J,$,ee,te,re,ie,ne,oe,se=r(637402);const ae="CAPTION_SERVICE_AVAILABLE_BACKENDS",ce="TRANSCRIPT_PANEL_CONFIG_TOKEN";let le=(Y=(0,a.Gr)(),Z=function(e,t){return(0,a.WQ)(p.Vg)(e,void 0,0)},J=function(e,t){return(0,a.WQ)(ae)(e,void 0,1)},$=Reflect.metadata("design:type",Function),ee=Reflect.metadata("design:paramtypes",[void 0===p.Vg?Object:p.Vg,Array]),te=(0,f.AR)({runOnFulfilled:(e,[t],r)=>{!function(e,t,r){if(r.recognizer?.wasCancelled()){const i=e/1e3,n={assetType:t.type,durationS:t.metadata.duration,recognitionTimeS:i,recognitionTimeDurationRatio:i/t.metadata.duration,recognitionLanguage:r.language,profanityFilter:r.profanityFilter,captionBackend:r.recognizer.backendName};return c.z.logAppLogicEvent("AutocaptionCancelled",n),void c.z.logEvent("AutocaptionCancelled",n)}const i=r.captions?Object.values(r.captions).length:0,n=e/1e3,o={assetType:t.type,durationS:t.metadata.duration,recognitionTimeS:n,recognitionTimeDurationRatio:n/t.metadata.duration,recognitionLanguage:r.language,profanityFilter:r.profanityFilter,captionBackend:r.recognizer?.backendName,wordCount:i};c.z.logAppLogicEvent("AutocaptionCompleted",o),c.z.logEvent("AutocaptionCompleted",o)}(e,t,r)},runOnRejected:(e,[t,r,i,n],o)=>{!function(e,t){let r={recognitionLanguage:e.language,profanityFilter:e.profanityFilter,captionBackend:e.recognizer?.backendName};t instanceof v.t?r={...r,...t.details,message:t.error,captionErrorContext:t.context}:t instanceof Error&&(r={...r,message:t.message,captionErrorContext:t.stack}),c.z.logEvent("AutocaptionFailed",r),c.z.logErrorEvent("AutocaptionFailed",r)}({language:i,profanityFilter:r,captions:void 0,recognizer:n},o)}}),re=Reflect.metadata("design:type",Function),ie=Reflect.metadata("design:paramtypes",["undefined"==typeof AVAsset?Object:AVAsset,Boolean,void 0===m.CaptionRecognitionLanguage?Object:m.CaptionRecognitionLanguage,void 0===se.J?Object:se.J]),Y(ne=Z(ne=J(ne=$(ne=ee((oe=class{constructor(e,t){(0,i.A)(this,"generationPromises",{}),(0,i.A)(this,"generationInProgress",{}),(0,i.A)(this,"generationProgressCollection",new o.t({})),(0,i.A)(this,"generationProgressCollection$",this.generationProgressCollection.asObservable()),(0,i.A)(this,"runningGenerationProgressTotal$",this.generationProgressCollection$.pipe((0,s.T)((e=>{const t=Object.values(e).filter(g.O9).filter((e=>"cancelled"!==e.stage));if(t.some((e=>(0,g.O9)(e.percentComplete))))return t.map((e=>e.percentComplete??0)).reduce(((e,t)=>e+t),0)/t.length})))),(0,i.A)(this,"isTranscriptionInProgress$",this.generationProgressCollection$.pipe((0,s.T)((e=>Object.values(e).filter(g.O9).some((({stage:e})=>"cancelled"!==e&&"error"!==e&&"complete"!==e)))))),(0,i.A)(this,"captionBackendOverride",void 0),this.augloopService=e,this.availableBackends=t}cancelCaptionGeneration(){for(const e of Object.keys(this.generationInProgress))this.cancelCaptionGenerationFor(e)}cancelCaptionGenerationFor(e){const t=this.generationInProgress[e];(0,g.O9)(t)&&(t.cancel(),delete this.generationInProgress[e])}isTranscriptionInProgress(){return Object.values(this.generationInProgress).some((e=>e.isRunning()))}isTranscriptionInProgressForAssetId(e){return Object.values(this.generationInProgress).some((t=>t.assetId===e&&t.isRunning()))}async generateCaptions(e,t=!1,r="en-US"){const i=this.generationPromises[e.id];if(i)return i;const n=(0,A.or)(e);if(n)return n.source;if(!(0,l.xF)(e.metadata.raw))return;const o=this.makeCaptionRecognizer(e,((e,t,r,i)=>this.updateProgressFor(e,t,r,i)),r,t),s=new Promise((i=>{this.doGenerateCaptions(e,t,r,o).then((e=>i(e.captions))).catch((e=>h.Vy.error(e))).finally((()=>{delete this.generationPromises[e.id]}))}));return this.generationPromises[e.id]=s,s}async doGenerateCaptions(e,t,r,i){const n={language:r,profanityFilter:t,captions:void 0,recognizer:i};this.updateProgressFor(e,"extractAudio"),this.generationInProgress[e.id]=i;try{const e=await i.generateCaptions();return{...n,captions:e,recognizer:i}}catch(t){throw this.updateProgressFor(e,"error"),t}}progressForAllAssetSnapshot(){return this.generationProgressCollection.getValue()}updateProgressFor(e,t,r,i){const n={...this.generationProgressCollection.getValue()};"cancelled"===t?delete n[e.id]:n[e.id]={asset:e,stage:t,percentComplete:r,estimatedTimeRemainingMs:i},Object.values(n).filter(g.O9).every((e=>"complete"===e.stage))?this.generationProgressCollection.next({}):this.generationProgressCollection.next(n)}makeCaptionRecognizer(e,t,r,i,n,o){return new se.J({asset:e,reportProgress:t,startTimeS:n,endTimeS:o,backend:this.getCaptionBackend(r,i),config:{recognitionLanguage:r,enableProfanityFilter:i}})}getCaptionBackend(e,t){if(this.captionBackendOverride){const r=this.makeBackend(this.captionBackendOverride,e,t,!0);if(r)return h.Vy.warn(`Overriding caption backend: ${this.captionBackendOverride}`),r}for(const r of this.availableBackends){const i=this.makeBackend(r,e,t);if(i)return i}throw new Error(`could not find any valid captioning backends, options: ${this.availableBackends}`)}makeBackend(e,t,r,i=!1){return"Augloop"===e?new R(this.augloopService,{recognitionLanguage:t}):"AugloopCameraTranscript"===e&&(i||"en-US"===t&&(0,d.G7)("magic__caption_augloop_backend_use_camera_transcript"))?new O(this.augloopService):"AzureCognitiveServices"===e?new j.M({recognitionLanguage:t,enableProfanityFilter:r}):"AzureFastTranscription"===e&&(i||X.SUPPORTED_LANGUAGES.has(t)&&!(0,d.Us)("ks_magic__caption_fast_transcription"))?new X({recognitionLanguage:t,enableProfanityFilter:r,enableDisfluencyTagging:!0}):void 0}},(0,n.A)(oe.prototype,"doGenerateCaptions",[te,re,ie],Object.getOwnPropertyDescriptor(oe.prototype,"doGenerateCaptions"),oe.prototype),ne=oe))||ne)||ne)||ne)||ne)||ne);function de(){return(0,u.l)(le)}function ue(){return(0,u.l)(ce)}function he(){return(0,u.l)(ae)}},352849:(e,t,r)=>{r.d(t,{GD:()=>a,MV:()=>s,Z2:()=>o});var i=r(562229),n=r(776016);const o=1e4;function s(e,t){const r={};for(const[i,n]of Object.entries(e)){const e=Number.parseFloat(i)*t,o=n.durationMs*t;r[e]={...n,startTimeMs:e,durationMs:o}}return r}function a(e,t){let r,s;const a=new Map,c=t.NBest[0];let l;if(!(0,n.O9)(c))return Object.fromEntries(a);l=c.Words;for(const[t,i]of l.entries()){const c=i.Word.toLowerCase(),d=e.toLowerCase().indexOf(c),u=l.slice(t+1,t+1+d).map((t=>e.toLowerCase().indexOf(t.Word.toLowerCase()))).filter((e=>e>-1));if(u.some((e=>e<d))){const t=u[0],s=e.slice(0,t),c=i.Duration/o;if(void 0!==r){const e=a.get(r);(0,n.O9)(e)&&a.set(r,{...e,text:e.text+s,durationMs:e.durationMs+c})}e=e.slice(t);continue}if(!e.toLowerCase().includes(c)){void 0===s&&(s=i.Offset/o);continue}if(d>0){if((0,n.O9)(s))a.set(s,{text:e.slice(0,d),startTimeMs:s,durationMs:i.Offset/o-s}),s=void 0;else if((0,n.O9)(r)){const t=a.get(r);(0,n.O9)(t)&&a.set(r,{...t,text:t.text+e.slice(0,d)})}e=e.slice(d)}const h=i.Offset/o,p=i.Duration/o;a.set(h,{startTimeMs:h,durationMs:p,text:e.slice(0,i.Word.length)}),e=e.slice(i.Word.length),r=h}if(e.length>0)if(void 0!==s){const t=l.at(-1)||{Offset:0,Duration:0},r=(t.Offset+t.Duration)/o;a.set(s,{text:e,startTimeMs:s,durationMs:r-s}),s=void 0}else if((0,n.O9)(r)){const t=a.get(r);(0,n.O9)(t)&&a.set(r,{...t,text:t.text+e})}return function(e,t){const r=Math.max(...e.map((e=>e.Word.length))),n=Object.values(t).reduce(((e,t)=>t.text.length>2*r?e+1:e),0);n>0&&(i.z.logEvent("AutocaptionLongCaptionsFound",{numCaptionsLongerThanExpected:n,numCaptions:Object.values(t).length,maxCaptionWordLength:r}),i.z.logAppLogicEvent("AutocaptionLongCaptionsFound",{numCaptionsLongerThanExpected:n,numCaptions:Object.values(t).length,maxCaptionWordLength:r}))}(l,Object.fromEntries(a)),Object.fromEntries(a)}},500018:(e,t,r)=>{r.d(t,{Y:()=>n});var i=r(324586);class n{constructor({total:e,initialN:t=0,smoothing:r=.35,minIntervalMs:n=100,initialT:s}){(0,i.A)(this,"n",void 0),(0,i.A)(this,"total",void 0),(0,i.A)(this,"lastN",void 0),(0,i.A)(this,"lastT",void 0),(0,i.A)(this,"minInterval",void 0),(0,i.A)(this,"emaDn",void 0),(0,i.A)(this,"emaDt",void 0),this.n=t,this.total=e,this.lastN=this.n,this.lastT=void 0===s?Date.now():s,this.minInterval=n,this.emaDn=new o(r),this.emaDt=new o(r)}updateWithN(e,t){this.n=e;const r=void 0===t?Date.now():t,i=r-this.lastT;if(i>=this.minInterval){const e=this.n-this.lastN;this.emaDn.append(e),this.emaDt.append(i),this.lastN=this.n,this.lastT=r}}updateWithDelta(e,t){this.updateWithN(this.n+e,t)}get rate(){return this.emaDn.get()/this.emaDt.get()||void 0}get percentComplete(){return this.total?this.n/this.total:0}get estimatedTimeRemaining(){const e=this.rate;return e&&this.total?(this.total-this.n)/e:0}}class o{constructor(e){(0,i.A)(this,"alpha",void 0),(0,i.A)(this,"ema",void 0),(0,i.A)(this,"step",void 0),this.alpha=e,this.ema=0,this.step=0}append(e){this.ema=this.alpha*e+(1-this.alpha)*this.ema,this.step++}get(){const e=1-this.alpha;return this.step>0?this.ema/(1-e**this.step):this.ema}}},769159:(e,t,r)=>{r.d(t,{P:()=>n,X:()=>i});const i="projectBackendPersistence";class n{get invalidFilenameCharacters(){return""}isFilenameValid(e){if(!this.invalidFilenameCharacters||0===this.invalidFilenameCharacters.length)return!0;const t=`^[^${this.invalidFilenameCharacters}]+$`;return new RegExp(t,"g").test(e)}}},825386:(e,t,r)=>{r.d(t,{Rb:()=>s,bd:()=>o,sh:()=>c,t:()=>a}),r(379321);var i=r(363155),n=r(36366);function o(e,t,r){if(!(0,n.S)(t))return[];const i=e.duration,o=[];for(let t=0;t<r.length;t++){const n=r[t],[s,a]=c(n,e),l=s/i,d=(a-s)/i;if(0===t&&l>0)o.push({leftPct:0,widthPct:l});else if(t>0&&o.length>0){const e=o.at(-1);e&&o.push({leftPct:e.leftPct+e.widthPct,widthPct:l-(e.leftPct+e.widthPct)})}o.push({leftPct:l,widthPct:d,highlight:n}),t===r.length-1&&o.push({leftPct:l+d,widthPct:1-(l+d)})}return o.filter((e=>e.widthPct>0))}function s(e,t,r,n){const o=[];if(0===r.length)return"keep"===n?[]:[{from:0,to:0}];for(let s=0;s<r.length;s++){const a=r[s];if("keep"!==n){if(0===s?a.startTimeS>e.trim.from&&o.push({from:e.trim.from,to:t.metadata.duration-a.startTimeS}):a.startTimeS>r[s-1].endTimeS&&o.push({from:r[s-1].endTimeS,to:t.metadata.duration-a.startTimeS}),s===r.length-1&&t.metadata.duration-e.trim.to>a.endTimeS){const r=a.endTimeS-(t.metadata.duration-e.trim.to)<i.Yw,n=t.metadata.duration-a.endTimeS<i.Yw;r&&n||o.push({from:a.endTimeS,to:e.trim.to})}}else o.push({from:a.startTimeS,to:t.metadata.duration-a.endTimeS})}return o.sort(((e,t)=>e.from-t.from))}function a(e){return e.reduce(((e,t)=>e+t.endTimeS-t.startTimeS),0)}function c(e,t){const r=t.trim.from/t.speed,i=e.startTimeS-r;return e.endTimeS===t.duration?[i,t.duration]:[i,e.endTimeS-r]}},908545:(e,t,r)=>{function i(e,t){return{...e.byId,...t.byId}}r.d(t,{n:()=>i})},2857:(e,t,r)=>{r.d(t,{E:()=>o,F:()=>s});var i=r(788855),n=r(644069);function o(e){return!!(0,i.N)(e)&&(!e.cloud||"cloudbackup"===e.cloud.provider||(0,n.NT)(e.cloud.provider))}function s(e){return e.id.startsWith("brand-asset-")}},937111:(e,t,r)=>{r.d(t,{$:()=>o});var i=r(776016);const n=e=>(0,i.t9)({allIds:(0,i._j)(i.Kg),byId:(0,i.eB)(e)}),o=(0,i.t9)({aspectRatio:e=>"string"==typeof e&&(e=>"string"==typeof e)(e),aspectRatioManuallyUpdated:(0,i.H7)(i.Lm),assets:n(i.wW),entities:(0,i.eB)(i.wW),clickCount:(0,i.H7)(i.Et),clickDistance:(0,i.H7)(i.Et),createdAt:i.Kg,firstTemplateId:(0,i.H7)(i.Kg),firstTemplateName:(0,i.H7)(i.Kg),flavor:(0,i.u)("clipchamp","template","team","mobile","remixed"),flavorData:(0,i.H7)(i.wW),groups:i.wW,hasCloudBackupUpsellBeenShown:(0,i.H7)(i.Lm),haveEmptyStatesBeenDismissed:(0,i.H7)(i.wW),id:i.Kg,includesComponentTemplate:(0,i.H7)(i.Lm),includesProjectTemplate:(0,i.H7)(i.Lm),isCloudBackupEnabled:(0,i.H7)(i.Lm),items:i.wW,lastUsedConfig:(0,i.H7)(i.wW),name:i.Kg,projectNumber:(0,i.H7)(i.Et),recentColors:(0,i.H7)((0,i._j)(i.Et)),schemaVersion:i.Kg,successfulExports:(0,i.H7)(i.Et),templatesAdded:(0,i.H7)((0,i._j)(i.Kg)),templatesAddedCount:(0,i.H7)(i.Et),tracks:n(i.wW),updatedAt:i.Kg,version:i.Et})},875527:(e,t,r)=>{r.d(t,{JP:()=>d,ME:()=>s,QD:()=>l,Tj:()=>c,U3:()=>a,lE:()=>u});var i=r(562229),n=r(345153),o=r(2857);function s(e,t){let r={...e.assets};for(const e of t.allIds){const i=t.byId[e];(0,o.F)(i)&&!(e in r.byId)&&(r={byId:{...r.byId,[e]:i},allIds:[...r.allIds,e]})}return{...e,assets:{...r}}}function a(e){(0,n.vr)((t=>{t.isCloudBackupEnabled=e}))}function c(e){(0,n.vr)((t=>{t.hasCloudBackupUpsellBeenShown=e}))}function l(e){(0,n.vr)((t=>{t.haveEmptyStatesBeenDismissed=e}))}function d(e){const t=(0,n.U1)((e=>e.recentColors))??[],r=[e,...t.filter((t=>t!==e))].slice(0,8);(0,n.vr)((e=>{e.recentColors=r}))}function u(){const e=(0,n.U1)((e=>e.id));if(!e)return void i.z.logEvent("Sync - Last Change Project Undefined");const t=localStorage.getItem("cc_last_change"),r=t?JSON.parse(t):{};localStorage.setItem("cc_last_change",JSON.stringify({...r,[e]:Date.now()})),(0,n.vr)((e=>{e.updatedAt=(new Date).toISOString()}))}},842880:(e,t,r)=>{r.d(t,{Ed:()=>c,tu:()=>l});var i=r(667017),n=r(545516),o=r(650882),s=r(615101);let a;function c(e,t="browser"){switch(t){case"hash":a=(0,i.Ge)(e);break;case"memory":a=(0,n.bg)(e);break;case"browser":a=(0,i.Ys)(e);break;default:throw new o.eP((0,s.vU)("Unexpected history type"))}return a}function l(){if(!a)throw new Error("Global router has not been initialised");return a}},399079:(e,t,r)=>{r.d(t,{$:()=>c,v:()=>a}),r(584570),r(82265),r(988124);var i=r(26141),n=r(545516),o=r(422226),s=r(776016);const a=(e,t={})=>{const r=((e,t)=>{if(!(window.location.pathname in t))return e;const r=new URLSearchParams(e);for(const e of t[window.location.pathname])r.has(e)&&r.delete(e);return r})(new URLSearchParams(window.location.search),t),n=(e=>(0,s.Kg)(e)?(0,i.Rr)(e):{...e})(e);return n.search&&new URLSearchParams(n.search).forEach(((e,t)=>{r.set(e,t)})),n.search=r.toString(),n},c=(e={})=>{const t=(0,n.Zp)();return(0,o.Z)(((r,i)=>{const n=a(r,e);return t(n,i)}))}},345153:(e,t,r)=>{r.d(t,{fH:()=>F,BB:()=>R,U1:()=>w,wk:()=>x,mY:()=>E,QV:()=>k,wZ:()=>O,sl:()=>D,MF:()=>B,R8:()=>M,eU:()=>I,I8:()=>_,od:()=>S,jK:()=>T,vr:()=>C,Cr:()=>L,wj:()=>P,$Z:()=>N,By:()=>b});var i=r(515207),n=r(415004),o=r(412746),s=r(573340),a=r(650882),c=(r(379321),r(562229)),l=r(827370),d=r(776016);function u({assets:e,version:t,...r}){return r}function h(e,t){if(0===t.length)return{actionsDiff:void 0,calculatedState:void 0};const r=(0,l.Cc)(e,function(e){if((0,d.O9)(e))return e}(t.pop()));if(!r||"object"!=typeof r)return{actionsDiff:void 0,calculatedState:void 0};const i=(0,l.Ui)(r,e);return i?{actionsDiff:i,calculatedState:r}:{actionsDiff:void 0,calculatedState:void 0}}const p=(e,t)=>({history:{lastSnapshot:void 0,forwardDiffs:[],backwardDiffs:[],tag:void 0},saveHistoryCheckpoint(r,i){const{history:n,project:o}=t();if(!o)return;const s=u(o);let a=[...n.forwardDiffs];const c=[...n.backwardDiffs];if("push"===r||"merge"===r&&0===c.length){if(a=[],50===c.length&&c.shift(),n.lastSnapshot){const e=(0,l.Ui)(s,n.lastSnapshot);e&&c.push(e)}}else if("merge"===r&&(a=[],n.lastSnapshot)){const{calculatedState:e}=h(n.lastSnapshot,n.backwardDiffs);if(e){const t=(0,l.Ui)(s,e);t&&c.splice(-1,1,t)}}e({history:{lastSnapshot:s,forwardDiffs:a,backwardDiffs:c,tag:{action:"checkpoint",timestamp:Date.now(),label:i}}})},historyForward(){const{history:r,project:i}=t();if(!i)return;const n=u(i),{actionsDiff:o,calculatedState:s}=h(n,r.forwardDiffs);o?e({project:{...s,version:i.version,assets:i.assets},history:{lastSnapshot:s,forwardDiffs:r.forwardDiffs,backwardDiffs:[...r.backwardDiffs,o],tag:{action:"forward",timestamp:Date.now()}}}):c.z.logWarningEvent("UndoOrRedoFailed",{action:"redo"})},historyBack(){const{history:r,project:i}=t();if(!i)return;const n=u(i),{actionsDiff:o,calculatedState:s}=h(n,r.backwardDiffs);o?e({project:{...s,version:i.version,assets:i.assets},history:{lastSnapshot:s,forwardDiffs:[...r.forwardDiffs,o],backwardDiffs:r.backwardDiffs,tag:{action:"back",timestamp:Date.now()}}}):c.z.logWarningEvent("UndoOrRedoFailed",{action:"undo"})},resetHistory(){const{project:r}=t();e({history:{lastSnapshot:r?u(r):void 0,forwardDiffs:[],backwardDiffs:[],tag:{action:"reset",timestamp:Date.now()}}})}}),m=(e,t)=>({editorMode:"Editor",isViewerMode(){const{editorMode:e,isForcedViewerMode:r,isViewerModeFlightEnabled:i}=t();return i&&"Viewer"===e||r},isQuotaViewerMode(){const{isViewerMode:e,isQuotaViewerModeEnabled:r}=t();return e()&&r},isForcedViewerMode:!1,setForcedViewerMode(t){e({isForcedViewerMode:t})},isViewerModeFlightEnabled:!1,setViewerModeFlightEnabled(t){e({isViewerModeFlightEnabled:t})},enableViewerMode(){e({editorMode:"Viewer"})},disableViewerMode(){e({editorMode:"Editor"})},isQuotaViewerModeEnabled:!1,enableQuotaViewerMode(){e({editorMode:"Viewer",isQuotaViewerModeEnabled:!0})},disableQuotaViewerMode(){e({editorMode:"Editor",isQuotaViewerModeEnabled:!1})}});var f=r(959763);const g=e=>({project:void 0,updateProject(t){e((e=>({project:(0,f.jM)(e.project,t)})))}}),A=(0,o.y)(((...e)=>({...g(...e),...p(...e),...m(...e)})));function v(e,t){return(0,n.n)(A,e,t)}const y=(e,t)=>e===t;function b(e,t){return v((t=>{if(t.project)return e(t.project)}),t)}function w(e){const t=A.getState().project;if(t)return e(t)}function x(){return void 0!==w((e=>e.id))}function S(e,t=!1){A.setState({project:e},t)}function T(){A.setState({project:void 0})}function C(e){A.getState().updateProject((t=>{t?e(t):s.Vy.error(new a.g9("Unable to update undefined project"))}))}function _(e="push",t){A.getState().saveHistoryCheckpoint(e,t)}function k(){A.getState().historyForward()}function E(){A.getState().historyBack()}function I(){A.getState().resetHistory()}function R(){return A.getState().history.backwardDiffs.length>0}function F(){return A.getState().history.forwardDiffs.length>0}function P(){return v((e=>e.history.backwardDiffs.length>0))}function L(){return v((e=>e.history.forwardDiffs.length>0))}function N(){return v((e=>e.history.tag))}function M(e){return A.subscribe(((t,r)=>e(t.project,r.project)))}function B(e){return A.subscribe(((t,r)=>{t.history?.tag?.action===r.history?.tag?.action&&t.history?.tag?.timestamp===r.history?.tag?.timestamp||e(t.history,r.history)}))}function D(e,t=y){return new i.c((r=>{const i=A.getState().project;i&&r.next(e(i));const n=M(((i,n)=>{const o=e(i),s=e(n);((void 0===o||void 0===s)&&o!==s||void 0!==o&&void 0!==s&&!t(o,s))&&r.next(o)}));r.add(n)}))}function O(){return A.getState().isViewerMode()}},272885:(e,t,r)=>{r.d(t,{AH:()=>h,Jq:()=>a,ch:()=>p,eS:()=>d,im:()=>c,v2:()=>u,y_:()=>l}),r(379321);var i=r(959763),n=r(831123),o=r(357891),s=r(544211);const a=(0,n.vt)((e=>({bundledIds:[],allIds:[],byId:{},add:t=>e((e=>({...e,byId:{...e.byId,[t.id]:t},allIds:[...e.allIds.filter((e=>e!==t.id)),t.id]}))),addMultiple:t=>e((e=>{const r={...e,byId:{},allIds:[]};for(const i of t.filter((t=>!e.allIds.includes(t.id))))r.allIds.push(i.id),r.byId[i.id]=i;return{...e,byId:{...e.byId,...r.byId},allIds:[...e.allIds,...r.allIds]}}))})));function c(){return a((e=>e.allIds.map((t=>e.byId[t]))),o.x)}function l(){const e=a.getState();return e.allIds.map((t=>e.byId[t])).filter(s.x)}function d(){return a.getState()}function u(e){a.getState().add(e)}function h(e){a.getState().addMultiple(e)}function p(e){const t=d();let r={type:"detached"};const n=(0,i.jM)(t,(t=>{r={type:"attached",value:e(t)}}));if("detached"===r.type)throw new Error("Produce closure was not run");return n===t||function(e){a.setState(e)}(n),r.value}},668388:(e,t,r)=>{r.d(t,{yH:()=>h,HF:()=>p,Js:()=>A});var i=r(71872),n=r(175358),o=r(674871);const s=[{color:{hex:i.F.fromString(o.pw.black),alpha:1},name:(0,n.mj)("editor.sidebar.backgroundBlack","Black"),id:"black-background-preset"},{color:{hex:i.F.fromString(o.pw.white),alpha:1},name:(0,n.mj)("editor.sidebar.backgroundWhite","White"),id:"white-background-preset"},{color:{hex:i.F.fromString("0084FF"),alpha:1},name:(0,n.mj)("editor.sidebar.backgroundSolidColor","Other color"),id:"solid-background-preset"}];var a=r(994651),c=r(362724),l=r(413497),d=r(897427),u=r(902573);const h=s.map((e=>({id:e.id,type:"background",metadata:{duration:5,size:0},hidden:!1,color:e.color,name:e.name}))),p=1e3,m={greenScreen:!0,smoke:!0,vertical:!0,radial:!0},f={normal:!0},g=a.vj.map(((e,t)=>({id:e.id,hidden:!1,name:e.name,type:"filter",preset:e,hasTransparency:!!m[e.id],options:e.options,order:(f[e.id]?0:2e3)+t}))),A=[c.lP,u.c,l.d,...h,...g,...d.ad]},170553:(e,t,r)=>{r.d(t,{F4:()=>v,HK:()=>A,Q_:()=>b,cS:()=>w,HW:()=>y});var i=r(776016),n=r(392844);const o=(0,i.H7)((0,i.u)(...n.Z)),s=(0,i.ey)((0,i.VA)(i.Et,3),(0,i.VA)(i.Et,4)),a=(0,i.t9)({alpha:i.Et,hex:i.Et}),c=(0,i.t9)({alpha:i.Et,hexStr:i.Kg}),l=(0,i.ey)(i.Kg,c,a,s),d=(0,i.t9)({colors:(0,i._j)(l),direction:o});var u=r(739367),h=r(889688),p=r(573340);const m=(0,r(53338).r)("education","creator","SME","corporate","personal","skipped"),f=(0,i.t9)({gaps:(0,i.H7)(i.Et),discover1:(0,i.H7)(i.Et),discover2:(0,i.H7)(i.Et),tts:(0,i.H7)(i.Et),pauseRemoval:(0,i.H7)(i.Et)}),g=(0,i.t9)({id:i.Kg,assets:i.wW,name:i.Kg});(0,i.t9)({schemaVersion:(0,i.H7)(i.Et),brandPrimary:(0,i.H7)(g),initialSurveyComplete:(0,i.H7)(i.Lm),surveyDismissed:(0,i.H7)(i.Lm),surveyUserExperienceLevelComplete:(0,i.H7)(i.Lm),surveyUserVideoKindComplete:(0,i.H7)(i.Lm),dontShowBackupNotEnabledUpsellDialog:(0,i.H7)(i.Lm),sidebarTransitionsTipClosed:(0,i.H7)(i.Lm),userType:(0,i.H7)((0,i.u)(...m)),userFunction:(0,i.H7)(i.Kg),dontShowReplaceOnboarding:(0,i.H7)(i.Lm),acceptCookies:(0,i.H7)(i.Lm),hidePWACTA:(0,i.H7)(i.Lm),MSAConnected:(0,i.H7)(i.Lm),productTourTimesShown:(0,i.H7)(f),showPersonalizedContent:(0,i.H7)(i.Lm),essentialsRebrandInfoDismissed:(0,i.H7)(i.Lm),recentGradientColors:(0,i.H7)((0,i._j)(d)),recentSolidColors:(0,i.H7)((0,i._j)(i.Kg)),renoMilestoneOneOnboardingDismissed:(0,i.H7)(i.Lm),renoMilestoneOneOnboardingTooltipDismissed:(0,i.H7)(i.Lm)});class A{}const v="retrieveUserPreferences";function y(){return(0,u.l)(v).getUserPreferences()}function b(e,t){w(e,t).catch((e=>{p.Vy.error("Error updating user preference",e)}))}async function w(e,t){const r=(0,h.W)(v);await r.updateUserPreferences(e,t)}},704613:()=>{},467379:(e,t,r)=>{r.d(t,{F7:()=>c,l8:()=>i,sK:()=>s,wl:()=>o});const i={"1:1":1,"2:3":2/3,"4:3":4/3,"4:5":.8,"9:16":9/16,"16:9":16/9,"21:9":21/9},n=Object.keys(i);function o(e){return i.hasOwnProperty(e)}const s={"1:1":"square","2:3":"vertical","4:3":"classic","4:5":"social","9:16":"portrait","16:9":"widescreen","21:9":"cinematic"},a="16:9",c=(e,t,r=.3,o=n)=>{if(!(e>0&&t>0))return console.warn(`Asset dimentions must be a number greater than zero. Defaulting to "${a}"`),a;const s=e/t;let c,l=a;return o.forEach((e=>{const t=i[e],n=Math.abs(1-s/t);n<=r&&(void 0===c||n<c)&&(c=n,l=e)})),l}},2e3:(e,t,r)=>{r.d(t,{c:()=>o,k:()=>s});var i=r(834533),n=r(978574);function o(e){return n.o.includes(e.type)}function s(e){return(0,i.bg)(e)||"background"===e.type||"component"===e.type}},978574:(e,t,r)=>{r.d(t,{S:()=>i,o:()=>n});const i=["video","audio","image"],n=["title","filter","transition","background","procedural","component"]},613001:(e,t,r)=>{r.d(t,{S9:()=>n,Sy:()=>o,U2:()=>c,nr:()=>s,sd:()=>a});var i=r(776016);function n(e){return"logo"===e.appearAsType}function o(e){return"giphy"===e.cloud?.provider}function s(e){return!!e.metadata.duration}function a(e){return"number"==typeof e?.metadata?.width&&"number"==typeof e?.metadata?.height}function c(e){return void 0!==e.cloud}(0,i.t9)({generationSequence:(0,i._j)((0,i.t9)({type:i.Kg}))})},345762:(e,t,r)=>{function i(e,t){return 1===t?e:Object.fromEntries(Object.entries(e).map((([e,r])=>[e,{...r,startTimeMs:r.startTimeMs/t,durationMs:r.durationMs/t}])))}r.d(t,{n:()=>i})},248142:(e,t,r)=>{r.d(t,{T:()=>l,n4:()=>c,or:()=>a,tf:()=>d});var i=r(345762),n=r(292388),o=r(36366),s=r(345563);function a(e){if((0,o.S)(e)&&e.analyses){const t=e.analyses.find((e=>"TranscriptAnalyser"===e.source));return t?.transcript}}function c(e,t){const r=e.analyses?.filter((e=>"TranscriptAnalyser"!==e.source));return{...e,analyses:[...r??[],{source:"TranscriptAnalyser",transcript:t}]}}function l(e,t,r,o){if(0===t.volume||o&&t.disableCaptions)return;const c=a(e);if(!c)return;const l=(0,n.g)(c),d=t.speed??1,u=(0,i.n)(l,d),h=t.trim.from/t.speed;return(0,s.H7)(u,{startTimeMs:1e3*h,endTimeMs:1e3*(h+t.duration),...s.eD[r]})}function d(e,t){const r={};for(const i of[...e,...t])r[i.source]=i;return Object.values(r)}},292388:(e,t,r)=>{r.d(t,{g:()=>i});const i=e=>{const t={...e.source,...e.updates};for(const r of e.deletions)delete t[r];return t}},89495:(e,t,r)=>{function i(e,t){if("presets"in e&&e.presets&&t in e.presets)return e.presets[t]}r.d(t,{G:()=>i})},36366:(e,t,r)=>{r.d(t,{S:()=>n,k:()=>o});var i=r(776016);function n(e){return!!(0,i.O9)(e)&&"metadata"in e&&void 0!==e.metadata&&("video"===e.type||"audio"===e.type)}function o(e,t){if("audio"===e&&"sampleRate"in t)return{type:"audio",metadata:t};if("video"===e&&"width"in t)return{type:"video",metadata:t};throw new Error("Metadata did not match asset type")}},345563:(e,t,r)=>{r.d(t,{H7:()=>c,PD:()=>a,U6:()=>s,b6:()=>d,eD:()=>o,hO:()=>m,pK:()=>l}),r(379321),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(847269);const n={charactersPerLine:42,maxDurationMs:3e3,removeGapsShorterThanMs:100},o={"1:1":{...n,charactersPerLine:30},"2:3":{...n,charactersPerLine:15},"4:5":{...n,charactersPerLine:22},"9:16":{...n,charactersPerLine:15},"16:9":n,"21:9":n,"4:3":n};function s(e){return e.map((e=>"."===e.text.at(-1)?{...e,text:e.text+" "}:e))}function a(e){return Object.values(e).sort(((e,t)=>e.startTimeMs-t.startTimeMs))}function c(e,t){const r=Object.assign({},n,t||{}),o={},c=s(a(e).filter((e=>function(e,t){let r=!0;return t.startTimeMs&&(r=e.startTimeMs>=t.startTimeMs),t.endTimeMs&&(r=r&&e.startTimeMs<=t.endTimeMs),r}(e,r))));if(0===c.length)return{};const l=(0,i.T9)(c[0],"filteredWords[0] is undefined");let d=l.durationMs;const u=l.startTimeMs+l.durationMs;r.endTimeMs&&u>r.endTimeMs&&(d=r.endTimeMs-l.startTimeMs);const h={startTimeMs:l.startTimeMs,durationMs:d,text:l.text};for(const e of c.slice(1)){const t=e.startTimeMs+e.durationMs-h.startTimeMs>r.maxDurationMs,i=h.text.length+e.text.length>r.charactersPerLine;if(t||i){o[h.startTimeMs]={...h},h.startTimeMs=e.startTimeMs,h.durationMs=e.durationMs,h.text=e.text;continue}const n=h.startTimeMs+h.durationMs,s=e.startTimeMs-n,a=r.endTimeMs&&r.endTimeMs-n;h.durationMs+=s+Math.min(e.durationMs,a??Number.POSITIVE_INFINITY),h.text+=e.text}return o[h.startTimeMs]=h,Object.values(o).forEach((e=>{" "===e.text.at(-1)&&(e.text=e.text.slice(0,-1))})),o}function l(e,t,r){const i={};for(const n of Object.values(e))n.startTimeMs>t&&n.startTimeMs<r&&(i[n.startTimeMs]={...n});return i}function d(e,t){if(0===Object.keys(e).length)return"";const r=Object.values(c(e,t)).sort(((e,t)=>e.startTimeMs-t.startTimeMs)),n=[];for(let e=0;e<r.length;e++){const t=(0,i.T9)(r[e],`captions[${e}] is undefined`),o=h(u(t.startTimeMs)),s=h(u(t.startTimeMs+t.durationMs));n.push([e+1,`${o} --\x3e ${s}`,t.text].join("\n"))}return n.join("\n\n")+"\n"}function u(e){const t=e%1e3,r=Math.floor(e/1e3),i=Math.floor(r/60);return{hours:Math.floor(i/60),minutes:i%60,seconds:r%60,milliseconds:t}}function h(e){return`${p(e.hours,2,"0")}:${p(e.minutes,2,"0")}:${p(e.seconds,2,"0")},${p(e.milliseconds,3,"0")}`}function p(e,t,r){const i=e.toFixed(0);return i.length<t?r.repeat(t-i.length)+i:i}function m(e){const t=[];for(const r of Object.values(e))t.push({captionStartTimeMs:r.startTimeMs,boundaryMs:r.startTimeMs},{captionStartTimeMs:r.startTimeMs,boundaryMs:r.startTimeMs+r.durationMs-1});t.sort(((e,t)=>e.boundaryMs-t.boundaryMs));const r=[],n=new Set;let o;for(const s of t){const t=(0,i.T9)(e[s.captionStartTimeMs],"captions[boundary.captionStartTimeMs] is undefined");if(void 0===o)n.add(s.captionStartTimeMs),o={startTimeMs:t.startTimeMs,durationMs:0,text:t.text};else if(n.has(s.captionStartTimeMs))if(n.delete(s.captionStartTimeMs),r.push({startTimeMs:o.startTimeMs,durationMs:s.boundaryMs-o.startTimeMs,text:o.text}),0===n.size)o=void 0;else{const t=[...n].sort().reverse().map((t=>(0,i.T9)(e[t],"captions[startTimeMs] is undefined").text));o={startTimeMs:s.boundaryMs,durationMs:0,text:t.join("\n")}}else n.add(s.captionStartTimeMs),r.push({startTimeMs:o.startTimeMs,durationMs:s.boundaryMs-o.startTimeMs,text:o.text}),o={startTimeMs:s.captionStartTimeMs,durationMs:0,text:`${t.text}\n${o.text}`}}return r.sort(((e,t)=>e.startTimeMs-t.startTimeMs))}},215363:(e,t,r)=>{function i(e){return!!e.cloud}r.d(t,{G:()=>i})},897592:(e,t,r)=>{function i(e){return"component"===e.type}r.d(t,{Y:()=>i})},902573:(e,t,r)=>{r.d(t,{c:()=>i});const i={id:"component-bridging-asset",name:"component-bridging-asset",type:"procedural",hidden:!1,entities:[]}},327443:(e,t,r)=>{r.d(t,{F_:()=>n,Fv:()=>s,IO:()=>c,XF:()=>d,gD:()=>u,no:()=>a,vP:()=>o});var i=r(540076);function n(e){return!0===e.isElement}function o(e){return"image"===l(e)}function s(e){return"video"===l(e)}function a(e){return n(e)&&"background"===e.subtype}function c(e){return n(e)&&("background"===e.subtype||"frame"===e.subtype)}function l(e){switch(e){case"png":case"svg":return"image";case"mp4":case"webm":case"gif":return"video";default:(0,i.xb)(e,`Unknown element format: [${e}]`)}}function d(e){switch(e){case"annotation":case"sticker":return.4;case"background":case"frame":case"icon":case"overlay":return;case"shape":return.6;default:(0,i.xb)(e,`Unsupported element subtype: [${e}]`)}}function u(e,t){const r=e.metadata.preferredHeight||d(e.subtype);if(!r)return;const i=1/t,n=r*e.metadata.width/e.metadata.height*i;return n&&r&&!Number.isNaN(n)&&!Number.isNaN(r)?{top:.5+r/2,bottom:.5-r/2,left:.5-n/2,right:.5+n/2}:void 0}},544211:(e,t,r)=>{function i(e){return!!e&&"type"in e&&"filter"===e.type&&"preset"in e}r.d(t,{x:()=>i})},623086:(e,t,r)=>{r.d(t,{R:()=>o});var i=r(36366),n=r(788855);function o(e){return!!(0,n.N)(e)&&!!(0,i.S)(e)&&!!e.metadata.raw.streams.find((e=>"audio"===e.codec_type))}},788855:(e,t,r)=>{r.d(t,{K:()=>o,N:()=>n});var i=r(978574);function n(e){return i.S.includes(e.type)&&"metadata"in e}function o(e){return!!e.metadata}},824378:(e,t,r)=>{r.d(t,{r:()=>o,u:()=>n});var i=r(902573);function n(e){return"procedural"===e.type&&e.id!==i.c.id}function o(e,t){return!(!e||1!==e.length)&&e[0].segments.some((e=>e.type===t))}},940069:(e,t,r)=>{r.d(t,{HS:()=>a,an:()=>s,bF:()=>o,rY:()=>n,vE:()=>i});const i=["default","x-low","low","medium","high","x-high"],n=["advertisement-upbeat","affectionate","angry","assistant","calm","chat","cheerful","customerservice","depressed","disgruntled","documentary-narration","embarrassed","empathetic","envious","excited","fearful","friendly","gentle","hopeful","lyrical","narration-professional","narration-relaxed","newscast","newscast-casual","newscast-formal","poetry-reading","sad","serious","shouting","sports-commentary","sports-commentary-excited","whispering","terrified","unfriendly","neutral"];function o(e){return i.includes(e)}function s(e){return n.includes(e)}function a(e){return"audio"===e.type&&"voiceId"in e&&"speed"in e&&"text"in e}},468314:(e,t,r)=>{function i(e){return!!e&&"type"in e&&"transition"===e.type}r.d(t,{S:()=>i})},167436:(e,t,r)=>{function i(e){return"metadata"in e&&void 0!==e.metadata&&"video"===e.type}r.d(t,{W:()=>i})},834533:(e,t,r)=>{r.d(t,{C1:()=>s,GO:()=>o,bg:()=>n});var i=r(89495);function n(e){return"video"===e.type||"image"===e.type}function o(e,t){if(!n(e))return;const r=(0,i.G)(e,"preferredHeight");if(!r)return;const o=1/t,s=r*e.metadata.width/e.metadata.height*o;return s&&r&&!Number.isNaN(s)&&!Number.isNaN(r)?{top:.5+r/2,bottom:.5-r/2,left:.5-s/2,right:.5+s/2}:void 0}function s(e){return"image"===e.type}},644069:(e,t,r)=>{r.d(t,{JV:()=>n,KG:()=>c,NT:()=>s}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);const i=["box_edit_in","box","dropbox","gdrive","google_photos","onedrive","onedrive1p","zoom","xbox"];function n(e){return i.includes(e)}const o=["url","windows_native"];function s(e){return o.includes(e)}const a=new Set(["videoblocks","clipchamp_stock","clipchamp","giphy","hubble"]);function c(e){return a.has(e)}},914023:(e,t,r)=>{r.d(t,{BJ:()=>s,Ju:()=>n,g$:()=>a,uo:()=>o});var i=r(324586);const n=1e3,o=2e3,s=1e3;class a{constructor(e,t,r,a={fields:[]},c=!0){(0,i.A)(this,"renderOrder",void 0),(0,i.A)(this,"uiOrder",s),(0,i.A)(this,"blackWhiteRemovalEnabled",!1),(0,i.A)(this,"blackWhiteRemovalCutoff",0),(0,i.A)(this,"blackWhiteRemovalColor","black"),(0,i.A)(this,"blurAmount",0),(0,i.A)(this,"cartoonEnabled",!1),(0,i.A)(this,"cartoonHalftoneIntensity",.3),(0,i.A)(this,"glassAmount",0),(0,i.A)(this,"glitchAmount",0),(0,i.A)(this,"glitchSpeed",0),(0,i.A)(this,"pixelation",0),(0,i.A)(this,"colorPalette","retro-handheld-green"),(0,i.A)(this,"grainAmount",0),(0,i.A)(this,"greenScreenCutoff",0),(0,i.A)(this,"greenScreenColor","r"),(0,i.A)(this,"pattern",!1),(0,i.A)(this,"radialAmount",0),(0,i.A)(this,"verticalAmount",0),(0,i.A)(this,"vhsShiftFrequency",0),(0,i.A)(this,"chromaticAberrationAmount",0),(0,i.A)(this,"smokeEnabled",!1),(0,i.A)(this,"szMode","disabled"),(0,i.A)(this,"szPosition",[1,1]),(0,i.A)(this,"szSpeed",0),(0,i.A)(this,"szReverse",!1),(0,i.A)(this,"crashZoomPosition",[1,1]),(0,i.A)(this,"crashZoomZoomAmount",0),(0,i.A)(this,"crashZoomSteps","0"),(0,i.A)(this,"crashZoomStepDelay",0),(0,i.A)(this,"crashZoomEnabled",!1),(0,i.A)(this,"colorShiftEnabled",!1),(0,i.A)(this,"discoEnabled",!1),(0,i.A)(this,"greenScreenEnabled",!1),(0,i.A)(this,"blurFillEnabled",!1),(0,i.A)(this,"lutSrc",void 0),(0,i.A)(this,"lutIntensity",0),(0,i.A)(this,"flash",void 0),(0,i.A)(this,"pulse",void 0),(0,i.A)(this,"rotate",void 0),(0,i.A)(this,"spin",void 0),(0,i.A)(this,"move",void 0),(0,i.A)(this,"kaleidoscopeV2",void 0),(0,i.A)(this,"diffusionV2",void 0),(0,i.A)(this,"glowV2",void 0),(0,i.A)(this,"vignette",void 0),this.name=e,this.id=t,this.subtype=r,this.options=a,this.supportsTextNodes=c,this.renderOrder="effect-filter"===r?n:o}}},532203:(e,t,r)=>{function i(e={}){return{strength:.7,...e}}r.d(t,{R:()=>i})},294258:(e,t,r)=>{function i(e={}){return{speed:1,fade:!1,...e}}r.d(t,{E:()=>i})},177191:(e,t,r)=>{function i(e={}){return{strength:.6,...e}}r.d(t,{d:()=>i})},320043:(e,t,r)=>{function i(e={}){return{speed:.3,segments:8,enableColorShift:!1,...e}}r.d(t,{x:()=>i})},903523:(e,t,r)=>{function i(e={}){return{direction:0,distance:.5,speed:1,ease:!0,mode:"simple",...e}}r.d(t,{j:()=>i})},709629:(e,t,r)=>{function i(e={}){return{speed:2,amount:.15,loop:!0,...e}}r.d(t,{L:()=>i})},588657:(e,t,r)=>{function i(e={}){return{speed:.15,reverse:!1,...e}}r.d(t,{d:()=>i})},552614:(e,t,r)=>{function i(e={}){return{bounce:!0,loop:!1,reverse:!1,...e}}r.d(t,{y:()=>i})},722392:(e,t,r)=>{function i(e){const{transitionIn:t,transitionOut:r,asset:i,filters:n,...o}=e;return{...o,transitionInId:t?t.id:void 0,transitionOutId:r?r.id:void 0,assetId:i.id,filters:n?n.map((e=>({filterId:e.filter.id,filterFields:e.filterFields}))):void 0}}r.d(t,{o:()=>i})},588831:(e,t,r)=>{r.d(t,{v:()=>i});const i=["projectNumber","clickCount","clickDistance","templatesAdded","templatesAddedCount","includesProjectTemplate","includesComponentTemplate","firstTemplateId","firstTemplateName","analytics","successfulExports","timeSpentEditingMs"]},74987:(e,t,r)=>{function i(e){return"audio"===e.asset.type}function n(e){return"video"===e.asset.type||"audio"===e.asset.type}r.d(t,{R:()=>i,j:()=>n})},165620:(e,t,r)=>{r.d(t,{VG:()=>o,Zo:()=>n,cL:()=>d,qO:()=>a,r4:()=>u,xQ:()=>c,z2:()=>s});const i=["plain-text","styled-text"],n=["text-to-speech","shape","background-smart-group","image-creator","container",...i],o=e=>!!e&&n.includes(e);function s(e){return l(e)?e.componentHint:void 0}function a(e){return l(e)}function c(e,t){return s(e)===t}function l(e){return"componentHint"in e&&!!e.componentHint&&n.includes(e.componentHint)}function d(e){return i.includes(e)}function u(e){return l(e)&&d(e.componentHint)}},680804:(e,t,r)=>{r.d(t,{Rh:()=>o,uF:()=>n});var i=r(824378);function n(e){return(0,i.u)(e.asset)}function o(e){return n(e)&&(0,i.r)(e.entities,"com.clipchamp.text")}},966139:(e,t,r)=>{function i(e){return"title"===e.asset.type}r.d(t,{p:()=>i})},448260:(e,t,r)=>{function i(e){return"video"===e.asset.type}r.d(t,{q:()=>i})},922557:(e,t,r)=>{function i(e){return"filter"in e}function n(e){return"video"===e.asset.type||"image"===e.asset.type}r.d(t,{B:()=>i,n:()=>n})},150919:(e,t,r)=>{r.d(t,{T:()=>o});var i=r(326180),n=r(439921);class o{get fb(){return this.textureImage.fb}get gl(){return this.textureImage.gl}get pixelHeight(){return this.textureImage.pixelHeight}get pixelWidth(){return this.textureImage.pixelWidth}get relative(){return this.textureImage.relative}get relativeHeight(){return this.textureImage.relativeHeight}get relativeWidth(){return this.textureImage.relativeWidth}get format(){return this.textureImage.format}get hasValidMipmap(){return this.textureImage.hasValidMipmap}get root(){return this.textureImage.root}get tex(){return this.textureImage.tex}static wrap(e){return(0,i.Ar)(new o(e.value))}constructor(e){this.textureImage=e}bindFb(){this.gl.enable(WebGLRenderingContext.BLEND),this.gl.blendEquation(WebGLRenderingContext.FUNC_ADD),this.gl.blendFunc(WebGLRenderingContext.ONE,WebGLRenderingContext.ONE_MINUS_SRC_ALPHA),this.gl.viewport(0,0,this.pixelWidth,this.pixelHeight),this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,this.fb)}bindSampler(e,t){return this.textureImage.bindSampler(e,t)}clear(){}copy(e){(0,i.Ww)(e)((e=>{(0,n.u)(this.root,e,(0,i.Ar)(this))}))}downloadBuffer(e,t){return this.textureImage.downloadBuffer(e,t)}downloadWebGL2Buffer(e,t){this.textureImage.downloadWebGL2Buffer(e,t)}unwrap(){return this.textureImage.unwrap()}upload(e,t){(0,i.Ww)(this.root.allocCopyImage())((r=>{r.value.upload(e,t),(0,n.u)(this.root,r,(0,i.Ar)(this))}))}uploadBuffer(e,t,r,o){(0,i.Ww)(this.root.allocCopyImage())((s=>{s.value.uploadBuffer(e,t,r,o),(0,n.u)(this.root,s,(0,i.Ar)(this))}))}}},987089:(e,t,r)=>{r.d(t,{Ou:()=>s,Tx:()=>o,VG:()=>a,YI:()=>l,_L:()=>n,bj:()=>i,j7:()=>u});const i={internalFormat:WebGLRenderingContext.RGBA},n={internalFormat:WebGLRenderingContext.LUMINANCE},o={internalFormat:WebGL2RenderingContext.R8},s={channels:WebGLRenderingContext.RGBA,type:WebGLRenderingContext.UNSIGNED_BYTE},a={channels:WebGLRenderingContext.LUMINANCE,type:WebGLRenderingContext.UNSIGNED_BYTE},c={channels:WebGL2RenderingContext.RED,type:WebGL2RenderingContext.UNSIGNED_BYTE};function l(e){switch(e.internalFormat){case WebGL2RenderingContext.RGBA:return s;case WebGL2RenderingContext.LUMINANCE:return a;case WebGL2RenderingContext.R8:return c;default:throw new Error(`Unknown image format ${e.internalFormat}, please add it to the getBufferFormat table`)}}function d(e){switch(e){case WebGL2RenderingContext.LUMINANCE:case WebGL2RenderingContext.RED:return 1;case WebGL2RenderingContext.LUMINANCE_ALPHA:case WebGL2RenderingContext.RG:return 2;case WebGL2RenderingContext.RGB:return 3;case WebGL2RenderingContext.RGBA:return 4;default:throw new Error(`Unknown channel format ${e}, please add it to the getChannelCount table`)}}function u(e){switch(e.type){case WebGL2RenderingContext.UNSIGNED_BYTE:return d(e.channels);case WebGL2RenderingContext.SHORT:case WebGL2RenderingContext.HALF_FLOAT:return 2*d(e.channels);case WebGL2RenderingContext.FLOAT:return 4*d(e.channels);default:throw new Error(`Unknown buffer type ${e.type}, please add it to the getFragmentByteLength table`)}}},439921:(e,t,r)=>{r.d(t,{L:()=>s,u:()=>o});var i=r(926562),n=r(987089);function o(e,t,r){const n=e.ctx.renderers.get(i.n);n.renderSampler.set(t.value.bindSampler(0)),n.renderTo(r)}function s(e,t){return e.value.pixelWidth*e.value.pixelHeight*(0,n.j7)(t)}},126990:(e,t,r)=>{r.d(t,{G:()=>o});var i=r(324586),n=r(987089);class o{get fb(){return this.ensureReadWriteImage().value.fb}get gl(){return this.root.gl}get pixelHeight(){return"empty"===this._underlyingImage.state?0:this._underlyingImage.image.value.pixelHeight}get pixelWidth(){return"empty"===this._underlyingImage.state?0:this._underlyingImage.image.value.pixelWidth}get relative(){return"empty"!==this._underlyingImage.state&&this._underlyingImage.image.value.relative}get relativeHeight(){return"empty"===this._underlyingImage.state?0:this._underlyingImage.image.value.relativeHeight}get relativeWidth(){return"empty"===this._underlyingImage.state?0:this._underlyingImage.image.value.relativeWidth}get format(){return"empty"===this._underlyingImage.state?n.bj:this._underlyingImage.image.value.format}get hasValidMipmap(){return"empty"!==this._underlyingImage.state&&this._underlyingImage.image.value.hasValidMipmap}get tex(){return this.ensureReadWriteImage().value.tex}get isEmpty(){return"empty"===this._underlyingImage.state}static create(e){const t=new o(e);return{value:t,free(){t.destroy()}}}constructor(e){(0,i.A)(this,"_underlyingImage",{state:"empty"}),this.root=e}bindFb(){this.ensureReadWriteImage().value.bindFb()}bindSampler(e,t){return this.ensureReadImage().value.bindSampler(e,t)}clear(){this.setUnderlyingImage({state:"empty"})}copy(e){this.setUnderlyingImage({state:"read",image:e})}downloadBuffer(e,t){return"empty"!==this._underlyingImage.state?this._underlyingImage.image.value.downloadBuffer(e,t):Promise.resolve()}downloadWebGL2Buffer(e,t){"empty"!==this._underlyingImage.state&&this._underlyingImage.image.value.downloadWebGL2Buffer(e,t)}unwrap(){return this.ensureReadWriteImage().value.unwrap()}upload(e,t){this.ensureReadWriteImage().value.upload(e,t)}uploadBuffer(e,t,r,i){this.ensureReadWriteImage().value.uploadBuffer(e,t,r,i)}allocateReadWriteUnderlyingImage(){const e=this.root.allocCopyImage();return this.setUnderlyingImage({state:"read-write",image:e}),e}destroy(){this.setUnderlyingImage({state:"empty"})}ensureReadImage(){return"empty"===this._underlyingImage.state?this.allocateReadWriteUnderlyingImage():this._underlyingImage.image}ensureReadWriteImage(){return"read-write"===this._underlyingImage.state?this._underlyingImage.image:this.allocateReadWriteUnderlyingImage()}setUnderlyingImage(e){"empty"!==this._underlyingImage.state&&this._underlyingImage.image.free(),this._underlyingImage=e}}},943134:(e,t,r)=>{function i(e,t,r){e.renderSampler.set(r.value.bindSampler(0)),e.renderTo(t)}r.d(t,{C:()=>i})},945596:(e,t,r)=>{r.d(t,{A:()=>a});var i=r(324586),n=r(847269);class o{constructor(e,t,r){this.ctx=e,this.program=t,this.location=r}set(e){this.ctx.useProgram((0,n.sw)(this.program,"Expected program")),this.ctx.gl.uniform1i(this.location,e)}}var s=r(979820);class a{constructor(e,t){(0,i.A)(this,"viewportSizeUniform",void 0),this.ctx=e,this.program=t}destroy(){this.ctx.gl.deleteProgram(this.program)}renderTo(e){this.viewportSizeUniform&&this.viewportSizeUniform.setFloatArray2([e.value.pixelWidth,e.value.pixelHeight]),e.value.bindFb(),this.renderToCurrent()}renderToCurrent(){this.ctx.useProgram((0,n.sw)(this.program,"Expected program")),this.ctx.renderQuad()}sampler(e){return new o(this.ctx,this.program,this.getUniformLocation(e))}uniform(e,t){return new s.n(this.ctx,this.program,this.getUniformLocation(e),t)}getUniformLocation(e){return null===this.program?null:this.ctx.gl.getUniformLocation(this.program,e)}}},979820:(e,t,r)=>{r.d(t,{A:()=>n,n:()=>o});var i=r(847269);const n={FLOAT:"float",BOOLEAN:"boolean",INTEGER:"integer",INTEGER_ARRAY_1:"integer_array_1",INTEGER_ARRAY_2:"integer_array_2",INTEGER_ARRAY_3:"integer_array_3",INTEGER_ARRAY_4:"integer_array_4",FLOAT_ARRAY_1:"float_array_1",FLOAT_ARRAY_2:"float_array_2",FLOAT_ARRAY_3:"float_array_3",FLOAT_ARRAY_4:"float_array_4",MATRIX_3:"matrix_3"};class o{constructor(e,t,r,i){this.ctx=e,this.program=t,this.location=r,this.type=i}readyProgram(){this.ctx.useProgram((0,i.sw)(this.program,"Expected program"))}checkType(e){if(this.type!==e)throw new Error(`Expected uniform of type ${this.type}, got ${e}.`)}setBoolean(e){this.checkType(n.BOOLEAN),this.readyProgram(),this.ctx.gl.uniform1i(this.location,e?1:0)}setFloat(e){this.checkType(n.FLOAT),this.readyProgram(),this.ctx.gl.uniform1f(this.location,e)}setInteger(e){this.checkType(n.INTEGER),this.readyProgram(),this.ctx.gl.uniform1i(this.location,e)}setMatrix3(e){this.checkType(n.MATRIX_3),this.readyProgram();const t=e.m;this.ctx.gl.uniformMatrix3fv(this.location,!1,[t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]])}setFloatArray1(e){this.checkType(n.FLOAT_ARRAY_1),this.readyProgram(),this.ctx.gl.uniform1fv(this.location,e)}setIntegerArray1(e){this.checkType(n.INTEGER_ARRAY_1),this.readyProgram(),this.ctx.gl.uniform1iv(this.location,e)}setFloatArray2(e){this.checkType(n.FLOAT_ARRAY_2),this.readyProgram(),this.ctx.gl.uniform2fv(this.location,e)}setIntegerArray2(e){this.checkType(n.INTEGER_ARRAY_2),this.readyProgram(),this.ctx.gl.uniform2iv(this.location,e)}setFloatArray3(e){this.checkType(n.FLOAT_ARRAY_3),this.readyProgram(),this.ctx.gl.uniform3fv(this.location,e)}setIntegerArray3(e){this.checkType(n.INTEGER_ARRAY_3),this.readyProgram(),this.ctx.gl.uniform3iv(this.location,e)}setFloatArray4(e){this.checkType(n.FLOAT_ARRAY_4),this.readyProgram(),this.ctx.gl.uniform4fv(this.location,e)}setIntegerArray4(e){this.checkType(n.INTEGER_ARRAY_4),this.readyProgram(),this.ctx.gl.uniform4iv(this.location,e)}}},313311:(e,t,r)=>{r.d(t,{r:()=>o});var i=r(324586),n=(r(379321),r(860784));class o{constructor(){(0,i.A)(this,"timeout",5e3),(0,i.A)(this,"_queue",[]),(0,i.A)(this,"_runningQueue",!1),(0,i.A)(this,"runNext",(()=>{this._runningQueue=!0,this._queue.sort(((e,t)=>e.job.priority-t.job.priority));const e=this._queue.shift();return e?Promise.race([e.controllablePromise.watch(e.job.runJob()),new Promise((e=>setTimeout(e,this.timeout)))]).then((()=>this.runNext())).catch((e=>{console.warn("Job wasn't finished:",e)})):(this._runningQueue=!1,Promise.resolve())}))}get queuedJobs(){return this._queue}get runningJob(){return this._runningQueue}clearAll(){for(const e of this._queue)e.controllablePromise.resolve(void 0);this._queue=[]}dequeue(e){for(let t=0;t<this._queue.length;t++){const r=this._queue[t];if(r.job===e)return r.controllablePromise.resolve(void 0),void this._queue.splice(t,1)}}queue(e){const t=new n.z;return this._queue.push({job:e,controllablePromise:t}),this._runningQueue||this.runNext(),t.promise}}},517934:(e,t,r)=>{r.d(t,{A:()=>i});let i=function(e){return e[e.ASSET_LOAD=0]="ASSET_LOAD",e[e.FILTER_PREVIEWS=1]="FILTER_PREVIEWS",e[e.PLAYBACK=2]="PLAYBACK",e[e.AUDIO_VIDEO_SEPARATION=3]="AUDIO_VIDEO_SEPARATION",e[e.VISIBLE_THUMBNAIL=4]="VISIBLE_THUMBNAIL",e[e.INVISIBLE_THUMBNAIL=5]="INVISIBLE_THUMBNAIL",e[e.PROJECT_THUMBNAIL=6]="PROJECT_THUMBNAIL",e[e.ORDERED_VISIBLE_FILMSTRIP=7]="ORDERED_VISIBLE_FILMSTRIP",e[e.SOUNDWAVE=8]="SOUNDWAVE",e}({})},165604:(e,t,r)=>{r.d(t,{Q:()=>n});var i=r(650882);class n{constructor(e,t,r,i,n,o){this.generator=e,this.time=t,this.target=r,this.width=i,this.height=n,this.priority=o}async runJob(){this.target.width=this.width,this.target.height=this.height,this.target.bind();try{await this.generator.seek(this.time,!0),this.generator.root.render(this.target,this.generator,this.time,!1,"manual")}catch(e){throw(0,i.xM)(e,"Error running thumbnail job")}}}},547285:(e,t,r)=>{r.d(t,{s:()=>d});var i=r(324586),n=r(204411),o=r(626395),s=r(677763),a=r(650882),c=r(326180),l=r(214015);class d{get rotation(){return this.videoStream?.metadata.displayRotationRads??0}get rotWidth(){return this.videoStream?.metadata.displayWidth??0}get rotHeight(){return this.videoStream?.metadata.displayHeight??0}get volume(){return this._volume}set volume(e){this._volume=e,this._gainNode&&(this._gainNode.gain.value=e)}constructor(e,t,r,n,o,s,a){(0,i.A)(this,"start",0),(0,i.A)(this,"duration",0),(0,i.A)(this,"_isDestroyed",!1),(0,i.A)(this,"_isActive",!1),(0,i.A)(this,"_lastUpdateTime",0),(0,i.A)(this,"_isStalled",!1),(0,i.A)(this,"_currentFrame",void 0),(0,i.A)(this,"_currentAudioNode",void 0),(0,i.A)(this,"_isExporting",!1),(0,i.A)(this,"_volume",1),(0,i.A)(this,"_gainNode",void 0),(0,i.A)(this,"videoTransform",void 0),(0,i.A)(this,"videoWaker",{wake:()=>{!this._isDestroyed&&this._isActive&&(this.pollVideo(),this._isStalled||this.graphContext.requestRender(this))}}),(0,i.A)(this,"audioWaker",{wake:()=>{!this._isDestroyed&&this._isActive&&this.pollAudio()}}),this.root=e,this.graphContext=t,this.streamReader=r,this.clock=n,this.videoStream=o,this.audioStream=s,a&&(this._gainNode=a.context.createGain(),this._gainNode.connect(a))}destroy(){this._isDestroyed=!0,this._gainNode?.disconnect()}hasLoaded(){return!this._isStalled}async waitForVideoStream(){await(0,o.L)((e=>this.pollReadVideo(e,this._lastUpdateTime)))}isActive(e){const t=this.clock.mediaSecondsToTicks(this.start),r=this.clock.mediaSecondsToTicks(this.start+this.duration),i=this.clock.mediaSecondsToTicks(e);return i>=t&&i<r}isStalled(){return this._isStalled}load(){return Promise.resolve()}seek(){return Promise.resolve()}pause(){return Promise.resolve()}play(){return Promise.resolve()}update(e){this._lastUpdateTime=e;const t=this.isActive(e);t?(this.pollAudio(),this.pollVideo()):this._isActive&&this._gainNode&&(this._currentAudioNode?.disconnect(this._gainNode),this._currentAudioNode=void 0),this._isActive=t}render(e){this._currentFrame&&e.value.copy((0,c.rd)(this._currentFrame))}reduceItems(){return[]}getExportStream(e,t,r){return this._isExporting=!0,(0,l.jz)(e,t,r,(async(e,t)=>{this._currentFrame=await(0,o.L)((t=>this.pollReadVideo(t,e))),await t()}),(()=>{this._isExporting=!1}))}pollVideo(){if(this._isExporting||!this.videoStream)return;const e=this.pollReadVideo(this.videoWaker,this._lastUpdateTime);if("pending"===e.type)return this._isStalled=!0,void(this._currentFrame=void 0);this._isStalled=!1,this._currentFrame=e.value}pollReadVideo(e,t){if(!this.videoStream)return s.eG;const r=this.videoStream.metadata;let i=r.displayWidth,o=r.displayHeight;if(this.videoTransform){const e=(0,n.v)(this.videoTransform,r.displayWidth/r.displayHeight,this.root.gl.canvas.width/this.root.gl.canvas.height);i=Math.floor(this.root.gl.canvas.width*Math.abs(e.bounds.right-e.bounds.left)),o=Math.floor(this.root.gl.canvas.height*Math.abs(e.bounds.top-e.bounds.bottom))}return this.pollReadAndReport(e,this.videoStream.id,this.clock.mediaSecondsToTicks(t),{preferredWidth:i,preferredHeight:o})}pollAudio(){if(!this._gainNode||!this.audioStream)return;const e=this.pollReadAndReport(this.audioWaker,this.audioStream.id,this.clock.mediaSecondsToTicks(this._lastUpdateTime),{});"pending"!==e.type&&e.value!==this._currentAudioNode&&void 0!==e.value.connect&&(this._currentAudioNode?.disconnect(this._gainNode),this._currentAudioNode=e.value,this._currentAudioNode.connect(this._gainNode))}pollReadAndReport(e,t,r,i){try{return this.streamReader.pollRead(e,t,r,i)}catch(e){if(this._isExporting)throw e;return this.root.ctx.logError(a.g9.fromUnknownError(e,"CompositeStreamNode failed to read stream",{lastUpdateSeconds:this._lastUpdateTime,readTicks:r,startSeconds:this.start,startTicks:this.clock.mediaSecondsToTicks(this.start),endSeconds:this.start+this.duration,endTicks:this.clock.mediaSecondsToTicks(this.start+this.duration)})),s.eG}}}},171957:(e,t,r)=>{r.d(t,{B:()=>d,N:()=>l});var i=r(943134),n=r(324586),o=r(945596),s=r(979820);class a extends o.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D inTex;\nuniform vec2 viewportSize;\nuniform vec2 direction;\nvarying vec2 texCoords;\n\n// from https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/13.glsl\nvec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n    vec4 color = vec4(0.0);\n    vec2 off1 = vec2(1.411764705882353) * direction;\n    vec2 off2 = vec2(3.2941176470588234) * direction;\n    vec2 off3 = vec2(5.176470588235294) * direction;\n    color += texture2D(image, uv) * 0.1964825501511404;\n    color += texture2D(image, uv + (off1 / resolution)) * 0.2969069646728344;\n    color += texture2D(image, uv - (off1 / resolution)) * 0.2969069646728344;\n    color += texture2D(image, uv + (off2 / resolution)) * 0.09447039785044732;\n    color += texture2D(image, uv - (off2 / resolution)) * 0.09447039785044732;\n    color += texture2D(image, uv + (off3 / resolution)) * 0.010381362401148057;\n    color += texture2D(image, uv - (off3 / resolution)) * 0.010381362401148057;\n    return color;\n}\n\nvoid main() {\n    gl_FragColor = blur13(inTex, texCoords, viewportSize, direction);\n}\n"),i=e.createProgram(t,r);e.gl.deleteShader(r),super(e,i),(0,n.A)(this,"direction",void 0),(0,n.A)(this,"renderSampler",void 0),this.viewportSizeUniform=this.uniform("viewportSize",s.A.FLOAT_ARRAY_2),this.renderSampler=this.sampler("inTex"),this.direction=this.uniform("direction",s.A.FLOAT_ARRAY_2)}}const c=10;function l(e,t,r,n,o=c){if(0===o)return;const s=e.ctx.renderers.get(a),l=e.cloneImage(t),d=e.cloneImage(t);let u=r;for(let e=0;e<o;e++)s.direction.setFloatArray2([n,0]),(0,i.C)(s,l,u),s.direction.setFloatArray2([0,n]),e===o-1?(0,i.C)(s,t,l):((0,i.C)(s,d,l),u=d);l.free(),d.free()}function d(e,t,r=c){return{render(i,n){l(e,i,n,t,r)},shouldRender:()=>t>0}}},207510:(e,t,r)=>{r.d(t,{Q:()=>c});var i=r(943134),n=r(324586),o=r(945596),s=r(979820);class a extends o.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D u_image;\nuniform float time;\nuniform float amount;\nuniform float speed;\nvarying vec2 texCoords;\n\nfloat sat(float t) { return clamp(t, 0.0, 1.0); }\nvec2 sat(vec2 t) { return clamp(t, 0.0, 1.0); }\n\n// note: [0;1]\nfloat rand(vec2 n) {\n  return fract(sin(dot(n.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat mytrunc(float x, float numLevels) {\n  return floor(x * numLevels) / numLevels;\n}\nvec2 mytrunc(vec2 x, vec2 numLevels) {\n  return floor(x * numLevels) / numLevels;\n}\n\nvec3 rgb2yuv(vec3 rgb) {\n  vec3 yuv;\n  yuv.x = dot(rgb, vec3(0.299, 0.587, 0.114));\n  yuv.y = dot(rgb, vec3(-0.14713, -0.28886, 0.436));\n  yuv.z = dot(rgb, vec3(0.615, -0.51499, -0.10001));\n  return yuv;\n}\n\nvec3 yuv2rgb(vec3 yuv) {\n  vec3 rgb;\n  rgb.r = yuv.x + yuv.z * 1.13983;\n  rgb.g = yuv.x + dot(vec2(-0.39465, -0.58060), yuv.yz);\n  rgb.b = yuv.x + yuv.y * 2.03211;\n  return rgb;\n}\n\n// Heavily taken from https://www.shadertoy.com/view/MdfGD2 - public domain\nvoid main() {\n  float normalTime = mod(time, 32.0);\n\n  float glitchThreshold = 1.0 - amount;\n  float maxOffset = amount;\n  float yuvThreshold = clamp(amount, 0., 1.);\n\n  const float minChangeFreq = 4.0;\n  float ct = mytrunc(normalTime, minChangeFreq);\n  float tf = speed * rand(mytrunc(texCoords.yy, vec2(16)) + 150.0 * ct);\n\n  float t = 5.0 * mytrunc(normalTime, tf);\n  float vtRand = 0.5 * rand(mytrunc(texCoords.yy + t, vec2(11)));\n  vtRand += 0.5 * rand(mytrunc(texCoords.yy + t, vec2(7)));\n  vtRand = vtRand * 2.0 - 1.0;\n  vtRand = sign(vtRand) *\n           sat((abs(vtRand) - glitchThreshold) / (1.0 - glitchThreshold));\n\n  vec2 uvNm = sat(texCoords + vec2(maxOffset * vtRand, 0));\n\n  vec4 smpl = texture2D(u_image, uvNm, -10.0);\n  vec3 smplYuv = rgb2yuv(smpl.rgb);\n  smplYuv.y /= 1.0 - 3.0 * abs(vtRand) * sat(yuvThreshold - vtRand);\n  smplYuv.z += 0.125 * vtRand * sat(vtRand - yuvThreshold);\n  gl_FragColor = vec4(yuv2rgb(smplYuv), smpl.a);\n}\n"),i=e.createProgram(t,r);e.gl.deleteShader(r),super(e,i),(0,n.A)(this,"amount",void 0),(0,n.A)(this,"renderSampler",void 0),(0,n.A)(this,"speed",void 0),(0,n.A)(this,"time",void 0),this.renderSampler=this.sampler("u_image"),this.time=this.uniform("time",s.A.FLOAT),this.amount=this.uniform("amount",s.A.FLOAT),this.speed=this.uniform("speed",s.A.FLOAT)}}function c(e,t,r){return{render(n,o,s){!function(e,t,r,n,o,s){const c=e.ctx.renderers.get(a);c.time.setFloat(n),c.amount.setFloat(o),c.speed.setFloat(s),(0,i.C)(c,t,r)}(e,n,o,s.time,t,r)},shouldRender:()=>0!==t}}},346392:(e,t,r)=>{r.d(t,{y:()=>l});var i=r(943134),n=r(324586),o=r(945596),s=r(979820);class a extends o.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,'#version 100\nprecision mediump float;\nuniform sampler2D u_image;\nuniform float time;\nvarying vec2 texCoords;\n\n// Based on Morgan McGuire @morgan3d\n// https://www.shadertoy.com/view/4dS3Wd\n\n/*\nCopyright 2014 Morgan McGuire @morgan3d, http://graphicscodex.com\n\nRedistribution and use in source and binary forms, with or without modification, are permitted\nprovided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this list of conditions\nand the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions\n and the following disclaimer in the documentation and/or other materials provided with the\n distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR\nIMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\nFITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\nCONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER\nIN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\nOF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nfloat hash(float p) {\n    p = fract(p * 0.011);\n    p *= p + 7.5;\n    p *= p + p;\n    return fract(p);\n}\n\nfloat hash(vec2 p) {\n    vec3 p3 = fract(vec3(p.xyx) * 0.13);\n    p3 += dot(p3, p3.yzx + 3.333);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\nfloat noise(vec2 x) {\n    vec2 i = floor(x);\n    vec2 f = fract(x);\n\n    // Four corners in 2D of a tile\n    float a = hash(i);\n    float b = hash(i + vec2(1., 0.));\n    float c = hash(i + vec2(0., 1.));\n    float d = hash(i + vec2(1., 1.));\n\n    // Optimized 2D lerp using smoothstep envelope between the values\n    vec2 u = f * f * (3. - 2. * f);\n    return mix(a, b, u.x) + (c - a) * u.y * (1. - u.x) + (d - b) * u.x * u.y;\n}\n\nfloat noise(vec3 x) {\n    const vec3 step = vec3(110., 241., 171.);\n\n    vec3 i = floor(x);\n    vec3 f = fract(x);\n\n    // For performance, compute the base input to a 1D hash from the integer\n    // part of the argument and the incremental change to the 1D based on the\n    // 3D -> 1D wrapping\n    float n = dot(i, step);\n\n    vec3 u = f * f * (3. - 2. * f);\n    return mix(mix(mix( hash(n + dot(step, vec3(0, 0, 0))), hash(n + dot(step, vec3(1, 0, 0))), u.x),\n                   mix( hash(n + dot(step, vec3(0, 1, 0))), hash(n + dot(step, vec3(1, 1, 0))), u.x), u.y),\n               mix(mix( hash(n + dot(step, vec3(0, 0, 1))), hash(n + dot(step, vec3(1, 0, 1))), u.x),\n                   mix( hash(n + dot(step, vec3(0, 1, 1))), hash(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);\n}\n\n#define NUM_OCTAVES 5\n\nfloat fbm(vec2 x) {\n    float v = 0.;\n    float a = 0.5;\n    vec2 shift = vec2(100.);\n\n    // Rotate to reduce axial bias\n    mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.5));\n    for (int i = 0; i < NUM_OCTAVES; ++i) {\n        v += a * noise(x);\n        x = rot * x * 2. + shift;\n        a *= 0.5;\n    }\n    return v;\n}\n\nfloat fbm(vec3 x) {\n    float v = 0.;\n    float a = 0.5;\n    vec3 shift = vec3(100.);\n    for (int i = 0; i < NUM_OCTAVES; ++i) {\n        v += a * noise(x);\n        x = x * 2. + shift;\n        a *= 0.5;\n    }\n    return v;\n}\n\n// pow does not support negative\nfloat workingPow3(float x) { return x * x * x; }\n\nvoid main() {\n    float modifiedTime = workingPow3(time - 0.5) * 8.;\n    float fadeTime = abs(modifiedTime) * 2.;\n\n    float verticalDisp = clamp(\n        fbm(texCoords * 10.) * modifiedTime,\n        -1., 1.\n    ) / 2.;\n    float horizontalDisp = clamp(\n        fbm(texCoords.yx * 5.) * modifiedTime,\n        -1., 1.\n    ) / 3.;\n    float smokeNoise = clamp(\n        fbm(vec3(texCoords * 3., time * 2.)),\n        0., 1.\n    );\n\n    vec2 offsetCoords = texCoords - vec2(horizontalDisp, verticalDisp);\n    vec4 tex = texture2D(u_image, offsetCoords);\n\n    // Output to screen\n    float lightness = clamp(tex.a * (1. - (fadeTime + smokeNoise)), 0., 1.);\n    gl_FragColor = tex * lightness;\n}\n'),i=e.createProgram(t,r);e.gl.deleteShader(r),super(e,i),(0,n.A)(this,"renderSampler",void 0),(0,n.A)(this,"time",void 0),this.renderSampler=this.sampler("u_image"),this.time=this.uniform("time",s.A.FLOAT)}}var c=r(828891);function l(e,t){return{render(t,r,n){!function(e,t,r,n){const o=e.ctx.renderers.get(a);o.time.setFloat((0,c.o)(n)),o.renderSampler.set(r.value.bindSampler(0)),(0,i.C)(o,t,r)}(e,t,r,n)},shouldRender:()=>t}}},214015:(e,t,r)=>{r.d(t,{R6:()=>n,fE:()=>s,jz:()=>o});var i=r(471189);function n(e,t,r,n,o){const s=1/e,a=Math.floor(r/s);return(0,i.tk)((async r=>{for(let i=0;i<=a;i++){const o=t+i/e;await n(o,(()=>r()))}}),o)}function o(e,t,r,n,o){const s=1/e,a=Math.round(r/s);return(0,i.tk)((async r=>{for(let i=0;i<a;i++){const o=t+i/e;await n(o,(()=>r()))}}),o)}function s(e,t){return n(e,0,t,((e,t)=>t()),(()=>{}))}},663393:(e,t,r)=>{r.d(t,{X:()=>Qe});var i=r(324586),n=(r(379321),r(126990)),o=r(471189),s=r(547285),a=r(943134),c=r(945596),l=r(979820);class d extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_image;\nuniform float u_alpha;\n\nvoid main() {\n    gl_FragColor = texture2D(s_image, texCoords) * u_alpha;\n}\n"),n=e.createProgram(t,r);super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"alpha",void 0),this.renderSampler=this.sampler("s_image"),this.alpha=this.uniform("u_alpha",l.A.FLOAT)}}function u(e,t,r,i){const n=e.ctx.renderers.get(d);n.alpha.setFloat(i),(0,a.C)(n,t,r)}function h(e,t){return{render(r,i){u(e,r,i,t)},shouldRender:()=>1!==t}}class p extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nvarying vec2 texCoords;\nuniform sampler2D texture;\nuniform float cutoff;\nuniform int color;\n\nmat3 rgb2yiq =\n        mat3(0.299, 0.596, 0.211, 0.587, -0.274, -0.523, 0.114, -0.322, 0.312);\n\nvoid main() {\n    vec4 base = texture2D(texture, texCoords);\n    float luma = (base.rgb * rgb2yiq).x;\n\n    if (color == 1) {\n        // For white we invert the luma, so we can re-use the black algorithm.\n        luma = 1.0 - luma;\n    }\n\n    float alpha = luma / cutoff;\n    alpha = clamp(alpha, 0., 1.);\n    base.a *= alpha;\n\n    gl_FragColor = base * alpha;\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"cutoff",void 0),(0,i.A)(this,"color",void 0),this.renderSampler=this.sampler("texture"),this.cutoff=this.uniform("cutoff",l.A.FLOAT),this.color=this.uniform("color",l.A.INTEGER)}}function m(e,t,r,i){return{render(t,n,o){!function(e,t,r,i,n){const o=e.ctx.renderers.get(p);o.cutoff.setFloat(i),o.color.setInteger("black"===n?0:1),(0,a.C)(o,t,r)}(e,t,n,r,i)},shouldRender:()=>t}}var f=r(326180);class g extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,'#version 100\nprecision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D baseSampler;\nuniform sampler2D blendSampler;\n\nuniform int blendMode;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n    vec4 baseSample = unmultAlpha(texture2D(baseSampler, texCoords));\n    vec4 blendSample = unmultAlpha(texture2D(blendSampler, texCoords));\n\n    vec3 base = baseSample.rgb;\n    vec3 blend = blendSample.rgb;\n\n    vec3 final = vec3(0.);\n\n    if (blendMode == 1) {\n        // Multiply\n        final = base * blend;\n    } else if (blendMode == 2) {\n        // Screen\n        final = 1.0 - (1.0 - base) * (1.0 - blend);\n    } else if (blendMode == 3) {\n        // Overlay\n        final.x = (base.r > 0.5) ? (1.0-(1.0-2.0*(base.r-0.5))*(1.0-blend.r)) : (2.0*base.r)*blend.r;\n        final.y = (base.g > 0.5) ? (1.0-(1.0-2.0*(base.g-0.5))*(1.0-blend.g)) : (2.0*base.g)*blend.g;\n        final.z = (base.b > 0.5) ? (1.0-(1.0-2.0*(base.b-0.5))*(1.0-blend.b)) : (2.0*base.b)*blend.b;\n    } else if (blendMode == 4) {\n        // Darken\n        final = min(base, blend);\n    } else if (blendMode == 5) {\n        // Lighten\n        final = max(base, blend);\n    } else if (blendMode == 6) {\n        // Color Dodge\n        final = min(base / (1.0 - blend), vec3(1.));\n    } else if (blendMode == 7) {\n        // Colour Burn\n        final = 1.0 - min((1.0 - base) / blend, vec3(1.0));\n    } else if (blendMode == 8) {\n        // Linear Dodge\n        final = min(base + blend, vec3(1.));\n    } else if (blendMode == 9) {\n        // Linear Burn\n        final = max(base + blend - 1.0, vec3(1.));\n    } else {\n        // Fallback case, treat as "Normal"\n        final = blend;\n    }\n\n    gl_FragColor = multAlpha(vec4(final, blendSample.a));\n}\n'),n=e.createProgram(t,r);super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"baseSampler",void 0),(0,i.A)(this,"blendMode",void 0),this.renderSampler=this.sampler("blendSampler"),this.baseSampler=this.sampler("baseSampler"),this.blendMode=this.uniform("blendMode",l.A.INTEGER)}}const A=new Map([["normal",0],["multiply",1],["screen",2],["overlay",3],["darken",4],["lighten",5],["colordodge",6],["colorburn",7],["lineardodge",8],["linearburn",9]]);function v(e,t){return{render(r,i){!function(e,t,r,i){const n=e.ctx.renderers.get(g),o=e.cloneImage(t);o.value.copy((0,f.rd)(t)),n.blendMode.setInteger(A.get(i)??0),n.baseSampler.set(o.value.bindSampler(1)),n.renderSampler.set(r.value.bindSampler(0)),n.renderTo(t),o.free()}(e,r,i,t)},shouldRender:()=>"normal"!==t}}var y=r(735625),b=r(150919),w=r(882196),x=r(472646),S=r(609636),T=r(204411),C=r(463716),_=r(869211),k=r(476636),E=r(962165);class I extends c.A{constructor(e){const t=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D s_in;\nvarying vec2 texCoords;\nuniform vec2 u_offset;\nuniform mat3 u_sampleMatrix;\nuniform bool u_showCropped;\n\nvoid main() {\n    vec4 color = vec4(0.);\n\n    // Generated by generateLanczosLetterbox.js\n    // 15 taps, kernel size of 2\n    color += texture2D(s_in, texCoords + u_offset * -1.75) * -0.004432973768954917;\n    color += texture2D(s_in, texCoords + u_offset * -1.5) * -0.015767000454914557;\n    color += texture2D(s_in, texCoords + u_offset * -1.25) * -0.02097620497352405;\n    color += texture2D(s_in, texCoords + u_offset * -0.75) * 0.058267236037566825;\n    color += texture2D(s_in, texCoords + u_offset * -0.5) * 0.141903004094231;\n    color += texture2D(s_in, texCoords + u_offset * -0.25) * 0.2172157146787908;\n    color += texture2D(s_in, texCoords) * 0.24758044877360952;\n    color += texture2D(s_in, texCoords + u_offset * 0.25) * 0.2172157146787908;\n    color += texture2D(s_in, texCoords + u_offset * 0.5) * 0.141903004094231;\n    color += texture2D(s_in, texCoords + u_offset * 0.75) * 0.058267236037566825;\n    color += texture2D(s_in, texCoords + u_offset * 1.25) * -0.02097620497352405;\n    color += texture2D(s_in, texCoords + u_offset * 1.5) * -0.015767000454914557;\n    color += texture2D(s_in, texCoords + u_offset * 1.75) * -0.004432973768954917;\n\n    vec2 a = (u_sampleMatrix * vec3(texCoords, 1)).xy;\n    float m = step(0., a.x) * step(0., a.y) * step(a.x, 1.) * step(a.y, 1.);\n    float m2 = mix(u_showCropped ? 0.5 : 0., 1., m);\n    gl_FragColor = mix(vec4(0., 0., 0., 0.), color, m2);\n}\n"),r=e.createShader(e.gl.VERTEX_SHADER,E),n=e.createProgram(t,r);e.gl.deleteShader(t),e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"matrix",void 0),(0,i.A)(this,"sampleMatrix",void 0),(0,i.A)(this,"showCropped",void 0),(0,i.A)(this,"offset",void 0),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("s_in"),this.matrix=this.uniform("matrix",l.A.MATRIX_3),this.sampleMatrix=this.uniform("u_sampleMatrix",l.A.MATRIX_3),this.showCropped=this.uniform("u_showCropped",l.A.BOOLEAN),this.offset=this.uniform("u_offset",l.A.FLOAT_ARRAY_2)}}var R=r(256070);class F{constructor(e,t){(0,i.A)(this,"videoTransform",y.DR),(0,i.A)(this,"cropping",!1),this.root=e,this.generator=t}static calculateAutoplaceBounds(e,t,r=.15){return(0,w.e)((0,y.Km)(e),t,r)}static calculateAutoplacePosition(e,t){return(0,x.I)((0,y.Km)(e),t)}static newCalculateCropMatrix(e,t,r){return(0,S.O)((0,y.Km)(e),t,r)}static calculateCropMatrix(e,t,r=1,i=!1){return(0,S.l)((0,y.Km)(e),t,r,i)}newCalculateMatrix(e,t){const r=(0,y.Km)(e),{bounds:i,crop:n}=r,o=i.right-i.left,s=i.top-i.bottom;let a,c,l,d;n?(a=o*(1-n.right-n.left),c=s*(1-n.bottom-n.top),l=i.left+n.left*o,d=i.bottom+n.bottom*s):(a=o,c=s,l=i.left,d=i.bottom);const u=[r.bounds.left>r.bounds.right?-1:1,r.bounds.bottom>r.bounds.top?-1:1],h=(l+a/2-(i.left+o/2))*u[0],p=(d+c/2-(i.bottom+s/2))*u[1];return C.d.identity.multiply(C.d.rotate(this.generator.rotation)).multiply(C.d.scale(o*t,s)).multiply(C.d.translate(-h*t*2,2*-p)).multiply(C.d.rotate(r.rotation)).multiply(C.d.translate(h*t*2,2*p)).multiply(C.d.scale(1/(o*t),1/s)).multiply(C.d.translate(1,1)).multiply(C.d.scale(o,s)).multiply(C.d.translate(2*i.left-1,2*i.bottom-1))}calculateMatrix(e,t,r=!1){if(r)return this.newCalculateMatrix(e,t);const i=(0,y.Km)(e),n=i.bounds,o=n.right-n.left,s=n.top-n.bottom;return C.d.identity.multiply(C.d.rotate(this.generator.rotation)).multiply(C.d.scale(o*t,s)).multiply(C.d.rotate(i.rotation)).multiply(C.d.scale(1/(o*t),1/s)).multiply(C.d.translate(1,1)).multiply(C.d.scale(o,s)).multiply(C.d.translate(2*n.left-1,2*n.bottom-1))}destroy(){this.generator.destroy()}render(e,t){if(0===this.generator.rotWidth||0===this.generator.rotHeight)return;const r=this.generator.rotWidth/this.generator.rotHeight,i=this.root.gl.canvas.width/this.root.gl.canvas.height,n=this.videoTransform.hasFixedBounds,o=(0,T.v)((0,y.Km)(this.videoTransform),r,i,void 0),s=this.calculateMatrix(o,i,n),a=F.calculateCropMatrix(o,s,i,n),c=Math.floor(Math.abs(o.bounds.right-o.bounds.left)*this.root.gl.canvas.width),l=Math.floor(Math.abs(o.bounds.bottom-o.bounds.top)*this.root.gl.canvas.height),d=(0,_.y)(new k.Z(c,l),-this.generator.rotation).floor(),u=d.x<=this.generator.rotWidth/2||d.y<=this.generator.rotHeight/2;if(e.value.clear(),!u||t.value.hasValidMipmap){const r=this.root.ctx.renderers.get(R.l);r.matrix.setMatrix3(s),r.sampleMatrix.setMatrix3(a),r.showCropped.setBoolean(this.cropping),r.renderSampler.set(t.value.bindSampler(0,{minFilter:u?"prefer-mipmap":"linear",magFilter:"linear"})),r.renderTo(e)}else{const r=this.root.ctx.renderers.get(I);(0,f.Ww)(this.root.allocImage(!1,d.x,this.generator.rotHeight))((i=>{r.matrix.setMatrix3(C.d.identity),r.sampleMatrix.setMatrix3(C.d.identity),r.showCropped.setBoolean(!1),r.offset.setFloatArray2([1/d.x,0]),r.renderSampler.set(t.value.bindSampler(0)),r.renderTo(i),r.matrix.setMatrix3(s),r.sampleMatrix.setMatrix3(a),r.showCropped.setBoolean(this.cropping),r.offset.setFloatArray2([0,1/d.y]),r.renderSampler.set(i.value.bindSampler(0)),r.renderTo(e)}))}}}class P extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_image;\nuniform float u_exposure;\nuniform float u_saturation;\nuniform float u_temperature;\nuniform float u_contrast;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nfloat luminance(vec3 color) {\n    return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n}\n\nvec3 applyExposure(vec3 color, float exposure) {\n    return color * exposure;\n}\n\nvec3 applySaturation(vec3 color, float saturation) {\n    return mix(color, vec3(luminance(color)), -saturation);\n}\n\nvec3 applyTemperature(vec3 color, float temperature) {\n    const vec3 warmFilter = vec3(0.93, 0.54, 0.);\n\n    vec3 lo = 2. * color * warmFilter;\n    vec3 hi = 1. - 2. * (1. - color) * (1. - warmFilter);\n\n    vec3 fullyWarm = vec3(\n        color.r < 0.5 ? lo.r : hi.r,\n        color.g < 0.5 ? lo.g : hi.g,\n        color.b < 0.5 ? lo.b : hi.b\n    );\n    return mix(color, fullyWarm, temperature);\n}\n\nvec3 applyContrast(vec3 color, float contrast) {\n    return (color - 0.5) * contrast + 0.5;\n}\n\nvoid main() {\n    vec4 originColor = unmultAlpha(texture2D(s_image, texCoords));\n\n    vec3 processColor = originColor.rgb;\n    processColor = applyExposure(processColor, 1. + u_exposure);\n    processColor = applySaturation(processColor, u_saturation);\n    processColor = applyTemperature(processColor, u_temperature);\n    processColor = applyContrast(processColor, 1. + u_contrast);\n\n    gl_FragColor = multAlpha(vec4(processColor, originColor.a));\n}\n"),n=e.createProgram(t,r);super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"exposure",void 0),(0,i.A)(this,"saturation",void 0),(0,i.A)(this,"temperature",void 0),(0,i.A)(this,"contrast",void 0),this.renderSampler=this.sampler("s_image"),this.exposure=this.uniform("u_exposure",l.A.FLOAT),this.saturation=this.uniform("u_saturation",l.A.FLOAT),this.temperature=this.uniform("u_temperature",l.A.FLOAT),this.contrast=this.uniform("u_contrast",l.A.FLOAT)}}const L={exposure:0,saturation:0,temperature:0,contrast:0};function N(e,t,r,i){const n=e.ctx.renderers.get(P);n.exposure.setFloat(i.exposure),n.saturation.setFloat(i.saturation),n.temperature.setFloat(i.temperature),n.contrast.setFloat(i.contrast),(0,a.C)(n,t,r)}var M=r(171957);function B(e,t,r,i){return{disableLetterbox:!0,render(t,n,o){!function(e,t,r,i,n,o){const s=new F(e,n);s.videoTransform=o;const a=new F(e,n);a.videoTransform={...y.DR,strategy:"fill"},t.value.clear();const c=b.T.wrap(t);(0,f.Ww)(e.cloneImage(t))((t=>{a.render(t,r),(0,M.N)(e,t,t,5,15),N(e,c,t,{...L,exposure:-.4})})),s.render(c,r)}(e,t,n,0,r,i)},shouldRender:()=>t&&"fill"!==i.strategy}}function D(e,t,r){const i=e.createShader(e.gl.FRAGMENT_SHADER,r),n=e.createProgram(t,i);return e.gl.deleteShader(i),n}class O extends c.A{constructor(e,t){super(e,D(e,t,"#version 100\n\nprecision mediump float;\nuniform sampler2D u_image;\nuniform float time;\nvarying vec2 texCoords;\n\nfloat timeFn() {\n  float x = time / 1.8 - 0.2;\n\n  float a = .6;\n  float y = 0.;\n  y += 1.2 * smoothstep(0., a, x) / (1. / a);\n  y += 3. * pow(max(x, 0.8) - 0.8, 2.);\n  y += x / 10.;\n\n  return y;\n}\n\nfloat mask(vec2 st) {\n    return clamp(-abs(350. * (st.x - 1.38 * timeFn() + .20 + .18 * st.y)) + 50., 0., 1.);\n}\n\nfloat shadowMask(vec2 st) {\n    return clamp(-abs(10. * (st.x - 1.38 * timeFn() + .14 + .18 * st.y)) + 1.9, 0., 1.);\n}\n\nvec4 shadow(vec2 st) {\n  return vec4(vec3(0.), smoothstep(0., 1., shadowMask(st) * 0.5));\n}\n\nvoid main() {\n    vec4 color = texture2D(u_image, texCoords * 0.7 + 0.15);\n    vec2 uv = texCoords;\n\n    color = vec4(color.rgb, mask(uv) * color.a);\n\n    color = mix(shadow(uv), vec4(color.rgb, 1.), color.a);\n\n    gl_FragColor = color;\n}\n\n")),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"time",void 0),this.renderSampler=this.sampler("u_image"),this.time=this.uniform("time",l.A.FLOAT)}}var j=r(828891);function U(e,t){return{render(t,r,i){!function(e,t,r,i){const n=e.ctx.renderers.get(O);n.time.setFloat((0,j.A)(i)),t.value.clear();const o=b.T.wrap(t);(0,M.N)(e,o,r,2),(0,a.C)(n,o,r)}(e,t,r,i)},shouldRender:()=>0!==Math.round(t)}}class z extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D u_image;\nuniform float time;\nuniform float amount;\nvarying vec2 texCoords;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n  float offset = 0.005 + abs(0.01 * sin(time) * amount);\n\n  vec2 rOffset = vec2(0. + offset, 0.);\n  vec2 bOffset = vec2(0. - offset, 0.);\n\n  vec4 base = unmultAlpha(texture2D(u_image, texCoords));\n  vec4 r = unmultAlpha(texture2D(u_image, texCoords + rOffset));\n  vec4 b = unmultAlpha(texture2D(u_image, texCoords + bOffset));\n\n  gl_FragColor = multAlpha(vec4(r.r, base.g, b.b, max(r.a, max(base.a, b.a))));\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"amount",void 0),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"time",void 0),this.renderSampler=this.sampler("u_image"),this.time=this.uniform("time",l.A.FLOAT),this.amount=this.uniform("amount",l.A.FLOAT)}}function W(e,t){return{render(r,i,n){!function(e,t,r,i,n){const o=e.ctx.renderers.get(z);o.time.setFloat(i),o.amount.setFloat(n),(0,a.C)(o,t,r)}(e,r,i,n.time,t)},shouldRender:()=>0!==t}}class V extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nvarying vec2 texCoords;\nuniform sampler2D image;\nuniform float newHue;\n\nvec3 hueShift( vec3 color, float hueAdjust ){\n    if (color.r == 1. && color.g == 1. && color.b == 1.) {\n        return color;\n    }\n    const vec3 kRGBToYPrime = vec3(0.299, 0.587, 0.114);\n    const vec3 kRGBToI = vec3(0.596, -0.275, -0.321);\n    const vec3 kRGBToQ = vec3(0.212, -0.523, 0.311);\n\n    const vec3 kYIQToR = vec3(1.0, 0.956, 0.621);\n    const vec3 kYIQToG = vec3(1.0, -0.272, -0.647);\n    const vec3 kYIQToB = vec3(1.0, -1.107, 1.704);\n\n    float YPrime = dot(color, kRGBToYPrime);\n    float I = dot(color, kRGBToI);\n    float Q = dot(color, kRGBToQ);\n    float hue = atan(Q, I);\n    float chroma = sqrt(I * I + Q * Q);\n\n    hue += hueAdjust;\n\n    Q = chroma * sin(hue);\n    I = chroma * cos(hue);\n\n    vec3 yIQ = vec3(YPrime, I, Q);\n\n    return vec3(dot(yIQ, kYIQToR), dot(yIQ, kYIQToG), dot(yIQ, kYIQToB));\n}\n\nvoid main() {\n    vec4 tex = texture2D(image, texCoords);\n    vec3 rgb = tex.xyz;\n    gl_FragColor = vec4(hueShift(rgb, newHue), tex.a);\n}"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"hue",void 0),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("image"),this.hue=this.uniform("newHue",l.A.FLOAT)}}function H(e,t){return{render(t,r,i){!function(e,t,r,i){const n=e.ctx.renderers.get(V);n.hue.setFloat(i*Math.PI),(0,a.C)(n,t,r)}(e,t,r,i.time)},shouldRender:()=>t}}var G=r(127168);function q(e,t,r,i,n,o){return{render(t,s,c){!function(e,t,r,i,n,o=0,s=1,c=0){const l=i.time-i.start,d=Math.min(s-1,Math.floor(l/c)),u=l-d*c,h=Math.min(u/.7,1),p=(0,G.vF)(h,8),m=.5*(Math.pow(d,2)+d),f=d+1,g=(m+f*p)*o,A=(e=>e?2*e[0]+6*e[1]:4)(n),[v,y]=[[1,-1],[0,-1],[-1,-1],[1,0],[0,0],[-1,0],[1,1],[0,1],[-1,1]][A],b=(m+f)*o,w=e=>0===e?0:.5*(1+e),x=w(m*o),S=x+(w(b)-x)*p,T=e.ctx.renderers.get(R.l);T.showCropped.setBoolean(!1),T.matrix.setMatrix3(C.d.identity.multiply(C.d.scale(g+1,g+1)).multiply(C.d.translate(v*S,y*S))),T.sampleMatrix.setMatrix3(C.d.identity),t.value.clear(),(0,a.C)(T,t,r)}(e,t,s,c,r,i,n,o)},shouldRender:()=>t}}var Q=r(532203);class K extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_base;\nuniform sampler2D s_blend;\n\nuniform float u_strength;\n\nvec4 unmultAlpha(vec4 color) {\n    if(color.a == 0.)\n        return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n    float clampAmount = 1.0 - u_strength;\n    float opacity = u_strength;\n    vec4 baseSample = unmultAlpha(texture2D(s_base, texCoords));\n    vec4 blendSample = unmultAlpha(texture2D(s_blend, texCoords));\n\n    vec3 base = baseSample.rgb;\n    vec3 blend = max(blendSample.rgb - clampAmount, vec3(0.)) / clampAmount;\n\n    // add blend\n    vec3 final = max(base, blend * opacity);\n\n    gl_FragColor = multAlpha(vec4(final, baseSample.a));\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"baseSampler",void 0),(0,i.A)(this,"strength",void 0),this.baseSampler=this.sampler("s_base"),this.renderSampler=this.sampler("s_blend"),this.strength=this.uniform("u_strength",l.A.FLOAT)}}function X(e,t){const{strength:r}=t||(0,Q.R)();return{render(t,i){!function(e,t,r,i){const n=e.cloneImage(r),o=10*i;(0,M.N)(e,n,r,o);const s=e.ctx.renderers.get(K);s.baseSampler.set(r.value.bindSampler(0)),s.renderSampler.set(n.value.bindSampler(1)),s.strength.setFloat(i),s.renderTo(t),n.free()}(e,t,i,r)},shouldRender:()=>!!t}}class Y extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nvarying vec2 texCoords;\nuniform sampler2D image;\nuniform vec3 color;\n\nfloat blendOverlay(float base, float blend) {\n    return base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend));\n}\n\nvec3 blendOverlay(vec3 base, vec3 blend) {\n    return vec3(blendOverlay(base.r, blend.r), blendOverlay(base.g, blend.g), blendOverlay(base.b, blend.b));\n}\n\nvec3 blendHardLight(vec3 base, vec3 blend) {\n    return blendOverlay(blend,base);\n}\n\nvec3 blendHardLight(vec3 base, vec3 blend, float opacity) {\n    return (blendHardLight(base, blend) * opacity + base * (1.0 - opacity));\n}\n\nvoid main() {\n    vec4 tex = texture2D(image, texCoords);\n    vec3 rgb = tex.xyz;\n    gl_FragColor = vec4(blendHardLight(rgb, color, 0.6), tex.a);\n}"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"color",void 0),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("image"),this.color=this.uniform("color",l.A.FLOAT_ARRAY_3)}}const Z=[[.47,0,.141],[.47,.141,0],[.489,.47,0],[.236,0,.47],[0,.47,.13],[0,.47,.44],[.0078,0,.47]];function J(e,t){return{render(t,r,i){!function(e,t,r,i){const n=e.ctx.renderers.get(Y),o=Math.floor(i/.4)%Z.length;n.color.setFloatArray3(Z[o]),(0,a.C)(n,t,r)}(e,t,r,i.time)},shouldRender:()=>t}}class $ extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_image;\nuniform float u_strength;\nuniform float u_seed;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n    vec4 color = unmultAlpha(texture2D(s_image, texCoords));\n\n    // from https://www.shadertoy.com/view/4dBcDK (licensed under CC0)\n    float grainStrength = 50. * u_strength;\n    float x = (texCoords.x + 4.) * (texCoords.y + 4.) * (u_seed + 10.) * 10.;\n    float grain = clamp(mod((mod(x, 13.0) + 1.0) * (mod(x, 123.0) + 1.0), 0.01) - 0.005, 0.0, 1.0) * grainStrength;\n    color.rgb *= 1. - grain;\n\n    gl_FragColor = multAlpha(color);\n}\n"),n=e.createProgram(t,r);super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"strength",void 0),(0,i.A)(this,"seed",void 0),this.renderSampler=this.sampler("s_image"),this.strength=this.uniform("u_strength",l.A.FLOAT),this.seed=this.uniform("u_seed",l.A.FLOAT)}}function ee(e,t){return{render(r,i,n){!function(e,t,r,i,n){const o=e.ctx.renderers.get($);o.strength.setFloat(i),o.seed.setFloat(n),(0,a.C)(o,t,r)}(e,r,i,t,n.time)},shouldRender:()=>0!==t}}var te=r(294258);function re(e,t){const{speed:r,fade:i}=t??(0,te.E)();return{render(t,n,o){!function(e,t,r,i,n,o){let s=i.time-i.start;s*=n;const a=2*Math.PI*s;let c=(Math.cos(a)+1)/2;o||(c=c>.5?1:0),u(e,t,r,c)}(e,t,n,o,r,i)},shouldRender:()=>!!t}}var ie=r(207510),ne=r(177191);class oe extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_base;\nuniform sampler2D s_blend;\n\nuniform float u_strength;\n\nvec4 unmultAlpha(vec4 color) {\n    if(color.a == 0.)\n        return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n    float clampAmount = 1.0 - u_strength;\n    float opacity = u_strength;\n    vec4 baseSample = unmultAlpha(texture2D(s_base, texCoords));\n    vec4 blendSample = unmultAlpha(texture2D(s_blend, texCoords));\n\n    vec3 base = baseSample.rgb;\n    vec3 blend = max(blendSample.rgb - clampAmount, vec3(0.)) / clampAmount;\n\n    // add blend\n    vec3 final = base + blend * opacity;\n\n    gl_FragColor = multAlpha(vec4(final, baseSample.a));\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"baseSampler",void 0),(0,i.A)(this,"strength",void 0),this.baseSampler=this.sampler("s_base"),this.renderSampler=this.sampler("s_blend"),this.strength=this.uniform("u_strength",l.A.FLOAT)}}function se(e,t){const{strength:r}=t||(0,ne.d)();return{render(t,i){!function(e,t,r,i){const n=e.cloneImage(r),o=10*i;(0,M.N)(e,n,r,o);const s=e.ctx.renderers.get(oe);s.baseSampler.set(r.value.bindSampler(0)),s.renderSampler.set(n.value.bindSampler(1)),s.strength.setFloat(i),s.renderTo(t),n.free()}(e,t,i,r)},shouldRender:()=>!!t}}class ae extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nvarying vec2 texCoords;\nuniform sampler2D texture;\nuniform float cutoff;\nuniform int colorIndex;\n\nvoid main() {\n    vec4 color = texture2D(texture, texCoords);\n    float alpha;\n\n    if (colorIndex == 0) {\n        alpha = 1.0 - (color.r - max(color.g, color.b)) / cutoff;\n    } else if (colorIndex == 1) {\n        alpha = 1.0 - (color.g - max(color.r, color.b)) / cutoff;\n    } else if (colorIndex == 2) {\n        alpha = 1.0 - (color.b - max(color.r, color.g)) / cutoff;\n    }\n    alpha = clamp(alpha, 0., 1.);\n    if (colorIndex == 0) {\n        color.r *= alpha;\n    } else if (colorIndex == 1) {\n        color.g *= alpha;\n    } else if (colorIndex == 2) {\n        color.b *= alpha;\n    }\n    gl_FragColor = color * alpha;\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"cutoff",void 0),(0,i.A)(this,"colorIndex",void 0),this.renderSampler=this.sampler("texture"),this.cutoff=this.uniform("cutoff",l.A.FLOAT),this.colorIndex=this.uniform("colorIndex",l.A.INTEGER)}}const ce=new Map([["r",0],["g",1],["b",2]]);function le(e,t,r,i){return{render(t,n,o){!function(e,t,r,i,n){const o=e.ctx.renderers.get(ae);o.cutoff.setFloat(i),o.colorIndex.setInteger(ce.get(n)??1),(0,a.C)(o,t,r)}(e,t,n,r,i)},shouldRender:()=>t}}class de extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D s_base;\nuniform sampler2D s_unblurred;\nuniform vec2 u_viewport_size;\nuniform vec2 u_direction;\nvarying vec2 texCoords;\n\nconst int SIZE = 7;\nconst float BSIGMA = 0.1;\n\nvec4 unmult_alpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 mult_alpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nfloat normpdf3(vec4 v) {\n    return 0.39894 * exp(-0.5 * dot(v,v) / (BSIGMA * BSIGMA)) / BSIGMA;\n}\n\nvec4 bilateral13(sampler2D image, vec2 uv, vec2 resolution, vec2 u_direction) {\n    vec4 base_color = unmult_alpha(texture2D(s_unblurred, uv));\n\n    float kernel[SIZE];\n    kernel[0] = kernel[6] = 0.010381362401148057;\n    kernel[1] = kernel[5] = 0.09447039785044732;\n    kernel[2] = kernel[4] = 0.2969069646728344;\n    kernel[3] = 0.1964825501511404;\n\n    vec2 offsets[SIZE];\n    offsets[0] = offsets[6] = vec2(5.176470588235294);\n    offsets[1] = offsets[5] = vec2(3.2941176470588234);\n    offsets[2] = offsets[4] = vec2(1.411764705882353);\n    offsets[3] = vec2(0.);\n\n    vec4 color = vec4(0.);\n    float weight = 0.;\n\n    for (int i = 0; i < SIZE; i++) {\n        vec2 offset = u_direction * offsets[i] / resolution;\n        if (i < SIZE/2) offset *= -1.;\n\n        vec4 sample_color = unmult_alpha(texture2D(image, uv + offset));\n        float sample_weight = normpdf3(sample_color - base_color) * kernel[i];\n\n        color += sample_color * sample_weight;\n        weight += sample_weight;\n    }\n\n    return color / weight;\n}\n\nvoid main() {\n    gl_FragColor = mult_alpha(bilateral13(s_base, texCoords, u_viewport_size, u_direction));\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"direction",void 0),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"originalSampler",void 0),this.renderSampler=this.sampler("s_base"),this.originalSampler=this.sampler("s_unblurred"),this.viewportSizeUniform=this.uniform("u_viewport_size",l.A.FLOAT_ARRAY_2),this.direction=this.uniform("u_direction",l.A.FLOAT_ARRAY_2)}}class ue extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D s_blurred;\nuniform sampler2D s_unblurred;\nuniform vec2 u_viewport_size;\nuniform float u_halftone_intensity;\nvarying vec2 texCoords;\n\nvec4 unmult_alpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 mult_alpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\n/// SOBEL EDGE DETECTION\nconst mat3 SOBEL_X = mat3(\n    1., 2., 1.,\n    0., 0., 0.,\n    -1., -2., -1.\n);\nconst mat3 SOBEL_Y = mat3(\n    1.0, 0., -1.,\n    2., 0., -2.,\n    1., 0., -1.\n);\n\nfloat sobel_gradient_magnitude(mat3 I) {\n    float gx = dot(SOBEL_X[0], I[0]) + dot(SOBEL_X[1], I[1]) + dot(SOBEL_X[2], I[2]);\n    float gy = dot(SOBEL_Y[0], I[0]) + dot(SOBEL_Y[1], I[1]) + dot(SOBEL_Y[2], I[2]);\n\n    return sqrt(pow(gx, 2.) + pow(gy, 2.));\n}\n\nfloat sobel_detect_edges(sampler2D image, vec2 uv) {\n    mat3 R, G, B;\n\n    for (int i = 0; i < 3; i++) {\n        for (int j = 0; j < 3; j++) {\n            vec2 offset = vec2(float(i - 1), float(j - 1)) / u_viewport_size;\n            vec3 color = unmult_alpha(texture2D(image, uv + offset)).rgb;\n\n            R[i][j] = color.r;\n            G[i][j] = color.g;\n            B[i][j] = color.b;\n        }\n    }\n\n    return (\n        sobel_gradient_magnitude(R)\n        + sobel_gradient_magnitude(G)\n        + sobel_gradient_magnitude(B)\n    ) / 3.;\n}\n\n/// HALFTONE PATTERN\n\n// Dot grid sizes relative to viewport height\nconst float HALFTONE_DOT_SIZE = 0.005;\nconst float HALFTONE_GRID_SIZE = 0.0067;\n\nconst float HALFTONE_EDGE = 0.888;\n\nconst mat2 HALFTONE_ROTATION = mat2(\n    0.707, -0.707,\n    0.707, 0.707\n);\n\nvec4 rgb_to_cmyki(vec3 c) {\n    float k = max(max(c.r, c.g), c.b);\n    return min(vec4(c / k, k), 1.);\n}\n\nvec3 cmyki_to_rgb(vec4 c) {\n    return c.rgb * c.a;\n}\n\nvec2 grid(vec2 px) {\n    return px - mod(px, HALFTONE_GRID_SIZE);\n}\n\nvec4 halftone_edge(vec4 gradient) {\n    float dot_size_pixels = HALFTONE_DOT_SIZE * u_viewport_size.y;\n    float pixel_gradient = 1. / dot_size_pixels;\n\n    return smoothstep(HALFTONE_EDGE - pixel_gradient, HALFTONE_EDGE + pixel_gradient, gradient);\n}\n\nvec3 halftone(sampler2D image, vec2 uv) {\n    float aspect = u_viewport_size.x / u_viewport_size.y;\n\n    vec2 center_coords = uv - 0.5;\n    center_coords.x *= aspect;\n\n    vec2 grid_coords = (grid(HALFTONE_ROTATION * center_coords) + 0.5 * HALFTONE_GRID_SIZE) * HALFTONE_ROTATION;\n\n    vec2 grid_uv = grid_coords;\n    grid_uv.x /= aspect;\n    grid_uv += 0.5;\n\n    float gradient = min(length(center_coords - grid_coords) / HALFTONE_DOT_SIZE, 1.);\n\n    vec4 color_rgb = unmult_alpha(texture2D(image, grid_uv));\n    color_rgb = pow(color_rgb, vec4(2.2));\n    vec4 color_cmyki = rgb_to_cmyki(color_rgb.rgb);\n    vec3 applied_rgb = cmyki_to_rgb(halftone_edge(color_cmyki + gradient));\n    applied_rgb = pow(applied_rgb, vec3(1. / 2.2));\n\n    return applied_rgb;\n}\n\nvoid main() {\n    vec4 fill_color = unmult_alpha(texture2D(s_blurred, texCoords));\n    vec3 halftone_color = halftone(s_unblurred, texCoords);\n\n    float edges = sobel_detect_edges(s_unblurred, texCoords);\n    if (edges < 0.05) {\n        edges = 0.;\n    }\n\n    gl_FragColor = mult_alpha(\n        vec4(\n            max(mix(fill_color.rgb, halftone_color, u_halftone_intensity) - edges, vec3(0.)),\n            fill_color.a\n        )\n    );\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"blurredSampler",void 0),(0,i.A)(this,"baseSampler",void 0),(0,i.A)(this,"halftoneIntensity",void 0),this.blurredSampler=this.sampler("s_blurred"),this.baseSampler=this.sampler("s_unblurred"),this.viewportSizeUniform=this.uniform("u_viewport_size",l.A.FLOAT_ARRAY_2),this.halftoneIntensity=this.uniform("u_halftone_intensity",l.A.FLOAT)}}function he(e,t,r){return{render(t,i){!function(e,t,r,i){const n=e.ctx.renderers.get(de),o=e.ctx.renderers.get(ue);(0,f.Ww)(e.cloneImage(r),e.cloneImage(r))(((e,s)=>{n.originalSampler.set(r.value.bindSampler(1)),n.direction.setFloatArray2([1,0]),(0,a.C)(n,e,r),n.direction.setFloatArray2([0,1]),(0,a.C)(n,s,e),n.direction.setFloatArray2([1,0]),(0,a.C)(n,e,s),n.direction.setFloatArray2([0,1]),(0,a.C)(n,s,e),o.baseSampler.set(r.value.bindSampler(0)),o.blurredSampler.set(s.value.bindSampler(1)),o.halftoneIntensity.setFloat(i),o.renderTo(t)}))}(e,t,i,r)},shouldRender:()=>t}}var pe=r(320043);class me extends c.A{constructor(e){const t=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\n\n#define PI 3.14159\n\nuniform sampler2D s_image;\nuniform float u_time;\nuniform float u_speed;\nuniform float u_segments;\nuniform vec4 u_bounds;// top, left, bottom, right\nuniform bool u_enable_color_shift;\n\nvarying vec2 texCoords;\n\nvec3 hueShift(vec3 color, float hueAdjust) {\n    if(color.r == 1. && color.g == 1. && color.b == 1.) {\n        return color;\n    }\n    const vec3 kRGBToYPrime = vec3(.299, .587, .114);\n    const vec3 kRGBToI = vec3(.596, -.275, -.321);\n    const vec3 kRGBToQ = vec3(.212, -.523, .311);\n\n    const vec3 kYIQToR = vec3(1., .956, .621);\n    const vec3 kYIQToG = vec3(1., -.272, -.647);\n    const vec3 kYIQToB = vec3(1., -1.107, 1.704);\n\n    float YPrime = dot(color, kRGBToYPrime);\n    float I = dot(color, kRGBToI);\n    float Q = dot(color, kRGBToQ);\n    float hue = atan(Q, I);\n    float chroma = sqrt(I * I + Q * Q);\n\n    hue += hueAdjust;\n\n    Q = chroma * sin(hue);\n    I = chroma * cos(hue);\n\n    vec3 yIQ = vec3(YPrime, I, Q);\n\n    return vec3(dot(yIQ, kYIQToR), dot(yIQ, kYIQToG), dot(yIQ, kYIQToB));\n}\n\nvoid main(void) {\n    float width = u_bounds.w - u_bounds.y;\n    float height = u_bounds.x - u_bounds.z;\n    vec2 scaledCoord = vec2((texCoords.x - u_bounds.y) / width, (texCoords.y - u_bounds.z) / height);\n    vec2 uv = scaledCoord * 2. - 1.;\n\n    // get angle and radius\n    float radius = length(uv);\n    float angle = atan(uv.y, uv.x) / PI * u_segments;\n\n    // repeat segment\n    if(mod(angle, 2.) >= 1.) {\n        angle = fract(angle);\n    } else {\n        angle = 1. - fract(angle);\n    }\n    angle += u_time * u_speed * 5.;\n\n    // unsquash segment\n    angle /= u_segments;\n    angle *= PI * 2.;\n\n    // control speed\n    angle *= u_speed * 2.;\n\n    // set coord for sampler\n    vec2 point = vec2(radius * cos(angle), radius * sin(angle));\n    point = fract(point);\n\n    point = vec2(point.x * width + u_bounds.y, point.y * height + u_bounds.z);\n    vec4 tex = texture2D(s_image, point);\n\n    if(u_enable_color_shift) {\n        gl_FragColor = vec4(hueShift(tex.xyz, u_time * u_speed * PI * 2.), tex.a);\n    } else {\n        gl_FragColor = tex;\n    }\n}\n"),r=e.createShader(e.gl.VERTEX_SHADER,"#version 100\nprecision mediump float;\n\nattribute vec2 vertexPos;\nattribute vec2 vertexUV;\nvarying vec2 texCoords;\nuniform mat3 u_matrix;\nuniform mat3 u_uv_matrix;\n\nvoid main() {\n    texCoords = (u_uv_matrix * vec3(vertexUV, 1.0)).xy;\n\n    vec3 transformedPosition = u_matrix * vec3(vertexPos, 1.0);\n    gl_Position = vec4(transformedPosition, 1.0);\n}\n"),n=e.createProgram(r,t);e.gl.deleteShader(t),e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"time",void 0),(0,i.A)(this,"speed",void 0),(0,i.A)(this,"segments",void 0),(0,i.A)(this,"enableColorShift",void 0),(0,i.A)(this,"matrix",void 0),(0,i.A)(this,"uvMatrix",void 0),(0,i.A)(this,"bounds",void 0),this.renderSampler=this.sampler("s_image"),this.time=this.uniform("u_time",l.A.FLOAT),this.speed=this.uniform("u_speed",l.A.FLOAT),this.segments=this.uniform("u_segments",l.A.FLOAT),this.matrix=this.uniform("u_matrix",l.A.MATRIX_3),this.uvMatrix=this.uniform("u_uv_matrix",l.A.MATRIX_3),this.bounds=this.uniform("u_bounds",l.A.FLOAT_ARRAY_4),this.enableColorShift=this.uniform("u_enable_color_shift",l.A.BOOLEAN)}}function fe(e,t,r){const{speed:i,segments:n,enableColorShift:o}={...(0,pe.x)(),...r};return{render(r,s,c){!function(e,t,r,i,n,o,s,c){const l=e.ctx.renderers.get(me);l.speed.setFloat(n),l.segments.setFloat(o),l.enableColorShift.setBoolean(s),l.time.setFloat(c),l.matrix.setMatrix3(C.d.translate(1,1).multiply(C.d.scale(i.right-i.left,i.top-i.bottom)).multiply(C.d.translate(2*i.left-1,2*i.bottom-1))),l.uvMatrix.setMatrix3(C.d.scale(i.right-i.left,i.top-i.bottom).multiply(C.d.translate(i.left,i.bottom))),l.bounds.setFloatArray4([i.top,i.left,i.bottom,i.right]),(0,a.C)(l,t,r)}(e,r,s,t,i,n,o,c.time)},shouldRender:()=>!!r}}var ge=r(439921);class Ae extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_image;\nuniform sampler2D s_lut;\nuniform float u_intensity;\nuniform bool u_flip_lut;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvec3 lookup(vec2 colorRg, float blueInt) {\n    vec2 quad;\n    quad.y = floor(blueInt / 8.);\n    quad.x = blueInt - quad.y * 8.;\n\n    vec2 texPos;\n    texPos.x = (quad.x * 0.125) + 0.5 / 512. + ((0.125 - 1. / 512.) * colorRg.r);\n    texPos.y = (quad.y * 0.125) + 0.5 / 512. + ((0.125 - 1. / 512.) * colorRg.g);\n\n    // lut is flipped in the new engine\n    if (u_flip_lut) texPos.y = 1. - texPos.y;\n\n    return texture2D(s_lut, texPos).rgb;\n}\n\nvoid main() {\n    vec4 originColor = unmultAlpha(texture2D(s_image, texCoords));\n\n    float blueColor = originColor.b * 63.;\n    vec3 newLo = lookup(originColor.rg, floor(blueColor));\n    vec3 newHi = lookup(originColor.rg, ceil(blueColor));\n    vec3 newColor = mix(newLo, newHi, fract(blueColor));\n\n    gl_FragColor = multAlpha(vec4(mix(originColor.rgb, newColor, u_intensity), originColor.a));\n}\n"),n=e.createProgram(t,r);super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"lutSampler",void 0),(0,i.A)(this,"intensity",void 0),(0,i.A)(this,"flipLut",void 0),this.renderSampler=this.sampler("s_image"),this.lutSampler=this.sampler("s_lut"),this.intensity=this.uniform("u_intensity",l.A.FLOAT),this.flipLut=this.uniform("u_flip_lut",l.A.BOOLEAN)}}var ve=r(815731),ye=r(477793),be=r(162036),we=r(342455);const xe=new WeakMap;const Se={value:{img:void 0,ready:Promise.resolve()},free(){}};class Te{get currentLut(){return this.currentLut$.value}set currentLut(e){this.currentLut$.next(e)}set srcUrl(e){e!==this.currentSrc&&(this.currentSrc=e,void 0===e?(this.currentLut.free(),this.currentLut=Se):this.currentLut=function(e,t,r,i){let n=!1;const o=()=>{n||e.free(),n=!0},s=function(e,t,r){const i=function(e){const t=xe.get(e);if(void 0!==t)return t;const r=we.w.create().value;return xe.set(e,r),r}(e);return i.get(r,(()=>t.loadLutImage(e,r)))}(t,r,i),a={img:e.value.img,ready:s.value.catch((e=>{console.error(`Failed to load LUT at ${i}:`,e)})).then((e=>{o(),a.img=e}))};return{value:a,free(){o(),s.free()}}}(this.currentLut,this.root,this.graphContext.lutLoader,e))}constructor(e,t){(0,i.A)(this,"currentSrc",void 0),(0,i.A)(this,"currentLut$",new ve.t(Se)),(0,i.A)(this,"intensity",1),this.root=e,this.graphContext=t}render(e,t){const r=this.currentLut.value.img;if(void 0===r)return void(0,ge.u)(this.root,t,e);const i=this.root.ctx.renderers.get(Ae);i.intensity.setFloat(this.intensity),i.flipLut.setBoolean(!1),i.lutSampler.set(r.bindSampler(1)),(0,a.C)(i,e,t)}shouldRender(){return void 0!==this.currentLut.value.img}destroy(){this.currentLut.free()}getLoadedLut$(){return this.currentLut$.pipe((0,ye.n)((e=>e.value.ready.then((()=>e.value.img)))))}waitForReady(){return this.getLoadedLut$().pipe((0,be.$)()).toPromise().then((()=>{}))}}var Ce=r(903523),_e=r(932808);function ke(e,t){const{direction:r,distance:i,speed:n,ease:o,mode:s}=t??(0,Ce.j)();return{render(t,c,l){!function(e,t,r,i,n,o,s,c,l){let d=i.time-i.start;if(d*=s,"simple"===l)d=Math.min(d,.5);else if("loop"===l)d%=.5;else if("boomerang"===l&&!c){const e=d%1;d=e<.5?e:1-e}c?d=-1*Math.cos(2*Math.PI*d)+1:d*=4;const u=o*d,h=Math.cos((0,_e.tR)(n)),p=Math.sin((0,_e.tR)(n)),m=e.ctx.renderers.get(R.l);m.showCropped.setBoolean(!1),m.matrix.setMatrix3(C.d.translate(h*u,p*u)),m.sampleMatrix.setMatrix3(C.d.identity),t.value.clear(),(0,a.C)(m,t,r)}(e,t,c,l,r,i,n,o,s)},shouldRender:()=>!!t}}class Ee extends c.A{constructor(e,t){super(e,D(e,t,"#version 100\n\n#define PI 3.14159\n#define MAX_ITS 7\n#define patternCount 5.\n\nprecision mediump float;\nuniform sampler2D u_image;\nvarying vec2 texCoords;\n\nuniform float time;\nuniform float radialAmount;\nuniform float verticalAmount;\n\nvec4 smallImage(float count, vec2 center, vec2 uv) {\n  vec2 s = count * uv - (center * count - count / 2.);\n  vec4 color = texture2D(u_image, s);\n  color *= ceil(fract(clamp(s.x, 0., 1.)));\n  color *= ceil(fract(clamp(s.y, 0., 1.)));\n  return color;\n}\n\nvec2 getRotate(float theta, float radius) {\n  float center = (patternCount - 1.) / 2.;\n  return vec2(\n    radius * cos(theta) + 0.5,\n    radius * sin(theta) + 0.5\n  );\n}\n\nvec2 normalise(vec2 uv, float size, float offset) {\n  return vec2(\n    (uv.x) * size + offset,\n    (uv.y + mod(uv.x, 2.) * 0.5 ) * size + offset\n  );\n}\n\nfloat loopInner(float x, float len) {\n  return (abs(\n    len * (1. - mod(x, 2.)) - ((x - mod(x, 2.)) / 2.)\n  ));\n}\n\nvec2 verticalAnimation(float x, float size, float time) {\n    return verticalAmount * vec2(0., (1. - 2. * mod(x, 2.)) * 0.5 * size * smoothstep(-1., 1., cos(time * 1.5 * PI)));\n}\n\nvoid main() {\n    vec4 o = vec4(0.);\n    float size = 1. / patternCount;\n    float offset = size / 2.;\n\n    int c = int(floor(patternCount) + 1.);\n\n    for (int i = 0; i < MAX_ITS; i++) {\n      for (int j = 0; j < MAX_ITS; j++) {\n\n        float count = float(c);\n\n        vec2 start = vec2(\n          loopInner(float(i), count) - 1.,\n          loopInner(float(j), count) - 1.\n        );\n\n        vec2 normalised = normalise(start, size, offset) + verticalAnimation(start.x, size, time);\n        float radius = distance(normalised, vec2(0.5));\n\n        float theta = atan(normalised.y - 0.5, normalised.x - 0.5);\n\n        start = getRotate(theta + ( radialAmount * (time + PI / 4.) ), radius) + size * floor((patternCount / 2.));\n\n        vec4 new = smallImage(patternCount, start, texCoords);\n        o = mix(o, new, new.a);\n      }\n    }\n\n    gl_FragColor = o;\n}\n\n")),(0,i.A)(this,"radialAmount",void 0),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"time",void 0),(0,i.A)(this,"verticalAmount",void 0),this.renderSampler=this.sampler("u_image"),this.time=this.uniform("time",l.A.FLOAT),this.verticalAmount=this.uniform("verticalAmount",l.A.FLOAT),this.radialAmount=this.uniform("radialAmount",l.A.FLOAT)}}var Ie=r(709629);function Re(e){return[(.5-(e.left+e.right)/2)/.5,(.5-(e.top+e.bottom)/2)/.5]}function Fe(e,t,r,i){const n=t/r,o=Re(i),s=C.d.identity.multiply(C.d.translate(o[0],o[1])).multiply(C.d.scale(n,1)),a=C.d.identity.multiply(C.d.scale(1/n,1)).multiply(C.d.translate(-o[0],-o[1]));return s.multiply(C.d.rotate(e)).multiply(a)}function Pe(e,t,r){const{speed:i,amount:n,loop:o}=r??(0,Ie.L)();return{render(r,s,c){!function(e,t,r,i,n,o,s,c){let l,d=i.time-i.start;d*=o,c&&(d%=2),l=d<=1?(0,G.vF)(d):d<=2?1-(0,G.vF)(d-1):0;const u=s*l,h=Re(n),p=e.ctx.renderers.get(R.l);p.showCropped.setBoolean(!1),p.matrix.setMatrix3(C.d.identity.multiply(C.d.translate(h[0],h[1])).multiply(C.d.scale(u+1,u+1)).multiply(C.d.translate(-h[0],-h[1]))),p.sampleMatrix.setMatrix3(C.d.identity),t.value.clear(),(0,a.C)(p,t,r)}(e,r,s,c,t,i,n,o)},shouldRender:()=>!!r}}class Le extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D inTex;\nuniform float pixelation;\nuniform int colorPalette;\nvarying vec2 texCoords;\n\nvec3 getPixelFromColorPalette(float avg, vec3 colorPalette[4]) {\n    // Map the greyscale pixel to the selected colour palette\n    if (avg < 0.25) {\n        return colorPalette[0];\n    } else if (avg < 0.5) {\n        return colorPalette[1];\n    } else if (avg < 0.75) {\n        return colorPalette[2];\n    }\n    return colorPalette[3];\n}\n\nfloat convertToGrayScale(vec3 pixel) {\n    // Grab the average of rgb\n    return (pixel.r + pixel.g + pixel.b) / 3.0;\n}\n\nvoid main() {\n    float squareSize = pixelation / 1000.0;\n    vec2 sampleLoc = (floor(texCoords / squareSize) + 0.5) * squareSize;\n\n    vec3 retroHandheldGreenColorPalette[4];\n    retroHandheldGreenColorPalette[0] = vec3(0.058, 0.219, 0.058);\n    retroHandheldGreenColorPalette[1] = vec3(0.188, 0.384, 0.188);\n    retroHandheldGreenColorPalette[2] = vec3(0.545, 0.675, 0.058);\n    retroHandheldGreenColorPalette[3] = vec3(0.608, 0.737, 0.058);\n\n    // Grab the pixel colour from the texture\n    vec4 pixel = texture2D(inTex, sampleLoc);\n    // Divide by alpha\n    if (pixel.a != 0.0) {\n        pixel.rgb /= pixel.a;\n    }\n\n    if (colorPalette == 1) {\n        pixel.rgb = floor(pixel.rgb * 4.0) / 4.0;\n    } else if (colorPalette == 2) {\n        float avg = convertToGrayScale(pixel.rgb);\n        pixel.rgb = getPixelFromColorPalette(avg, retroHandheldGreenColorPalette);\n    }\n\n    pixel.rgb *= pixel.a;\n\n    // Set the pixel colour to the new colour\n    gl_FragColor = pixel;\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"pixelation",void 0),(0,i.A)(this,"colorPalette",void 0),this.renderSampler=this.sampler("inTex"),this.pixelation=this.uniform("pixelation",l.A.FLOAT),this.colorPalette=this.uniform("colorPalette",l.A.INTEGER)}}function Ne(e,t,r){let i=0;switch(r){case"original":default:i=0;break;case"8-bit":i=1;break;case"retro-handheld-green":i=2}return{render(r,n){const o=e.ctx.renderers.get(Le);o.renderSampler.set(n.value.bindSampler(0)),o.pixelation.setFloat(t),o.colorPalette.setInteger(i),o.renderTo(r)},shouldRender:()=>0!==t}}var Me=r(588657);function Be(e,t,r){const{speed:i,reverse:n}=r??(0,Me.d)();return{render(r,o,s){!function(e,t,r,i,n,o=.05,s=!1){let c=i.time-i.start;s&&(c=-c),c*=o;const l=Fe(2*Math.PI*c,t.value.pixelWidth,t.value.pixelHeight,n);t.value.clear();const d=e.ctx.renderers.get(R.l);d.showCropped.setBoolean(!1),d.matrix.setMatrix3(l),(0,a.C)(d,t,r)}(e,r,o,s,t,i,n)},shouldRender:()=>!!r}}const De=e=>e?2*e[0]+6*e[1]:4;function Oe(e,t,r,i=.05,n=!1){return{render(o,s,c){!function(e,t,r,i,n,o,s=.05,c=!1){let l=i.time-i.start;c&&(l=i.duration-l),l*=s;const d=[[.5*l,-.5*l],[0,-.5*l],[-.5*l,-.5*l],[.5*l,0],[0,0],[-.5*l,0],[.5*l,.5*l],[0,.5*l],[-.5*l,.5*l]];let u;u="zoom_to_random"===n?(e=>{const t=e??function(){const e=[0,.5,1];return[e[Math.floor(Math.random()*e.length)],e[Math.floor(Math.random()*e.length)]]}();return De(t)})(o):De(o);const[h,p]=d[u],m=e.ctx.renderers.get(R.l);m.matrix.setMatrix3(C.d.identity.multiply(C.d.translate(h,p)).multiply(C.d.scale(l+1,l+1))),m.sampleMatrix.setMatrix3(C.d.identity),t.value.clear(),(0,a.C)(m,t,r)}(e,o,s,c,t,r,i,n)},shouldRender:()=>"disabled"!==t}}var je=r(346392),Ue=r(552614);const ze=1.2256;function We(e,t,r){const{bounce:i,loop:n,reverse:o}=r??(0,Ue.y)();return{render(r,s,c){!function(e,t,r,i,n,o,s,c){let l=i.time-i.start;s&&(l%=o?3.5:1.5);let d=o?function(e){if(e<=.3538)return-.3029*Math.sin(5*e);if(e<=ze){const t=e+Math.PI/4-Math.PI/10;return-.3*Math.exp(3*t-2)*Math.sin(3*t)}if(e<=3){const t=e-ze;return 20*Math.exp(-3*e)*Math.sin(8*t)}return 0}(l):function(e){return e>=1?0:2*Math.PI*(0,G.vF)(e,3)}(l);c&&(d=-d);const u=Fe(d,t.value.pixelWidth,t.value.pixelHeight,n);t.value.clear();const h=e.ctx.renderers.get(R.l);h.showCropped.setBoolean(!1),h.matrix.setMatrix3(u),(0,a.C)(h,t,r)}(e,r,s,c,t,i,n,o)},shouldRender:()=>!!r}}class Ve extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D u_image;\nuniform vec2 blurAmount;\nuniform vec2 downsampleSize;\nvarying vec2 texCoords;\n\nmat3 rgb2yiq =\n        mat3(0.299, 0.596, 0.211, 0.587, -0.274, -0.523, 0.114, -0.322, 0.312);\nmat3 yiq2rgb = mat3(1, 1, 1, 0.956, -0.272, -1.106, 0.621, -0.647, 1.703);\n\nconst ivec2 samples = ivec2(8, 3);\n\nvec3 downsampleVideo2(vec2 uv, vec2 pixelSize) {\n    vec2 uvStart = uv - pixelSize / 2.0;\n    vec2 uvEnd = uv + pixelSize;\n\n    vec3 result = vec3(0.0, 0.0, 0.0);\n    for (int i_u = 0; i_u < samples.x; i_u++) {\n        float u = mix(uvStart.x, uvEnd.x, float(i_u) / float(samples.x));\n\n        for (int i_v = 0; i_v < samples.y; i_v++) {\n            float v = mix(uvStart.y, uvEnd.y, float(i_v) / float(samples.y));\n\n            result += texture2D(u_image, vec2(u, v)).rgb;\n        }\n    }\n\n    return (result / float(samples.x * samples.y)) * rgb2yiq;\n}\n\nvec3 downsampleVideo(vec2 fragCoord) {\n    vec2 uv = fragCoord;\n    vec2 pixelSize = 1.0 / downsampleSize;\n\n    pixelSize *= 1.0 + blurAmount; // Slight box blur to avoid aliasing\n\n    return downsampleVideo2(uv, pixelSize);\n}\n\nvoid main() {\n    gl_FragColor = vec4(downsampleVideo(texCoords) * yiq2rgb, 1);\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"blurAmount",void 0),(0,i.A)(this,"downsampleSize",void 0),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("u_image"),this.downsampleSize=this.uniform("downsampleSize",l.A.FLOAT_ARRAY_2),this.blurAmount=this.uniform("blurAmount",l.A.FLOAT_ARRAY_2)}}class He extends c.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D chr_image;\nuniform sampler2D lum_image;\nuniform float time;\nuniform float shiftFrequency;\nuniform vec2 textureSize;\nvarying vec2 texCoords;\nuniform vec2 resLuminance;\nuniform vec2 resChroma;\nuniform float noiseThreshold;\n\nmat3 rgb2yiq =\n        mat3(0.299, 0.596, 0.211, 0.587, -0.274, -0.523, 0.114, -0.322, 0.312);\nmat3 yiq2rgb = mat3(1, 1, 1, 0.956, -0.272, -1.106, 0.621, -0.647, 1.703);\n\nvec4 hash42(vec2 p) {\n    vec4 p4 = fract(vec4(p.xyxy) * vec4(443.8975, 397.2973, 491.1871, 470.7827));\n    p4 += dot(p4.wzxy, p4 + 19.19);\n    return fract(vec4(p4.x * p4.y, p4.x * p4.z, p4.y * p4.w, p4.x * p4.w));\n}\n\nfloat hash(float n) { return fract(sin(n) * 43758.5453123); }\n\nfloat noise(in vec3 x) {\n    vec3 p = floor(x);\n    vec3 f = fract(x);\n    f = f * f * (3.0 - 2.0 * f);\n    float n = p.x + p.y * 57.0 + 113.0 * p.z;\n    float res = mix(mix(mix(hash(n + 0.0), hash(n + 1.0), f.x),\n                                            mix(hash(n + 57.0), hash(n + 58.0), f.x), f.y),\n                                    mix(mix(hash(n + 113.0), hash(n + 114.0), f.x),\n                                            mix(hash(n + 170.0), hash(n + 171.0), f.x), f.y),\n                                    f.z);\n    return res;\n}\n\nfloat tapeNoise(vec2 coords) {\n    float s = time * 80.;\n    vec2 gridRatio = (textureSize / resLuminance) * 250.;\n    vec2 gridCoords = vec2(floor(coords.x * gridRatio.x) / gridRatio.x,\n                                                 floor(coords.y * gridRatio.y) / gridRatio.y);\n\n    float v = (noise(vec3(gridCoords.y * 140. + s, 1., 1.0)) + .0);\n    v *= hash42(vec2(gridCoords.x + time * 0.01, gridCoords.y)).x;\n\n    if (v < noiseThreshold) {\n        v = 0.;\n    }\n    return v / 3.;\n}\n\n// from http://www.java-gaming.org/index.php?topic=35123.0\nvec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w) * (1.0 / 6.0);\n}\n\nvec3 textureBicubic(sampler2D sampler, vec2 inCoords, vec2 textureRes) {\n    vec2 invTexSize = vec2(1.0) / textureRes;\n\n    vec2 coords = inCoords * textureRes - 0.5;\n\n    vec2 fxy = fract(coords);\n    coords -= fxy;\n\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = coords.xxyy + vec2(-0.5, +1.5).xyxy;\n\n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4(xcubic.yw, ycubic.yw) / s;\n\n    offset *= invTexSize.xxyy;\n\n    vec3 sample0 = texture2D(sampler, offset.xz).rgb * rgb2yiq;\n    vec3 sample1 = texture2D(sampler, offset.yz).rgb * rgb2yiq;\n    vec3 sample2 = texture2D(sampler, offset.xw).rgb * rgb2yiq;\n    vec3 sample3 = texture2D(sampler, offset.yw).rgb * rgb2yiq;\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(mix(sample3, sample2, sx), mix(sample1, sample0, sx), sy);\n}\n\nvoid main() {\n    // CRT offset effect\n    vec2 coords =\n            vec2(texCoords.x +\n                             (max(min(sin((texCoords.y + time) * shiftFrequency), 0.05), 0.) /\n                                20.),\n                     texCoords.y);\n\n    // Colour bleeding\n    float luminance = textureBicubic(lum_image, coords, resLuminance).x;\n    vec2 chroma = textureBicubic(chr_image, coords, resChroma).yz;\n    vec3 result = vec3(luminance, chroma) * yiq2rgb;\n\n    result.rgb += vec3(tapeNoise(coords));\n\n    gl_FragColor = vec4(result, texture2D(u_image, coords).a);\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"chromaSampler",void 0),(0,i.A)(this,"luminanceSampler",void 0),(0,i.A)(this,"noiseThreshold",void 0),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"resChroma",void 0),(0,i.A)(this,"resLuminance",void 0),(0,i.A)(this,"shiftFrequency",void 0),(0,i.A)(this,"textureSize",void 0),(0,i.A)(this,"time",void 0),this.renderSampler=this.sampler("u_image"),this.chromaSampler=this.sampler("chr_image"),this.luminanceSampler=this.sampler("lum_image"),this.textureSize=this.uniform("textureSize",l.A.FLOAT_ARRAY_2),this.time=this.uniform("time",l.A.FLOAT),this.shiftFrequency=this.uniform("shiftFrequency",l.A.FLOAT),this.resLuminance=this.uniform("resLuminance",l.A.FLOAT_ARRAY_2),this.resChroma=this.uniform("resChroma",l.A.FLOAT_ARRAY_2),this.noiseThreshold=this.uniform("noiseThreshold",l.A.FLOAT)}}function Ge(e,t,r){return{render(i,n,o){!function(e,t,r,{time:i},n,o){const s=e.ctx.renderers.get(Ve),c=e.ctx.renderers.get(He),l=[40,480],d=[333,480],u=e.allocImage(!1,l[0],l[1]),h=e.allocImage(!1,d[0],d[1]);s.downsampleSize.setFloatArray2(l),s.blurAmount.setFloatArray2([.2,.2]),(0,a.C)(s,u,r),s.downsampleSize.setFloatArray2(d),(0,a.C)(s,h,r),c.time.setFloat(i),c.shiftFrequency.setFloat(o),c.resChroma.setFloatArray2(l),c.resLuminance.setFloatArray2(d),c.noiseThreshold.setFloat(n),c.textureSize.setFloatArray2([r.value.pixelWidth,r.value.pixelHeight]),c.renderSampler.set(r.value.bindSampler(0)),c.chromaSampler.set(u.value.bindSampler(1)),c.luminanceSampler.set(h.value.bindSampler(2)),c.renderTo(t),u.free(),h.free()}(e,i,n,o,t,r)},shouldRender:()=>r>0}}var qe=r(383989);class Qe extends qe._{set extraContrast(e){this.colorBalance={...this.colorBalance,contrast:e}}get extraContrast(){return this.colorBalance.contrast}set extraExposure(e){this.colorBalance={...this.colorBalance,exposure:e}}get extraExposure(){return this.colorBalance.exposure}set extraSaturation(e){this.colorBalance={...this.colorBalance,saturation:e}}get extraSaturation(){return this.colorBalance.saturation}set extraTemperature(e){this.colorBalance={...this.colorBalance,temperature:e}}get extraTemperature(){return this.colorBalance.temperature}get videoTransform(){return this.letterboxNode.videoTransform}set videoTransform(e){this.letterboxNode.videoTransform=e,this.generator.videoTransform=e}get cropping(){return this.letterboxNode.cropping}set cropping(e){this.letterboxNode.cropping=e}constructor(e,t,r,n){super(e,r),(0,i.A)(this,"alpha",1),(0,i.A)(this,"colorBalance",L),(0,i.A)(this,"blendMode","normal"),(0,i.A)(this,"letterboxNode",void 0),(0,i.A)(this,"filterPresets",[]),(0,i.A)(this,"filterLutStates",[]),this.graphContext=t,this.lutProvider=n,this.letterboxNode=new F(e,r)}updateFilters(e){const t=e.filters??[];if(this.filterPresets=t.map((e=>({...e.filter.preset,...e.filterFields}))),this.filterLutStates.length>this.filterPresets.length)for(let e=this.filterPresets.length;e<this.filterLutStates.length;e++)this.filterLutStates[e]?.node.destroy();this.filterLutStates.length=this.filterPresets.length;for(let r=0;r<this.filterPresets.length;r++){const i=this.filterPresets[r];let n=this.filterLutStates[r];if(!i.lutSrc){n?.node.destroy(),this.filterLutStates[r]=void 0;continue}const o=t[r].filter.id,a=this.lutProvider?.getVideoStreamForTrackItem(`${e.id}-${o}`);void 0===a||void 0===this.lutProvider?("legacy"!==n?.type&&(n?.node.destroy(),n={type:"legacy",node:new Te(this.root,this.graphContext)},this.filterLutStates[r]=n),n.node.srcUrl=i.lutSrc,n.node.intensity=i.lutIntensity):"stream"===n?.type&&n.streamId===a.id||(n?.node.destroy(),n={type:"stream",streamId:a.id,node:new s.s(this.root,this.graphContext,this.lutProvider.reader,this.lutProvider.clock,a)},this.filterLutStates[r]=n)}}destroy(){this.generator.destroy();for(const e of this.filterLutStates)e?.node.destroy()}update(e,t,r){this.generator.update(e,t,r);for(const t of this.filterLutStates)"stream"===t?.type&&(t.node.start=this.start,t.node.duration=this.duration,t.node.update(e))}hasLoaded(e){return!!this.generator.hasLoaded(e)&&this.filterLutStates.every((e=>"stream"!==e?.type||e.node.hasLoaded()))}getExportStream(e,t,r){return(0,o._y)(this.waitForLutNodes().then((()=>super.getExportStream(e,t,r))))}render(e,t){const r=[];for(let e=0;e<this.filterPresets.length;e++)r.push(...this.getFilterPasses(e));r.push(...this.getGlobalPasses());const i=r.filter((e=>e.shouldRender())),o=i.some((e=>e.disableLetterbox)),s=i;o||s.unshift(this.letterboxNode);const a=this.getRenderParams(t),c=n.G.create(this.root);if(this.generator.render(c,t),c.value.isEmpty)return void c.free();let l=c;for(let t=0;t<s.length;t++){const r=s[t];if(t===s.length-1){r.render(e,l,a);break}const i=this.root.cloneImage(e);r.render(i,l,a),l.free(),l=i}l.free()}async load(e){await this.generator.load(e),await this.waitForLutNodes()}async seek(e,t){await this.generator.seek(e,t),await this.waitForLutNodes()}getRenderParams(e){return{time:e,start:this.generator.start,duration:this.generator.duration}}getFilterPasses(e){const t=this.filterPresets[e],r=[(o=this.root,s=t.radialAmount,c=t.verticalAmount,l=t.pattern,{render(e,t,r){!function(e,t,r,i,n,o){const s=e.ctx.renderers.get(Ee);s.time.setFloat((0,j.A)(i)),s.radialAmount.setFloat(n),s.verticalAmount.setFloat(o),(0,a.C)(s,t,r)}(o,e,t,r,s,c)},shouldRender:()=>l||s>0||c>0}),U(this.root,t.glassAmount),(0,ie.Q)(this.root,t.glitchAmount,t.glitchSpeed),Ne(this.root,t.pixelation,t.colorPalette),W(this.root,t.chromaticAberrationAmount),Ge(this.root,.9,t.vhsShiftFrequency),(0,je.y)(this.root,t.smokeEnabled),Oe(this.root,t.szMode,t.szPosition,t.szSpeed,t.szReverse),q(this.root,t.crashZoomEnabled,t.crashZoomPosition,t.crashZoomZoomAmount,Number.parseInt(t.crashZoomSteps,10),t.crashZoomStepDelay),ke(this.root,t.move),re(this.root,t.flash),Be(this.root,this.videoTransform.bounds,t.rotate),We(this.root,this.videoTransform.bounds,t.spin),H(this.root,t.colorShiftEnabled),J(this.root,t.discoEnabled),le(this.root,t.greenScreenEnabled,t.greenScreenCutoff,t.greenScreenColor),B(this.root,t.blurFillEnabled,this.generator,this.videoTransform),ee(this.root,t.grainAmount),he(this.root,t.cartoonEnabled,t.cartoonHalftoneIntensity),m(this.root,t.blackWhiteRemovalEnabled,t.blackWhiteRemovalCutoff,t.blackWhiteRemovalColor),(0,M.B)(this.root,t.blurAmount),se(this.root,t.glowV2),fe(this.root,this.videoTransform.bounds,t.kaleidoscopeV2),X(this.root,t.diffusionV2),Pe(this.root,this.videoTransform.bounds,t.pulse)],i=this.filterLutStates[e];var o,s,c,l;return"legacy"===i?.type?r.push(i.node):"stream"===i?.type&&r.push(function(e,t,r){return{render(i,o){!function(e,t,r,i,o){const s=n.G.create(e);if(i.render(s,0),s.value.isEmpty)return void(0,ge.u)(e,r,t);const c=e.ctx.renderers.get(Ae);c.intensity.setFloat(o),c.flipLut.setBoolean(!0),c.lutSampler.set(s.value.bindSampler(1)),(0,a.C)(c,t,r),s.free()}(e,i,o,t,r)},shouldRender:()=>r>0}}(this.root,i.node,t.lutIntensity)),r}getGlobalPasses(){return[(e=this.root,t=this.colorBalance,{render(r,i){N(e,r,i,t)},shouldRender:()=>!function(e){return 0===e.exposure&&0===e.saturation&&0===e.temperature&&0===e.contrast}(t)}),h(this.root,this.alpha),v(this.root,this.blendMode)];var e,t}async waitForLutNodes(){for(const e of this.filterLutStates)"legacy"===e?.type?await e.node.waitForReady():"stream"===e?.type&&await e.node.waitForVideoStream()}}},383989:(e,t,r)=>{r.d(t,{_:()=>n});var i=r(142056);class n extends i.E{get rotation(){return this.generator.rotation}get rotWidth(){return this.generator.rotWidth}get rotHeight(){return this.generator.rotHeight}}},142056:(e,t,r)=>{r.d(t,{E:()=>i});class i{findChildGenerator(e){let t=this;if(t instanceof e)return t;for(;t instanceof i;)if(t=t.wrappedGenerator,t instanceof e)return t}get wrappedGenerator(){return this.generator}get duration(){return this.generator.duration}set duration(e){this.generator.duration=e}get offset(){return this.generator.offset}set offset(e){this.generator.offset=e}get playbackRate(){return this.generator.playbackRate}set playbackRate(e){this.generator.playbackRate=e}get root(){return this._root}get start(){return this.generator.start}set start(e){this.generator.start=e}get volume(){return this.generator.volume}set volume(e){this.generator.volume=e}constructor(e,t){this._root=e,this.generator=t}getExportStream(e,t,r){return this.generator.getExportStream(e,t,r)}hasLoaded(e){return this.generator.hasLoaded(e)}isActive(e){return this.generator.isActive(e)}isStalled(e){return this.generator.isStalled(e)}load(e){return this.generator.load(e)}pause(e,t){return this.generator.pause(e,t)}play(e){return this.generator.play(e)}reduceItems(){return this.generator.reduceItems()}seek(e,t){return this.generator.seek(e,t)}update(e,t,r){this.generator.update(e,t,r)}}},326180:(e,t,r)=>{function i(e){return{value:e}}function n(e){return{...e,free(){}}}function o(...e){let t=!1;return r=>{if(t)throw new Error("Trying to call a doWith function after it has already been disposed");t=!0;try{return r(...e)}finally{for(const t of e)t.free()}}}r.d(t,{Ar:()=>i,Ww:()=>o,rd:()=>n})},942552:(e,t,r)=>{r.d(t,{O:()=>i});class i{get canvas(){return this.root.gl.canvas}get root(){return this._root}constructor(e,t,r){this._root=e,this.width=t,this.height=r}bind(){this.root.gl.canvas.width===this.width&&this.root.gl.canvas.height===this.height||(this.root.gl.canvas.width=this.width,this.root.gl.canvas.height=this.height)}finish(){this.root.gl.finish()}toBlob(){return this.finish(),new Promise(((e,t)=>{this.canvas.toBlob((r=>{r&&r.size>0?e(r):(console.error("Error retrieving image blob from canvas",r),t(new Error("Failed to create blob from canvas")))}),"image/webp")}))}toDataUrl(e="image/jpeg"){return this.finish(),this.canvas.toDataURL(e)}}},926562:(e,t,r)=>{r.d(t,{n:()=>o});var i=r(324586),n=r(945596);class o extends n.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D inTex;\nvarying vec2 texCoords;\nvoid main() { gl_FragColor = texture2D(inTex, texCoords); }\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("inTex")}}},256070:(e,t,r)=>{r.d(t,{l:()=>a});var i=r(324586),n=r(945596),o=r(979820),s=r(962165);class a extends n.A{constructor(e){const t=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D inTex;\nvarying vec2 texCoords;\nuniform mat3 u_sampleMatrix;\nuniform bool u_showCropped;\n\nvoid main() {\n    vec2 a = (u_sampleMatrix * vec3(texCoords, 1)).xy;\n    float m = step(0., a.x) * step(0., a.y) * step(a.x, 1.) * step(a.y, 1.);\n    float m2 = mix(u_showCropped ? 0.5 : 0., 1., m);\n    gl_FragColor = mix(vec4(0., 0., 0., 0.), texture2D(inTex, texCoords), m2);\n}\n"),r=e.createShader(e.gl.VERTEX_SHADER,s),n=e.createProgram(r,t);e.gl.deleteShader(r),e.gl.deleteShader(t),super(e,n),(0,i.A)(this,"matrix",void 0),(0,i.A)(this,"sampleMatrix",void 0),(0,i.A)(this,"showCropped",void 0),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("inTex"),this.matrix=this.uniform("matrix",o.A.MATRIX_3),this.sampleMatrix=this.uniform("u_sampleMatrix",o.A.MATRIX_3),this.showCropped=this.uniform("u_showCropped",o.A.BOOLEAN)}}},152848:(e,t,r)=>{r.d(t,{C:()=>s});var i=r(324586),n=r(945596),o=r(979820);class s extends n.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\n\nuniform sampler2D yTex;\nuniform sampler2D uTex;\nuniform sampler2D vTex;\nuniform sampler2D aTex;\n\nuniform vec2 textureStretch; // >1 shrinks, <1 expands\nuniform vec2 textureOffset;\nuniform bool useAlpha;\nvarying vec2 texCoords;\n\nvoid main() {\n    vec2 modifiedCoords = texCoords * textureStretch + textureOffset;\n\n    float y = (texture2D(yTex, modifiedCoords).r * 255.0 - 16.0) / 219.0;\n    float u = (texture2D(uTex, modifiedCoords).r * 255.0 - 128.0) / 224.0;\n    float v = (texture2D(vTex, modifiedCoords).r * 255.0 - 128.0) / 224.0;\n    float alpha = useAlpha ? texture2D(aTex, modifiedCoords).r : 1.0;\n\n    float r = v * 1.5748 + y;\n    float b = u * 1.8556 + y;\n    float g = (y - 0.2126 * r - 0.0722 * b) / 0.7152;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * alpha;\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"textureOffset",void 0),(0,i.A)(this,"textureStretch",void 0),(0,i.A)(this,"useAlpha",void 0),(0,i.A)(this,"uSampler",void 0),(0,i.A)(this,"vSampler",void 0),(0,i.A)(this,"ySampler",void 0),(0,i.A)(this,"aSampler",void 0),this.textureStretch=this.uniform("textureStretch",o.A.FLOAT_ARRAY_2),this.textureOffset=this.uniform("textureOffset",o.A.FLOAT_ARRAY_2),this.useAlpha=this.uniform("useAlpha",o.A.FLOAT),this.ySampler=this.sampler("yTex"),this.uSampler=this.sampler("uTex"),this.vSampler=this.sampler("vTex"),this.aSampler=this.sampler("aTex")}}},16885:(e,t,r)=>{r.d(t,{Q:()=>c});var i=r(324586),n=(r(379321),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(540076));class o{constructor(){(0,i.A)(this,"nextInt",0)}nextId(){const e=this.nextInt.toString(32);return this.nextInt++,e}}const s={font:{type:"always active"},default:{type:"warmup cooldown",warmupSeconds:1,cooldownSeconds:.5}};function a(e,t){return`${e}-${t}`}class c{constructor(e=s){(0,i.A)(this,"currentTimeSecs",0),(0,i.A)(this,"isUpdateScheduled",!1),(0,i.A)(this,"idAllocator",new o),(0,i.A)(this,"handles",[]),(0,i.A)(this,"resources",new Map),this.strategy=e}createHandle(e){const t={descriptor:e,currentResourceKey:void 0};return this.handles.push(t),{unlink:()=>this.removeHandle(t)}}at(e){this.currentTimeSecs=e,this.updateAtCurrentTime(),this.isUpdateScheduled=!1}cleanup(){this.cleanupUnusedResources(new Set)}renderDebugOverlay(e,t){for(let r=0;r<this.handles.length;r++)this.handles[r].descriptor.renderDebugOverlay(e,{x:t.x,y:t.y+75+25*r,width:t.width,height:24})}removeHandle(e){const t=this.handles.indexOf(e);-1!==t&&(this.handles.splice(t,1),e.descriptor.onDataChanged(void 0),this.tryScheduleUpdate())}getActiveResourceKeys(){const e=new Set;for(const t of this.handles)void 0!==t.currentResourceKey&&this.isDescriptorActive(this.currentTimeSecs,t.descriptor)&&e.add(t.currentResourceKey);return e}allocateResourceForHandle(e){const{data:t,unload:r}=e.descriptor.loader.load(),{type:i,cacheKey:n}=e.descriptor.loader,o=`${i}-${n}`,s=this.idAllocator.nextId(),c=a(o,s);return this.getResourcePool(o).push({id:s,data:t,unload:r}),e.currentResourceKey=c,e.descriptor.onDataChanged(t),c}cleanupUnusedResources(e){const t=[];for(const[r,i]of this.resources){for(let t=0;t<i.length;){const n=i[t],o=a(r,n.id);e.has(o)?t++:(n.unload(),i.splice(t,1))}0===i.length&&t.push(r)}for(const e of t)this.resources.delete(e)}updateAtCurrentTime(){this.isUpdateScheduled=!1;const e=this.getActiveResourceKeys();for(const t of this.handles){const r=this.isDescriptorActive(this.currentTimeSecs,t.descriptor);void 0===t.currentResourceKey&&r?e.add(this.allocateResourceForHandle(t)):void 0===t.currentResourceKey||r||(t.currentResourceKey=void 0,t.descriptor.onDataChanged(void 0))}this.cleanupUnusedResources(e)}isDescriptorActive(e,t){const r=this.strategy[t.loader.type]??this.strategy.default;if("always active"===r.type)return!0;if("warmup cooldown"===r.type){const i=t.getStartSecs(),n=t.getDurationSecs(),o=i-r.warmupSeconds,s=i+n+r.cooldownSeconds;return o<=e&&e<s}(0,n.xb)(r,"unknown resource strategy")}getResourcePool(e){const t=this.resources.get(e);if(void 0!==t)return t;const r=[];return this.resources.set(e,r),r}tryScheduleUpdate(){this.isUpdateScheduled||(this.isUpdateScheduled=!0,queueMicrotask((()=>{this.isUpdateScheduled&&this.updateAtCurrentTime()})))}}},835908:(e,t,r)=>{function i(e){return[e.red,e.green,e.blue,e.alpha]}function n(e,t=1){return{red:e,green:e,blue:e,alpha:t}}r.d(t,{FU:()=>o,qX:()=>i,wj:()=>s});const o=n(0,0),s=n(0,1)},989263:(e,t,r)=>{r.d(t,{A:()=>o});var i=r(324586);function n(e){return{value:e.item,ref:()=>(e.refCount++,n(e)),free:()=>{e.refCount--}}}r(379321);class o{constructor(){(0,i.A)(this,"entries",void 0),this.entries=new Map}destroy(){for(const e of this.entries.values())e.free()}static create(){const e=new o;return{value:e,free:()=>e.destroy()}}entryRefs(){const e=[];for(const[t,r]of this.entries)e.push([t,r.item]);return e}tryGet(e){const t=this.entries.get(e);if(void 0!==t)return t.refCount++,n(t)}tryGetRef(e){const t=this.entries.get(e);if(void 0!==t)return t.item}get(e,t){const r=this.entries.get(e);if(void 0!==r)return r.refCount++,n(r);const i=t(),o={refCount:1,item:i.value,free:i.free};return this.entries.set(e,o),n(o)}collectGarbage(){const e=[];for(const[t,r]of this.entries)0===r.refCount&&(r.free(),e.push(t));for(const t of e)this.entries.delete(t)}tryCollect(e){const t=this.entries.get(e);void 0!==t&&0===t.refCount&&(t.free(),this.entries.delete(e))}}},127168:(e,t,r)=>{r.d(t,{$Z:()=>a,HQ:()=>c,vF:()=>s});var i=r(620544),n=r.n(i);const o=(e,t=2)=>Math.pow(e,t);function s(e,t=2){const r=Math.pow(2,t-1);return e<.5?r*o(e,t):1-r*o(1-e,t)}const a=n()(.5,0,.5,1),c=n()(.3,0,.3,1)},471189:(e,t,r)=>{r.d(t,{_y:()=>a,BJ:()=>c,tk:()=>s}),r(379321);var i=r(324586);class n{constructor(){(0,i.A)(this,"queuedValues",[]),(0,i.A)(this,"queuedWaiters",[])}push(e){const t=this.queuedWaiters.shift();t?t(e):this.queuedValues.push(e)}shift(){return this.queuedValues.shift()||new Promise((e=>this.queuedWaiters.push(e)))}}class o{constructor(e){(0,i.A)(this,"generator",void 0),(0,i.A)(this,"hasCleanedUp",!1),(0,i.A)(this,"valueQueue",new n),this.cleanup=e,this.generator={next:this.valueQueue.shift(),cleanup:()=>this.doCleanup()}}push(e){return new Promise((t=>{let r=!1;const i={finished:!1,value:e,continue:e=>r?Promise.reject(new Error("Cannot continue a generator iteration more than once")):(r=!0,t(e),this.valueQueue.shift())};this.valueQueue.push(Promise.resolve(i))}))}return(){this.doCleanup(),this.valueQueue.push(Promise.resolve({finished:!0}))}throw(e){this.doCleanup(),this.valueQueue.push(Promise.reject(e))}doCleanup(){this.hasCleanedUp||(this.hasCleanedUp=!0,this.cleanup&&this.cleanup())}}function s(e,t){const r=new o(t);return e((e=>r.push(e))).then((()=>r.return()),(e=>r.throw(e))),r.generator}function a(e){return{next:e.then((e=>e.next)),cleanup:()=>{e.then((e=>e.cleanup()),(e=>console.error("Error while cleaning up promise-based AsyncGenerator:",e)))}}}function c(e,t,r){let i=!1,n=0;function o(){i||(i=!0,r&&r())}return{next:async function r(i){try{const s=await i;return s.finished?(o(),{finished:!0}):{finished:!1,value:await t(s.value,n++).catch((t=>{throw e.cleanup(),t})),continue:e=>r(s.continue(e))}}catch(e){throw o(),e}}(e.next),cleanup:()=>{e.cleanup(),o()}}}},932808:(e,t,r)=>{r.d(t,{Qq:()=>a,Su:()=>c,sc:()=>l,tR:()=>s,y:()=>o});var i=r(476636);const n=Math.PI/180;function o(e,t){const r=new i.Z(e.x/2,e.y/2).rotate(t),n=new i.Z(e.x/2,-e.y/2).rotate(t),o=new i.Z(-e.x/2,-e.y/2).rotate(t),s=new i.Z(-e.x/2,e.y/2).rotate(t),a=i.Z.min(r,n,o,s);return i.Z.max(r,n,o,s).sub(a)}function s(e){return e*n}function a(e,t,r){return e>=t&&e<r}function c(e,t,r,i){return!(t<=r||e>=i)}function l(e){return[e[0]/255,e[1]/255,e[2]/255,e[3]]}},342455:(e,t,r)=>{r.d(t,{w:()=>o});var i=r(324586),n=r(989263);class o{constructor(){(0,i.A)(this,"deferredCache",void 0),this.deferredCache=n.A.create()}destroy(){this.deferredCache.free()}static create(){const e=new o;return{value:e,free:()=>e.destroy()}}entryRefs(){return this.deferredCache.value.entryRefs()}get(e,t){const r=this.deferredCache.value.get(e,t);return this.createRef(e,r)}createRef(e,t){return{value:t.value,ref:()=>this.createRef(e,t.ref()),free:()=>{t.free(),this.deferredCache.value.tryCollect(e)}}}}},828891:(e,t,r)=>{function i(e){return Math.max(0,Math.min(n(e)/e.duration,1))}function n(e){return Math.max(0,e.time-e.start)}r.d(t,{A:()=>n,o:()=>i})},403643:(e,t,r)=>{r.d(t,{DR:()=>c,Ge:()=>l,oI:()=>a,sF:()=>d,xs:()=>s});var i=r(476636),n=r(562151),o=r(956502);const s={left:0,right:0,bottom:0,top:0},a={left:0,right:1,bottom:0,top:1},c={strategy:"fit",bounds:a,rotation:0,hasFixedBounds:!1};class l{constructor(e,t,r,i,n){this.mid=e,this.size=t,this.flippedStatus=r,this.crop=i,this.rotation=n}getCropMid(){const{x:e,y:t}=this.mid,{width:r,height:n}=this.size,o=this.crop;return new i.Z(e+r*(o.left-o.right)/2,t+n*(o.bottom-o.top)/2)}flipped(e){const t={...this.flippedStatus};let r=new i.Z(this.mid.x,this.mid.y);const s={...this.crop},{x:a,y:c}=this.getCropMid();let d=e;const u=-n.D/4,h=(0,o.z)(u,n.D),p=(0,o.z)(3*u,n.D);return this.rotation!==h&&this.rotation!==p||(d="horizontal"===d?"vertical":"horizontal"),"horizontal"===d?([s.left,s.right]=[s.right,s.left],t.horizontal=!t.horizontal,r=this.mid.withX(2*a-this.mid.x)):([s.bottom,s.top]=[s.top,s.bottom],t.vertical=!t.vertical,r=this.mid.withY(2*c-this.mid.y)),new l(r,this.size,t,s,this.rotation)}getPlain(){const{x:e,y:t}=this.mid,{width:r,height:i}=this.size;let n=e-r/2,o=e+r/2,s=t-i/2,a=t+i/2;return this.flippedStatus.horizontal&&([n,o]=[o,n]),this.flippedStatus.vertical&&([s,a]=[a,s]),{strategy:"freehand",bounds:{left:n,right:o,bottom:s,top:a},crop:{...this.crop},rotation:this.rotation,hasFixedBounds:!0}}static from(e){const{left:t,right:r,bottom:n,top:o}=e.bounds??a,c=Math.abs(r-t),d=Math.abs(n-o),u=Math.min(t,r)+c/2,h=Math.min(n,o)+d/2;return new l(new i.Z(u,h),{width:c,height:d},{horizontal:t>r,vertical:n>o},e.crop??s,e.rotation??0)}rotated(e,t){const r=new i.Z(t,1),s=this.getCropMid(),a=this.mid.mul(r),c=s.mul(r),d=a.sub(c).div(new i.Z(t,1)),u=s.add(d),h=(0,o.z)(this.rotation+e,n.D);return new l(u,this.size,this.flippedStatus,this.crop,h)}resetCrop(e){const t=new i.Z(e,1),r=this.getCropMid(),n=this.mid.mul(t),o=r.mul(t).sub(n).rotate(this.rotation).div(new i.Z(e,1)),a=r.sub(o);return new l(a,this.size,this.flippedStatus,s,this.rotation)}}const d={flip:(e,t)=>l.from(e).flipped(t).getPlain(),getTightBounds(e,t){const r={...e.bounds},i=r.right-r.left,n=r.top-r.bottom,o=i/n;if("fill"===e.strategy&&o<t||"fill"!==e.strategy&&o>t){const e=(r.left+r.right)/2,i=n*t;r.left=e-i/2,r.right=e+i/2}else{const e=(r.bottom+r.top)/2,n=i/t;r.bottom=e-n/2,r.top=e+n/2}return r},rotate:(e,t)=>({...e,rotation:(0,o.z)((e.rotation??0)+t,n.D)}),scale(e,t,r){const i={...e.bounds??a},n=[(i.left+i.right)/2,(i.bottom+i.top)/2],o=[(i.right-i.left)*t,(i.top-i.bottom)*r];return i.left=n[0]-o[0]/2,i.right=n[0]+o[0]/2,i.bottom=n[1]-o[1]/2,i.top=n[1]+o[1]/2,{...e,bounds:i}}}},833665:(e,t,r)=>{function i(e){e.wrapU=0,e.wrapV=0,e.anisotropicFilteringLevel=1,e.updateSamplingMode(11)}r.d(t,{S:()=>i})},164768:(e,t,r)=>{r.d(t,{g:()=>c});var i=r(324586),n=(r(116962),r(912170)),o=r(80801),s=r(677763),a=r(833665);class c{constructor(e,t){(0,i.A)(this,"texture",void 0),(0,i.A)(this,"audioNode",void 0),this.engine=e,this.audioContext=t}setConfig(){}updatePlayback(){}pollRead(e,t,r,i){return(0,o.Y)(t,i,{video:()=>this.pollReadVideo(),audio:()=>this.pollReadAudio()})}destroy(){this.texture?.dispose(),this.audioNode?.disconnect()}pollReadVideo(){if(!this.texture){const e=this.engine.createDynamicTexture(1,1,!1,0);this.engine.updateDynamicTexture(e,new Image(1,1),!1,!1),this.texture=new n.D(e),(0,a.S)(this.texture)}return(0,s.eO)(this.texture)}pollReadAudio(){if(!this.audioContext)throw new Error("ErrorSource was created without an AudioContext");return this.audioNode||(this.audioNode=this.audioContext.createGain()),(0,s.eO)(this.audioNode)}}},204643:(e,t,r)=>{r.d(t,{j:()=>s});var i=r(324586),n=(r(34456),r(159129),r(940233),r(677763)),o=r(80801);class s{constructor(e){(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"waker",void 0),(0,i.A)(this,"isDestroyed",!1),(0,i.A)(this,"waitingForIdle",!1),(0,i.A)(this,"fontSource",void 0),this.fontSource=fetch(e).then((e=>{if(!e.ok)throw new Error("Failed to load font");return e.arrayBuffer()})),this.fontSource.then((e=>{this.buffer=e})).catch((e=>console.error("Failed to load font source on construction",e)))}pollReadFont(e){return this.waker=e,this.isDestroyed?(0,n.eO)(new ArrayBuffer(0)):(this.waitingForIdle&&(this.waitingForIdle=!1,this.waker?.wake(),this.waker=void 0),void 0===this.buffer?n.eG:(0,n.eO)(this.buffer))}destroy(){this.isDestroyed=!0,this.buffer=void 0}updatePlayback(){}setConfig(){}pollRead(e,t,r,i){return(0,o.Y)(t,i,{font:()=>this.pollReadFont(e)})}}},784087:(e,t,r)=>{r.d(t,{q:()=>l});var i=r(324586),n=(r(116962),r(912170)),o=r(677763),s=r(80801),a=r(833665);function c(e,t){return e.preferredWidth===t.preferredWidth&&e.preferredHeight===t.preferredHeight}class l{constructor(e,t,r){(0,i.A)(this,"bitmapSource",void 0),(0,i.A)(this,"texture",void 0),(0,i.A)(this,"waker",void 0),(0,i.A)(this,"lastParams",void 0),(0,i.A)(this,"isDestroyed",!1),(0,i.A)(this,"waitingForIdle",!1),this.engine=r,this.bitmapSource=function(e,t){return"bitmap"===t?fetch(e).then((e=>e.blob())):new Promise(((t,r)=>{const i=document.createElementNS("http://www.w3.org/2000/svg","image");i.setAttribute("href",e),i.onload=()=>t(i),i.onerror=()=>r(new Error("Failed to load SVG image"))}))}(e,t),this.bitmapSource.then((e=>createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"premultiply"}))).then((e=>{if(!this.isDestroyed){const t=this.engine.createDynamicTexture(e.width,e.height,!1,0);this.engine.updateDynamicTexture(t,e,!1,!1),this.texture=new n.D(t),(0,a.S)(this.texture)}e.close()})).catch((e=>console.error("Failed to load original bitmap source on construction",e)))}destroy(){this.isDestroyed=!0,this.lastParams=void 0,this.texture?.dispose()}updatePlayback(){}setConfig(){}async resizeBitmap(){const e=this.lastParams;if(void 0===e)return;const t=await this.bitmapSource,r=await createImageBitmap(t,{imageOrientation:"flipY",premultiplyAlpha:"premultiply",resizeWidth:e.preferredWidth,resizeHeight:e.preferredHeight,resizeQuality:"medium"});if(!this.isDestroyed&&void 0!==this.lastParams&&c(e,this.lastParams)){const e=this.engine.createDynamicTexture(r.width,r.height,!1,0);this.engine.updateDynamicTexture(e,r,!1,!1),this.texture=new n.D(e),(0,a.S)(this.texture),this.waker?.wake(),this.waker=void 0}r.close()}resizeBitmapSync(){this.resizeBitmap().catch((e=>console.error("Failed to load and resize the bitmap:",e)))}pollReadVideo(e,t){this.waker=e;const r=this.lastParams;return this.lastParams=t,void 0===r?this.resizeBitmapSync():this.waitingForIdle||c(t,r)||(this.waitingForIdle=!0,requestIdleCallback((()=>{this.waitingForIdle=!1,this.resizeBitmapSync()}))),void 0===this.texture?o.eG:(0,o.eO)(this.texture)}pollRead(e,t,r,i){return(0,s.Y)(t,i,{video:t=>this.pollReadVideo(e,t)})}}},629179:(e,t,r)=>{r.d(t,{EQ:()=>n,OE:()=>o,Oz:()=>s,r7:()=>a});var i=r(542809);function n(e,t,r){const i=e.clock,n=i.mediaSecondsToTicks(r.startTime),o=i.mediaSecondsToTicks(r.startTime+r.duration),s=i.ticksToSeconds(n),a=i.ticksToSeconds(o)-s;t.start===s&&t.duration===a||(t.start=s,t.duration=a)}function o(e,t,r){e.updateFilters(t,r),e.colorBalance=t.colorBalance??{exposure:0,saturation:0,temperature:0,contrast:0},e.blendMode=t.blendMode??"normal",t.transform&&(e.videoTransform=(0,i.Km)(t.transform))}function s(e,t,r){const i=t.alpha??1,n=a(r,t);e.alpha=i*n}function a(e,t){if(!t.fadeInOut)return 1;const r=t.fadeInOut.fadeInSeconds,i=t.fadeInOut.fadeOutSeconds;return(r>0?Math.max(0,Math.min(1,(e-t.startTime)/r)):1)*(i>0?Math.max(0,Math.min(1,(e-t.startTime-t.duration)/i*-1)):1)}},365800:(e,t,r)=>{r.d(t,{V:()=>n,v:()=>o});var i=r(324586);r(379321);const n=["frameTime","paint","allocations","resources","streamCache"];class o{constructor(e){(0,i.A)(this,"_context",void 0),(0,i.A)(this,"_instantiatedOverlays",void 0),(0,i.A)(this,"_overlays",[]),this.availableOverlays=e,this._instantiatedOverlays={}}enableOverlays(e,t){this._overlays=[];for(const r of n){if(!t[r])continue;let i=this._instantiatedOverlays[r];if(i){this._overlays.push(i);continue}const n=this.availableOverlays[r];n&&(i=n(e),this._instantiatedOverlays[r]=i,this._overlays.push(i))}}render(e,t){if(0===this._overlays.length)return void(this._context=void 0);if(!this._context){const e=document.createElement("canvas").getContext("2d");if(!e)throw new Error("Failed to create debug overlay surface");this._context=e}const r=t.value.pixelWidth,i=t.value.pixelHeight;this._context.canvas.width=r,this._context.canvas.height=i;for(const e of this._overlays)this._context.save(),e.render(this._context,{x:0,y:0,width:r,height:i}),this._context.restore();const n=e.allocCopyImage();n.value.upload(this._context.canvas,{isAlreadyPremult:!1,yFlipped:!1}),t.value.copy(n)}}},266343:(e,t,r)=>{r.d(t,{Z:()=>o});var i=r(324586),n=r(555333);class o{get format(){return{internalFormat:this.texture.getInternalTexture()?.format??0}}get hasValidMipmap(){return this.texture.getInternalTexture()?.generateMipMaps??!1}get pixelWidth(){return this.texture.getSize().width}get pixelHeight(){return this.texture.getSize().height}get relativeWidth(){return this.pixelWidth}get relativeHeight(){return this.pixelHeight}constructor(e){(0,i.A)(this,"relative",!1),this.texture=e}bindSampler(e=n.TL){return(0,n.S3)(this.texture,e,this.hasValidMipmap),this.texture}unwrap(){return{value:this}}}},284613:(e,t,r)=>{r.d(t,{T:()=>o});var i=r(582982),n=r(165223);class o{get pixelHeight(){return this.textureImage.pixelHeight}get pixelWidth(){return this.textureImage.pixelWidth}get relative(){return this.textureImage.relative}get relativeHeight(){return this.textureImage.relativeHeight}get relativeWidth(){return this.textureImage.relativeWidth}get format(){return this.textureImage.format}get hasValidMipmap(){return this.textureImage.hasValidMipmap}get root(){return this.textureImage.root}static wrap(e){return(0,i.Ar)(new o(e.value))}get renderTarget(){return this.textureImage.renderTarget}get texture(){return this.textureImage.texture}constructor(e){this.textureImage=e}bindFb(){this.root.ctx.engine.bindFramebuffer(this.renderTarget),this.root.ctx.engine.setAlphaMode(8)}bindSampler(e){return this.textureImage.bindSampler(e)}clear(){}copy(e){(0,i.Ww)(e)((e=>{(0,n.u)(this.root,e,(0,i.Ar)(this))}))}downloadBuffer(e,t){return this.textureImage.downloadBuffer(e,t)}downloadWebGL2Buffer(e,t){this.textureImage.downloadWebGL2Buffer(e,t)}unwrap(){return this.textureImage.unwrap()}}},393279:(e,t,r)=>{r.d(t,{VG:()=>s,YI:()=>c,_L:()=>n,bj:()=>i,j7:()=>d});const i={internalFormat:6408},n={internalFormat:6409},o={channels:6408,type:5121},s={channels:6409,type:5121},a={channels:6403,type:5121};function c(e){switch(e.internalFormat){case 6408:return o;case 6409:return s;case 33321:return a;default:throw new Error(`Unknown image format ${e.internalFormat}, please add it to the getBufferFormat table`)}}function l(e){switch(e){case 6409:case 6403:return 1;case 6410:case 33319:return 2;case 6407:return 3;case 6408:return 4;default:throw new Error(`Unknown channel format ${e}, please add it to the getChannelCount table`)}}function d(e){switch(e.type){case 5121:return l(e.channels);case 5122:case 5131:return 2*l(e.channels);case 5126:return 4*l(e.channels);default:throw new Error(`Unknown buffer type ${e.type}, please add it to the getFragmentByteLength table`)}}},165223:(e,t,r)=>{r.d(t,{u:()=>n});var i=r(752904);function n(e,t,r){const n=e.ctx.renderers.get(i.n);n.renderSampler.set(t.value.bindSampler()),n.renderTo(r)}},796748:(e,t,r)=>{r.d(t,{G:()=>o});var i=r(324586),n=r(393279);class o{get defaultPixelWidth(){return this.defaultWidth*(this.relative?this.root.ctx.getRenderWidth():1)}get defaultPixelHeight(){return this.defaultHeight*(this.relative?this.root.ctx.getRenderHeight():1)}get pixelWidth(){return"empty"===this.state.type?this.defaultPixelWidth:this.state.image.value.pixelWidth}get pixelHeight(){return"empty"===this.state.type?this.defaultPixelHeight:this.state.image.value.pixelHeight}get relative(){return"empty"===this.state.type?this.defaultRelative:this.state.image.value.relative}get relativeWidth(){return"empty"===this.state.type?this.defaultWidth:this.state.image.value.relativeWidth}get relativeHeight(){return"empty"===this.state.type?this.defaultHeight:this.state.image.value.relativeHeight}get format(){return"empty"===this.state.type?this.defaultFormat:this.state.image.value.format}get hasValidMipmap(){return"empty"!==this.state.type&&this.state.image.value.hasValidMipmap}get renderTarget(){return this.getWritable().value.renderTarget}get texture(){return this.getWritable().value.texture}static create(e,t,r,i,s=n.bj){const a=new o(e,t,r,i,s);return{value:a,free(){a.destroy()}}}static clone(e,t){return this.create(e,t.value.relative,t.value.relativeWidth,t.value.relativeHeight,t.value.format)}constructor(e,t,r,n,o){(0,i.A)(this,"state",{type:"empty"}),this.root=e,this.defaultRelative=t,this.defaultWidth=r,this.defaultHeight=n,this.defaultFormat=o}take(){if("empty"===this.state.type)return;const e=this.state.image;return this.state={type:"empty"},e}bindFb(){this.getWritable().value.bindFb()}clear(e){this.getWritable().value.clear(e)}copy(e){"empty"!==this.state.type&&this.state.image.free(),this.state={type:"read",image:e}}bindSampler(e){return this.getReadable().value.bindSampler(e)}downloadBuffer(e,t){return this.getWritable().value.downloadBuffer(e,t)}downloadWebGL2Buffer(e,t){this.getWritable().value.downloadWebGL2Buffer(e,t)}unwrap(){return this.getWritable().value.unwrap()}getWritable(){if("write"===this.state.type)return this.state.image;const e=this.root.allocImage(this.defaultRelative,this.defaultWidth,this.defaultHeight,this.defaultFormat);return"read"===this.state.type&&(this.root.ctx.logError(new Error("Forced to upgrade a read-only image to read-write, this should be avoided")),e.value.copy(this.state.image)),this.state={type:"write",image:e},e}getReadable(){if("empty"!==this.state.type)return this.state.image;const e=this.getWritable();return e.value.clear(),e}destroy(){"empty"!==this.state.type&&this.state.image.free(),this.state={type:"empty"}}}},163460:(e,t,r)=>{function i(e,t,r){e.renderSampler.set(r.value.bindSampler()),e.renderTo(t)}r.d(t,{C:()=>i})},736766:(e,t,r)=>{r.d(t,{A:()=>s});var i=r(324586);class n{constructor(e,t,r){this.effectRenderer=e,this.effectWrapper=t,this.samplerName=r}set(e){this.effectRenderer.applyEffectWrapper(this.effectWrapper),this.effectWrapper.effect.setTexture(this.samplerName,e)}}var o=r(129582);class s{constructor(e,t){(0,i.A)(this,"effectWrapper",void 0),(0,i.A)(this,"viewportSizeUniform",void 0),this.ctx=e,this.effectWrapper=e.getEffectWrapper(t)}destroy(){this.effectWrapper.dispose()}renderTo(e){this.viewportSizeUniform&&this.viewportSizeUniform.setFloatArray2([e.value.pixelWidth,e.value.pixelHeight]),e.value.bindFb(),this.renderToCurrent()}renderToCurrent(){this.ctx.effectRenderer.applyEffectWrapper(this.effectWrapper),this.ctx.engine.setState(!1),this.ctx.effectRenderer.draw()}sampler(e){return new n(this.ctx.effectRenderer,this.effectWrapper,e)}uniform(e,t){return new o.n(this.ctx.effectRenderer,this.effectWrapper,e,t)}}},555333:(e,t,r)=>{r.d(t,{S3:()=>l,TL:()=>c,xc:()=>u});var i=r(324586),n=(r(116962),r(560007),r(507851),r(406262)),o=r(582982),s=r(156106),a=r(165223);const c={minFilter:"linear",magFilter:"linear"};function l(e,t,r){e.wrapU=0,e.wrapV=0,e.anisotropicFilteringLevel=1;const i=function(e,t){const r=function(e,t){return"nearest"===e||"linear"===e?e:t?"prefer-mipmap":"linear"}(e.minFilter,t);return"linear"===e.magFilter?"prefer-mipmap"===r?5:"linear"===r?11:12:"prefer-mipmap"===r?5:"linear"===r?7:8}(t,r);e.samplingMode!==i&&e.updateSamplingMode(i)}const d={r:0,g:0,b:0,a:1};class u{get pixelHeight(){return this.relativeHeight*(this.relative?this.root.ctx.getRenderHeight():1)}get pixelWidth(){return this.relativeWidth*(this.relative?this.root.ctx.getRenderWidth():1)}get renderTarget(){const e=this._rtt.renderTarget;if(null==e){const e=new Error("TextureImage: renderTarget getter - Attempting to use a none initialized or disposed render target");throw this.root.ctx.logError(e),e}return e}get texture(){return this._rtt}static create(e,t,r,i,n){const o=new u(e,t,r,i,n);return{value:o,free(){o.destroy()}}}constructor(e,t,r,n,o){(0,i.A)(this,"hasValidMipmap",!1),(0,i.A)(this,"_lastHeight",0),(0,i.A)(this,"_lastWidth",0),(0,i.A)(this,"_destroyed",!1),(0,i.A)(this,"_rtt",void 0),this.root=e,this.relative=t,this.relativeWidth=r,this.relativeHeight=n,this.format=o,this.reinitializeResources()}bindFb(){if(this._lastWidth<=0||this._lastHeight<=0)throw new Error("Attempting to render to a 0-sized texture");this._throwIfDestroyed(),this.root.ctx.engine.bindFramebuffer(this.renderTarget),this.root.ctx.engine.setAlphaMode(0)}bindSampler(e=c){return this._throwIfDestroyed(),l(this._rtt,e,this.hasValidMipmap),this._rtt}clear(e=s.FU){this.bindFb(),d.r=e.red,d.g=e.green,d.b=e.blue,d.a=e.alpha,this.root.ctx.engine.clear(d,!0,!1,!1)}copy(e){(0,o.Ww)(e)((e=>{(0,a.u)(this.root,e,(0,o.Ar)(this))}))}downloadBuffer(e,t){return this._throwIfDestroyed(),this.root.performance.markTextureDownloadStart(),this.root.ctx.engine.bindFramebuffer(this.renderTarget),this.root.ctx.engine._gl.readPixels(0,0,this.pixelWidth,this.pixelHeight,t.channels,t.type,e),this.root.performance.markTextureDownloadEnd(),Promise.resolve()}downloadWebGL2Buffer(e,t){}reinitializeResources(){this._throwIfDestroyed(),this._rtt&&this._rtt.dispose(),this._rtt=new n.s(this.root.ctx.engine,{width:this.pixelWidth,height:this.pixelHeight},{generateDepthBuffer:!1,generateStencilBuffer:!1}),this._lastWidth=this.pixelWidth,this._lastHeight=this.pixelHeight}unwrap(){return(0,o.Ar)(this)}updateSize(){this._throwIfDestroyed();const e=this.pixelWidth,t=this.pixelHeight;e===this._lastWidth&&t===this._lastHeight||(this._rtt.resize({width:e,height:t}),this._lastWidth=this.pixelWidth,this._lastHeight=this.pixelHeight)}_throwIfDestroyed(){if(this._destroyed)throw new Error("Texture already destroyed")}destroy(){this._rtt.dispose(),this._destroyed=!0}}},129582:(e,t,r)=>{r.d(t,{A:()=>n,n:()=>s});var i=r(324586);const n={FLOAT:"float",BOOLEAN:"boolean",INTEGER:"integer",INTEGER_ARRAY_1:"integer_array_1",INTEGER_ARRAY_2:"integer_array_2",INTEGER_ARRAY_3:"integer_array_3",INTEGER_ARRAY_4:"integer_array_4",FLOAT_ARRAY_1:"float_array_1",FLOAT_ARRAY_2:"float_array_2",FLOAT_ARRAY_3:"float_array_3",FLOAT_ARRAY_4:"float_array_4",MATRIX_3:"matrix_3"},o=[0,0,0,0,0,0,0,0,0];class s{constructor(e,t,r,n){(0,i.A)(this,"effect",void 0),this.effectRenderer=e,this.effectWrapper=t,this.name=r,this.type=n,this.effect=this.effectWrapper.effect}readyProgram(){this.effectRenderer.applyEffectWrapper(this.effectWrapper)}checkType(e){if(this.type!==e)throw new Error(`Expected uniform of type ${this.type}, got ${e}.`)}setBoolean(e){this.checkType(n.BOOLEAN),this.readyProgram(),this.effect.setBool(this.name,e)}setFloat(e){this.checkType(n.FLOAT),this.readyProgram(),this.effect.setFloat(this.name,e)}setInteger(e){this.checkType(n.INTEGER),this.readyProgram(),this.effect.setInt(this.name,e)}setMatrix3(e){this.checkType(n.MATRIX_3),this.readyProgram();const t=e.m;o[0]=t[0],o[1]=t[3],o[2]=t[6],o[3]=t[1],o[4]=t[4],o[5]=t[7],o[6]=t[2],o[7]=t[5],o[8]=t[8],this.effect.setMatrix3x3(this.name,o)}setFloatArray1(e){this.checkType(n.FLOAT_ARRAY_1),this.readyProgram(),this.effect.setArray(this.name,e)}setIntegerArray1(e){this.checkType(n.INTEGER_ARRAY_1),this.readyProgram(),this.effect.setIntArray(this.name,e)}setFloatArray2(e){this.checkType(n.FLOAT_ARRAY_2),this.readyProgram(),this.effect.setArray2(this.name,e)}setIntegerArray2(e){this.checkType(n.INTEGER_ARRAY_2),this.readyProgram(),this.effect.setIntArray2(this.name,e)}setFloatArray3(e){this.checkType(n.FLOAT_ARRAY_3),this.readyProgram(),this.effect.setArray3(this.name,e)}setIntegerArray3(e){this.checkType(n.INTEGER_ARRAY_3),this.readyProgram(),this.effect.setIntArray3(this.name,e)}setFloatArray4(e){this.checkType(n.FLOAT_ARRAY_4),this.readyProgram(),this.effect.setArray4(this.name,e)}setIntegerArray4(e){this.checkType(n.INTEGER_ARRAY_4),this.readyProgram(),this.effect.setIntArray4(this.name,e)}}},586707:(e,t,r)=>{r.d(t,{s:()=>a});var i=r(324586),n=r(204411),o=r(266343),s=r(582982);class a{get rotation(){return this.videoStream?.metadata.displayRotationRads??0}get rotWidth(){return this.videoStream?.metadata.displayWidth??0}get rotHeight(){return this.videoStream?.metadata.displayHeight??0}constructor(e,t){(0,i.A)(this,"start",0),(0,i.A)(this,"duration",0),(0,i.A)(this,"_isDestroyed",!1),(0,i.A)(this,"_isActive",!1),(0,i.A)(this,"_lastUpdateTime",0),(0,i.A)(this,"_isStalled",!1),(0,i.A)(this,"_currentFrame",void 0),(0,i.A)(this,"videoTransform",void 0),(0,i.A)(this,"videoWaker",{wake:()=>{!this._isDestroyed&&this._isActive&&(this.pollVideo(),this._isStalled||this.root.requestRender(this))}}),this.root=e,this.videoStream=t}destroy(){this._isDestroyed=!0}isActive(e){return e>=this.start&&e<this.start+this.duration}isStalled(){return this._isStalled}load(){return Promise.resolve()}seek(){return Promise.resolve()}pause(){return Promise.resolve()}play(){return Promise.resolve()}update(e){this._lastUpdateTime=e;const t=this.isActive(e);t&&this.pollVideo(),this._isActive=t}render(e){this._currentFrame&&e.value.copy((0,s.rd)(this._currentFrame))}pollVideo(){const e=this.pollReadVideo(this.videoWaker,this._lastUpdateTime);if("pending"===e.type)return this._isStalled=!0,void(this._currentFrame=void 0);this._isStalled=!1,this._currentFrame={value:new o.Z(e.value)}}pollReadVideo(e,t){const r=this.videoStream.metadata;let i=r.displayWidth,o=r.displayHeight;if(this.videoTransform){const e=this.root.ctx.getRenderWidth(),t=this.root.ctx.getRenderHeight(),s=(0,n.v)(this.videoTransform,r.displayWidth/r.displayHeight,e/t);i=Math.floor(e*Math.abs(s.bounds.right-s.bounds.left)),o=Math.floor(t*Math.abs(s.bounds.top-s.bounds.bottom))}return this.root.reader.pollRead(e,this.videoStream.id,this.root.clock.mediaSecondsToTicks(t),{preferredWidth:i,preferredHeight:o})}}},350879:(e,t,r)=>{r.d(t,{B:()=>u,N:()=>d});var i=r(163460),n=r(324586),o=r(736766),s=r(129582);const a={name:"GaussBlurRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D inTex;\nuniform vec2 viewportSize;\nuniform vec2 direction;\nvarying vec2 texCoords;\n\nvoid main() {\n\n    vec4 color = vec4(0.0);\n    vec2 off1 = vec2(1.411764705882353) * direction;\n    vec2 off2 = vec2(3.2941176470588234) * direction;\n    vec2 off3 = vec2(5.176470588235294) * direction;\n    color += texture2D(inTex, texCoords) * 0.1964825501511404;\n    color += texture2D(inTex, texCoords + (off1 / viewportSize)) * 0.2969069646728344;\n    color += texture2D(inTex, texCoords - (off1 / viewportSize)) * 0.2969069646728344;\n    color += texture2D(inTex, texCoords + (off2 / viewportSize)) * 0.09447039785044732;\n    color += texture2D(inTex, texCoords - (off2 / viewportSize)) * 0.09447039785044732;\n    color += texture2D(inTex, texCoords + (off3 / viewportSize)) * 0.010381362401148057;\n    color += texture2D(inTex, texCoords - (off3 / viewportSize)) * 0.010381362401148057;\n\n   gl_FragColor = color;\n}\n",uniformNames:["viewportSize","direction"],samplerNames:["inTex"]};class c extends o.A{constructor(e){super(e,a),(0,n.A)(this,"viewportSizeUniform",void 0),(0,n.A)(this,"direction",void 0),(0,n.A)(this,"renderSampler",void 0),this.viewportSizeUniform=this.uniform("viewportSize",s.A.FLOAT_ARRAY_2),this.renderSampler=this.sampler("inTex"),this.direction=this.uniform("direction",s.A.FLOAT_ARRAY_2)}}const l=10;function d(e,t,r,n,o=l){if(0===o)return;const s=e.ctx.renderers.get(c),a=e.cloneImage(t),d=e.cloneImage(t);let u=r;for(let e=0;e<o;e++)s.direction.setFloatArray2([n,0]),(0,i.C)(s,a,u),s.direction.setFloatArray2([0,n]),e===o-1?(0,i.C)(s,t,a):((0,i.C)(s,d,a),u=d);a.free(),d.free()}function u(e,t,r=l){return{render(i,n){d(e,i,n,t,r)},shouldRender:()=>t>0}}},655624:(e,t,r)=>{r.d(t,{Q:()=>l});var i=r(163460),n=r(324586),o=r(736766),s=r(129582);const a={name:"GlitchRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D u_image;\nuniform float time;\nuniform float amount;\nuniform float speed;\nvarying vec2 texCoords;\n\nfloat sat(float t) { return clamp(t, 0.0, 1.0); }\nvec2 sat(vec2 t) { return clamp(t, 0.0, 1.0); }\n\n// note: [0;1]\nfloat rand(vec2 n) {\n  return fract(sin(dot(n.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat mytrunc(float x, float numLevels) {\n  return floor(x * numLevels) / numLevels;\n}\nvec2 mytrunc(vec2 x, vec2 numLevels) {\n  return floor(x * numLevels) / numLevels;\n}\n\nvec3 rgb2yuv(vec3 rgb) {\n  vec3 yuv;\n  yuv.x = dot(rgb, vec3(0.299, 0.587, 0.114));\n  yuv.y = dot(rgb, vec3(-0.14713, -0.28886, 0.436));\n  yuv.z = dot(rgb, vec3(0.615, -0.51499, -0.10001));\n  return yuv;\n}\n\nvec3 yuv2rgb(vec3 yuv) {\n  vec3 rgb;\n  rgb.r = yuv.x + yuv.z * 1.13983;\n  rgb.g = yuv.x + dot(vec2(-0.39465, -0.58060), yuv.yz);\n  rgb.b = yuv.x + yuv.y * 2.03211;\n  return rgb;\n}\n\n// Heavily taken from https://www.shadertoy.com/view/MdfGD2 - public domain\nvoid main() {\n  float normalTime = mod(time, 32.0);\n\n  float glitchThreshold = 1.0 - amount;\n  float maxOffset = amount;\n  float yuvThreshold = clamp(amount, 0., 1.);\n\n  const float minChangeFreq = 4.0;\n  float ct = mytrunc(normalTime, minChangeFreq);\n  float tf = speed * rand(mytrunc(texCoords.yy, vec2(16)) + 150.0 * ct);\n\n  float t = 5.0 * mytrunc(normalTime, tf);\n  float vtRand = 0.5 * rand(mytrunc(texCoords.yy + t, vec2(11)));\n  vtRand += 0.5 * rand(mytrunc(texCoords.yy + t, vec2(7)));\n  vtRand = vtRand * 2.0 - 1.0;\n  vtRand = sign(vtRand) *\n           sat((abs(vtRand) - glitchThreshold) / (1.0 - glitchThreshold));\n\n  vec2 uvNm = sat(texCoords + vec2(maxOffset * vtRand, 0));\n\n  // Lets use the lodEXT notation for Babylon native compat\n  vec4 smpl = texture2DLodEXT(u_image, uvNm, -10.0);\n  vec3 smplYuv = rgb2yuv(smpl.rgb);\n  smplYuv.y /= 1.0 - 3.0 * abs(vtRand) * sat(yuvThreshold - vtRand);\n  smplYuv.z += 0.125 * vtRand * sat(vtRand - yuvThreshold);\n  gl_FragColor = vec4(yuv2rgb(smplYuv), smpl.a);\n}\n",uniformNames:["time","amount","speed"],samplerNames:["u_image"]};class c extends o.A{constructor(e){super(e,a),(0,n.A)(this,"amount",void 0),(0,n.A)(this,"renderSampler",void 0),(0,n.A)(this,"speed",void 0),(0,n.A)(this,"time",void 0),this.renderSampler=this.sampler("u_image"),this.time=this.uniform("time",s.A.FLOAT),this.amount=this.uniform("amount",s.A.FLOAT),this.speed=this.uniform("speed",s.A.FLOAT)}}function l(e,t,r){return{render(n,o,s){!function(e,t,r,n,o,s){const a=e.ctx.renderers.get(c);a.time.setFloat(n),a.amount.setFloat(o),a.speed.setFloat(s),(0,i.C)(a,t,r)}(e,n,o,s.time,t,r)},shouldRender:()=>0!==t}}},893910:(e,t,r)=>{r.d(t,{y:()=>d});var i=r(163460),n=r(324586),o=r(736766),s=r(129582);const a={name:"SmokeRenderer",fragmentShader:'precision mediump float;\nuniform sampler2D u_image;\nuniform float time;\nvarying vec2 texCoords;\n\n// Based on Morgan McGuire @morgan3d\n// https://www.shadertoy.com/view/4dS3Wd\n\n/*\nCopyright 2014 Morgan McGuire @morgan3d, http://graphicscodex.com\n\nRedistribution and use in source and binary forms, with or without modification, are permitted\nprovided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this list of conditions\nand the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions\n and the following disclaimer in the documentation and/or other materials provided with the\n distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR\nIMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\nFITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\nCONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER\nIN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\nOF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nfloat hash(float p) {\n    p = fract(p * 0.011);\n    p *= p + 7.5;\n    p *= p + p;\n    return fract(p);\n}\n\nfloat hash(vec2 p) {\n    vec3 p3 = fract(vec3(p.xyx) * 0.13);\n    p3 += dot(p3, p3.yzx + 3.333);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\nfloat noise(vec2 x) {\n    vec2 i = floor(x);\n    vec2 f = fract(x);\n\n    // Four corners in 2D of a tile\n    float a = hash(i);\n    float b = hash(i + vec2(1., 0.));\n    float c = hash(i + vec2(0., 1.));\n    float d = hash(i + vec2(1., 1.));\n\n    // Optimized 2D lerp using smoothstep envelope between the values\n    vec2 u = f * f * (3. - 2. * f);\n    return mix(a, b, u.x) + (c - a) * u.y * (1. - u.x) + (d - b) * u.x * u.y;\n}\n\nfloat noise(vec3 x) {\n    const vec3 step = vec3(110., 241., 171.);\n\n    vec3 i = floor(x);\n    vec3 f = fract(x);\n\n    // For performance, compute the base input to a 1D hash from the integer\n    // part of the argument and the incremental change to the 1D based on the\n    // 3D -> 1D wrapping\n    float n = dot(i, step);\n\n    vec3 u = f * f * (3. - 2. * f);\n    return mix(mix(mix( hash(n + dot(step, vec3(0, 0, 0))), hash(n + dot(step, vec3(1, 0, 0))), u.x),\n                   mix( hash(n + dot(step, vec3(0, 1, 0))), hash(n + dot(step, vec3(1, 1, 0))), u.x), u.y),\n               mix(mix( hash(n + dot(step, vec3(0, 0, 1))), hash(n + dot(step, vec3(1, 0, 1))), u.x),\n                   mix( hash(n + dot(step, vec3(0, 1, 1))), hash(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);\n}\n\n#define NUM_OCTAVES 5\n\nfloat fbm(vec2 x) {\n    float v = 0.;\n    float a = 0.5;\n    vec2 shift = vec2(100.);\n\n    // Rotate to reduce axial bias\n    mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.5));\n    for (int i = 0; i < NUM_OCTAVES; ++i) {\n        v += a * noise(x);\n        x = rot * x * 2. + shift;\n        a *= 0.5;\n    }\n    return v;\n}\n\nfloat fbm(vec3 x) {\n    float v = 0.;\n    float a = 0.5;\n    vec3 shift = vec3(100.);\n    for (int i = 0; i < NUM_OCTAVES; ++i) {\n        v += a * noise(x);\n        x = x * 2. + shift;\n        a *= 0.5;\n    }\n    return v;\n}\n\n// pow does not support negative\nfloat workingPow3(float x) { return x * x * x; }\n\nvoid main() {\n    float modifiedTime = workingPow3(time - 0.5) * 8.;\n    float fadeTime = abs(modifiedTime) * 2.;\n\n    float verticalDisp = clamp(\n        fbm(texCoords * 10.) * modifiedTime,\n        -1., 1.\n    ) / 2.;\n    float horizontalDisp = clamp(\n        fbm(texCoords.yx * 5.) * modifiedTime,\n        -1., 1.\n    ) / 3.;\n    float smokeNoise = clamp(\n        fbm(vec3(texCoords * 3., time * 2.)),\n        0., 1.\n    );\n\n    vec2 offsetCoords = texCoords - vec2(horizontalDisp, verticalDisp);\n    vec4 tex = texture2D(u_image, offsetCoords);\n\n    // Output to screen\n    float lightness = clamp(tex.a * (1. - (fadeTime + smokeNoise)), 0., 1.);\n    gl_FragColor = tex * lightness;\n}\n',uniformNames:["time"],samplerNames:["u_image"]};class c extends o.A{constructor(e){super(e,a),(0,n.A)(this,"renderSampler",void 0),(0,n.A)(this,"time",void 0),this.renderSampler=this.sampler("u_image"),this.time=this.uniform("time",s.A.FLOAT)}}var l=r(187285);function d(e,t){return{render(t,r,n){!function(e,t,r,n){const o=e.ctx.renderers.get(c);o.time.setFloat((0,l.o)(n)),o.renderSampler.set(r.value.bindSampler()),(0,i.C)(o,t,r)}(e,t,r,n)},shouldRender:()=>t}}},148278:(e,t,r)=>{r.d(t,{X:()=>mt});var i=r(324586),n=(r(379321),r(463716)),o=r(914023),s=r(796748),a=r(586707),c=r(163460),l=r(736766),d=r(129582);const u={name:"ApplyAlphaRenderer",fragmentShader:"precision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_image;\nuniform float u_alpha;\n\nvoid main() {\n    gl_FragColor = texture2D(s_image, texCoords) * u_alpha;\n}\n",uniformNames:["u_alpha"],samplerNames:["s_image"]};class h extends l.A{constructor(e){super(e,u),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"alpha",void 0),this.renderSampler=this.sampler("s_image"),this.alpha=this.uniform("u_alpha",d.A.FLOAT)}}function p(e,t,r,i){const n=e.ctx.renderers.get(h);n.alpha.setFloat(i),(0,c.C)(n,t,r)}function m(e,t){return{render(r,i){p(e,r,i,t)},shouldRender:()=>1!==t}}const f={name:"BlackWhiteRemovalRenderer",fragmentShader:"precision mediump float;\nvarying vec2 texCoords;\nuniform sampler2D textureSampler;\nuniform float cutoff;\nuniform int color;\n\nmat3 rgb2yiq =\n        mat3(0.299, 0.596, 0.211, 0.587, -0.274, -0.523, 0.114, -0.322, 0.312);\n\nvoid main() {\n    vec4 base = texture2D(textureSampler, texCoords);\n    float luma = (base.rgb * rgb2yiq).x;\n\n    if (color == 1) {\n        // For white we invert the luma, so we can re-use the black algorithm.\n        luma = 1.0 - luma;\n    }\n\n    float alpha = luma / cutoff;\n    alpha = clamp(alpha, 0., 1.);\n    base.a *= alpha;\n\n    gl_FragColor = base * alpha;\n}\n",uniformNames:["cutoff","color"],samplerNames:["textureSampler"]};class g extends l.A{constructor(e){super(e,f),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"cutoff",void 0),(0,i.A)(this,"color",void 0),this.renderSampler=this.sampler("textureSampler"),this.cutoff=this.uniform("cutoff",d.A.FLOAT),this.color=this.uniform("color",d.A.INTEGER)}}function A(e,t,r,i){return{render(t,n,o){!function(e,t,r,i,n){const o=e.ctx.renderers.get(g);o.cutoff.setFloat(i),o.color.setInteger("black"===n?0:1),(0,c.C)(o,t,r)}(e,t,n,r,i)},shouldRender:()=>t}}var v=r(582982);const y={name:"BlendModeRenderer",fragmentShader:'precision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D baseSampler;\nuniform sampler2D blendSampler;\n\nuniform int blendMode;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n    vec4 baseSample = unmultAlpha(texture2D(baseSampler, texCoords));\n    vec4 blendSample = unmultAlpha(texture2D(blendSampler, texCoords));\n\n    vec3 base = baseSample.rgb;\n    vec3 blend = blendSample.rgb;\n\n    vec3 final = vec3(0.);\n\n    if (blendMode == 1) {\n        // Multiply\n        final = base * blend;\n    } else if (blendMode == 2) {\n        // Screen\n        final = 1.0 - (1.0 - base) * (1.0 - blend);\n    } else if (blendMode == 3) {\n        // Overlay\n        final.x = (base.r > 0.5) ? (1.0-(1.0-2.0*(base.r-0.5))*(1.0-blend.r)) : (2.0*base.r)*blend.r;\n        final.y = (base.g > 0.5) ? (1.0-(1.0-2.0*(base.g-0.5))*(1.0-blend.g)) : (2.0*base.g)*blend.g;\n        final.z = (base.b > 0.5) ? (1.0-(1.0-2.0*(base.b-0.5))*(1.0-blend.b)) : (2.0*base.b)*blend.b;\n    } else if (blendMode == 4) {\n        // Darken\n        final = min(base, blend);\n    } else if (blendMode == 5) {\n        // Lighten\n        final = max(base, blend);\n    } else if (blendMode == 6) {\n        // Color Dodge\n        final = min(base / (1.0 - blend), vec3(1.));\n    } else if (blendMode == 7) {\n        // Colour Burn\n        final = 1.0 - min((1.0 - base) / blend, vec3(1.0));\n    } else if (blendMode == 8) {\n        // Linear Dodge\n        final = min(base + blend, vec3(1.));\n    } else if (blendMode == 9) {\n        // Linear Burn\n        final = max(base + blend - 1.0, vec3(1.));\n    } else {\n        // Fallback case, treat as "Normal"\n        final = blend;\n    }\n\n    gl_FragColor = multAlpha(vec4(final, blendSample.a));\n}\n',uniformNames:["blendMode"],samplerNames:["blendSampler","baseSampler"]};class b extends l.A{constructor(e){super(e,y),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"baseSampler",void 0),(0,i.A)(this,"blendMode",void 0),this.renderSampler=this.sampler("blendSampler"),this.baseSampler=this.sampler("baseSampler"),this.blendMode=this.uniform("blendMode",d.A.INTEGER)}}const w=new Map([["normal",0],["multiply",1],["screen",2],["overlay",3],["darken",4],["lighten",5],["colordodge",6],["colorburn",7],["lineardodge",8],["linearburn",9]]);function x(e,t){return{render(r,i){!function(e,t,r,i){const n=e.ctx.renderers.get(b),o=e.cloneImage(t);o.value.copy((0,v.rd)(t)),n.blendMode.setInteger(w.get(i)??0),n.baseSampler.set(o.value.bindSampler()),n.renderSampler.set(r.value.bindSampler()),n.renderTo(t),o.free()}(e,r,i,t)},shouldRender:()=>"normal"!==t}}var S=r(284613),T=r(542809),C=r(735625),_=r(882196),k=r(472646),E=r(204411),I=r(609636),R=r(869211),F=r(476636);const P="attribute vec2 position;\n// attribute vec2 vertexUV;\nvarying vec2 texCoords;\nuniform mat3 u_transformMatrix;\nvoid main() {\n    texCoords = position * 0.5 + 0.5;\n    vec2 transformed = (u_transformMatrix * vec3(position, 1)).xy;\n    gl_Position = vec4(transformed, 0, 1);\n}\n",L={name:"LanczosLetterboxRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D s_in;\nvarying vec2 texCoords;\nuniform vec2 u_offset;\nuniform mat3 u_sampleMatrix;\nuniform bool u_showCropped;\n\nvoid main() {\n    vec4 color = vec4(0.);\n\n    // Generated by generateLanczosLetterbox.js\n    // 15 taps, kernel size of 2\n    color += texture2D(s_in, texCoords + u_offset * -1.75) * -0.004432973768954917;\n    color += texture2D(s_in, texCoords + u_offset * -1.5) * -0.015767000454914557;\n    color += texture2D(s_in, texCoords + u_offset * -1.25) * -0.02097620497352405;\n    color += texture2D(s_in, texCoords + u_offset * -0.75) * 0.058267236037566825;\n    color += texture2D(s_in, texCoords + u_offset * -0.5) * 0.141903004094231;\n    color += texture2D(s_in, texCoords + u_offset * -0.25) * 0.2172157146787908;\n    color += texture2D(s_in, texCoords) * 0.24758044877360952;\n    color += texture2D(s_in, texCoords + u_offset * 0.25) * 0.2172157146787908;\n    color += texture2D(s_in, texCoords + u_offset * 0.5) * 0.141903004094231;\n    color += texture2D(s_in, texCoords + u_offset * 0.75) * 0.058267236037566825;\n    color += texture2D(s_in, texCoords + u_offset * 1.25) * -0.02097620497352405;\n    color += texture2D(s_in, texCoords + u_offset * 1.5) * -0.015767000454914557;\n    color += texture2D(s_in, texCoords + u_offset * 1.75) * -0.004432973768954917;\n\n    vec2 a = (u_sampleMatrix * vec3(texCoords, 1)).xy;\n    float m = step(0., a.x) * step(0., a.y) * step(a.x, 1.) * step(a.y, 1.);\n    float m2 = mix(u_showCropped ? 0.5 : 0., 1., m);\n    gl_FragColor = mix(vec4(0., 0., 0., 0.), color, m2);\n}\n",vertexShader:P,uniformNames:["u_transformMatrix","u_sampleMatrix","u_showCropped","u_offset"],samplerNames:["s_in"]};class N extends l.A{constructor(e){super(e,L),(0,i.A)(this,"matrix",void 0),(0,i.A)(this,"sampleMatrix",void 0),(0,i.A)(this,"showCropped",void 0),(0,i.A)(this,"offset",void 0),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("s_in"),this.matrix=this.uniform("u_transformMatrix",d.A.MATRIX_3),this.sampleMatrix=this.uniform("u_sampleMatrix",d.A.MATRIX_3),this.showCropped=this.uniform("u_showCropped",d.A.BOOLEAN),this.offset=this.uniform("u_offset",d.A.FLOAT_ARRAY_2)}}const M={name:"LetterboxRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D inTex;\nvarying vec2 texCoords;\nuniform mat3 u_sampleMatrix;\nuniform bool u_showCropped;\n\nvoid main() {\n    vec2 a = (u_sampleMatrix * vec3(texCoords, 1)).xy;\n    float m = step(0., a.x) * step(0., a.y) * step(a.x, 1.) * step(a.y, 1.);\n    float m2 = mix(u_showCropped ? 0.5 : 0., 1., m);\n    gl_FragColor = mix(vec4(0., 0., 0., 0.), texture2D(inTex, texCoords), m2);\n}\n",vertexShader:P,uniformNames:["u_transformMatrix","u_sampleMatrix","u_showCropped"],samplerNames:["inTex"]};class B extends l.A{constructor(e){super(e,M),(0,i.A)(this,"matrix",void 0),(0,i.A)(this,"sampleMatrix",void 0),(0,i.A)(this,"showCropped",void 0),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("inTex"),this.matrix=this.uniform("u_transformMatrix",d.A.MATRIX_3),this.sampleMatrix=this.uniform("u_sampleMatrix",d.A.MATRIX_3),this.showCropped=this.uniform("u_showCropped",d.A.BOOLEAN)}}class D{constructor(e,t){(0,i.A)(this,"videoTransform",C.DR),(0,i.A)(this,"cropping",!1),this.root=e,this.generator=t}static calculateAutoplaceBounds(e,t,r=.15){return(0,_.e)(e,t,r)}static calculateAutoplacePosition(e,t){return(0,k.I)(e,t)}static calculateTransform(e,t,r,i){return(0,E.v)(e,t,r,i)}static calculateCropMatrix(e,t,r=1){return(0,I.O)(e,t,r)}calculateMatrix(e,t){const{bounds:r,crop:i}=e,o=r.right-r.left,s=r.top-r.bottom;let a,c,l,d;i?(a=o*(1-i.right-i.left),c=s*(1-i.bottom-i.top),l=r.left+i.left*o,d=r.bottom+i.bottom*s):(a=o,c=s,l=r.left,d=r.bottom);const u=[e.bounds.left>e.bounds.right?-1:1,e.bounds.bottom>e.bounds.top?-1:1],h=(l+a/2-(r.left+o/2))*u[0],p=(d+c/2-(r.bottom+s/2))*u[1];return n.d.identity.multiply(n.d.rotate(this.generator.rotation)).multiply(n.d.scale(o*t,s)).multiply(n.d.translate(-h*t*2,2*-p)).multiply(n.d.rotate(e.rotation)).multiply(n.d.translate(h*t*2,2*p)).multiply(n.d.scale(1/(o*t),1/s)).multiply(n.d.translate(1,1)).multiply(n.d.scale(o,s)).multiply(n.d.translate(2*r.left-1,2*r.bottom-1))}destroy(){this.generator.destroy()}render(e,t,r){if(0===this.generator.rotWidth||0===this.generator.rotHeight)return;const i=this.root.ctx.getRenderWidth(),o=this.root.ctx.getRenderHeight(),s=this.generator.rotWidth/this.generator.rotHeight,a=i/o,c=(0,E.v)(this.videoTransform,s,a),l=this.calculateMatrix(c,a),d=D.calculateCropMatrix(c,l,a),u=Math.floor(Math.abs(c.bounds.right-c.bounds.left)*i),h=Math.floor(Math.abs(c.bounds.bottom-c.bounds.top)*o),p=(0,R.y)(new F.Z(u,h),-this.generator.rotation).floor(),m=p.x<=this.generator.rotWidth/2||p.y<=this.generator.rotHeight/2;if(e.value.clear(),!m||t.value.hasValidMipmap){const i=this.root.ctx.renderers.get(B);i.matrix.setMatrix3(l.multiply(r.matrix)),i.sampleMatrix.setMatrix3(d),i.showCropped.setBoolean(this.cropping),i.renderSampler.set(t.value.bindSampler({minFilter:m?"prefer-mipmap":"linear",magFilter:"linear"})),i.renderTo(e)}else{const i=this.root.ctx.renderers.get(N);(0,v.Ww)(this.root.allocImage(!1,p.x,this.generator.rotHeight))((o=>{i.matrix.setMatrix3(n.d.identity),i.sampleMatrix.setMatrix3(n.d.identity),i.showCropped.setBoolean(!1),i.offset.setFloatArray2([1/p.x,0]),i.renderSampler.set(t.value.bindSampler()),i.renderTo(o),i.matrix.setMatrix3(l.multiply(r.matrix)),i.sampleMatrix.setMatrix3(d),i.showCropped.setBoolean(this.cropping),i.offset.setFloatArray2([0,1/p.y]),i.renderSampler.set(o.value.bindSampler()),i.renderTo(e)}))}}}const O={name:"ColorBalanceRenderer",fragmentShader:"precision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_image;\nuniform float u_exposure;\nuniform float u_saturation;\nuniform float u_temperature;\nuniform float u_contrast;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nfloat luminance(vec3 color) {\n    return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n}\n\nvec3 applyExposure(vec3 color, float exposure) {\n    return color * exposure;\n}\n\nvec3 applySaturation(vec3 color, float saturation) {\n    return mix(color, vec3(luminance(color)), -saturation);\n}\n\nvec3 applyTemperature(vec3 color, float temperature) {\n    const vec3 warmFilter = vec3(0.93, 0.54, 0.);\n\n    vec3 lo = 2. * color * warmFilter;\n    vec3 hi = 1. - 2. * (1. - color) * (1. - warmFilter);\n\n    vec3 fullyWarm = vec3(\n        color.r < 0.5 ? lo.r : hi.r,\n        color.g < 0.5 ? lo.g : hi.g,\n        color.b < 0.5 ? lo.b : hi.b\n    );\n    return mix(color, fullyWarm, temperature);\n}\n\nvec3 applyContrast(vec3 color, float contrast) {\n    return (color - 0.5) * contrast + 0.5;\n}\n\nvoid main() {\n    vec4 originColor = unmultAlpha(texture2D(s_image, texCoords));\n\n    vec3 processColor = originColor.rgb;\n    processColor = applyExposure(processColor, 1. + u_exposure);\n    processColor = applySaturation(processColor, u_saturation);\n    processColor = applyTemperature(processColor, u_temperature);\n    processColor = applyContrast(processColor, 1. + u_contrast);\n\n    gl_FragColor = multAlpha(vec4(processColor, originColor.a));\n}\n",uniformNames:["u_exposure","u_saturation","u_temperature","u_contrast"],samplerNames:["s_image"]};class j extends l.A{constructor(e){super(e,O),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"exposure",void 0),(0,i.A)(this,"saturation",void 0),(0,i.A)(this,"temperature",void 0),(0,i.A)(this,"contrast",void 0),this.renderSampler=this.sampler("s_image"),this.exposure=this.uniform("u_exposure",d.A.FLOAT),this.saturation=this.uniform("u_saturation",d.A.FLOAT),this.temperature=this.uniform("u_temperature",d.A.FLOAT),this.contrast=this.uniform("u_contrast",d.A.FLOAT)}}const U={exposure:0,saturation:0,temperature:0,contrast:0};function z(e,t,r,i){const n=e.ctx.renderers.get(j);n.exposure.setFloat(i.exposure),n.saturation.setFloat(i.saturation),n.temperature.setFloat(i.temperature),n.contrast.setFloat(i.contrast),(0,c.C)(n,t,r)}var W=r(350879);function V(e,t,r,i){return{disableLetterbox:!0,render(t,o,s){!function(e,t,r,i,o,s){const a=new D(e,o);a.videoTransform=s;const c=new D(e,o);c.videoTransform={...T.DR,strategy:"fill"},t.value.clear();const l=S.T.wrap(t);(0,v.Ww)(e.cloneImage(t))((t=>{c.render(t,r,{...i,matrix:n.d.identity}),(0,W.N)(e,t,t,5,15),z(e,l,t,{...U,exposure:-.4})})),a.render(l,r,i)}(e,t,o,s,r,i)},shouldRender:()=>t&&"fill"!==i.strategy}}const H={name:"BrokenGlassRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D u_image;\nuniform float time;\nvarying vec2 texCoords;\n\nfloat timeFn() {\n  float x = time / 1.8 - 0.2;\n\n  float a = .6;\n  float y = 0.;\n  y += 1.2 * smoothstep(0., a, x) / (1. / a);\n  y += 3. * pow(max(x, 0.8) - 0.8, 2.);\n  y += x / 10.;\n\n  return y;\n}\n\nfloat mask(vec2 st) {\n    return clamp(-abs(350. * (st.x - 1.38 * timeFn() + .20 + .18 * st.y)) + 50., 0., 1.);\n}\n\nfloat shadowMask(vec2 st) {\n    return clamp(-abs(10. * (st.x - 1.38 * timeFn() + .14 + .18 * st.y)) + 1.9, 0., 1.);\n}\n\nvec4 shadow(vec2 st) {\n  return vec4(vec3(0.), smoothstep(0., 1., shadowMask(st) * 0.5));\n}\n\nvoid main() {\n    vec4 color = texture2D(u_image, texCoords * 0.7 + 0.15);\n    vec2 uv = texCoords;\n\n    color = vec4(color.rgb, mask(uv) * color.a);\n\n    color = mix(shadow(uv), vec4(color.rgb, 1.), color.a);\n\n    gl_FragColor = color;\n}\n\n",uniformNames:["time"],samplerNames:["u_image"]};class G extends l.A{constructor(e){super(e,H),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"time",void 0),this.renderSampler=this.sampler("u_image"),this.time=this.uniform("time",d.A.FLOAT)}}var q=r(187285);function Q(e,t){return{render(t,r,i){!function(e,t,r,i){const n=e.ctx.renderers.get(G);n.time.setFloat((0,q.A)(i)),t.value.clear();const o=S.T.wrap(t);(0,W.N)(e,o,r,2),(0,c.C)(n,o,r)}(e,t,r,i)},shouldRender:()=>0!==Math.round(t)}}const K={name:"ChromaticAberrationRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D u_image;\nuniform float time;\nuniform float amount;\nvarying vec2 texCoords;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n  float offset = 0.005 + abs(0.01 * sin(time) * amount);\n\n  vec2 rOffset = vec2(0. + offset, 0.);\n  vec2 bOffset = vec2(0. - offset, 0.);\n\n  vec4 base = unmultAlpha(texture2D(u_image, texCoords));\n  vec4 r = unmultAlpha(texture2D(u_image, texCoords + rOffset));\n  vec4 b = unmultAlpha(texture2D(u_image, texCoords + bOffset));\n\n  gl_FragColor = multAlpha(vec4(r.r, base.g, b.b, max(r.a, max(base.a, b.a))));\n}\n",uniformNames:["time","amount"],samplerNames:["u_image"]};class X extends l.A{constructor(e){super(e,K),(0,i.A)(this,"amount",void 0),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"time",void 0),this.renderSampler=this.sampler("u_image"),this.time=this.uniform("time",d.A.FLOAT),this.amount=this.uniform("amount",d.A.FLOAT)}}function Y(e,t){return{render(r,i,n){!function(e,t,r,i,n){const o=e.ctx.renderers.get(X);o.time.setFloat(i),o.amount.setFloat(n),(0,c.C)(o,t,r)}(e,r,i,n.time,t)},shouldRender:()=>0!==t}}const Z={name:"HueShiftRenderer",fragmentShader:"precision mediump float;\nvarying vec2 texCoords;\nuniform sampler2D image;\nuniform float newHue;\n\nvec3 hueShift( vec3 color, float hueAdjust ){\n    if (color.r == 1. && color.g == 1. && color.b == 1.) {\n        return color;\n    }\n    const vec3 kRGBToYPrime = vec3(0.299, 0.587, 0.114);\n    const vec3 kRGBToI = vec3(0.596, -0.275, -0.321);\n    const vec3 kRGBToQ = vec3(0.212, -0.523, 0.311);\n\n    const vec3 kYIQToR = vec3(1.0, 0.956, 0.621);\n    const vec3 kYIQToG = vec3(1.0, -0.272, -0.647);\n    const vec3 kYIQToB = vec3(1.0, -1.107, 1.704);\n\n    float YPrime = dot(color, kRGBToYPrime);\n    float I = dot(color, kRGBToI);\n    float Q = dot(color, kRGBToQ);\n    float hue = atan(Q, I);\n    float chroma = sqrt(I * I + Q * Q);\n\n    hue += hueAdjust;\n\n    Q = chroma * sin(hue);\n    I = chroma * cos(hue);\n\n    vec3 yIQ = vec3(YPrime, I, Q);\n\n    return vec3(dot(yIQ, kYIQToR), dot(yIQ, kYIQToG), dot(yIQ, kYIQToB));\n}\n\nvoid main() {\n    vec4 tex = texture2D(image, texCoords);\n    vec3 rgb = tex.xyz;\n    gl_FragColor = vec4(hueShift(rgb, newHue), tex.a);\n}",uniformNames:["newHue"],samplerNames:["image"]};class J extends l.A{constructor(e){super(e,Z),(0,i.A)(this,"hue",void 0),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("image"),this.hue=this.uniform("newHue",d.A.FLOAT)}}function $(e,t){return{render(t,r,i){!function(e,t,r,i){const n=e.ctx.renderers.get(J);n.hue.setFloat(i*Math.PI),(0,c.C)(n,t,r)}(e,t,r,i.time)},shouldRender:()=>t}}var ee=r(329506);var te=r(532203);const re={name:"DiffusionRenderer",fragmentShader:"precision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_base;\nuniform sampler2D s_blend;\n\nuniform float u_strength;\n\nvec4 unmultAlpha(vec4 color) {\n    if(color.a == 0.)\n        return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n    float clampAmount = 1.0 - u_strength;\n    float opacity = u_strength;\n    vec4 baseSample = unmultAlpha(texture2D(s_base, texCoords));\n    vec4 blendSample = unmultAlpha(texture2D(s_blend, texCoords));\n\n    vec3 base = baseSample.rgb;\n    vec3 blend = max(blendSample.rgb - clampAmount, vec3(0.)) / clampAmount;\n\n    // add blend\n    vec3 final = max(base, blend * opacity);\n\n    gl_FragColor = multAlpha(vec4(final, baseSample.a));\n}\n",uniformNames:["u_strength"],samplerNames:["s_base","s_blend"]};class ie extends l.A{constructor(e){super(e,re),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"baseSampler",void 0),(0,i.A)(this,"strength",void 0),this.baseSampler=this.sampler("s_base"),this.renderSampler=this.sampler("s_blend"),this.strength=this.uniform("u_strength",d.A.FLOAT)}}function ne(e,t){const{strength:r}=t||(0,te.R)();return{render(t,i){!function(e,t,r,i){const n=e.cloneImage(r),o=10*i;(0,W.N)(e,n,r,o);const s=e.ctx.renderers.get(ie);s.baseSampler.set(r.value.bindSampler()),s.renderSampler.set(n.value.bindSampler()),s.strength.setFloat(i),s.renderTo(t),n.free()}(e,t,i,r)},shouldRender:()=>!!t}}const oe={name:"TintRenderer",fragmentShader:"precision mediump float;\nvarying vec2 texCoords;\nuniform sampler2D image;\nuniform vec3 color;\n\nfloat blendOverlay(float base, float blend) {\n    return base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend));\n}\n\nvec3 blendOverlay(vec3 base, vec3 blend) {\n    return vec3(blendOverlay(base.r, blend.r), blendOverlay(base.g, blend.g), blendOverlay(base.b, blend.b));\n}\n\nvec3 blendHardLight(vec3 base, vec3 blend) {\n    return blendOverlay(blend,base);\n}\n\nvec3 blendHardLight(vec3 base, vec3 blend, float opacity) {\n    return (blendHardLight(base, blend) * opacity + base * (1.0 - opacity));\n}\n\nvoid main() {\n    vec4 tex = texture2D(image, texCoords);\n    vec3 rgb = tex.xyz;\n    gl_FragColor = vec4(blendHardLight(rgb, color, 0.6), tex.a);\n}",uniformNames:["color"],samplerNames:["image"]};class se extends l.A{constructor(e){super(e,oe),(0,i.A)(this,"color",void 0),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("image"),this.color=this.uniform("color",d.A.FLOAT_ARRAY_3)}}const ae=[[.47,0,.141],[.47,.141,0],[.489,.47,0],[.236,0,.47],[0,.47,.13],[0,.47,.44],[.0078,0,.47]];function ce(e,t){return{render(t,r,i){!function(e,t,r,i){const n=e.ctx.renderers.get(se),o=Math.floor(i/.4)%ae.length;n.color.setFloatArray3(ae[o]),(0,c.C)(n,t,r)}(e,t,r,i.time)},shouldRender:()=>t}}const le={name:"FilmGrainRenderer",fragmentShader:"precision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_image;\nuniform float u_strength;\nuniform float u_seed;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n    vec4 color = unmultAlpha(texture2D(s_image, texCoords));\n\n    // from https://www.shadertoy.com/view/4dBcDK (licensed under CC0)\n    float grainStrength = 50. * u_strength;\n    float x = (texCoords.x + 4.) * (texCoords.y + 4.) * (u_seed + 10.) * 10.;\n    float grain = clamp(mod((mod(x, 13.0) + 1.0) * (mod(x, 123.0) + 1.0), 0.01) - 0.005, 0.0, 1.0) * grainStrength;\n    color.rgb *= 1. - grain;\n\n    gl_FragColor = multAlpha(color);\n}\n",uniformNames:["u_strength","u_seed"],samplerNames:["s_image"]};class de extends l.A{constructor(e){super(e,le),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"strength",void 0),(0,i.A)(this,"seed",void 0),this.renderSampler=this.sampler("s_image"),this.strength=this.uniform("u_strength",d.A.FLOAT),this.seed=this.uniform("u_seed",d.A.FLOAT)}}function ue(e,t){return{render(r,i,n){!function(e,t,r,i,n){const o=e.ctx.renderers.get(de);o.strength.setFloat(i),o.seed.setFloat(n),(0,c.C)(o,t,r)}(e,r,i,t,n.time)},shouldRender:()=>0!==t}}function he(e){return void 0!==e.render}var pe=r(294258);function me(e,t){const{speed:r,fade:i}=t??(0,pe.E)();return{render(t,n,o){!function(e,t,r,i,n,o){let s=i.time-i.start;s*=n;const a=2*Math.PI*s;let c=(Math.cos(a)+1)/2;o||(c=c>.5?1:0),p(e,t,r,c)}(e,t,n,o,r,i)},shouldRender:()=>!!t}}var fe=r(655624),ge=r(177191);const Ae={name:"GlowRenderer",fragmentShader:"precision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_base;\nuniform sampler2D s_blend;\n\nuniform float u_strength;\n\nvec4 unmultAlpha(vec4 color) {\n    if(color.a == 0.)\n        return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n    float clampAmount = 1.0 - u_strength;\n    float opacity = u_strength;\n    vec4 baseSample = unmultAlpha(texture2D(s_base, texCoords));\n    vec4 blendSample = unmultAlpha(texture2D(s_blend, texCoords));\n\n    vec3 base = baseSample.rgb;\n    vec3 blend = max(blendSample.rgb - clampAmount, vec3(0.)) / clampAmount;\n\n    // add blend\n    vec3 final = base + blend * opacity;\n\n    gl_FragColor = multAlpha(vec4(final, baseSample.a));\n}\n",uniformNames:["u_strength"],samplerNames:["s_base","s_blend"]};class ve extends l.A{constructor(e){super(e,Ae),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"baseSampler",void 0),(0,i.A)(this,"strength",void 0),this.baseSampler=this.sampler("s_base"),this.renderSampler=this.sampler("s_blend"),this.strength=this.uniform("u_strength",d.A.FLOAT)}}function ye(e,t){const{strength:r}=t||(0,ge.d)();return{render(t,i){!function(e,t,r,i){const n=e.cloneImage(r),o=10*i;(0,W.N)(e,n,r,o);const s=e.ctx.renderers.get(ve);s.baseSampler.set(r.value.bindSampler()),s.renderSampler.set(n.value.bindSampler()),s.strength.setFloat(i),s.renderTo(t),n.free()}(e,t,i,r)},shouldRender:()=>!!t}}const be={name:"GreenScreenRenderer",fragmentShader:"precision mediump float;\nvarying vec2 texCoords;\nuniform sampler2D textureSampler;\nuniform float cutoff;\nuniform int colorIndex;\n\nvoid main() {\n    vec4 color = texture2D(textureSampler, texCoords);\n    float alpha;\n\n    if (colorIndex == 0) {\n        alpha = 1.0 - (color.r - max(color.g, color.b)) / cutoff;\n    } else if (colorIndex == 1) {\n        alpha = 1.0 - (color.g - max(color.r, color.b)) / cutoff;\n    } else if (colorIndex == 2) {\n        alpha = 1.0 - (color.b - max(color.r, color.g)) / cutoff;\n    }\n    alpha = clamp(alpha, 0., 1.);\n    if (colorIndex == 0) {\n        color.r *= alpha;\n    } else if (colorIndex == 1) {\n        color.g *= alpha;\n    } else if (colorIndex == 2) {\n        color.b *= alpha;\n    }\n    gl_FragColor = color * alpha;\n}\n",uniformNames:["cutoff","colorIndex"],samplerNames:["textureSampler"]};class we extends l.A{constructor(e){super(e,be),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"cutoff",void 0),(0,i.A)(this,"colorIndex",void 0),this.renderSampler=this.sampler("textureSampler"),this.cutoff=this.uniform("cutoff",d.A.FLOAT),this.colorIndex=this.uniform("colorIndex",d.A.INTEGER)}}const xe={r:0,g:1,b:2};function Se(e,t,r,i){return{render(t,n,o){!function(e,t,r,i,n){const o=e.ctx.renderers.get(we);o.cutoff.setFloat(i),o.colorIndex.setInteger(xe[n]??1),(0,c.C)(o,t,r)}(e,t,n,r,i)},shouldRender:()=>t}}const Te={name:"BilateralBlurRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D s_base;\nuniform sampler2D s_unblurred;\nuniform vec2 u_viewport_size;\nuniform vec2 u_direction;\nvarying vec2 texCoords;\n\nconst int SIZE = 7;\nconst float BSIGMA = 0.1;\n\nvec4 unmult_alpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 mult_alpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nfloat normpdf3(vec4 v) {\n    return 0.39894 * exp(-0.5 * dot(v,v) / (BSIGMA * BSIGMA)) / BSIGMA;\n}\n\nvec4 bilateral13(vec2 uv, vec2 resolution, vec2 u_direction) {\n    vec4 base_color = unmult_alpha(texture2D(s_unblurred, uv));\n\n    float kernel[SIZE];\n    kernel[0] = kernel[6] = 0.010381362401148057;\n    kernel[1] = kernel[5] = 0.09447039785044732;\n    kernel[2] = kernel[4] = 0.2969069646728344;\n    kernel[3] = 0.1964825501511404;\n\n    vec2 offsets[SIZE];\n    offsets[0] = offsets[6] = vec2(5.176470588235294);\n    offsets[1] = offsets[5] = vec2(3.2941176470588234);\n    offsets[2] = offsets[4] = vec2(1.411764705882353);\n    offsets[3] = vec2(0.);\n\n    vec4 color = vec4(0.);\n    float weight = 0.;\n\n    for (int i = 0; i < SIZE; i++) {\n        vec2 offset = u_direction * offsets[i] / resolution;\n        if (i < SIZE/2) offset *= -1.;\n\n        vec4 sample_color = unmult_alpha(texture2D(s_base, uv + offset));\n        float sample_weight = normpdf3(sample_color - base_color) * kernel[i];\n\n        color += sample_color * sample_weight;\n        weight += sample_weight;\n    }\n\n    return color / weight;\n}\n\nvoid main() {\n    gl_FragColor = mult_alpha(bilateral13(texCoords, u_viewport_size, u_direction));\n}\n",uniformNames:["u_viewport_size","u_direction"],samplerNames:["s_base","s_unblurred"]};class Ce extends l.A{constructor(e){super(e,Te),(0,i.A)(this,"viewportSizeUniform",void 0),(0,i.A)(this,"direction",void 0),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"originalSampler",void 0),this.renderSampler=this.sampler("s_base"),this.originalSampler=this.sampler("s_unblurred"),this.viewportSizeUniform=this.uniform("u_viewport_size",d.A.FLOAT_ARRAY_2),this.direction=this.uniform("u_direction",d.A.FLOAT_ARRAY_2)}}const _e={name:"HalftoneComicRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D s_blurred;\nuniform sampler2D s_unblurred;\nuniform vec2 u_viewport_size;\nuniform float u_halftone_intensity;\nvarying vec2 texCoords;\n\nvec4 unmult_alpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 mult_alpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\n/// SOBEL EDGE DETECTION\nconst mat3 SOBEL_X = mat3(\n    1., 2., 1.,\n    0., 0., 0.,\n    -1., -2., -1.\n);\nconst mat3 SOBEL_Y = mat3(\n    1.0, 0., -1.,\n    2., 0., -2.,\n    1., 0., -1.\n);\n\nfloat sobel_gradient_magnitude(mat3 I) {\n    float gx = dot(SOBEL_X[0], I[0]) + dot(SOBEL_X[1], I[1]) + dot(SOBEL_X[2], I[2]);\n    float gy = dot(SOBEL_Y[0], I[0]) + dot(SOBEL_Y[1], I[1]) + dot(SOBEL_Y[2], I[2]);\n\n    return sqrt(pow(gx, 2.) + pow(gy, 2.));\n}\n\nfloat sobel_detect_edges(vec2 uv) {\n    mat3 R, G, B;\n\n    for (int i = 0; i < 3; i++) {\n        for (int j = 0; j < 3; j++) {\n            vec2 offset = vec2(float(i - 1), float(j - 1)) / u_viewport_size;\n            vec3 color = unmult_alpha(texture2D(s_unblurred, uv + offset)).rgb;\n\n            R[i][j] = color.r;\n            G[i][j] = color.g;\n            B[i][j] = color.b;\n        }\n    }\n\n    return (\n        sobel_gradient_magnitude(R)\n        + sobel_gradient_magnitude(G)\n        + sobel_gradient_magnitude(B)\n    ) / 3.;\n}\n\n/// HALFTONE PATTERN\n\n// Dot grid sizes relative to viewport height\nconst float HALFTONE_DOT_SIZE = 0.005;\nconst float HALFTONE_GRID_SIZE = 0.0067;\n\nconst float HALFTONE_EDGE = 0.888;\n\nconst mat2 HALFTONE_ROTATION = mat2(\n    0.707, -0.707,\n    0.707, 0.707\n);\n\nvec4 rgb_to_cmyki(vec3 c) {\n    float k = max(max(c.r, c.g), c.b);\n    return min(vec4(c / k, k), 1.);\n}\n\nvec3 cmyki_to_rgb(vec4 c) {\n    return c.rgb * c.a;\n}\n\nvec2 grid(vec2 px) {\n    return px - mod(px, HALFTONE_GRID_SIZE);\n}\n\nvec4 halftone_edge(vec4 gradient) {\n    float dot_size_pixels = HALFTONE_DOT_SIZE * u_viewport_size.y;\n    float pixel_gradient = 1. / dot_size_pixels;\n\n    return smoothstep(HALFTONE_EDGE - pixel_gradient, HALFTONE_EDGE + pixel_gradient, gradient);\n}\n\nvec3 halftone(vec2 uv) {\n    float aspect = u_viewport_size.x / u_viewport_size.y;\n\n    vec2 center_coords = uv - 0.5;\n    center_coords.x *= aspect;\n\n    vec2 grid_coords = (grid(HALFTONE_ROTATION * center_coords) + 0.5 * HALFTONE_GRID_SIZE) * HALFTONE_ROTATION;\n\n    vec2 grid_uv = grid_coords;\n    grid_uv.x /= aspect;\n    grid_uv += 0.5;\n\n    float gradient = min(length(center_coords - grid_coords) / HALFTONE_DOT_SIZE, 1.);\n\n    vec4 color_rgb = unmult_alpha(texture2D(s_unblurred, grid_uv));\n    color_rgb = pow(color_rgb, vec4(2.2));\n    vec4 color_cmyki = rgb_to_cmyki(color_rgb.rgb);\n    vec3 applied_rgb = cmyki_to_rgb(halftone_edge(color_cmyki + gradient));\n    applied_rgb = pow(applied_rgb, vec3(1. / 2.2));\n\n    return applied_rgb;\n}\n\nvoid main() {\n    vec4 fill_color = unmult_alpha(texture2D(s_blurred, texCoords));\n    vec3 halftone_color = halftone(texCoords);\n\n    float edges = sobel_detect_edges(texCoords);\n    if (edges < 0.05) {\n        edges = 0.;\n    }\n\n    gl_FragColor = mult_alpha(\n        vec4(\n            max(mix(fill_color.rgb, halftone_color, u_halftone_intensity) - edges, vec3(0.)),\n            fill_color.a\n        )\n    );\n}\n",uniformNames:["u_viewport_size","u_halftone_intensity"],samplerNames:["s_blurred","s_unblurred"]};class ke extends l.A{constructor(e){super(e,_e),(0,i.A)(this,"blurredSampler",void 0),(0,i.A)(this,"baseSampler",void 0),(0,i.A)(this,"viewportSizeUniform",void 0),(0,i.A)(this,"halftoneIntensity",void 0),this.blurredSampler=this.sampler("s_blurred"),this.baseSampler=this.sampler("s_unblurred"),this.viewportSizeUniform=this.uniform("u_viewport_size",d.A.FLOAT_ARRAY_2),this.halftoneIntensity=this.uniform("u_halftone_intensity",d.A.FLOAT)}}function Ee(e,t,r){return{render(t,i){!function(e,t,r,i){const n=e.ctx.renderers.get(Ce),o=e.ctx.renderers.get(ke);(0,v.Ww)(e.cloneImage(r),e.cloneImage(r))(((e,s)=>{n.originalSampler.set(r.value.bindSampler()),n.direction.setFloatArray2([1,0]),(0,c.C)(n,e,r),n.direction.setFloatArray2([0,1]),(0,c.C)(n,s,e),n.direction.setFloatArray2([1,0]),(0,c.C)(n,e,s),n.direction.setFloatArray2([0,1]),(0,c.C)(n,s,e),o.baseSampler.set(r.value.bindSampler()),o.blurredSampler.set(s.value.bindSampler()),o.halftoneIntensity.setFloat(i),o.renderTo(t)}))}(e,t,i,r)},shouldRender:()=>t}}var Ie=r(320043);const Re={name:"KaleidoscopeRenderer",vertexShader:"precision mediump float;\n\nattribute vec2 position;\n\nvarying vec2 texCoords;\n\nuniform mat3 u_matrix;\nuniform mat3 u_uv_matrix;\n\nvoid main() {\n    vec2 vertexUV = position * 0.5 + 0.5;\n    texCoords = (u_uv_matrix * vec3(vertexUV, 1.0)).xy;\n\n    vec3 transformedPosition = u_matrix * vec3(position, 1.0);\n    gl_Position = vec4(transformedPosition, 1.0);\n}\n",fragmentShader:"precision mediump float;\n\n#define PI 3.14159\n\nuniform sampler2D s_image;\nuniform float u_time;\nuniform float u_speed;\nuniform float u_segments;\nuniform vec4 u_bounds;// top, left, bottom, right\nuniform bool u_enable_color_shift;\n\nvarying vec2 texCoords;\n\nvec3 hueShift(vec3 color, float hueAdjust) {\n    if(color.r == 1. && color.g == 1. && color.b == 1.) {\n        return color;\n    }\n    const vec3 kRGBToYPrime = vec3(.299, .587, .114);\n    const vec3 kRGBToI = vec3(.596, -.275, -.321);\n    const vec3 kRGBToQ = vec3(.212, -.523, .311);\n\n    const vec3 kYIQToR = vec3(1., .956, .621);\n    const vec3 kYIQToG = vec3(1., -.272, -.647);\n    const vec3 kYIQToB = vec3(1., -1.107, 1.704);\n\n    float YPrime = dot(color, kRGBToYPrime);\n    float I = dot(color, kRGBToI);\n    float Q = dot(color, kRGBToQ);\n    float hue = atan(Q, I);\n    float chroma = sqrt(I * I + Q * Q);\n\n    hue += hueAdjust;\n\n    Q = chroma * sin(hue);\n    I = chroma * cos(hue);\n\n    vec3 yIQ = vec3(YPrime, I, Q);\n\n    return vec3(dot(yIQ, kYIQToR), dot(yIQ, kYIQToG), dot(yIQ, kYIQToB));\n}\n\nvoid main(void) {\n    float width = u_bounds.w - u_bounds.y;\n    float height = u_bounds.x - u_bounds.z;\n    vec2 scaledCoord = vec2((texCoords.x - u_bounds.y) / width, (texCoords.y - u_bounds.z) / height);\n    vec2 uv = scaledCoord * 2. - 1.;\n\n    // get angle and radius\n    float radius = length(uv);\n    float angle = atan(uv.y, uv.x) / PI * u_segments;\n\n    // repeat segment\n    if(mod(angle, 2.) >= 1.) {\n        angle = fract(angle);\n    } else {\n        angle = 1. - fract(angle);\n    }\n    angle += u_time * u_speed * 5.;\n\n    // unsquash segment\n    angle /= u_segments;\n    angle *= PI * 2.;\n\n    // control speed\n    angle *= u_speed * 2.;\n\n    // set coord for sampler\n    vec2 point = vec2(radius * cos(angle), radius * sin(angle));\n    point = fract(point);\n\n    point = vec2(point.x * width + u_bounds.y, point.y * height + u_bounds.z);\n    vec4 tex = texture2D(s_image, point);\n\n    if(u_enable_color_shift) {\n        gl_FragColor = vec4(hueShift(tex.xyz, u_time * u_speed * PI * 2.), tex.a);\n    } else {\n        gl_FragColor = tex;\n    }\n}\n",uniformNames:["u_time","u_speed","u_segments","u_matrix","u_uv_matrix","u_bounds","u_enable_color_shift"],samplerNames:["s_image"]};class Fe extends l.A{constructor(e){super(e,Re),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"time",void 0),(0,i.A)(this,"speed",void 0),(0,i.A)(this,"segments",void 0),(0,i.A)(this,"enableColorShift",void 0),(0,i.A)(this,"matrix",void 0),(0,i.A)(this,"uvMatrix",void 0),(0,i.A)(this,"bounds",void 0),this.renderSampler=this.sampler("s_image"),this.time=this.uniform("u_time",d.A.FLOAT),this.speed=this.uniform("u_speed",d.A.FLOAT),this.segments=this.uniform("u_segments",d.A.FLOAT),this.matrix=this.uniform("u_matrix",d.A.MATRIX_3),this.uvMatrix=this.uniform("u_uv_matrix",d.A.MATRIX_3),this.bounds=this.uniform("u_bounds",d.A.FLOAT_ARRAY_4),this.enableColorShift=this.uniform("u_enable_color_shift",d.A.BOOLEAN)}}function Pe(e,t,r){const{speed:i,segments:o,enableColorShift:s}={...(0,Ie.x)(),...r};return{render(r,a,l){!function(e,t,r,i,o,s,a,l){const d=e.ctx.renderers.get(Fe);d.speed.setFloat(o),d.segments.setFloat(s),d.enableColorShift.setBoolean(a),d.time.setFloat(l),d.matrix.setMatrix3(n.d.translate(1,1).multiply(n.d.scale(i.right-i.left,i.top-i.bottom)).multiply(n.d.translate(2*i.left-1,2*i.bottom-1))),d.uvMatrix.setMatrix3(n.d.scale(i.right-i.left,i.top-i.bottom).multiply(n.d.translate(i.left,i.bottom))),d.bounds.setFloatArray4([i.top,i.left,i.bottom,i.right]),(0,c.C)(d,t,r)}(e,r,a,t,i,o,s,l.time)},shouldRender:()=>!!r}}var Le=r(165223);const Ne={name:"LutRenderer",fragmentShader:"precision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D s_image;\nuniform sampler2D s_lut;\nuniform float intensity;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvec3 lookup(vec2 colorRg, float blueInt) {\n    vec2 quad;\n    quad.y = floor(blueInt / 8.);\n    quad.x = blueInt - quad.y * 8.;\n\n    vec2 texPos;\n    texPos.x = (quad.x * 0.125) + 0.5 / 512. + ((0.125 - 1. / 512.) * colorRg.r);\n    texPos.y = (quad.y * 0.125) + 0.5 / 512. + ((0.125 - 1. / 512.) * colorRg.g);\n\n    // lut texture is loaded flipped\n    texPos.y = 1. - texPos.y;\n\n    return texture2D(s_lut, texPos).rgb;\n}\n\nvoid main() {\n    vec4 originColor = unmultAlpha(texture2D(s_image, texCoords));\n\n    float blueColor = originColor.b * 63.;\n    vec3 newLo = lookup(originColor.rg, floor(blueColor));\n    vec3 newHi = lookup(originColor.rg, ceil(blueColor));\n    vec3 newColor = mix(newLo, newHi, fract(blueColor));\n\n    gl_FragColor = multAlpha(vec4(mix(originColor.rgb, newColor, intensity), originColor.a));\n}\n",uniformNames:["intensity"],samplerNames:["s_image","s_lut"]};class Me extends l.A{constructor(e){super(e,Ne),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"lutSampler",void 0),(0,i.A)(this,"intensity",void 0),this.intensity=this.uniform("intensity",d.A.FLOAT),this.renderSampler=this.sampler("s_image"),this.lutSampler=this.sampler("s_lut")}}function Be(e,t,r){return{render(i,n){t&&function(e,t,r,i,n){const o=s.G.create(e,!1,512,512);i.render(o,0);const a=o.value.take();if(void 0===a)return void(0,Le.u)(e,r,t);const l=e.ctx.renderers.get(Me);l.intensity.setFloat(n),l.lutSampler.set(a.value.bindSampler()),(0,c.C)(l,t,r),a.free()}(e,i,n,t,r)},shouldRender:()=>void 0!==t&&r>0}}var De=r(903523);const Oe=Math.PI/180;function je(e){return e*Oe}function Ue(e){const{direction:t,distance:r,speed:i,ease:o,mode:s}=e??(0,De.j)();return{updateParemeters(e,a){!function(e,t,r,i,o,s){let a=e.time-e.start;if(a*=i,"simple"===s)a=Math.min(a,.5);else if("loop"===s)a%=.5;else if("boomerang"===s&&!o){const e=a%1;a=e<.5?e:1-e}o?a=-1*Math.cos(2*Math.PI*a)+1:a*=4;const c=r*a,l=Math.cos(je(t)),d=Math.sin(je(t));e.matrix=e.matrix.multiply(n.d.translate(l*c,d*c))}(a,t,r,i,o,s)},shouldRender:()=>!!e}}const ze={name:"PatternRenderer",fragmentShader:"#define PI 3.14159\n#define MAX_ITS 7\n#define patternCount 5.\n\nprecision mediump float;\nuniform sampler2D u_image;\nvarying vec2 texCoords;\n\nuniform float time;\nuniform float radialAmount;\nuniform float verticalAmount;\n\nvec4 smallImage(float count, vec2 center, vec2 uv) {\n  vec2 s = count * uv - (center * count - count / 2.);\n  vec4 color = texture2D(u_image, s);\n  color *= ceil(fract(clamp(s.x, 0., 1.)));\n  color *= ceil(fract(clamp(s.y, 0., 1.)));\n  return color;\n}\n\nvec2 getRotate(float theta, float radius) {\n  float center = (patternCount - 1.) / 2.;\n  return vec2(\n    radius * cos(theta) + 0.5,\n    radius * sin(theta) + 0.5\n  );\n}\n\nvec2 normalise(vec2 uv, float size, float offset) {\n  return vec2(\n    (uv.x) * size + offset,\n    (uv.y + mod(uv.x, 2.) * 0.5 ) * size + offset\n  );\n}\n\nfloat loopInner(float x, float len) {\n  return (abs(\n    len * (1. - mod(x, 2.)) - ((x - mod(x, 2.)) / 2.)\n  ));\n}\n\nvec2 verticalAnimation(float x, float size, float time) {\n    return verticalAmount * vec2(0., (1. - 2. * mod(x, 2.)) * 0.5 * size * smoothstep(-1., 1., cos(time * 1.5 * PI)));\n}\n\nvoid main() {\n    vec4 o = vec4(0.);\n    float size = 1. / patternCount;\n    float offset = size / 2.;\n\n    int c = int(floor(patternCount) + 1.);\n\n    for (int i = 0; i < MAX_ITS; i++) {\n      for (int j = 0; j < MAX_ITS; j++) {\n\n        float count = float(c);\n\n        vec2 start = vec2(\n          loopInner(float(i), count) - 1.,\n          loopInner(float(j), count) - 1.\n        );\n\n        vec2 normalised = normalise(start, size, offset) + verticalAnimation(start.x, size, time);\n        float radius = distance(normalised, vec2(0.5));\n\n        float theta = atan(normalised.y - 0.5, normalised.x - 0.5);\n\n        start = getRotate(theta + ( radialAmount * (time + PI / 4.) ), radius) + size * floor((patternCount / 2.));\n\n        vec4 small = smallImage(patternCount, start, texCoords);\n        o = mix(o, small, small.a);\n      }\n    }\n\n    gl_FragColor = o;\n}\n\n",uniformNames:["time","verticalAmount","radialAmount"],samplerNames:["u_image"]};class We extends l.A{constructor(e){super(e,ze),(0,i.A)(this,"radialAmount",void 0),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"time",void 0),(0,i.A)(this,"verticalAmount",void 0),this.renderSampler=this.sampler("u_image"),this.time=this.uniform("time",d.A.FLOAT),this.verticalAmount=this.uniform("verticalAmount",d.A.FLOAT),this.radialAmount=this.uniform("radialAmount",d.A.FLOAT)}}var Ve=r(709629);function He(e){return[(.5-(e.left+e.right)/2)/.5,(.5-(e.top+e.bottom)/2)/.5]}function Ge(e,t,r,i){const o=t/r,s=He(i),a=n.d.identity.multiply(n.d.translate(s[0],s[1])).multiply(n.d.scale(o,1)),c=n.d.identity.multiply(n.d.scale(1/o,1)).multiply(n.d.translate(-s[0],-s[1]));return a.multiply(n.d.rotate(e)).multiply(c)}function qe(e,t){const{speed:r,amount:i,loop:o}=t??(0,Ve.L)();return{updateParemeters(t,s){!function(e,t,r,i,o){let s,a=e.time-e.start;a*=r,o&&(a%=2),s=a<=1?(0,ee.vF)(a):a<=2?1-(0,ee.vF)(a-1):0;const c=i*s,l=He(t);e.matrix=e.matrix.multiply(n.d.translate(l[0],l[1])).multiply(n.d.scale(c+1,c+1)).multiply(n.d.translate(-l[0],-l[1]))}(s,e,r,i,o)},shouldRender:()=>!!t}}const Qe={name:"RetroGraphicsRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D inTex;\nuniform float pixelation;\nuniform int colorPalette;\nvarying vec2 texCoords;\n\nvec3 getPixelFromColorPalette(float avg, vec3 colorPalette[4]) {\n    // Map the greyscale pixel to the selected colour palette\n    if (avg < 0.25) {\n        return colorPalette[0];\n    } else if (avg < 0.5) {\n        return colorPalette[1];\n    } else if (avg < 0.75) {\n        return colorPalette[2];\n    }\n    return colorPalette[3];\n}\n\nfloat convertToGrayScale(vec3 pixel) {\n    // Grab the average of rgb\n    return (pixel.r + pixel.g + pixel.b) / 3.0;\n}\n\nvoid main() {\n    float squareSize = pixelation / 1000.0;\n    vec2 sampleLoc = (floor(texCoords / squareSize) + 0.5) * squareSize;\n\n    vec3 retroHandheldGreenColorPalette[4];\n    retroHandheldGreenColorPalette[0] = vec3(0.058, 0.219, 0.058);\n    retroHandheldGreenColorPalette[1] = vec3(0.188, 0.384, 0.188);\n    retroHandheldGreenColorPalette[2] = vec3(0.545, 0.675, 0.058);\n    retroHandheldGreenColorPalette[3] = vec3(0.608, 0.737, 0.058);\n\n    // Grab the pixel colour from the texture\n    vec4 pixel = texture2D(inTex, sampleLoc);\n    // Divide by alpha\n    if (pixel.a != 0.0) {\n        pixel.rgb /= pixel.a;\n    }\n\n    if (colorPalette == 1) {\n        pixel.rgb = floor(pixel.rgb * 4.0) / 4.0;\n    } else if (colorPalette == 2) {\n        float avg = convertToGrayScale(pixel.rgb);\n        pixel.rgb = getPixelFromColorPalette(avg, retroHandheldGreenColorPalette);\n    }\n\n    pixel.rgb *= pixel.a;\n\n    // Set the pixel colour to the new colour\n    gl_FragColor = pixel;\n}\n",uniformNames:["pixelation","colorPalette"],samplerNames:["inTex"]};class Ke extends l.A{constructor(e){super(e,Qe),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"pixelation",void 0),(0,i.A)(this,"colorPalette",void 0),this.renderSampler=this.sampler("inTex"),this.pixelation=this.uniform("pixelation",d.A.FLOAT),this.colorPalette=this.uniform("colorPalette",d.A.INTEGER)}}function Xe(e,t,r){let i=0;switch(r){case"original":default:i=0;break;case"8-bit":i=1;break;case"retro-handheld-green":i=2}return{render(r,n){const o=e.ctx.renderers.get(Ke);o.renderSampler.set(n.value.bindSampler()),o.pixelation.setFloat(t),o.colorPalette.setInteger(i),o.renderTo(r)},shouldRender:()=>0!==t}}var Ye=r(588657);function Ze(e,t){const{speed:r,reverse:i}=t??(0,Ye.d)();return{updateParemeters(t,n){!function(e,t,r,i=.05,n=!1){let o=t.time-t.start;n&&(o=-o),o*=i;const s=Ge(2*Math.PI*o,e.value.pixelWidth,e.value.pixelHeight,r);t.matrix=t.matrix.multiply(s)}(t,n,e,r,i)},shouldRender:()=>!!t}}const Je=e=>e?2*e[0]+6*e[1]:4;function $e(e,t,r=.05,i=!1){return{updateParemeters(o,s){!function(e,t,r,i=.05,o=!1){let s=e.time-e.start;o&&(s=e.duration-s),s*=i;const a=[[.5*s,-.5*s],[0,-.5*s],[-.5*s,-.5*s],[.5*s,0],[0,0],[-.5*s,0],[.5*s,.5*s],[0,.5*s],[-.5*s,.5*s]];let c;c="zoom_to_random"===t?(e=>{const t=e??function(){const e=[0,.5,1];return[e[Math.floor(Math.random()*e.length)],e[Math.floor(Math.random()*e.length)]]}();return Je(t)})(r):Je(r);const[l,d]=a[c];e.matrix=e.matrix.multiply(n.d.translate(l,d)).multiply(n.d.scale(s+1,s+1))}(s,e,t,r,i)},shouldRender:()=>"disabled"!==e}}var et=r(893910),tt=r(552614);const rt=1.2256;function it(e,t){const{bounce:r,loop:i,reverse:n}=t??(0,tt.y)();return{updateParemeters(t,o){!function(e,t,r,i,n,o){let s=t.time-t.start;n&&(s%=i?3.5:1.5);let a=i?function(e){if(e<=.3538)return-.3029*Math.sin(5*e);if(e<=rt){const t=e+Math.PI/4-Math.PI/10;return-.3*Math.exp(3*t-2)*Math.sin(3*t)}if(e<=3){const t=e-rt;return 20*Math.exp(-3*e)*Math.sin(8*t)}return 0}(s):function(e){return e>=1?0:2*Math.PI*(0,ee.vF)(e,3)}(s);o&&(a=-a);const c=Ge(a,e.value.pixelWidth,e.value.pixelHeight,r);t.matrix=t.matrix.multiply(c)}(t,o,e,r,i,n)},shouldRender:()=>!!t}}const nt={name:"DownsampleRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D u_image;\nuniform vec2 blurAmount;\nuniform vec2 downsampleSize;\nvarying vec2 texCoords;\n\nmat3 rgb2yiq =\n        mat3(0.299, 0.596, 0.211, 0.587, -0.274, -0.523, 0.114, -0.322, 0.312);\nmat3 yiq2rgb = mat3(1, 1, 1, 0.956, -0.272, -1.106, 0.621, -0.647, 1.703);\n\nconst ivec2 samples = ivec2(8, 3);\n\nvec3 downsampleVideo2(vec2 uv, vec2 pixelSize) {\n    vec2 uvStart = uv - pixelSize / 2.0;\n    vec2 uvEnd = uv + pixelSize;\n\n    vec3 result = vec3(0.0, 0.0, 0.0);\n    for (int i_u = 0; i_u < samples.x; i_u++) {\n        float u = mix(uvStart.x, uvEnd.x, float(i_u) / float(samples.x));\n\n        for (int i_v = 0; i_v < samples.y; i_v++) {\n            float v = mix(uvStart.y, uvEnd.y, float(i_v) / float(samples.y));\n\n            result += texture2D(u_image, vec2(u, v)).rgb;\n        }\n    }\n\n    return (result / float(samples.x * samples.y)) * rgb2yiq;\n}\n\nvec3 downsampleVideo(vec2 fragCoord) {\n    vec2 uv = fragCoord;\n    vec2 pixelSize = 1.0 / downsampleSize;\n\n    pixelSize *= 1.0 + blurAmount; // Slight box blur to avoid aliasing\n\n    return downsampleVideo2(uv, pixelSize);\n}\n\nvoid main() {\n    gl_FragColor = vec4(downsampleVideo(texCoords) * yiq2rgb, 1);\n}\n",uniformNames:["downsampleSize","blurAmount"],samplerNames:["u_image"]};class ot extends l.A{constructor(e){super(e,nt),(0,i.A)(this,"blurAmount",void 0),(0,i.A)(this,"downsampleSize",void 0),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("u_image"),this.downsampleSize=this.uniform("downsampleSize",d.A.FLOAT_ARRAY_2),this.blurAmount=this.uniform("blurAmount",d.A.FLOAT_ARRAY_2)}}const st={name:"VHSRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D chr_image;\nuniform sampler2D lum_image;\nuniform float time;\nuniform float shiftFrequency;\nuniform vec2 texSize;\nvarying vec2 texCoords;\nuniform vec2 resLuminance;\nuniform vec2 resChroma;\nuniform float noiseThreshold;\n\nmat3 rgb2yiq =\n        mat3(0.299, 0.596, 0.211, 0.587, -0.274, -0.523, 0.114, -0.322, 0.312);\nmat3 yiq2rgb = mat3(1, 1, 1, 0.956, -0.272, -1.106, 0.621, -0.647, 1.703);\n\nvec4 hash42(vec2 p) {\n    vec4 p4 = fract(vec4(p.xyxy) * vec4(443.8975, 397.2973, 491.1871, 470.7827));\n    p4 += dot(p4.wzxy, p4 + 19.19);\n    return fract(vec4(p4.x * p4.y, p4.x * p4.z, p4.y * p4.w, p4.x * p4.w));\n}\n\nfloat hash(float n) { return fract(sin(n) * 43758.5453123); }\n\nfloat noise(in vec3 x) {\n    vec3 p = floor(x);\n    vec3 f = fract(x);\n    f = f * f * (3.0 - 2.0 * f);\n    float n = p.x + p.y * 57.0 + 113.0 * p.z;\n    float res = mix(mix(mix(hash(n + 0.0), hash(n + 1.0), f.x),\n                                            mix(hash(n + 57.0), hash(n + 58.0), f.x), f.y),\n                                    mix(mix(hash(n + 113.0), hash(n + 114.0), f.x),\n                                            mix(hash(n + 170.0), hash(n + 171.0), f.x), f.y),\n                                    f.z);\n    return res;\n}\n\nfloat tapeNoise(vec2 coords) {\n    float s = time * 80.;\n    vec2 gridRatio = (texSize / resLuminance) * 250.;\n    vec2 gridCoords = vec2(floor(coords.x * gridRatio.x) / gridRatio.x,\n                                                 floor(coords.y * gridRatio.y) / gridRatio.y);\n\n    float v = (noise(vec3(gridCoords.y * 140. + s, 1., 1.0)) + .0);\n    v *= hash42(vec2(gridCoords.x + time * 0.01, gridCoords.y)).x;\n\n    if (v < noiseThreshold) {\n        v = 0.;\n    }\n    return v / 3.;\n}\n\n// from http://www.java-gaming.org/index.php?topic=35123.0\nvec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w) * (1.0 / 6.0);\n}\n\nstruct BicubicData {\n    vec4 offset;\n    vec2 mixes;\n};\n\nBicubicData textureBicubicOffset(vec2 inCoords, vec2 textureRes) {\n    BicubicData returnValue;\n\n    vec2 invTexSize = vec2(1.0) / textureRes;\n\n    vec2 coords = inCoords * textureRes - 0.5;\n\n    vec2 fxy = fract(coords);\n    coords -= fxy;\n\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = coords.xxyy + vec2(-0.5, +1.5).xyxy;\n\n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n\n    returnValue.offset = c + vec4(xcubic.yw, ycubic.yw) / s;\n    returnValue.offset *= invTexSize.xxyy;\n\n    returnValue.mixes.x = s.x / (s.x + s.y);\n    returnValue.mixes.y = s.z / (s.z + s.w);\n\n    return returnValue;\n}\n\nvoid main() {\n    // CRT offset effect\n    vec2 coords =\n            vec2(texCoords.x +\n                             (max(min(sin((texCoords.y + time) * shiftFrequency), 0.05), 0.) /\n                                20.),\n                     texCoords.y);\n\n    // Colour bleeding\n    BicubicData luminanceBicubicData = textureBicubicOffset(coords, resLuminance);\n    vec3 sample0 = texture2D(lum_image, luminanceBicubicData.offset.xz).rgb * rgb2yiq;\n    vec3 sample1 = texture2D(lum_image, luminanceBicubicData.offset.yz).rgb * rgb2yiq;\n    vec3 sample2 = texture2D(lum_image, luminanceBicubicData.offset.xw).rgb * rgb2yiq;\n    vec3 sample3 = texture2D(lum_image, luminanceBicubicData.offset.yw).rgb * rgb2yiq;\n    vec3 bicubicLuma = mix(mix(sample3, sample2, luminanceBicubicData.mixes.x), mix(sample1, sample0, luminanceBicubicData.mixes.x), luminanceBicubicData.mixes.y);\n\n    BicubicData chromaBicubicData = textureBicubicOffset(coords, resChroma);\n    sample0 = texture2D(chr_image, chromaBicubicData.offset.xz).rgb * rgb2yiq;\n    sample1 = texture2D(chr_image, chromaBicubicData.offset.yz).rgb * rgb2yiq;\n    sample2 = texture2D(chr_image, chromaBicubicData.offset.xw).rgb * rgb2yiq;\n    sample3 = texture2D(chr_image, chromaBicubicData.offset.yw).rgb * rgb2yiq;\n    vec3 bicubicChroma = mix(mix(sample3, sample2, chromaBicubicData.mixes.x), mix(sample1, sample0, chromaBicubicData.mixes.x), chromaBicubicData.mixes.y);\n\n    float luminance = bicubicLuma.x;\n    vec2 chroma = bicubicChroma.yz;\n\n    vec3 result = vec3(luminance, chroma) * yiq2rgb;\n\n    result.rgb += vec3(tapeNoise(coords));\n\n    gl_FragColor = vec4(result, texture2D(u_image, coords).a);\n}\n",uniformNames:["texSize","time","shiftFrequency","resLuminance","resChroma","noiseThreshold"],samplerNames:["u_image","chr_image","lum_image"]};class at extends l.A{constructor(e){super(e,st),(0,i.A)(this,"chromaSampler",void 0),(0,i.A)(this,"luminanceSampler",void 0),(0,i.A)(this,"noiseThreshold",void 0),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"resChroma",void 0),(0,i.A)(this,"resLuminance",void 0),(0,i.A)(this,"shiftFrequency",void 0),(0,i.A)(this,"textureSize",void 0),(0,i.A)(this,"time",void 0),this.renderSampler=this.sampler("u_image"),this.chromaSampler=this.sampler("chr_image"),this.luminanceSampler=this.sampler("lum_image"),this.textureSize=this.uniform("texSize",d.A.FLOAT_ARRAY_2),this.time=this.uniform("time",d.A.FLOAT),this.shiftFrequency=this.uniform("shiftFrequency",d.A.FLOAT),this.resLuminance=this.uniform("resLuminance",d.A.FLOAT_ARRAY_2),this.resChroma=this.uniform("resChroma",d.A.FLOAT_ARRAY_2),this.noiseThreshold=this.uniform("noiseThreshold",d.A.FLOAT)}}function ct(e,t,r){return{render(i,n,o){!function(e,t,r,{time:i},n,o){const s=e.ctx.renderers.get(ot),a=e.ctx.renderers.get(at),l=[40,480],d=[333,480],u=e.allocImage(!1,l[0],l[1]),h=e.allocImage(!1,d[0],d[1]);s.downsampleSize.setFloatArray2(l),s.blurAmount.setFloatArray2([.2,.2]),(0,c.C)(s,u,r),s.downsampleSize.setFloatArray2(d),(0,c.C)(s,h,r),a.time.setFloat(i),a.shiftFrequency.setFloat(o),a.resChroma.setFloatArray2(l),a.resLuminance.setFloatArray2(d),a.noiseThreshold.setFloat(n),a.textureSize.setFloatArray2([r.value.pixelWidth,r.value.pixelHeight]),a.renderSampler.set(r.value.bindSampler()),a.chromaSampler.set(u.value.bindSampler()),a.luminanceSampler.set(h.value.bindSampler()),a.renderTo(t),u.free(),h.free()}(e,i,n,o,t,r)},shouldRender:()=>r>0}}const lt={name:"VignetteRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D image;\nuniform float ambientAlpha;\nuniform float haloRadius;\nuniform float smoothnessEdgeEnd;\nvarying vec2 texCoords;\n\nvoid main() {\n    vec2 uv = texCoords - 0.5;\n\n    // Create circular/oval shadow\n    float c = 1.0 - smoothstep(haloRadius, haloRadius + smoothnessEdgeEnd, length(uv));\n\n    // Get pixel color\n    vec4 baseColor = texture2D(image, texCoords);\n\n    // Ambient color\n    baseColor.rgb *= min(c + ambientAlpha, 1.0);\n    gl_FragColor = baseColor;\n}\n",uniformNames:["ambientAlpha","haloRadius","smoothnessEdgeEnd"],samplerNames:["image"]};class dt extends l.A{constructor(e){super(e,lt),(0,i.A)(this,"renderSampler",void 0),(0,i.A)(this,"ambientAlpha",void 0),(0,i.A)(this,"haloRadius",void 0),(0,i.A)(this,"smoothnessEdgeEnd",void 0),this.renderSampler=this.sampler("image"),this.ambientAlpha=this.uniform("ambientAlpha",d.A.FLOAT),this.smoothnessEdgeEnd=this.uniform("smoothnessEdgeEnd",d.A.FLOAT),this.haloRadius=this.uniform("haloRadius",d.A.FLOAT)}}function ut(e,t){const{ambientAlpha:r,haloRadius:i,smoothnessEdgeEnd:n}=t??function(e={}){return{ambientAlpha:.3,haloRadius:.25,smoothnessEdgeEnd:.2,...e}}();return{render(t,o){!function(e,t,r,i,n,o){const s=e.ctx.renderers.get(dt);s.ambientAlpha.setFloat(i),s.haloRadius.setFloat(n),s.smoothnessEdgeEnd.setFloat(o),(0,c.C)(s,t,r)}(e,t,o,r,i,n)},shouldRender:()=>!!t}}var ht=r(930919);const pt={...new o.g$("","","colour-filter")};class mt extends ht._{set extraContrast(e){this.colorBalance={...this.colorBalance,contrast:e}}get extraContrast(){return this.colorBalance.contrast}set extraExposure(e){this.colorBalance={...this.colorBalance,exposure:e}}get extraExposure(){return this.colorBalance.exposure}set extraSaturation(e){this.colorBalance={...this.colorBalance,saturation:e}}get extraSaturation(){return this.colorBalance.saturation}set extraTemperature(e){this.colorBalance={...this.colorBalance,temperature:e}}get extraTemperature(){return this.colorBalance.temperature}get videoTransform(){return this.letterboxNode.videoTransform}set videoTransform(e){this.letterboxNode.videoTransform=e,this.generator.videoTransform=e}get cropping(){return this.letterboxNode.cropping}set cropping(e){this.letterboxNode.cropping=e}constructor(e,t){super(e,t),(0,i.A)(this,"alpha",1),(0,i.A)(this,"colorBalance",U),(0,i.A)(this,"blendMode","normal"),(0,i.A)(this,"letterboxNode",void 0),(0,i.A)(this,"filterPresets",[]),(0,i.A)(this,"filterLutStates",[]),this.letterboxNode=new D(e,t)}updateFilters(e,t){const r=e.filters??[];if(this.filterPresets=r.map((e=>({...pt,...t.assets.byId[e.filterId].preset,...e.filterFields}))),this.filterLutStates.length>this.filterPresets.length)for(let e=this.filterPresets.length;e<this.filterLutStates.length;e++)this.filterLutStates[e]?.node.destroy();this.filterLutStates.length=this.filterPresets.length;for(let t=0;t<this.filterPresets.length;t++){const i=this.filterPresets[t],n=this.filterLutStates[t];if(!i.lutSrc){n?.node.destroy(),this.filterLutStates[t]=void 0;continue}const o=r[t].filterId,s=this.root.getStreamForTrackItem(`${e.id}-${o}`);s?.id!==n?.streamId&&(n?.node.destroy(),this.filterLutStates[t]=void 0===s?void 0:{streamId:s.id,node:new a.s(this.root,s)})}}destroy(){this.generator.destroy();for(const e of this.filterLutStates)e?.node.destroy()}update(e,t){this.generator.update(e,t);for(const t of this.filterLutStates)void 0!==t&&(t.node.start=this.start,t.node.duration=this.duration,t.node.update(e))}isStalled(e){return!!this.generator.isStalled(e)||this.filterLutStates.some((e=>e&&e.node.isStalled()))}render(e,t){const r=[];for(let e=0;e<this.filterPresets.length;e++)r.push(...this.getFilterPasses(e));r.push(...this.getGlobalPasses());const i=r.filter((e=>e.shouldRender())),n=i.some((e=>e.disableLetterbox)),o=i.filter(he);n||o.unshift(this.letterboxNode);const a=this.getRenderParams(e,t,i),c=s.G.clone(this.root,e);this.generator.render(c,t);const l=c.value.take();if(c.free(),void 0===l)return;let d=l;for(let t=0;t<o.length;t++){const r=o[t];if(t===o.length-1){r.render(e,d,a);break}const i=this.root.cloneImage(e);r.render(i,d,a),d.free(),d=i}d.free()}getRenderParams(e,t,r){const i={time:t,start:this.generator.start,duration:this.generator.duration,matrix:n.d.identity};for(const t of r)t.updateParemeters?.(e,i);return i}getFilterPasses(e){const t=this.filterPresets[e];return[(l=this.root,d=t.radialAmount,u=t.verticalAmount,h=t.pattern,{render(e,t,r){!function(e,t,r,i,n,o){const s=e.ctx.renderers.get(We);s.time.setFloat((0,q.A)(i)),s.radialAmount.setFloat(n),s.verticalAmount.setFloat(o),(0,c.C)(s,t,r)}(l,e,t,r,d,u)},shouldRender:()=>h||d>0||u>0}),Q(this.root,t.glassAmount),(0,fe.Q)(this.root,t.glitchAmount,t.glitchSpeed),Xe(this.root,t.pixelation,t.colorPalette),Y(this.root,t.chromaticAberrationAmount),ct(this.root,.9,t.vhsShiftFrequency),ut(this.root,t.vignette),(0,et.y)(this.root,t.smokeEnabled),$e(t.szMode,t.szPosition,t.szSpeed,t.szReverse),(r=t.crashZoomEnabled,i=t.crashZoomPosition,o=t.crashZoomZoomAmount,s=Number.parseInt(t.crashZoomSteps,10),a=t.crashZoomStepDelay,{updateParemeters(e,t){!function(e,t,r=0,i=1,o=0){const s=e.time-e.start,a=Math.min(i-1,Math.floor(s/o)),c=s-a*o,l=Math.min(c/.7,1),d=(0,ee.vF)(l,8),u=.5*(Math.pow(a,2)+a),h=a+1,p=(u+h*d)*r,m=(e=>e?2*e[0]+6*e[1]:4)(t),[f,g]=[[1,-1],[0,-1],[-1,-1],[1,0],[0,0],[-1,0],[1,1],[0,1],[-1,1]][m],A=(u+h)*r,v=e=>0===e?0:.5*(1+e),y=v(u*r),b=y+(v(A)-y)*d;e.matrix=e.matrix.multiply(n.d.scale(p+1,p+1)).multiply(n.d.translate(f*b,g*b))}(t,i,o,s,a)},shouldRender:()=>r}),Ue(t.move),me(this.root,t.flash),Ze(this.videoTransform.bounds,t.rotate),it(this.videoTransform.bounds,t.spin),$(this.root,t.colorShiftEnabled),ce(this.root,t.discoEnabled),Se(this.root,t.greenScreenEnabled,t.greenScreenCutoff,t.greenScreenColor),V(this.root,t.blurFillEnabled,this.generator,this.videoTransform),ue(this.root,t.grainAmount),Ee(this.root,t.cartoonEnabled,t.cartoonHalftoneIntensity),A(this.root,t.blackWhiteRemovalEnabled,t.blackWhiteRemovalCutoff,t.blackWhiteRemovalColor),(0,W.B)(this.root,t.blurAmount),ye(this.root,t.glowV2),Pe(this.root,this.videoTransform.bounds,t.kaleidoscopeV2),ne(this.root,t.diffusionV2),qe(this.videoTransform.bounds,t.pulse),Be(this.root,this.filterLutStates[e]?.node,t.lutIntensity)];var r,i,o,s,a,l,d,u,h}getGlobalPasses(){return[(e=this.root,t=this.colorBalance,{render(r,i){z(e,r,i,t)},shouldRender:()=>!function(e){return 0===e.exposure&&0===e.saturation&&0===e.temperature&&0===e.contrast}(t)}),m(this.root,this.alpha),x(this.root,this.blendMode)];var e,t}}},930919:(e,t,r)=>{r.d(t,{_:()=>n});var i=r(620358);class n extends i.E{get rotation(){return this.generator.rotation}get rotWidth(){return this.generator.rotWidth}get rotHeight(){return this.generator.rotHeight}}},620358:(e,t,r)=>{r.d(t,{E:()=>i});class i{findChildGenerator(e){let t=this;if(t instanceof e)return t;for(;t instanceof i;)if(t=t.wrappedGenerator,t instanceof e)return t}get wrappedGenerator(){return this.generator}get duration(){return this.generator.duration}set duration(e){this.generator.duration=e}get root(){return this._root}get start(){return this.generator.start}set start(e){this.generator.start=e}constructor(e,t){this._root=e,this.generator=t}isStalled(e){return this.generator.isStalled(e)}isActive(e){return this.generator.isActive(e)}update(e,t){this.generator.update(e,t)}}},582982:(e,t,r)=>{function i(e){return{value:e}}function n(e){return{...e,free(){}}}function o(...e){let t=!1;return r=>{if(t)throw new Error("Trying to call a doWith function after it has already been disposed");t=!0;try{return r(...e)}finally{for(const t of e)t.free()}}}r.d(t,{Ar:()=>i,Ww:()=>o,rd:()=>n})},830349:(e,t,r)=>{r.d(t,{a7:()=>Rt});var i=r(324586),n=r(635311),o=r(104173),s=r(736965),a=r(677763);class c extends Error{constructor(){super("Font cache has been destroyed")}}class l{constructor(e,t,r){(0,i.A)(this,"_primaryProvider",void 0),(0,i.A)(this,"fontCollection",void 0),(0,i.A)(this,"_destroyed",!1),this._primaryProvider=e.TypefaceFontProvider.Make(),this.fontCollection=e.FontCollection.Make(),this.fontCollection.setDefaultFontManager(this._primaryProvider);for(const e of t)this._primaryProvider.registerFont(e.buffer,e.alias);for(const e of r)this._primaryProvider.registerFallbackFont(e.buffer)}getMissingGlyphs(){return[...this.fontCollection.getMissingGlyphs()]}destroy(){this._assertNotDestroyed(),this._destroyed=!0,this.fontCollection.delete(),this._primaryProvider.delete()}_assertNotDestroyed(){if(this._destroyed)throw new c}}var d=r(912170);class u extends Error{constructor(){super("Could not create a CanvasKit surface")}}class h extends Error{constructor(){super("Surface has been destroyed")}}class p extends Error{constructor(){super("Could not resize surface")}}class m{constructor(e,t,r,n){(0,i.A)(this,"_destroyed",!1),(0,i.A)(this,"_canvas",void 0),(0,i.A)(this,"_texture",void 0),(0,i.A)(this,"_surface",void 0),this.canvaskit=e,this._engine=t;const o=t.createDynamicTexture(r,n,!1,0);this._texture=new d.D(o),this._canvas=document.createElement("canvas"),this._canvas.width=r,this._canvas.height=n;const s=e.MakeWebGLCanvasSurface(this._canvas,void 0);if(!s)throw new u;this._surface=s}getCanvas(){return this._surface.getCanvas()}getTexture(){return this._assertNotDestroyed(),this._texture}clear(){this._assertNotDestroyed(),this._surface.getCanvas().clear(this.canvaskit.TRANSPARENT)}flush(){this._assertNotDestroyed(),this._surface.flush(),this._engine.updateDynamicTexture(this._texture.getInternalTexture(),this._canvas,!0,!0)}setSize(e,t){if(this._assertNotDestroyed(),e===this._canvas.width&&t===this._canvas.height)return;if(e<=0||t<=0)throw new p;this._canvas.width=e,this._canvas.height=t,this._surface?.delete();const r=this.canvaskit.MakeWebGLCanvasSurface(this._canvas,void 0);if(!r)throw new u;this._surface=r,this._texture?.dispose(),this._texture=new d.D(this._engine.createDynamicTexture(e,t,!1,0))}destroy(){this._assertNotDestroyed(),this._destroyed=!0,this._surface.delete(),this._canvas.remove(),this._texture?.dispose()}_assertNotDestroyed(){if(this._destroyed)throw new h}}class f{constructor(e,t){this.canvaskit=e,this.engine=t}createSurface(e,t){return new m(this.canvaskit,this.engine,e,t)}createFontCache(e){return new l(this.canvaskit,e,[])}}class g{constructor(e,t){(0,i.A)(this,"_modulePromise",void 0),this.engine=e,this.canvaskitWasmUrl=t}async getModule(){if(!this._modulePromise){this._modulePromise=async function(e,t){const i=await Promise.all([r.e(84893),r.e(85697)]).then(r.t.bind(r,484893,23)),n=await i.default({locateFile:e=>{if("canvaskit.wasm"===e)return t}});return new f(n,e)}(this.engine,this.canvaskitWasmUrl);try{await this._modulePromise}catch(e){}}return this._modulePromise}}class A{getModule(){throw new Error("Device was created with null canvaskit integration")}}r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var v=r(602445),y=r(751203),b=r(943873);function w(e,t,r){return((t-1-e)%r+r)%r}r(379321),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);class x{get capacity(){return this._storage.length}get length(){return this._length}constructor(e){if((0,i.A)(this,"_cursor",0),(0,i.A)(this,"_length",0),this._storage=e,0===this._storage.length)throw new Error("Can't create a RingBuffer with 0 capacity")}push(e){this._storage[this._cursor]=e,this._cursor=(this._cursor+1)%this.capacity,this._length=Math.min(this._length+1,this.capacity)}at(e){if(!(e<0||e>=this._length))return this._storage[w(e,this._cursor,this.capacity)]}*[Symbol.iterator](){for(let e=0;e<this._length;e++)yield this._storage[w(e,this._cursor,this.capacity)]}}class S{constructor(e){(0,i.A)(this,"_allocationBuffer",new x(new Uint32Array(900))),this.root=e}render(e,t){this._allocationBuffer.push(this.root.allocatedTextureCount),e.strokeStyle="white",e.lineWidth=2,e.beginPath();let r=0;for(const i of this._allocationBuffer){const n=r/(this._allocationBuffer.capacity-1),o=1-i/50,s=t.x+n*t.width,a=t.y+o*t.height;0===r?e.moveTo(s,a):e.lineTo(s,a),r++}e.stroke(),e.fillStyle="white",e.fillText(`${this.root.allocatedTextureCount} texture(s)`,t.x+5,t.y+t.height-2)}}var T=r(365800);class C{constructor(){(0,i.A)(this,"_colors",new x(new Array(5)))}render(e,t){const r=Math.floor(255*Math.random()),i=Math.floor(255*Math.random()),n=Math.floor(255*Math.random());this._colors.push(`rgb(${r}, ${i}, ${n})`);const o=t.x+t.width-10;for(let t=this._colors.length-1;t>=0;t--)e.fillStyle=this._colors.at(t)??"",e.fillRect(o-10*(this._colors.length-t)-10,10,20,20)}}const _={loading:"#FFC107",active:"#4CAF50",unloading:"#F44336"},k={video:"128, 203, 196",audio:"206, 147, 216",font:"216, 180, 147"};class E{constructor(e,t){(0,i.A)(this,"timeWidth",void 0),(0,i.A)(this,"interval",void 0),this.streamCache=e,this.clock=t,this.timeWidth=this.clock.durationSecondsToTicks(30),this.interval=this.clock.durationSecondsToTicks(5)}render(e,t){const r=this.streamCache.getDebugState();this.renderState(e,t,r)}renderState(e,t,r){let i=t.y+5;for(const n of r.sources){const o={x:t.x+5,y:i,width:t.width-10,height:0};i+=this.renderSourceState(e,o,n,r.time)+5}}renderSourceState(e,t,r,i){const n=r.streams.some((e=>"active"===e.state)),s=!n&&r.streams.some((e=>"loading"===e.state)),a=n?"active":s?"loading":"unloading",c=n?"Active":s?"Loading":"Unloading",l=this.getPlaybackString(r.playbackState),d=t.x+5,u=t.x+t.width;let h=t.y+5+12;e.fillStyle="white",e.fillText(`Asset: ${r.assetId}`,d+5,h,u-5),h+=12,e.fillText(`${c}, ${l}, playback rate: ${r.config.playbackRate}, streams: ${[...r.streamTypes].join(",")}`,d+5,h,u-5),h+=5;const p=h;h+=17;const m=i-.2*this.timeWidth,f=(u-d)/this.timeWidth,g=e=>Math.floor(this.clampTime(e-m)*f+d);for(const t of r.streams){const r=t.timing.start-t.timing.preload,i=t.timing.end+t.timing.unload,n=g(r),o=g(t.timing.start),s=g(t.timing.end),a=g(i),c=22,l=k[t.type],d=`rgb(${l})`,u=`rgba(${l}, 0.5)`;n<o&&(e.fillStyle=u,e.fillRect(n,h,o-n,c)),o<s&&(e.fillStyle=d,e.fillRect(o,h,s-o,c)),s<a&&(e.fillStyle=u,e.fillRect(s,h,a-s,c)),e.fillStyle="black",e.fillText(t.type,o+5,h+5+12,a-n-10),h+=c+1}h+=5;const A=d+.2*(u-d);e.strokeStyle="white",e.lineWidth=1,e.beginPath(),e.moveTo(A,p),e.lineTo(A,h),e.stroke(),e.fillStyle="white",e.fillText(this.displayTime(i),A+5,p+12),e.globalCompositeOperation="destination-over",e.fillStyle=_[a],e.fillRect(t.x,t.y,5,h-t.y),e.fillStyle="rgba(255, 255, 255, 0.5)",e.strokeStyle="rgba(255, 255, 255, 0.5)",e.lineWidth=1;const v=Math.floor(m/this.interval),y=(m+this.timeWidth)/this.interval;for(let t=v;t<y;t++){const r=t*this.interval,i=(r-m)*f+d;e.beginPath(),e.moveTo(i,p),e.lineTo(i,h),e.stroke(),e.fillText(this.displayTime((0,o.H)(r)),i+5,p+12)}return e.fillStyle="rgba(0, 0, 0, 0.75)",e.fillRect(t.x,t.y,t.width,h-t.y),e.globalCompositeOperation="source-over",h-t.y}clampTime(e){return Math.max(0,Math.min(this.timeWidth,e))}displayTime(e){return`${e.toFixed(2)} ticks`}getPlaybackString(e){switch(e.type){case"playing":return`playing at ${this.displayTime((0,o._K)(this.clock.getTime(),e.mediaDelta))}`;case"paused":return`paused at ${this.displayTime(e.mediaTime)}${e.canBeInaccurate?" (inaccurate)":""}`}}}r(191864);var I=r(416162),R=r(815731),F=r(217563),P=r(321450);class L{constructor(e){(0,i.A)(this,"cache",new Map),this.ctx=e}destroy(){for(const e of this.cache.values())e.destroy()}get(e){const t=this.cache.get(e);if(t)return t;const r=new e(this.ctx);return this.cache.set(e,r),r}}class N{constructor(e,t,r,n){(0,i.A)(this,"contextRestored",void 0),(0,i.A)(this,"effectRenderer",void 0),(0,i.A)(this,"debugInfo",void 0),(0,i.A)(this,"renderers",void 0),(0,i.A)(this,"webGlContextLost",new R.t(!1)),(0,i.A)(this,"_contextRestored",new F.B),(0,i.A)(this,"hasWebGLContext",!0),this.name=e,this.engine=t,this.features=r,this.analytics=n,this.contextRestored=this._contextRestored.asObservable(),this.effectRenderer=new I.J(this.engine),this.setupState(),this.renderers=new L(this);const o=this.engine.getGlInfo();this.debugInfo=o?{rendererName:o.renderer,vendorName:o.vendor}:{rendererName:"unknown",vendorName:"unknown"}}getRenderWidth(){return this.engine.getRenderWidth()}getRenderHeight(){return this.engine.getRenderHeight()}setRenderSize(e,t){this.engine.setSize(e,t)}contextPromise(){return this.hasWebGLContext?Promise.resolve():(0,P._)(this.contextRestored)}getEffectWrapper(e){return new I.$({engine:this.engine,vertexShader:"//attribute vec2 vertexPos;\n//attribute vec2 vertexUV;\n//varying vec2 texCoords;\n//void main() {\n//    texCoords = vertexUV;\n//    gl_Position = vec4(vertexPos, 0, 1);\n//}\n\nattribute vec2 position;\n\nvarying vec2 texCoords;\n\nvoid main() {\n    texCoords = position * 0.5 + 0.5;\n    gl_Position = vec4(position, 0, 1);\n}\n",...e})}logError(e){this.analytics?.logError(e,"warning")}destroy(){this._contextRestored.complete(),this.renderers.destroy(),this.effectRenderer.dispose()}isContextLost(){return!this.hasWebGLContext}setupState(){this.engine.getCaps().parallelShaderCompile=void 0,this.engine.setDepthBuffer(!1),this.engine.setAlphaMode(8)}}class M extends N{constructor(e,t,r,i){super(e,t,r,i)}contextPromise(){return Promise.resolve()}destroy(){this.renderers.destroy(),this.effectRenderer.dispose()}}var B=r(284613),D=r(156106);class O{constructor(){(0,i.A)(this,"duration",0),(0,i.A)(this,"start",0)}destroy(){this.items.forEach((e=>e.destroy()))}fitDuration(){return this.duration=this.items.reduce(((e,t)=>Math.max(e,t.start+t.duration)),0),this.duration}isActive(e){const t=this.remapTime(e);if(t<0||t>=this.duration)return!1;for(const e of this.items)if(e.isActive(t))return!0;return!1}isStalled(e){const t=this.remapTime(e);for(const e of this.items)if(e.isActive(t)&&e.isStalled(t))return!0;return!1}update(e,t){const r=this.remapTime(e);for(const e of this.items)e.update(r,t)}getActive(e){const t=this.remapTime(e);return this.items.filter((e=>e.isActive(t)))}remapTime(e){return e-this.start}}class j{constructor(e){(0,i.A)(this,"duration",0),(0,i.A)(this,"start",0),this.root=e}destroy(){}isStalled(){return!0}isActive(e){return e>=this.start&&e<this.start+this.duration}render(e,t){}update(){}}class U{constructor(e){(0,i.A)(this,"generator",void 0),this.generator=new z(e)}update(){}beforeRender(){}destroy(){}}class z{constructor(e){(0,i.A)(this,"start",0),(0,i.A)(this,"duration",0),this.root=e}destroy(){}isStalled(){return!1}isActive(){return!1}render(){}update(){}}var W=r(71872),V=r(736766),H=r(129582);const G={name:"SolidRenderer",fragmentShader:"precision mediump float;\nuniform vec4 color;\nvarying vec2 texCoords;\nvoid main() { gl_FragColor = vec4(color.rgb * color.a, color.a); }\n",uniformNames:["color"]};class q extends V.A{constructor(e){super(e,G),(0,i.A)(this,"color",void 0),this.color=this.uniform("color",H.A.FLOAT_ARRAY_4)}}class Q{get baseHeight(){return this.root.ctx.getRenderHeight()}get baseWidth(){return this.root.ctx.getRenderWidth()}get rotHeight(){return this.baseHeight}get rotWidth(){return this.baseWidth}constructor(e){(0,i.A)(this,"color",[0,0,0,0]),(0,i.A)(this,"duration",0),(0,i.A)(this,"rotation",0),(0,i.A)(this,"start",0),this.root=e}destroy(){}isStalled(){return!1}isActive(e){return e>=this.start&&e<this.start+this.duration}render(e,t){const r=this.root.ctx.renderers.get(q);r.color.setFloatArray4(this.color),r.renderTo(e)}update(){}}var K=r(629179);class X{constructor(e){(0,i.A)(this,"item",void 0),(0,i.A)(this,"generator",void 0),this.root=e,this.generator=new Q(e)}update(e){this.item=e;const t=e.color??{hex:0,alpha:1},r=W.F.toRgb(t.hex);this.generator.color=[r.red/255,r.green/255,r.blue/255,t.alpha],(0,K.EQ)(this.root,this.generator,e)}beforeRender(e){const t=this.item?.color?.alpha??1,r=this.item?(0,K.r7)(e,this.item):1;this.generator.color[3]=t*r}destroy(){}}var Y=r(266343),Z=r(582982);class J{constructor(e,t){(0,i.A)(this,"fontsRefs",new Map),(0,i.A)(this,"currentStreams",new Set),(0,i.A)(this,"streams",[]),this.reader=e,this.fontProvider=t}destroy(){for(const[e,t]of this.fontsRefs)t.free();this.fontsRefs.clear(),this.currentStreams.clear(),this.streams=[]}setStreams(e){this.streams=e}pollUpdate(e,t){if(this.streams.every((e=>this.currentStreams.has(e.id))))return a.yE;const r=new Set,i=new Set;let n=!1,o=!0;for(const s of this.streams){if(r.add(s.assetId),void 0===this.fontsRefs.get(s.assetId)){const r=this.reader.pollRead(e,s.id,t,{});if("pending"===r.type){n=!0;continue}const i=this.fontProvider.getFont(s.assetId,(()=>({value:{alias:s.family,buffer:r.value},free:()=>{this.fontsRefs.delete(s.assetId)}})));this.fontsRefs.set(s.assetId,i)}this.currentStreams.has(s.id)||(o=!1),i.add(s.id)}if(!o){this.currentStreams=i;for(const[e,t]of this.fontsRefs)r.has(e)||t.free();this.fontProvider.update()}return n?a.eG:a.yE}}class ${constructor(e){(0,i.A)(this,"_moduleState",void 0),(0,i.A)(this,"_isDestroyed",!1),(0,i.A)(this,"_isActive",!1),(0,i.A)(this,"_isStalled",!0),(0,i.A)(this,"_lastUpdateTime",(0,o.H)(0)),(0,i.A)(this,"fontStreams",[]),(0,i.A)(this,"start",0),(0,i.A)(this,"duration",0),(0,i.A)(this,"offset",void 0),(0,i.A)(this,"playbackRate",void 0),(0,i.A)(this,"volume",void 0),(0,i.A)(this,"rootEntityId",void 0),(0,i.A)(this,"fontWaker",{wake:()=>{!this._isDestroyed&&this._isActive&&(this.pollFonts(),this._isStalled||this.root.requestRender(this))}}),(0,i.A)(this,"rotation",0),this.root=e,e.canvaskit.getModule().then((t=>{if(this._isDestroyed)return;e.db.read(b.FQ)||e.db.set(b.FQ,t.canvaskit);const r=e.ctx.getRenderWidth(),i=e.ctx.getRenderHeight(),n=t.createSurface(r,i),o=e.getFontProvider(t),s=new J(e.reader,o);s.setStreams(this.fontStreams),this._moduleState={module:t,surfaceWidth:r,surfaceHeight:i,surface:n,fontManager:s},this._isStalled=!1,this.pollFonts()}))}get rotWidth(){return this.root.ctx.getRenderWidth()}get rotHeight(){return this.root.ctx.getRenderHeight()}setEntity(e,t){this.rootEntityId=e,this.fontStreams=t,void 0!==this._moduleState&&(this._moduleState.fontManager.setStreams(t),this.pollFonts())}destroy(){this._isDestroyed=!0,void 0!==this._moduleState&&(this._moduleState.surface.destroy(),this._moduleState.fontManager.destroy(),this._moduleState=void 0)}isActive(e){return e>=this.start&&e<this.start+this.duration}isStalled(){return this._isStalled}update(e){this._lastUpdateTime=this.root.clock.mediaSecondsToTicks(e),this._isActive=this.isActive(e),this.pollFonts()}render(e){if(void 0===this._moduleState)return;const t=this._moduleState,{root:r,rootEntityId:i}=this,{db:n}=r;if(!i)return void e.value.clear();const o=this.root.ctx.getRenderWidth(),s=this.root.ctx.getRenderHeight(),a=Math.min(o,s);n.set(y.B0,{width:o/a,height:s/a}),n.set(b.H5,a);const c=this.root.ctx.getRenderWidth(),l=this.root.ctx.getRenderHeight();c===t.surfaceWidth&&l===t.surfaceHeight||(t.surface.destroy(),t.surface=t.module.createSurface(c,l),t.surfaceWidth=c,t.surfaceHeight=l);const{surface:d}=t;d.setSize(o,s),d.clear();const u=d.getCanvas();u.save(),u.scale(a,a),n.read(b.eY,i).value(u),u.restore(),d.flush();const h=d.getTexture();e.value.copy((0,Z.rd)({value:new Y.Z(h)}))}pollFonts(){if(!this._isActive||void 0===this._moduleState)return;const e=this._moduleState.fontManager.pollUpdate(this.fontWaker,this._lastUpdateTime);this._isStalled="pending"===e.type}}var ee=r(148278);class te{constructor(e){(0,i.A)(this,"item",void 0),(0,i.A)(this,"componentNode",void 0),(0,i.A)(this,"generator",void 0),this.root=e,this.componentNode=new $(e),this.generator=new ee.X(e,this.componentNode)}update(e,t){this.item=e,(0,K.EQ)(this.root,this.generator,e),(0,K.OE)(this.generator,e,t),this.componentNode.setEntity(e.rootEntity,this.root.rendererState?.getFontsForTrackItem(e.id)??[])}beforeRender(e){this.item&&(0,K.Oz)(this.generator,this.item,e)}destroy(){}}var re=r(118221),ie=r(999270);class ne{constructor(e,t,r){(0,i.A)(this,"currentFallbacks",new Set),(0,i.A)(this,"typefaces",new Map),(0,i.A)(this,"currentStreams",new Set),(0,i.A)(this,"streams",[]),(0,i.A)(this,"fontCache",void 0),this.reader=e,this.module=t,this.fallbackManager=r,this.fontCache=this.module.createFontCache([],[])}destroy(){for(const e of this.typefaces.values())e.destroy();this.typefaces.clear(),this.currentStreams.clear(),this.streams=[],this.fontCache.destroy()}getFontCache(){return this.fontCache}setStreams(e){this.streams=e}pollUpdate(e,t){if(this.streams.every((e=>this.currentStreams.has(e.id)))&&[...this.fallbackManager.getFallbackFonts().keys()].every((e=>this.currentFallbacks.has(e))))return a.yE;const r=new Set,i=new Set,n=new Set,o=[],s=[];let c=!1,l=!0;for(const i of this.streams){r.add(i.assetId);let s=this.typefaces.get(i.assetId);if(void 0===s){const r=this.reader.pollRead(e,i.id,t,{});if("pending"===r.type){c=!0;continue}const n=this.module.createDataFromBuffer(r.value);try{s=this.module.parseTypeface(n),this.typefaces.set(i.assetId,s)}catch(e){console.error("Failed to parse typeface:",e);continue}finally{n.destroy()}}this.currentStreams.has(i.id)||(l=!1),n.add(i.id),o.push({alias:i.family,typeface:s})}for(const[e,t]of this.fallbackManager.getFallbackFonts())void 0!==t.typeface?(l=!1,s.push(t.typeface),i.add(e)):c=!0;if(!l){this.currentStreams=n,this.currentFallbacks=i;for(const[e,t]of this.typefaces)r.has(e)||(t.destroy(),this.typefaces.delete(e));this.fontCache.destroy(),this.fontCache=this.module.createFontCache(o,s)}return c?a.eG:a.yE}}class oe{constructor(e){(0,i.A)(this,"fallbackFonts",new Map),(0,i.A)(this,"seenMissingGlyphs",new Set),this.verseModule=e}getFallbackFonts(){return this.fallbackFonts}destroy(){for(const e of this.fallbackFonts.values())e.typeface?.destroy();this.fallbackFonts.clear()}async scanForMissingGlyphs(e,t){if("function"!=typeof fetch)return;const r=e();if(void 0===r)return;const i=Array.from(r.getMissingGlyphs());for(let e=0;e<i.length;e++){const t=i[e];if(this.seenMissingGlyphs.has(t))continue;this.seenMissingGlyphs.add(t);const r=(0,ie.d)(t);if(void 0===r)continue;if(this.fallbackFonts.has(r))continue;const n=fetch(r).then((e=>e.arrayBuffer())).then((e=>{const t=this.verseModule.createDataFromBuffer(e);try{const e=this.verseModule.parseTypeface(t);this.fallbackFonts.set(r,{typeface:e,promise:Promise.resolve()})}finally{t.destroy()}})).catch((e=>{this.fallbackFonts.delete(r),console.error("Failed to create typeface:",e)}));this.fallbackFonts.set(r,{promise:n})}await Promise.resolve();const n=[...this.fallbackFonts.values()].filter((e=>void 0===e.typeface)).map((e=>e.promise));(await Promise.all(n)).length>0&&t()}}class se{constructor(e,t){(0,i.A)(this,"created",!1),(0,i.A)(this,"_value",void 0),(0,i.A)(this,"refCount",0),this.create=e,this.dispose=t}get value(){return this._value}ref(e,t){return this.refCount++,this.created&&void 0!==this._value||(this.created=!0,this._value=this.create(e,t)),this}destroy(){this.refCount>0&&this.refCount--,0===this.refCount&&this.created&&void 0!==this._value&&(this.dispose(this._value),this.created=!1,this._value=void 0)}reset(){this.refCount=0,this.created=!1,void 0!==this._value&&this.dispose(this._value),this._value=void 0}}const ae=new se(((e,t)=>new oe(t)),(e=>e.destroy())),ce=new se(((e,t)=>t.createSurface(e.ctx.getRenderWidth(),e.ctx.getRenderHeight())),(e=>e.destroy()));class le{get rotWidth(){return this.root.ctx.getRenderWidth()}get rotHeight(){return this.root.ctx.getRenderHeight()}constructor(e,t){(0,i.A)(this,"_isStalled",!0),(0,i.A)(this,"_isDestroyed",!1),(0,i.A)(this,"_lastUpdateTime",(0,o.H)(0)),(0,i.A)(this,"_isActive",!1),(0,i.A)(this,"_editingEntities",[]),(0,i.A)(this,"_boundsWaker",void 0),(0,i.A)(this,"_moduleState",void 0),(0,i.A)(this,"model",void 0),(0,i.A)(this,"fontStreams",[]),(0,i.A)(this,"hasChangedSinceRender",!1),(0,i.A)(this,"lastRenderFontCache",void 0),(0,i.A)(this,"fontWaker",{wake:()=>{!this._isDestroyed&&this._isActive&&(this.pollFonts(),this._isStalled||this.root.requestRender(this))}}),(0,i.A)(this,"start",0),(0,i.A)(this,"duration",0),(0,i.A)(this,"rotation",0),this.root=e,this.shareVerseSurface=t,this.root.libverse.getModule().then((e=>{if(this._isDestroyed)return;const r=ae.ref(this.root,e).value;if(!r)throw new Error("Failed to create fallback font manager");const i=new ne(this.root.reader,e,r);i.setStreams(this.fontStreams);const n=e.createDocument();this.model&&n.update(this.model);const o=this.root.ctx.getRenderWidth(),s=this.root.ctx.getRenderHeight(),a=t?ce.ref(this.root,e).value:e.createSurface(o,s);if(!a)throw new Error("Failed to create surface");this._moduleState={module:e,fallbackFonts:r,fontManager:i,document:n,surface:a,surfaceWidth:o,surfaceHeight:s,frame:void 0,texture:void 0},this._isStalled=!1,this.updateTexture(),this.pollFonts(),this.updateFrame()})).catch((e=>{console.error(e)}))}setDocument(e,t){(0,re.h)(e,this.model)||(this.model=e,this.fontStreams=t,void 0!==this._moduleState&&(this.hasChangedSinceRender=!0,this._moduleState.fontManager.setStreams(t),this._moduleState.document.update(e),this.pollFonts(),this.updateFrame()))}pollBounds(e,t){return this._boundsWaker=e,void 0===this._moduleState||void 0===this._moduleState.frame?a.eG:(0,a.eO)(this._moduleState.frame.getBounds(t))}setEditing(e,t){const r=this._editingEntities.indexOf(e);t&&-1===r&&this._editingEntities.push(e),t||-1===r||this._editingEntities.splice(r,1),this.root.requestRender(this)}destroy(){this._isDestroyed=!0,this._moduleState&&(this._moduleState.fontManager.destroy(),this._moduleState.document.destroy(),this.shareVerseSurface?ce.destroy():this._moduleState.surface.destroy(),ae.destroy(),this._moduleState=void 0)}isActive(e){return e>=this.start&&e<this.start+this.duration}isStalled(){return this._isStalled}update(e){this._lastUpdateTime=this.root.clock.mediaSecondsToTicks(e),this._isActive=this.isActive(e),this.pollFonts()}render(e){if(void 0===this._moduleState)return;const t=this._moduleState;if(this.updateFrame(),void 0===t.frame)return;const r=this.root.ctx.getRenderWidth(),i=this.root.ctx.getRenderHeight();r===t.surfaceWidth&&i===t.surfaceHeight||(this.shareVerseSurface?t.surface.setSize(r,i):(t.surface.destroy(),t.surface=t.module.createSurface(r,i)),t.surfaceWidth=r,t.surfaceHeight=i,t.texture=void 0,this.updateTexture()),void 0!==t.texture&&(t.surface.clear(),t.frame.render(t.surface),t.surface.flush(),e.value.copy((0,Z.rd)({value:new Y.Z(t.texture)})));const n=this._moduleState.fontManager.getFontCache();(this.hasChangedSinceRender||n!==this.lastRenderFontCache)&&(this.hasChangedSinceRender=!1,this.lastRenderFontCache=n,this._moduleState.fallbackFonts.scanForMissingGlyphs((()=>this._moduleState?.fontManager.getFontCache()),(()=>this.root.requestRender(this))).catch((e=>console.error(e))))}pollFonts(){if(!this._isActive||void 0===this._moduleState)return;const e=this._moduleState.fontManager.pollUpdate(this.fontWaker,this._lastUpdateTime);this._isStalled="pending"===e.type}updateFrame(){if(!this._isActive||void 0===this._moduleState)return;this._moduleState.frame=this._moduleState.document.nextFrame({fontCache:this._moduleState.fontManager.getFontCache(),localTimeSecs:this.root.clock.ticksToSeconds(this._lastUpdateTime)-this.start,durationSecs:this.duration,frameWidth:this._moduleState.surfaceWidth,frameHeight:this._moduleState.surfaceHeight,editingEntities:this._editingEntities});const e=this._boundsWaker;this._boundsWaker=void 0,e?.wake()}updateTexture(){void 0!==this._moduleState&&this._moduleState.surface.getTexture().then((e=>{void 0!==this._moduleState&&(this._moduleState.texture=e,this.root.requestRender(this))}))}}class de{constructor(e,t){(0,i.A)(this,"item",void 0),(0,i.A)(this,"verseNode",void 0),(0,i.A)(this,"generator",void 0),this.root=e,this.verseNode=new le(e,t),this.generator=new ee.X(e,this.verseNode)}update(e,t){this.item=e,(0,K.EQ)(this.root,this.generator,e),(0,K.OE)(this.generator,e,t),this.verseNode.setDocument({entities:e.entities??[]},this.root.rendererState?.getFontsForTrackItem(e.id)??[])}beforeRender(e){this.item&&(0,K.Oz)(this.generator,this.item,e)}getVerseNode(){return this.verseNode}destroy(){}}var ue=r(586707);class he{constructor(e,t){(0,i.A)(this,"item",void 0),(0,i.A)(this,"generator",void 0),this.root=e;const r=new ue.s(e,t);this.generator=new ee.X(e,r)}update(e,t){this.item=e,function(e,t,r,i){(0,K.EQ)(e,t,r),(0,K.OE)(t,r,i)}(this.root,this.generator,e,t)}beforeRender(e){this.item&&this.generator&&(0,K.Oz)(this.generator,this.item,e)}destroy(){}setCropping(e){this.generator&&(this.generator.cropping=e)}}var pe=r(620358);class me extends pe.E{constructor(e,t,r,n){const o=function(e,t,r,i){if(void 0!==r)return new he(e,r);if("background"===t.type)return new X(e);if("audio"===t.type)return new U(e);if("procedural"===t.type)return new de(e,i.shareVerseSurface);if("component"===t.type)return new te(e);if("title"===t.type){const r=i.createExternalMapper(t,{rootNode:e});if(void 0!==r)return r}throw new Error(`Cannot create a graph node from an unknown asset type: ${t.type}`)}(e,t,r,n);super(e,o.generator),(0,i.A)(this,"mapper",void 0),this.mapper=o}render(e,t){this.mapper.beforeRender(t),this.generator.render(e,t)}destroy(){this.mapper.destroy(),this.generator.destroy()}updateItem(e,t){this.mapper.update(e,t)}setCropping(e){this.mapper.setCropping?.(e)}getVerseNode(){return this.mapper.getVerseNode?.()}}class fe extends pe.E{get itemId(){return this.item?.id}get itemStartTime(){return this.item?.startTime}get itemTrim(){return this.item?.trim}constructor(e){super(e,new j(e)),(0,i.A)(this,"item",void 0),(0,i.A)(this,"videoStreamId",void 0)}render(e,t){this.generator.render(e,t)}destroy(){this.generator.destroy()}findNodeForTrackitem(e){if(this.item?.id===e&&this.generator instanceof me)return this.generator}updateItem(e,t,r){if(e===this.item)return;const i=this.root.getStreamForTrackItem(e.id);if(this.item?.assetId!==e.assetId||this.videoStreamId!==i?.id){const n=t.assets.byId[e.assetId];if(void 0===n)return;this.generator.destroy(),this.generator=new me(this.root,n,i,r)}this.item=e,this.videoStreamId=i?.id,this.generator instanceof me&&this.generator.updateItem(e,t)}}function ge(e,t,r,i,n){e.bottomSampler.set(i.value.bindSampler()),e.topSampler.set(r.value.bindSampler()),e.mixUniform.setFloat(n),e.renderTo(t)}var Ae=r(350879);class ve{constructor(e,t,r,i){this.root=e,this.startTime=t,this.duration=r,this.options=i}isActive(e){return e>=this.startTime&&e<this.startTime+this.duration}getInnerGenerator(){}destroy(){}getMixAtTime(e){return 0===this.duration?0:Math.max(0,Math.min((e-this.startTime)/this.duration,1))}}const ye={name:"FadeRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nvarying vec2 texCoords;\nvoid main() {\n    vec4 colorA = texture2D(aTex, texCoords);\n    vec4 colorB = texture2D(bTex, texCoords);\n    gl_FragColor = mix(colorA, colorB, mixVal);\n}\n",uniformNames:["mixVal"],samplerNames:["aTex","bTex"]};class be extends V.A{constructor(e){super(e,ye),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"topSampler",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",H.A.FLOAT)}}class we extends ve{constructor(e,t,r){super(e,t,r)}render(e,t,r,i){const n=this.root.ctx.renderers.get(be),o=this.getMixAtTime(i),s=this.root.cloneImage(t);(0,Ae.N)(this.root,s,t,5*o),t.free();const a=this.root.cloneImage(r);(0,Ae.N)(this.root,a,r,5*(1-o)),r.free(),ge(n,e,s,a,o),s.free(),a.free()}}class xe extends ve{render(e,t,r,i){(0,Z.Ww)(t,r)(((t,r)=>{ge(this.root.ctx.renderers.get(be),e,t,r,this.getMixAtTime(i))}))}}const Se={name:"FadeThroughRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform vec3 fadeColor;\nvarying vec2 texCoords;\nvoid main() {\n    if (mixVal < 0.5) gl_FragColor = mix(texture2D(aTex, texCoords), vec4(fadeColor, 1), mixVal*2.);\n    else gl_FragColor = mix(vec4(fadeColor, 1), texture2D(bTex, texCoords), mixVal*2.-1.);\n}\n",uniformNames:["mixVal","fadeColor"],samplerNames:["aTex","bTex"]};class Te extends V.A{constructor(e){super(e,Se),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"colorUniform",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"topSampler",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",H.A.FLOAT),this.colorUniform=this.uniform("fadeColor",H.A.FLOAT_ARRAY_3)}}const Ce=[0,0,0];class _e extends ve{get color(){return this.options&&this.options.color?this.options.color:Ce}render(e,t,r,i){(0,Z.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(Te);n.colorUniform.setFloatArray3(this.color),ge(n,e,t,r,this.getMixAtTime(i))}))}}const ke={name:"FlickerRenderer",fragmentShader:"#define M_PI 3.1415926535897932384626433832795\n\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform float mixRatio;\nuniform float speed;\nuniform bool fade;\nvarying vec2 texCoords;\n\nvoid main() {\n    vec4 colorA = texture2D(aTex, texCoords);\n    vec4 colorB = texture2D(bTex, texCoords);\n    float s = mixVal * speed;\n    float radians = 2.0 * M_PI * s;\n    float cos = (cos(radians) + 1.0) / 2.0;\n\n    // Check if not works\n    if(!fade) {\n        cos = cos > 0.5 ? 1.0 : 0.0;\n    }\n\n    if (mixVal < mixRatio) {\n        gl_FragColor = colorA * cos;\n    } else {\n        gl_FragColor = colorB * cos;\n    }\n}\n",uniformNames:["mixVal","mixRatio","speed","fade"],samplerNames:["aTex","bTex"]};class Ee extends V.A{constructor(e){super(e,ke),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"mixRatioUniform",void 0),(0,i.A)(this,"speedUniform",void 0),(0,i.A)(this,"fadeUniform",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",H.A.FLOAT),this.mixRatioUniform=this.uniform("mixRatio",H.A.FLOAT),this.speedUniform=this.uniform("speed",H.A.FLOAT),this.fadeUniform=this.uniform("fade",H.A.BOOLEAN)}}class Ie extends ve{get speed(){return this.options&&this.options.speed?this.options.speed:13}get timeRatio(){return this.options&&this.options.timeRatio?this.options.timeRatio:.5}render(e,t,r,i){(0,Z.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(Ee);n.mixRatioUniform.setFloat(this.timeRatio),n.speedUniform.setFloat(this.speed),n.fadeUniform.setBoolean(!0);const o=this.getMixAtTime(i);ge(n,e,t,r,o)}))}}const Re={name:"GlitchTransitionRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nvarying vec2 texCoords;\n\nconst float INTENSITY = 0.3;\n\n// Based on https://github.com/akella/webGLImageTransitions/blob/master/js/demo5.js\nvoid main() {\n    vec4 baseA = texture2D(aTex, texCoords);\n    vec4 baseB = texture2D(bTex, texCoords);\n\n    float displaceA = (baseA.r + baseA.g + baseA.b) * 0.33;\n    float displaceB = (baseB.r + baseB.g + baseB.b) * 0.33;\n\n    vec2 offsetCoordA = vec2(texCoords.x, texCoords.y + mixVal * displaceB * INTENSITY);\n    vec4 colorA = texture2D(aTex, offsetCoordA);\n\n    vec2 offsetCoordB = vec2(texCoords.x, texCoords.y + (1. - mixVal) * displaceA * INTENSITY);\n    vec4 colorB = texture2D(bTex, offsetCoordB);\n\n    gl_FragColor = mix(colorA, colorB, mixVal);\n}\n",uniformNames:["mixVal"],samplerNames:["aTex","bTex"]};class Fe extends V.A{constructor(e){super(e,Re),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",H.A.FLOAT)}}var Pe=r(329506);class Le extends ve{render(e,t,r,i){(0,Z.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(Fe),o=this.getMixAtTime(i),s=(0,Pe.vF)(o);ge(n,e,t,r,s)}))}}var Ne=r(796748);const Me={name:"MaskTransitionRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D s_a;\nuniform sampler2D s_b;\nuniform sampler2D s_mask;\nuniform float u_mix;\nvarying vec2 texCoords;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n    float maskVal = texture2D(s_mask, texCoords).r;\n    vec4 colorA = unmultAlpha(texture2D(s_a, texCoords));\n    vec4 colorB = unmultAlpha(texture2D(s_b, texCoords));\n    gl_FragColor = multAlpha(mix(colorA, colorB, maskVal));\n}\n",uniformNames:["u_mix"],samplerNames:["s_a","s_b","s_mask"]};class Be extends V.A{constructor(e){super(e,Me),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"maskSampler",void 0),(0,i.A)(this,"mixUniform",void 0),this.topSampler=this.sampler("s_a"),this.bottomSampler=this.sampler("s_b"),this.maskSampler=this.sampler("s_mask"),this.mixUniform=this.uniform("u_mix",H.A.FLOAT)}}class De extends ve{constructor(e,t,r,i){super(e,t,r),this.maskVideo=i}getInnerGenerator(){return this.maskVideo}render(e,t,r,i){(0,Z.Ww)(Ne.G.clone(this.root,e))((n=>{this.maskVideo.render(n,i);const o=this.root.ctx.renderers.get(Be);o.maskSampler.set(n.value.bindSampler()),ge(o,e,t,r,this.getMixAtTime(i))})),t.free(),r.free()}destroy(){this.maskVideo.destroy()}}const Oe={name:"PixelateRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform vec2 squaresMin;\nuniform int steps;\nvarying vec2 texCoords;\n\nvoid main() {\n\tfloat d = min(mixVal, 1.0 - mixVal);\n\tfloat dist = steps > 0 ? ceil(d * float(steps)) / float(steps) : d;\n\tvec2 squareSize = 2.0 * dist / vec2(squaresMin);\n\tvec2 p = dist>0.0 ? (floor(texCoords / squareSize) + 0.5) * squareSize : texCoords;\n    vec4 colorA = texture2D(aTex, p);\n    vec4 colorB = texture2D(bTex, p);\n\tgl_FragColor = mix(colorA, colorB, mixVal);\n}\n",uniformNames:["squaresMin","steps","mixVal"],samplerNames:["aTex","bTex"]};class je extends V.A{constructor(e){super(e,Oe),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"squaresMinUniform",void 0),(0,i.A)(this,"stepsUniform",void 0),(0,i.A)(this,"topSampler",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.squaresMinUniform=this.uniform("squaresMin",H.A.FLOAT_ARRAY_2),this.stepsUniform=this.uniform("steps",H.A.FLOAT),this.mixUniform=this.uniform("mixVal",H.A.FLOAT)}}const Ue=[20,10];class ze extends ve{render(e,t,r,i){(0,Z.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(je);n.stepsUniform.setFloat(20),n.squaresMinUniform.setFloatArray2(Ue),ge(n,e,t,r,this.getMixAtTime(i))}))}}const We={name:"PushRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform float lastMixVal;\nuniform vec2 direction;\nvarying vec2 texCoords;\n\nvec4 sampleAtTime(float time) {\n    vec2 p = texCoords + time * direction;\n    vec2 f = fract(p);\n    return p == f\n        ? texture2D(aTex, f)\n        : texture2D(bTex, f);\n}\n\nconst int SAMPLE_COUNT = 10;\n\nvoid main() {\n    vec4 accum = vec4(0.);\n    for (int sampleIndex = 0; sampleIndex < SAMPLE_COUNT; sampleIndex++) {\n        float currentMixVal = mix(lastMixVal, mixVal, float(sampleIndex) / float(SAMPLE_COUNT));\n        accum += sampleAtTime(currentMixVal) / float(SAMPLE_COUNT);\n    }\n    gl_FragColor = accum;\n}\n",uniformNames:["direction","mixVal","lastMixVal"],samplerNames:["aTex","bTex"]};class Ve extends V.A{constructor(e){super(e,We),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"directionUniform",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"lastMixUniform",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.directionUniform=this.uniform("direction",H.A.FLOAT_ARRAY_2),this.mixUniform=this.uniform("mixVal",H.A.FLOAT),this.lastMixUniform=this.uniform("lastMixVal",H.A.FLOAT)}}const He=[1,0],Ge=1/120;class qe extends ve{get direction(){return this.options&&this.options.direction?this.options.direction:He}render(e,t,r,i){(0,Z.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(Ve);n.directionUniform.setFloatArray2(this.direction);const o=this.getMixAtTime(i-Ge),s=(0,Pe.vF)(o,4);n.lastMixUniform.setFloat(s);const a=this.getMixAtTime(i),c=(0,Pe.vF)(a,4);ge(n,e,t,r,c)}))}}var Qe=r(463716);const Ke={name:"SpinRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nvarying vec2 texCoords;\n\nuniform float fadeAmt;\nuniform mat3 aLastTransform;\nuniform mat3 aTransform;\nuniform mat3 bLastTransform;\nuniform mat3 bTransform;\n\nconst int SAMPLE_COUNT = 10;\n\nmat3 mixMatrix(mat3 a, mat3 b, float t) {\n    return a * (1. - t) + b * t;\n}\n\nvec4 sampleBlurredA() {\n    vec4 res = vec4(0.);\n    for (int sampleIndex = 0; sampleIndex < SAMPLE_COUNT; sampleIndex++) {\n        mat3 m = mixMatrix(aLastTransform, aTransform, float(sampleIndex) / float(SAMPLE_COUNT));\n\n        vec2 transformed = (m * vec3(texCoords, 1)).xy;\n\n        res += texture2D(aTex, transformed) / float(SAMPLE_COUNT);\n    }\n    return res;\n}\n\nvec4 sampleBlurredB() {\n    vec4 res = vec4(0.);\n    for (int sampleIndex = 0; sampleIndex < SAMPLE_COUNT; sampleIndex++) {\n        mat3 m = mixMatrix(bLastTransform, bTransform, float(sampleIndex) / float(SAMPLE_COUNT));\n\n        vec2 transformed = (m * vec3(texCoords, 1)).xy;\n\n        res += texture2D(bTex, transformed) / float(SAMPLE_COUNT);\n    }\n    return res;\n}\n\nvoid main() {\n    // Most of the transition only shows one texture, so only sample from one if we can\n    if (fadeAmt == 0.) gl_FragColor = sampleBlurredA();\n    else if (fadeAmt == 1.) gl_FragColor = sampleBlurredB();\n    else {\n        gl_FragColor = mix(\n            sampleBlurredA(),\n            sampleBlurredB(),\n            fadeAmt\n        );\n    }\n}\n",uniformNames:["mixVal","fadeAmt","aLastTransform","aTransform","bLastTransform","bTransform"],samplerNames:["aTex","bTex"]};class Xe extends V.A{constructor(e){super(e,Ke),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"fadeAmtUniform",void 0),(0,i.A)(this,"topLastTransformUniform",void 0),(0,i.A)(this,"topTransformUniform",void 0),(0,i.A)(this,"bottomLastTransformUniform",void 0),(0,i.A)(this,"bottomTransformUniform",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",H.A.FLOAT),this.fadeAmtUniform=this.uniform("fadeAmt",H.A.FLOAT),this.topLastTransformUniform=this.uniform("aLastTransform",H.A.MATRIX_3),this.topTransformUniform=this.uniform("aTransform",H.A.MATRIX_3),this.bottomLastTransformUniform=this.uniform("bLastTransform",H.A.MATRIX_3),this.bottomTransformUniform=this.uniform("bTransform",H.A.MATRIX_3)}}function Ye(e,t,r,i){const n=function(e,t){const r=t*Math.abs(Math.cos(e))+Math.abs(Math.sin(e)),i=t*Math.abs(Math.sin(e))+Math.abs(Math.cos(e));return Math.min(t/r,1/i)}(e,i);return t.multiply(Qe.d.rotate(e)).multiply(Qe.d.scale(n,n)).multiply(r)}function Ze(e){return e*-Math.PI*.5}function Je(e){return e*-Math.PI*.5-1.5*Math.PI}const $e=1/120;class et extends ve{render(e,t,r,i){const n=this.root.ctx.renderers.get(Xe),o=e.value.pixelWidth/e.value.pixelHeight,s=Qe.d.identity.multiply(Qe.d.translate(-.5,-.5)).multiply(Qe.d.scale(o,1)),a=Qe.d.identity.multiply(Qe.d.scale(1/o,1)).multiply(Qe.d.translate(.5,.5)),c=this.getMixAtTime(i-$e),l=(0,Pe.vF)(c,4);n.topLastTransformUniform.setMatrix3(Ye(Ze(l),s,a,o)),n.bottomLastTransformUniform.setMatrix3(Ye(Je(l),s,a,o));const d=this.getMixAtTime(i),u=(0,Pe.vF)(d,4);n.topTransformUniform.setMatrix3(Ye(Ze(u),s,a,o)),n.bottomTransformUniform.setMatrix3(Ye(Je(u),s,a,o));const h=Math.min(1,Math.max(0,(d-.5)/.05+.5));n.fadeAmtUniform.setFloat(h),(0,Z.Ww)(t,r)(((t,r)=>{ge(n,e,t,r,u)}))}}const tt={name:"TileRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform vec2 tileCount;\nvarying vec2 texCoords;\n\nfloat random(vec2 pos) {\n    return fract(sin(dot(pos.xy, vec2(12.9898, 78.233))) * 43758.5453123);\n}\n\nconst float TILE_FADE_LENGTH = 0.5;\n\nvoid main() {\n    vec2 tileIndex = floor(texCoords * tileCount);\n    float tileOffset = random(tileIndex);\n\n    // With offset=0, mask should be 0 at time=0 and 1 at time=FADE_LENGTH\n    // With offset=1, mask should be 0 at time=(1-FADE_LENGTH) and 1 at time=1\n    float tileMask = clamp((mixVal - tileOffset * (1. - TILE_FADE_LENGTH)) / TILE_FADE_LENGTH, 0., 1.);\n\n    vec4 colorA = texture2D(aTex, texCoords);\n    vec4 colorB = texture2D(bTex, texCoords);\n    gl_FragColor = mix(colorA, colorB, tileMask);\n}\n",uniformNames:["mixVal","tileCount"],samplerNames:["aTex","bTex"]};class rt extends V.A{constructor(e){super(e,tt),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"tileCountUniform",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",H.A.FLOAT),this.tileCountUniform=this.uniform("tileCount",H.A.FLOAT_ARRAY_2)}}class it extends ve{render(e,t,r,i){const n=e.value.pixelWidth*e.value.pixelHeight/35,o=Math.sqrt(n),s=Math.floor(e.value.pixelWidth/o),a=Math.ceil(e.value.pixelHeight/o);(0,Z.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(rt);n.tileCountUniform.setFloatArray2([s,a]),ge(n,e,t,r,this.getMixAtTime(i))}))}}const nt={name:"WipeRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform float angle;\nuniform float size;\nvarying vec2 texCoords;\n\nvoid main() {\n    vec4 colorA = texture2D(aTex, texCoords);\n    vec4 colorB = texture2D(bTex, texCoords);\n\n    // rotate around the center to get a remapped point\n    vec2 centerPos = vec2(0.5);\n    vec2 deltaP = texCoords - centerPos;\n    vec2 rotatedP = vec2(\n        centerPos.x + deltaP.x * cos(angle) - deltaP.y * sin(angle),\n        centerPos.y + deltaP.x * sin(angle) + deltaP.y * cos(angle)\n    );\n\n    gl_FragColor = mix(colorA, colorB, clamp((rotatedP.y - mixVal) / (size + 0.001) + 0.5, 0., 1.));\n}\n",uniformNames:["mixVal","angle","size"],samplerNames:["aTex","bTex"]};class ot extends V.A{constructor(e){super(e,nt),(0,i.A)(this,"angleUniform",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"sizeUniform",void 0),(0,i.A)(this,"topSampler",void 0),this.topSampler=this.sampler("bTex"),this.bottomSampler=this.sampler("aTex"),this.mixUniform=this.uniform("mixVal",H.A.FLOAT),this.angleUniform=this.uniform("angle",H.A.FLOAT),this.sizeUniform=this.uniform("size",H.A.FLOAT)}}class st extends ve{get angle(){return this.options&&this.options.angle?this.options.angle:0}get size(){return this.options&&this.options.size?this.options.size:.1}render(e,t,r,i){(0,Z.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(ot);n.angleUniform.setFloat(this.angle),n.sizeUniform.setFloat(this.size),ge(n,e,t,r,this.getMixAtTime(i))}))}}const at={name:"ZoomRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nvarying vec2 texCoords;\n\nvec4 getColorAtProgress(float progress) {\n    float smoothedProgress = progress * progress * progress;\n    float zoom = 1. + smoothedProgress * 3.;\n    return texture2D(aTex, (texCoords - vec2(0.5)) / zoom + vec2(0.5));\n}\n\nconst int sampleCount = 20;\nconst float blurAmount = 0.2;\n\nvoid main() {\n    vec4 accumulatedColor = vec4(0.);\n    float accumulateCount = 0.;\n    for (int i = 0; i < sampleCount; i++) {\n        float sampleIndex = float(i) / float(sampleCount);\n        float progressNeg = sampleIndex * blurAmount;\n        float progress = max(0., mixVal - progressNeg);\n        float mult = max(0., 1. - abs(2. * sampleIndex - 1.));\n        accumulatedColor += getColorAtProgress(progress) * mult;\n        accumulateCount += mult;\n    }\n\n    vec4 aColor = accumulatedColor / accumulateCount;\n    vec4 bColor = texture2D(bTex, texCoords);\n\n    float mixAmount = smoothstep(0.8, 1., mixVal);\n    gl_FragColor = mix(aColor, bColor, mixAmount);\n}\n",uniformNames:["mixVal"],samplerNames:["aTex","bTex"]};class ct extends V.A{constructor(e){super(e,at),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"topSampler",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",H.A.FLOAT)}}class lt extends ve{get reversed(){return!!this.options&&!!this.options.reversed}render(e,t,r,i){(0,Z.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(ct);this.reversed?ge(n,e,r,t,1-this.getMixAtTime(i)):ge(n,e,t,r,this.getMixAtTime(i))}))}}class dt{constructor(e){(0,i.A)(this,"currentState",void 0),(0,i.A)(this,"videoStreamId",void 0),this.root=e}isActive(e){return void 0!==this.currentState&&this.currentState.node.isActive(e)}getInnerGenerator(){return this.currentState?.node.getInnerGenerator()}render(e,t,r,i){if(void 0===this.currentState)return t.free(),void r.free();this.currentState.node.render(e,t,r,i)}updateItem(e,t,r){const i=this.root.getStreamForTrackItem(e.id),n=this.root.clock,o=n.mediaSecondsToTicks(r),s=n.mediaSecondsToTicks(r+e.durationInS),a=n.ticksToSeconds(o),c=n.ticksToSeconds(s)-a;if(void 0!==this.currentState&&e.asset===this.currentState.assetId&&c===this.currentState.durationSecs&&a===this.currentState.startSecs&&i===this.videoStreamId)return;let l;if(void 0!==this.currentState&&this.currentState.node.destroy(),void 0!==i){const e=new ue.s(this.root,i);e.start=a,e.duration=c,l=new De(this.root,a,c,e)}else{const r=t.assets.byId[e.asset],i=function(e){switch(e){case"crossBlur":return we;case"crossFade":return xe;case"fadeThrough":return _e;case"flicker":return Ie;case"glitch":return Le;case"pixelate":return ze;case"push":return qe;case"spin":return et;case"tile":return it;case"wipe":return st;case"zoom":return lt;case"mask":throw new Error("Cannot create mask transition node without video stream");default:throw new Error(`Unsupported transition type: ${e}`)}}(r.transitionType),n=(d=r.fields||[],Object.fromEntries(d.map((e=>[e.name,e.defaultValue]))));l=new i(this.root,a,c,n)}var d;this.currentState={assetId:e.asset,startSecs:a,durationSecs:c,node:l}}destroy(){void 0!==this.currentState&&(this.currentState.node.destroy(),this.currentState=void 0)}}class ut extends O{get root(){return this._root}set root(e){}get items(){return 0===this.transitions.length?this.trackItems:[...this.trackItems,...this.transitions.map((e=>e.getInnerGenerator())).filter((e=>void 0!==e))]}constructor(e){super(),(0,i.A)(this,"hidden",!1),(0,i.A)(this,"trackItems",[]),(0,i.A)(this,"transitions",[]),this._root=e}destroy(){for(const e of this.trackItems)e.destroy();for(const e of this.transitions)e.destroy()}render(e,t){const r=this.remapTime(t),i=this.findActiveTransition(r),n=[];for(const t of this.trackItems)if(t.isActive(r)){if(!i)return void t.render(e,r);const o=this.root.cloneImage(e);if(t.render(o,r),n.push(o),n.length>=2)return void i.render(e,n[0],n[1],r)}for(const e of n)e.free()}setNumItems(e){if(this.trackItems.length!==e){for(;e>this.trackItems.length;)this.trackItems.push(new fe(this._root));for(;e<this.trackItems.length;){const e=this.trackItems.pop();e&&e.destroy()}}}setNumTransitions(e){if(this.transitions.length!==e){for(;e>this.transitions.length;)this.transitions.push(new dt(this._root));for(;e<this.transitions.length;){const e=this.transitions.pop();e&&e.destroy()}}}findNodeForTrackitem(e){for(const t of this.trackItems){const r=t.findNodeForTrackitem(e);if(void 0!==r)return r}}findActiveTransition(e){for(const t of this.transitions)if(t.isActive(e))return t}}class ht extends O{constructor(e){super(),(0,i.A)(this,"items",[]),this.root=e}fitDuration(){return this.duration=this.items.reduce(((e,t)=>t.hidden?e:Math.max(e,t.start+t.duration)),0),this.duration}render(e,t){const r=this.remapTime(t),i=B.T.wrap(e);e.value.clear(D.wj);for(let e=this.items.length-1;e>=0;e--){const t=this.items[e];t.isActive(r)&&t.render(i,r)}}setNumTracks(e){if(this.items.length!==e){for(;this.items.length<e;)this.items.push(new ut(this.root));for(;this.items.length>e;){const e=this.items.shift();e&&e.destroy()}}}update(e,t){super.update(e,t)}get baseHeight(){return this.root.ctx.getRenderHeight()}get baseWidth(){return this.root.ctx.getRenderWidth()}get rotHeight(){return this.root.ctx.getRenderHeight()}get rotWidth(){return this.root.ctx.getRenderWidth()}get rotation(){return 0}}var pt=r(396159),mt=r(343314),ft=r(773395);function gt(e){return{value:e.item,ref:()=>(e.refCount++,gt(e)),free:()=>{e.refCount--}}}class At{constructor(){(0,i.A)(this,"entries",void 0),this.entries=new Map}destroy(){for(const e of this.entries.values())e.free()}static create(){const e=new At;return{value:e,free:()=>e.destroy()}}entryRefs(){const e=[];for(const[t,r]of this.entries)e.push([t,r.item]);return e}tryGet(e){const t=this.entries.get(e);if(void 0!==t)return t.refCount++,gt(t)}tryGetRef(e){const t=this.entries.get(e);if(void 0!==t)return t.item}get(e,t){const r=this.entries.get(e);if(void 0!==r)return r.refCount++,gt(r);const i=t(),n={refCount:1,item:i.value,free:i.free};return this.entries.set(e,n),gt(n)}collectGarbage(){const e=[];for(const[t,r]of this.entries)0===r.refCount&&(r.free(),e.push(t));for(const t of e)this.entries.delete(t)}tryCollect(e){const t=this.entries.get(e);void 0!==t&&0===t.refCount&&(t.free(),this.entries.delete(e))}}class vt{constructor(){(0,i.A)(this,"deferredCache",void 0),this.deferredCache=At.create()}destroy(){this.deferredCache.free()}static create(){const e=new vt;return{value:e,free:()=>e.destroy()}}entryRefs(){return this.deferredCache.value.entryRefs()}get(e,t){const r=this.deferredCache.value.get(e,t);return this.createRef(e,r)}createRef(e,t){return{value:t.value,ref:()=>this.createRef(e,t.ref()),free:()=>{t.free(),this.deferredCache.value.tryCollect(e)}}}}class yt{constructor(e,t){(0,i.A)(this,"fontCache",void 0),(0,i.A)(this,"fonts",vt.create()),(0,i.A)(this,"isStale",!1),this.module=e,this.db=t,this.fontCache=e.createFontCache([]),this.db.set(b.Qk,this.fontCache.fontCollection)}getFont(e,t){return this.fonts.value.get(e,(()=>(this.isStale=!0,t())))}update(){if(this.isStale){this.fontCache.destroy();const e=this.fonts.value.entryRefs().map((([e,t])=>t));this.fontCache=this.module.createFontCache(e),this.db.set(b.Qk,void 0),this.db.set(b.Qk,this.fontCache.fontCollection),this.isStale=!1}}destroy(){this.fontCache.destroy(),this.db.set(b.Qk,void 0),this.fonts.free(),this.isStale=!1}}var bt=r(393279),wt=r(555333);r(116962);class xt{static create(e){const t=new xt(e);return{value:t,free(){t.destroy()}}}get pixelWidth(){return this._texture?.getSize().width||0}get pixelHeight(){return this._texture?.getSize().height||0}get relativeWidth(){return this.pixelWidth}get relativeHeight(){return this.pixelHeight}get format(){return this._format}get hasValidMipmap(){return this._hasValidMipmap}constructor(e){(0,i.A)(this,"relative",!1),(0,i.A)(this,"_format",bt.bj),(0,i.A)(this,"_hasValidMipmap",!1),(0,i.A)(this,"_texture",void 0),this.root=e}reinitializeResources(){this._texture&&this._texture.dispose(),this._texture=void 0}bindSampler(e=wt.TL){if(!this._texture){const e=new Error("Attempting to bind a none initialized or disposed texture");throw this.root.ctx.logError(e),e}return(0,wt.S3)(this._texture,e,this.hasValidMipmap),this._texture}upload(e,t){const r=(i=e)instanceof HTMLImageElement?{width:i.naturalWidth,height:i.naturalHeight}:i instanceof HTMLVideoElement?{width:i.videoWidth,height:i.videoHeight}:i instanceof VideoFrame?{width:i.displayWidth,height:i.displayHeight}:{width:i.width,height:i.height};var i;if(0===r.width||0===r.height)return void this.root.ctx.logError(new Error("Attempting to upload a 0x0 image"));const n=this._initTextureForUpload(r.width,r.height,t);this.root.performance.markTextureUploadStart(),this.root.ctx.engine.updateDynamicTexture(n,e,!t.yFlipped,t.isAlreadyPremult),this.root.performance.markTextureUploadEnd(),this._hasValidMipmap=n.generateMipMaps,this._format=bt.bj}uploadBuffer(e,t,r,i){const n=this._initTextureForUpload(t,r,i);this.root.performance.markTextureUploadStart();const o=this.root.ctx.engine._gl;o&&(o.bindTexture(WebGLRenderingContext.TEXTURE_2D,n._hardwareTexture?.underlyingResource),o.pixelStorei(WebGLRenderingContext.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.isAlreadyPremult?0:1),o.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,i.yFlipped?0:1),o.pixelStorei(WebGLRenderingContext.UNPACK_ALIGNMENT,1),o.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,i.imageFormat.internalFormat,t,r,0,i.bufferFormat.channels,i.bufferFormat.type,e)),this.root.performance.markTextureUploadEnd(),n.isReady=!0,n.generateMipMaps&&this.root.ctx.engine.generateMipmaps(n),this._hasValidMipmap=n.generateMipMaps,this._format=i.imageFormat}unwrap(){return(0,Z.Ar)(this)}_initTextureForUpload(e,t,r){const i=(r.generateMipmap??!1)&&this.root.ctx.engine.webGLVersion>=2;if(this._texture){const r=this._texture.getInternalTexture();!r||e===r.baseWidth&&t===r.baseHeight&&i===r.generateMipMaps||(this._texture.dispose(),this._texture=void 0)}let n;if(this._texture){const r=this._texture.getInternalTexture();null==r?(n=this.root.ctx.engine.createDynamicTexture(e,t,i,0),this._texture=new d.D(n)):n=r}else n=this.root.ctx.engine.createDynamicTexture(e,t,i,0),this._texture=new d.D(n);return n}destroy(){this._texture?.dispose()}}var St=r(752904);const Tt={r:0,g:0,b:0,a:1};class Ct{get ctx(){return this._ctx}get allocatedTextureCount(){return this._textures.length+this._uploadTextures.length}get allocatedTextureApproximateSizeBytes(){let e=0;for(const t of this._textures){const r=(0,bt.j7)((0,bt.YI)(t.image.value.format));e+=t.image.value.pixelWidth*t.image.value.pixelHeight*r}return e}static makeBufferOwnedValue(e,t){return{value:e,free(){t.isDestroyed&&console.error("Attempting to double-free an image"),t.isDestroyed=!0}}}constructor(e,t,r,n,o,s,a,c){(0,i.A)(this,"loadChange",void 0),(0,i.A)(this,"stallChange",void 0),(0,i.A)(this,"unstallRequest",void 0),(0,i.A)(this,"loadState",void 0),(0,i.A)(this,"_destroyed",!1),(0,i.A)(this,"_destroyedSubject",new F.B),(0,i.A)(this,"_loadChange",new R.t(!1)),(0,i.A)(this,"_outputBuffer",void 0),(0,i.A)(this,"_stallChange",new R.t(!1)),(0,i.A)(this,"_textures",[]),(0,i.A)(this,"_uploadTextures",[]),(0,i.A)(this,"_unstallRequest",new F.B),(0,i.A)(this,"_loadState",new R.t("loading")),(0,i.A)(this,"fontProvider",void 0),(0,i.A)(this,"db",new ft.f(0)),(0,i.A)(this,"rendererState",void 0),this._ctx=e,this.libverse=t,this.canvaskit=r,this.clock=n,this.reader=o,this.requestRender=s,this.performance=a,this.debugOverlayRenderer=c,this.loadChange=this._loadChange.pipe((0,pt.F)()),this.stallChange=this._stallChange.pipe((0,pt.F)()),this.unstallRequest=this._unstallRequest.asObservable(),this.loadState=this._loadState.pipe((0,pt.F)()),this._outputBuffer=wt.xc.create(this,!0,1,1,bt.bj),this._ctx.contextRestored.pipe((0,mt.Q)(this._destroyedSubject)).subscribe((()=>{this._outputBuffer.value.reinitializeResources();for(const e of this._textures)e.image.value.reinitializeResources();for(const e of this._uploadTextures)e.value.reinitializeResources()}))}getStreamForTrackItem(e){return this.rendererState?.getStreamForTrackItem(e)}allocCopyImage(){const e=xt.create(this);return this._uploadTextures.push(e),{value:e.value,free:()=>{e.free();const t=this._uploadTextures.indexOf(e);-1!==t&&this._uploadTextures.splice(t,1)}}}allocImage(e=!0,t=1,r=1,i=bt.bj){return this.findAvailableBuffer((n=>n.relative===e&&n.relativeWidth===t&&n.relativeHeight===r&&n.format.internalFormat===i.internalFormat),(()=>wt.xc.create(this,e,t,r,i)))}cloneImage(e){return this.allocImage(e.value.relative,e.value.relativeWidth,e.value.relativeHeight,e.value.format)}destroy(){this._destroyed=!0,this._destroyedSubject.next(),this._destroyedSubject.complete(),this._loadChange.complete(),this._stallChange.complete(),this._unstallRequest.complete(),this._outputBuffer.free();for(const e of this._textures)e.image.free();this.db.clear(),this.fontProvider?.destroy()}render(e,t,r,i,n){if(this._destroyed)throw new Error("Attempting to render to destroyed RootNode");if(0===e||0===t)return this._outputBuffer;if(this.ctx.isContextLost())return this._outputBuffer;this.performance.markFrameStart();try{this.ctx.setRenderSize(e,t),this.cleanupTextures(),this.renderGenerator(r,i,n),this.renderDebugOverlays()}finally{this.performance.markFrameEnd()}return this._outputBuffer}requestUnstall(e){this._unstallRequest.next(e)}setLoadState(e){this._loadState.next(e)}reset(){this._loadChange.next(!1),this._stallChange.next(!1)}cleanupTextures(){this._outputBuffer.value.updateSize();for(let e=0;e<this._textures.length;e++){const t=this._textures[e];!t.frameUse&&t.isDestroyed?(t.image.free(),this._textures.splice(e,1),e--):(t.frameUse=!1,t.image.value.updateSize())}}getFontProvider(e){if(this._destroyed)throw new Error("Attempting to get font manager from destroyed RootNode");return void 0===this.fontProvider&&(this.fontProvider=new yt(e,this.db)),this.fontProvider}display(e){Tt.a=this.ctx.features.alphaInOutput?0:1,this.ctx.engine.restoreDefaultFramebuffer(),this.ctx.engine.clear(Tt,!0,!1,!1);const t=this.ctx.renderers.get(St.n);t.renderSampler.set(e.value.bindSampler()),t.renderToCurrent()}displayGenerator(){this.display(this._outputBuffer)}findAvailableBuffer(e,t){for(const t of this._textures){const r=t.image.value;if(t.isDestroyed&&e(r))return t.isDestroyed=!1,t.frameUse=!0,Ct.makeBufferOwnedValue(r,t)}const r=t(),i={image:r,isDestroyed:!1,frameUse:!0};return this._textures.push(i),this.allocatedTextureCount>50&&(console.warn(`Texture memory leak detected: ${this._textures.length} textures are allocated in ${this.ctx.name}`),this.ctx.features.reportTextureLeaks&&this.ctx.logError(new Error("A texture memory leak occurred"))),Ct.makeBufferOwnedValue(r.value,i)}renderGenerator(e,t,r){e.update(t,r),e.render(this._outputBuffer,t)}renderDebugOverlays(){this.debugOverlayRenderer?.render(this,B.T.wrap(this._outputBuffer))}}const _t={updateTracks(e,t,r,i){e.setNumTracks(r.length);for(let n=r.length-1;n>=0;n--){const o=r[n],s=t.tracks.byId[o],a=e.items[n];a.setNumItems(s.itemIds.length),a.setNumTransitions(s.transitionIds.length),a.hidden=s.hidden;for(let e=0;e<s.itemIds.length;e++){const r=t.items.byId[s.itemIds[e]];a.trackItems[e].updateItem(r,t,i)}for(let e=0;e<s.transitionIds.length;e++){const r=t.items.transitions[s.transitionIds[e]],i=a.transitions[e],n=t.items.byId[r.fromId];i.updateItem(r,t,n.startTime+n.duration-r.durationInS)}a.fitDuration()}e.fitDuration()}},kt={markFrameStart:()=>{},markFrameEnd:()=>{},markTextureUploadStart:()=>{},markTextureUploadEnd:()=>{},markTextureDownloadStart:()=>{},markTextureDownloadEnd:()=>{},markCheckErrorStart:()=>{},markCheckErrorEnd:()=>{},markCheckFramebufferStart:()=>{},markCheckFramebufferEnd:()=>{}};class Et{constructor(e,t,r,n,o,s){(0,i.A)(this,"ctx",void 0),(0,i.A)(this,"root",void 0),(0,i.A)(this,"timelineNode",void 0),(0,i.A)(this,"waker",void 0),(0,i.A)(this,"lastPollSeconds",0),this.builderOptions=s,this.ctx=new M("native",e,{level:"prefer-webgl2",reportTextureLeaks:!0,alphaInOutput:!0}),this.root=new Ct(this.ctx,t,r,n,o,(e=>this.onNodeRequestRender(e)),kt,this.createDebugOverlayRenderer(o,n)),this.timelineNode=new ht(this.root)}setRenderState(e){void 0!==e.project&&(this.root.rendererState=e,_t.updateTracks(this.timelineNode,e.project,e.project.tracks.allIds,this.builderOptions),this.root.db.set(y.Iz,{entities:e.project.entities}),this.waker?.wake())}poll(e,t){const r=this.root.clock.ticksToSeconds(t);return this.waker=e,this.lastPollSeconds=r,this.timelineNode.update(r,!1),this.timelineNode.isStalled(r)?a.eG:a.yE}render(){return this.root.render(this.root.ctx.getRenderWidth(),this.root.ctx.getRenderHeight(),this.timelineNode,this.lastPollSeconds,!0).value.texture}copyToFramebuffer(){this.root.displayGenerator()}pollTextAtomBounds(e,t,r){const i=this.getVerseNode(t);return void 0===i?(0,a.eO)(void 0):i.pollBounds(e,r)}setTextAtomEditing(e,t,r){const i=this.getVerseNode(e);i?.setEditing(t,r)}setComponentEditing(e,t){const{db:r}=this.root,i=new Set(r.read(b.Db));t?i.add(e):i.delete(e),r.set(b.Db,i),this.waker?.wake()}setCropping(e,t){const r=this.findNodeForTrackitem(e);r?.setCropping(t)}setResolution(e,t){this.ctx.setRenderSize(e,t)}enableOverlays(e){this.root.debugOverlayRenderer?.enableOverlays(this.root,e)}destroy(){this.timelineNode.destroy(),this.root.destroy(),this.ctx.destroy()}onNodeRequestRender(e){this.waker&&e.isActive(this.lastPollSeconds)&&this.waker.wake()}getVerseNode(e){const t=this.findNodeForTrackitem(e);return t?.getVerseNode()}findNodeForTrackitem(e){for(const t of this.timelineNode.items){const r=t.findNodeForTrackitem(e);if(void 0!==r)return r}}createDebugOverlayRenderer(e,t){const r={paint:()=>new C,allocations:e=>new S(e)};return e instanceof v.r&&(r.streamCache=()=>new E(e,t)),new T.v(r)}}class It{constructor(e,t,r,n,s,a,c,l){(0,i.A)(this,"compositor",void 0),(0,i.A)(this,"waker",{wake:()=>this.wakeRealtime()}),(0,i.A)(this,"currentState",{type:"paused",mediaTime:(0,o.H)(0),canBeInaccurate:!1}),(0,i.A)(this,"frameState","idle"),(0,i.A)(this,"isDestroyed",!1),this.clock=n,this.waiter=a,this.flush=l,this.compositor=new Et(e,t,r,n,s,c),this.wakeRealtime()}setRenderState(e){this.compositor.setRenderState(e)}updatePlayback(e){this.currentState=e,this.wakeRealtime()}pollRenderFrame(e){const t=(0,s._)(this.currentState,this.clock);if("ready"===this.compositor.poll(e,t).type){const e=this.compositor.render();return(0,a.eO)(e)}return a.eG}pollTextAtomBounds(e,t,r){return this.compositor.pollTextAtomBounds(e,t,r)}setTextAtomEditing(e,t,r){this.compositor.setTextAtomEditing(e,t,r)}setComponentEditing(e,t){this.compositor.setComponentEditing(e,t)}setCropping(e,t){this.compositor.setCropping(e,t)}setResolution(e,t){this.compositor.setResolution(e,t)}enableOverlays(e){this.compositor.enableOverlays(e)}destroy(){this.isDestroyed=!0,this.compositor.destroy()}wakeRealtime(){!this.isDestroyed&&this.clock.isRealtime&&("idle"===this.frameState&&n.w.QueueNewFrame((async()=>{this.frameState="rendering",await this.renderRealtime()})),this.frameState="queued")}async renderRealtime(){if(this.isDestroyed)return;try{const e=this.pollRenderFrame(this.waker);this.waiter.setIsWaiting("pending"===e.type),this.compositor.copyToFramebuffer(),this.flush&&await this.flush()}catch(e){console.error(`Failed to render frame: ${e}`)}const e="queued"===this.frameState;this.frameState="idle",("playing"===this.currentState.type||e)&&this.wakeRealtime()}}function Rt(e,t,r,i){return(n,o)=>new It(e,t,i?.deprecated__canvaskitWasmUrl?new g(e,i?.deprecated__canvaskitWasmUrl):new A,r,n,o,{createExternalMapper:i?.deprecated__createExternalMapper??(()=>{}),shareVerseSurface:i?.deprecated__shareVerseSurface??!0},i?.flush)}},752904:(e,t,r)=>{r.d(t,{n:()=>s});var i=r(324586),n=r(736766);const o={name:"CopyRenderer",fragmentShader:"precision mediump float;\nuniform sampler2D inTex;\nvarying vec2 texCoords;\nvoid main() { gl_FragColor = texture2D(inTex, texCoords); }\n",samplerNames:["inTex"]};class s extends n.A{constructor(e){super(e,o),(0,i.A)(this,"renderSampler",void 0),this.renderSampler=this.sampler("inTex")}}},156106:(e,t,r)=>{function i(e,t=1){return{red:e,green:e,blue:e,alpha:t}}r.d(t,{FU:()=>n,wj:()=>o});const n=i(0,0),o=i(0,1)},329506:(e,t,r)=>{r.d(t,{vF:()=>n});const i=(e,t=2)=>Math.pow(e,t);function n(e,t=2){const r=Math.pow(2,t-1);return e<.5?r*i(e,t):1-r*i(1-e,t)}},187285:(e,t,r)=>{function i(e){return Math.max(0,Math.min(n(e)/e.duration,1))}function n(e){return Math.max(0,e.time-e.start)}r.d(t,{A:()=>n,o:()=>i})},542809:(e,t,r)=>{r.d(t,{DR:()=>o,Km:()=>a}),r(562151),r(956502);const i={left:0,right:0,bottom:0,top:0},n={left:0,right:1,bottom:0,top:1},o={strategy:"fit",bounds:n,rotation:0,hasFixedBounds:!1};function s(e,t){return{left:e.left??t.left,right:e.right??t.right,bottom:e.bottom??t.bottom,top:e.top??t.top}}function a(e){return{...o,...e,bounds:e.bounds?s(e.bounds,n):o.bounds,crop:e.crop?s(e.crop,i):void 0}}},105263:(e,t,r)=>{r.d(t,{S:()=>s});var i=r(324586),n=(r(379321),r(736965)),o=r(104173);class s{constructor(e,t,r,n){(0,i.A)(this,"_streams",[]),(0,i.A)(this,"_playbackVolume",1),(0,i.A)(this,"_activeStreams",new Map),(0,i.A)(this,"_connections",new Map),(0,i.A)(this,"_connectionsReverse",new Map),(0,i.A)(this,"_playbackState",{type:"paused",mediaTime:(0,o.H)(0),canBeInaccurate:!1}),(0,i.A)(this,"maxActiveStreams",void 0),this.clock=e,this.schedulerHandler=t,this.supermixCallbacks=n,this.maxActiveStreams=r.maxActiveStreams??128}get streams(){return this._streams}get playbackVolume(){return this._playbackVolume}get activeStreams(){return this._activeStreams}get connections(){return this._connections}get connectionsReverse(){return this._connectionsReverse}get playbackState(){return this._playbackState}setPlaybackVolume(e){this._playbackVolume=e,this.supermixCallbacks?.updatePlaybackVolume?.()}setMixerState(e){this._streams=[...e.streams],this.supermixCallbacks?.updateStreamState?.(),this.updateActiveStreams();const t=[];for(const r of e.streams)t.push({time:r.timingTicks.start,callback:e=>this.updateActiveStream(r,e)},{time:r.timingTicks.end,callback:e=>this.updateActiveStream(r,e)});this.schedulerHandler.setEvents(t)}updatePlayback(e){if((0,n.N)(e,this._playbackState))return;this._playbackState=e;const t=(0,n._)(this._playbackState,this.clock);for(const e of this._streams)this.updateActiveStream(e,t)}destroy(){this.setMixerState({streams:[]})}updateActiveStreams(){const e=(0,n._)(this._playbackState,this.clock);for(const t of this._streams)this.updateActiveStream(t,e);const t=new Map(this._activeStreams);for(const e of this._streams)t.delete(e.id);for(const[e,r]of t)this.removeActiveConnection(r)}updateActiveStream(e,t){const r=t>=e.timingTicks.start&&t<e.timingTicks.end,i=this._activeStreams.get(e.id);r?void 0===i&&this.addActiveConnection(e):void 0!==i&&this.removeActiveConnection(i)}addActiveConnection(e){const{activeStream:t,connectionIndex:r}=this.createActiveStream(e.id);this.addConnection(r,e.id),this._activeStreams.set(e.id,t),this.supermixCallbacks?.updateConnectionState?.()}removeActiveConnection(e){this.removeActiveStream(e),this.removeConnection(e.streamId),this._activeStreams.delete(e.streamId),this.supermixCallbacks?.updateConnectionState?.()}addConnection(e,t){return this._connections.set(e,t),this._connectionsReverse.set(t,e),e}removeConnection(e){const t=this._connectionsReverse.get(e);void 0!==t&&(this._connectionsReverse.delete(e),this._connections.delete(t))}}},116924:(e,t,r)=>{function i(e,t){let r=0;for(;r<t;){if(!e.has(r))return r;r+=1}throw new Error("No free connection found")}r.d(t,{t:()=>i})},602445:(e,t,r)=>{r.d(t,{r:()=>c});var i=r(324586),n=(r(379321),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(736965)),o=r(80801),s=r(104173);const a={type:"paused",mediaTime:(0,s.H)(0),canBeInaccurate:!1};class c{constructor(e,t,r,n,o){(0,i.A)(this,"schedulerHandler",void 0),(0,i.A)(this,"streams",new Map),(0,i.A)(this,"resources",new Map),(0,i.A)(this,"currentStreamDefs",[]),(0,i.A)(this,"currentState",a),(0,i.A)(this,"isGarbageCollectScheduled",!1),this.resolveSource=e,this.deferredScheduler=r,this.clock=n,this.options=o,this.schedulerHandler=t.createHandle()}pollRead(e,t,r,i){let o=this.streams.get(t);if(!o){const e=this.currentStreamDefs.find((e=>e.id===t));if(void 0===e)console.error(`While polling stream ${t} at ${r} ticks: stream does not exist`);else{const i=(0,n._)(this.currentState,this.clock);console.warn(`While polling stream ${t} at ${r} ticks: stream is not loaded but a candidate exists from ${e.timing.start} ticks to ${e.timing.end} ticks, attempting update at ${i} ticks`),this.updateStreams([e],i),this.updateAllResources(i),o=this.streams.get(t)}if(!o)throw new Error("Stream is not loaded")}const a=o;if(!a.resource.ready)throw new Error("Tried to poll invalid resource");a.lastWaker=e;const c={wake:()=>function(e,t){for(const r of e.streams)r.lastWaker&&r.type===t&&r.lastWaker.wake()}(a.resource,a.type)},l=(0,s._K)(r,a.mediaOffset);return a.resource.ready.source.pollRead(c,a.type,l,i)}updatePlayback(e){if((0,n.N)(e,this.currentState))return;this.currentState=e;const t=(0,n._)(this.currentState,this.clock);this.updateStreams(this.currentStreamDefs,t),this.updateAllResources(t)}setStreams(e){e.sort(((e,t)=>e.timing.start-t.timing.start)),this.currentStreamDefs=e;const t=(0,n._)(this.currentState,this.clock),r=[];for(const t of e){const e=this.deleteStreamIfChanged(t);e&&e.lastWaker&&r.push([t.id,e])}this.updateStreams(e,t);const i=new Map(this.streams);for(const t of e)i.delete(t.id);for(const[e,t]of i)this.streams.delete(e),t.resource.streams.splice(t.resource.streams.indexOf(t),1);this.updateAllResources(t);for(const[e,t]of r){const r=this.streams.get(e);r&&(r.lastWaker=t.lastWaker,r.resource!==t.resource&&t.lastWaker?.wake())}const o=new Map;for(const t of e){const e=t.timing.start-t.timing.preload,r=t.timing.start,i=t.timing.end,n=t.timing.end+t.timing.unload;d(o,e,t),d(o,r,t),d(o,i,t),d(o,n,t)}this.schedulerHandler.setEvents([...o].map((([e,t])=>({time:e,callback:e=>{this.updateStreams(t,e),this.updateAllResources(e)}}))))}getDebugState(){const e=(0,n._)(this.currentState,this.clock),t=[];for(const[r,i]of this.resources)for(const n of i){const i=n.ready;if(!i)continue;const o=n.streams.map((t=>({timing:t.timing,state:e<t.timing.start?"loading":e<t.timing.end?"active":"unloading",type:t.type})));t.push({assetId:r,playbackState:i.latestState?.playback??a,config:i.latestState?.config??{playbackRate:0,loop:!1},streamTypes:i.streamTypes,streams:o})}return{time:e,sources:t}}destroy(){this.setStreams([])}deleteStreamIfChanged(e){const t=this.streams.get(e.id);var r,i;if(t&&(t.resource.assetId!==e.assetId||!(0,o.H)(t.config,e.config)||(r=t.timing,i=e.timing,r.start!==i.start||r.end!==i.end||r.offset!==i.offset||r.preload!==i.preload||r.gap!==i.gap||r.unload!==i.unload)))return this.streams.delete(e.id),t.resource.streams.splice(t.resource.streams.indexOf(t),1),t}updateStreams(e,t){for(const r of e){const e=this.streams.get(r.id);!l(r,t)&&e&&(this.streams.delete(r.id),e.resource.streams.splice(e.resource.streams.indexOf(e),1))}for(const r of e){const e=this.streams.get(r.id);if(!l(r,t)||t>=r.timing.end||e)continue;const i=(0,s.z1)(r.timing.offset-r.timing.start),n=this.getOrCreateResourceForStream(r,i,t),o={type:r.type,resource:n,timing:r.timing,config:r.config,mediaOffset:i,lastWaker:void 0};n.streams.push(o),this.streams.set(r.id,o)}}getOrCreateResourceForStream(e,t,r){const i=this.resources.get(e.assetId);if(i){const n=(0,s.H)(Math.max(r,e.timing.start-e.timing.gap)),a=function(e,t,r,i,n){for(const l of e){if(l.ready&&!l.ready.streamTypes.has(t))continue;const e=l.streams.find((e=>n<e.timing.end));if(e&&(s=e.mediaOffset,a=r,c=1,Math.abs(s-a)<=c&&(0,o.H)(e.config,i)))return l}var s,a,c;for(const r of e)if((!r.ready||r.ready.streamTypes.has(t))&&r.streams.every((e=>n>=e.timing.end)))return r}(i,e.type,t,e.config,n);if(a)return a}const n={assetId:e.assetId,streams:[],ready:void 0};return i?i.push(n):this.resources.set(e.assetId,[n]),n}updateAllResources(e){let t=!1;for(const r of this.resources.values())for(const i of r)this.updateResourceState(i,e),0===i.streams.length&&(t=!0);t&&this.scheduleGarbageCollect()}updateResourceState(e,t){const r=this.getResourceState(e,t),i=e.ready;if(i)(0,o.H)(i.latestState.config,r.config)||i.source.setConfig(r.config),(0,n.N)(i.latestState.playback,r.playback)||i.source.updatePlayback(r.playback),i.latestState=r;else{const t=new Set;for(const r of e.streams)t.add(r.type);const i=this.resolveSource(e.assetId,t,r.config);i.setConfig(r.config),i.updatePlayback(r.playback),e.ready={source:i,streamTypes:t,latestState:r}}}getResourceState(e,t){if(0===e.streams.length){if(!e.ready)throw new Error("Tried to get state of invalid resource");return{config:e.ready.latestState.config,playback:{type:"paused",mediaTime:(0,s.H)(0),canBeInaccurate:!0}}}const r=e.streams.filter((e=>t<e.timing.end));if(0===r.length){const t=function(e){if(0===e.length)return;let t=e[0];for(const r of e)r.timing.end>t.timing.end&&(t=r);return t}(e.streams)??e.streams[0],r=t.timing.offset+t.timing.end-t.timing.start;return{config:t.config,playback:{type:"paused",mediaTime:(0,s.H)(r),canBeInaccurate:!0}}}if(r.some((e=>t>=e.timing.start))){const e=r[0].mediaOffset,t=r[0].config;let i;switch(this.currentState.type){case"playing":i={type:"playing",mediaDelta:(0,s.z1)(this.currentState.mediaDelta+e)};break;case"paused":i={type:"paused",mediaTime:(0,s.H)(this.currentState.mediaTime+e),canBeInaccurate:this.currentState.canBeInaccurate}}return{config:t,playback:i}}const i=function(e){if(0===e.length)return;let t=e[0];for(const r of e)r.timing.start<t.timing.start&&(t=r);return t}(r)??r[0];return{config:i.config,playback:{type:"paused",mediaTime:(0,s.H)(i.timing.offset),canBeInaccurate:!1}}}scheduleGarbageCollect(){this.isGarbageCollectScheduled||(this.isGarbageCollectScheduled=!0,this.deferredScheduler((()=>{this.isGarbageCollectScheduled&&(this.isGarbageCollectScheduled=!1,this.destroyEmptyResources())})))}destroyEmptyResources(){for(const[e,t]of this.resources){const r=[];for(const e of t)e.ready&&0===e.streams.length?e.ready.source.destroy():r.push(e);r.length>0?this.resources.set(e,r):this.resources.delete(e)}}}function l(e,t){return t>=e.timing.start-e.timing.preload&&t<e.timing.end+e.timing.unload}function d(e,t,r){const i=e.get(t);i?i.push(r):e.set(t,[r])}},573432:(e,t,r)=>{r.d(t,{z:()=>o});var i=r(324586),n=r(104173);class o{constructor(e,t){(0,i.A)(this,"isRealtime",void 0),(0,i.A)(this,"timebase",void 0),this.isRealtime=e,this.timebase=t}mediaSecondsToTicks(e){return(0,n.H)(Math.round(e*this.timebase))}mediaMsToTicks(e){return this.mediaSecondsToTicks(e/1e3)}durationSecondsToTicks(e){return(0,n.z1)(Math.round(e*this.timebase))}durationMsToTicks(e){return this.durationSecondsToTicks(e/1e3)}ticksToSeconds(e){return e/this.timebase}ticksToMs(e){return 1e3*this.ticksToSeconds(e)}}},641306:(e,t,r)=>{r.d(t,{K:()=>i,y:()=>n});const i={type:"end"},n={type:"busy"}},677763:(e,t,r)=>{r.d(t,{eG:()=>i,eO:()=>o,yE:()=>n});const i={type:"pending"},n={type:"ready",value:void 0};function o(e){return{type:"ready",value:e}}},707050:(e,t,r)=>{r.d(t,{_:()=>o});var i=r(324586),n=r(677763);class o{constructor(e){(0,i.A)(this,"inner",{type:"pending",destroyed:!1,config:void 0,state:void 0,readWakers:new Map}),e.then((e=>{if("ready"===this.inner.type||"error"===this.inner.type)return;const t=this.inner;if(this.inner={type:"ready",source:e},t.destroyed)e.destroy();else{void 0!==t.config&&e.setConfig(t.config),void 0!==t.state&&"paused"===t.state.type?e.updatePlayback({type:"paused",mediaTime:t.state.mediaTime,canBeInaccurate:!1}):void 0!==t.state&&e.updatePlayback(t.state);for(const e of t.readWakers.values())e.wake()}})).catch((e=>{if("ready"===this.inner.type||"error"===this.inner.type)return;const t=this.inner;this.inner={type:"error",error:e};for(const e of t.readWakers.values())e.wake()}))}updatePlayback(e){if("ready"===this.inner.type)this.inner.source.updatePlayback(e);else{if("error"===this.inner.type)throw this.inner.error;this.inner.state=e}}pollRead(e,t,r,i){if("ready"===this.inner.type)return this.inner.source.pollRead(e,t,r,i);if("error"===this.inner.type)throw this.inner.error;return this.inner.readWakers.set(t,e),n.eG}setConfig(e){if("ready"===this.inner.type)this.inner.source.setConfig(e);else{if("error"===this.inner.type)throw this.inner.error;this.inner.config=e}}destroy(){if("ready"===this.inner.type)this.inner.source.destroy();else{if("error"===this.inner.type)throw this.inner.error;this.inner.destroyed=!0}}}},708451:(e,t,r)=>{r.d(t,{I:()=>h});var i=r(324586),n=(r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(641306)),o=(r(379321),r(677763)),s=r(104173);const a={type:"retry"};class c{constructor(e){(0,i.A)(this,"buffer",[]),(0,i.A)(this,"headValue",void 0),(0,i.A)(this,"tailState",{type:"idle"}),(0,i.A)(this,"resetTime",void 0),(0,i.A)(this,"isReading",!1),(0,i.A)(this,"nextHintTime",(0,s.H)(0)),this.config=e}getBufferedDuration(){const e=this.buffer.at(-1);if(void 0===e)return(0,s.z1)(0);const t=this.buffer[0];return(0,s.h9)(t.startTime,e.startTime)}isAvailableSynchronously(e){let t;if(void 0!==this.headValue)t=this.headValue.startTime;else{if(!(this.buffer.length>0))return!1;t=this.buffer[0].startTime}const r=this.buffer.at(-1);return void 0!==r&&e>=t&&e<=r.startTime}reset(e){this.clearBuffer(),this.headValue=void 0,this.tailState={type:"seeking",waker:{wake:()=>{}},time:e},this.resetTime=e,this.startReading()}destroy(){this.setError(new Error("Decoder was destroyed"))}pollRead(e,t){if("error"===this.tailState.type)throw this.tailState.error;if(void 0!==this.headValue&&(t===this.headValue.startTime||this.isBeforeBuffer(t)))return(0,o.eO)(this.headValue.cached);const r=this.findBufferIndex(t);if(-1!==r){const e=this.buffer[r],t={startTime:e.startTime,cached:e.value()};return this.clearBufferTo(r+1),this.headValue=t,this.startReading(),(0,o.eO)(this.headValue.cached)}if("ended"===this.tailState.type){const e=this.tailState.lastData??this.buffer.at(-1);if(void 0!==e){const t={startTime:e.startTime,cached:e.value()};this.clearBuffer(),this.headValue=t}if(this.tailState.lastData=void 0,this.headValue)return(0,o.eO)(this.headValue.cached)}return this.buffer.length>0&&this.clearBufferTo(this.buffer.length-1),this.tailState={type:"seeking",waker:e,time:t},this.startReading(),o.eG}startReading(){!this.isReading&&this.canReadInState()&&(this.isReading=!0,this.readLoop().catch((e=>this.setError(e))))}async readLoop(){this.isReading=!0;try{for(;this.canReadInState();){const e="seeking"===this.tailState.type?this.tailState.time:this.nextHintTime;this.resetTime=void 0;const t=await this.readNext(e);if(void 0!==this.resetTime){"data"===t.type&&t.startTime>this.resetTime&&t.destroy(),this.resetTime=void 0;continue}if(!this.canReadInState()){"data"===t.type&&t.destroy();break}if("end"===t.type){const e=this.tailState;this.tailState={type:"ended",lastData:t.lastData},"seeking"===e.type&&e.waker.wake();continue}if("busy"===t.type)break;if("retry"===t.type)continue;const r=this.buffer.at(-1)??this.headValue;if(r&&t.startTime<r.startTime)this.clearBuffer();else if(r&&t.startTime===r.startTime){t.destroy();continue}if(this.nextHintTime=(0,s.H)(t.startTime+1),"seeking"===this.tailState.type&&this.tailState.time>t.startTime)this.clearBuffer(),this.buffer.push(t);else{if(this.buffer.push(t),"seeking"===this.tailState.type){const e=this.tailState.waker;this.tailState={type:"idle"},e.wake()}if(this.getBufferedDuration()>=this.config.maxLookAheadDuration)break}}}finally{this.isReading=!1}}setError(e){const t=this.tailState;this.clearBuffer(),this.tailState={type:"error",error:e},"seeking"===t.type&&t.waker.wake()}findBufferIndex(e){const t=this.buffer.at(-1);if(void 0===t||e>t.startTime)return-1;for(let t=1;t<this.buffer.length;t++)if(e<this.buffer[t].startTime)return t-1;return this.buffer.length-1}isBeforeBuffer(e){return this.buffer.length>0&&e<this.buffer[0].startTime}clearBuffer(){this.headValue=void 0;for(const e of this.buffer)e.destroy();this.buffer.length=0}clearBufferTo(e){this.headValue=void 0;const t=this.buffer.splice(0,e);for(const e of t)e.destroy()}canReadInState(){return"seeking"===this.tailState.type||"idle"===this.tailState.type}}class l extends c{constructor(e,t,r){super(r),this.stream=e,this.context=t}async readNext(e){const t=this.context.getLoopMediaDelta();let r=await this.context.decoder.readNext(this.stream,(0,s.H)(e-t));if("end"===r.type){const e=this.context.onStreamEnded(this.stream);r="end"===e.type?r:e}if("end"===r.type)return r;if("retry"===r.type)return a;if("busy"===r.type)return this.context.onStreamBusy(this.stream),n.y;this.context.onStreamData(this.stream);const i=r;return{type:"data",startTime:(0,s.H)(i.startTime+t),value:()=>i.value(),destroy:()=>i.destroy()}}}var d=r(736965);class u{constructor(e,t,r){(0,i.A)(this,"readers",void 0),(0,i.A)(this,"busyStreams",new Set),(0,i.A)(this,"waitingForLoopStreams",new Set),(0,i.A)(this,"playbackRate",1),(0,i.A)(this,"isLooping",!1),(0,i.A)(this,"playbackState",void 0),(0,i.A)(this,"loopIndex",0),this.decoder=e,this.clock=t,this.config=r,this.readers=Object.fromEntries(e.streams.map((e=>[e,new l(e,this,r)])))}destroy(){for(const e of this.decoder.streams)this.readers[e].destroy();this.decoder.destroy()}pollRead(e,t,r){if(!(t in this.readers))throw new Error(`Stream '${t}' not supported`);return this.readers[t].pollRead(e,(0,s.H)(Math.floor(r)))}setConfig({loop:e,...t}){const r=this.config.loopDuration>0,i=e&&r;i===this.isLooping&&t.playbackRate===this.playbackRate||(this.isLooping=i,this.playbackRate=t.playbackRate,this.decoder.setConfig(t),void 0!==this.playbackState&&this.seek(this.getPlaybackMediaTicksQuantized(this.playbackState)))}updatePlayback(e){const t=this.getPlaybackMediaTicksQuantized(e),r=this.playbackState;this.playbackState=e,(void 0===r||t!==this.getPlaybackMediaTicksQuantized(r))&&this.seek(t)}onStreamData(e){if(this.busyStreams.delete(e),0!==this.busyStreams.size){for(const e of this.busyStreams)this.readers[e].startReading();this.busyStreams.clear()}}onStreamBusy(e){this.busyStreams.add(e)}onStreamEnded(e){return this.isLooping?(this.waitingForLoopStreams.add(e),this.waitingForLoopStreams.size===this.decoder.streams.length?(this.waitingForLoopStreams.clear(),this.loopIndex++,this.decoder.seek((0,s.H)(0)),a):n.y):n.K}getLoopMediaDelta(){const e=this.config.loopDuration/this.playbackRate;return(0,s.z1)(Math.ceil(this.loopIndex*e))}getLoopedDecoderTime(e){if(this.isLooping){const t=this.config.loopDuration/this.playbackRate;return{seekTime:(0,s.H)(Math.floor(e%t)),loopIndex:Math.floor(e/t)}}return{seekTime:e,loopIndex:0}}seek(e){if(this.decoder.streams.every((t=>this.readers[t].isAvailableSynchronously(e))))return;this.busyStreams.clear(),this.waitingForLoopStreams.clear();const t=this.getLoopedDecoderTime(e);this.loopIndex=t.loopIndex,this.decoder.seek(t.seekTime);for(const t of this.decoder.streams)this.readers[t].reset(e)}getPlaybackMediaTicksQuantized(e){return(0,s.H)(Math.floor((0,d._)(e,this.clock)))}}function h(e,t,r){return new u(e,t,r)}},647306:(e,t,r)=>{async function i(e,t){const r=t[e];if(void 0===r)throw new Error(`Stream '${e}' not supported`);return await r()}r.d(t,{y:()=>i})},626395:(e,t,r)=>{function i(e){return new Promise(((t,r)=>{let i=!0;const n=()=>{try{const r=e(o);"ready"===r.type&&(i=!1,t(r.value))}catch(e){i=!1,r(e)}},o={wake:()=>{i&&(i=!1,queueMicrotask((()=>{i=!0,n()})))}};n()}))}r.d(t,{L:()=>i})},668359:(e,t,r)=>{r.d(t,{K:()=>o});var i=r(324586),n=r(677763);class o{constructor(){(0,i.A)(this,"inner",{type:"pending",config:void 0,state:void 0,readWakers:new Map})}setInner(e){if("ready"===this.inner.type&&this.inner.source.destroy(),"destroyed"!==this.inner.type){this.inner={type:"ready",source:e,config:this.inner.config,state:this.inner.state,readWakers:this.inner.readWakers},void 0!==this.inner.config&&e.setConfig(this.inner.config),void 0!==this.inner.state&&e.updatePlayback(this.inner.state);for(const e of this.inner.readWakers.values())e.wake()}else e.destroy()}updatePlayback(e){if("destroyed"===this.inner.type)throw new Error("Cannot update destroyed source");"ready"===this.inner.type&&this.inner.source.updatePlayback(e),this.inner.state=e}pollRead(e,t,r,i){if("destroyed"===this.inner.type)throw new Error("Cannot poll destroyed source");return this.inner.readWakers.set(t,e),"pending"===this.inner.type?n.eG:this.inner.source.pollRead(e,t,r,i)}setConfig(e){if("destroyed"===this.inner.type)throw new Error("Cannot update destroyed source");"ready"===this.inner.type&&this.inner.source.setConfig(e),this.inner.config=e}destroy(){"ready"===this.inner.type&&this.inner.source.destroy(),this.inner={type:"destroyed"}}}},736965:(e,t,r)=>{r.d(t,{N:()=>o,_:()=>n});var i=r(104173);function n(e,t){switch(e.type){case"playing":return(0,i.XT)(t.getTime(),e.mediaDelta);case"paused":return e.mediaTime;default:throw new Error(`Invalid playback state: ${e.type}`)}}function o(e,t){return"playing"===e.type&&"playing"===t.type&&e.mediaDelta===t.mediaDelta||"paused"===e.type&&"paused"===t.type&&e.mediaTime===t.mediaTime&&e.canBeInaccurate===t.canBeInaccurate}},80801:(e,t,r)=>{function i(e,t,r){const i=r[e];if(void 0===i)throw new Error(`Stream '${e}' not supported`);return i(t)}function n(e,t){return e.playbackRate===t.playbackRate&&e.loop===t.loop}r.d(t,{H:()=>n,Y:()=>i})},104173:(e,t,r)=>{function i(e){return e}function n(e){return e}function o(e){return e}function s(e,t){return t-e}function a(e,t){return e+t}function c(e,t){return s(e,t)}function l(e,t){return a(e,t)}r.d(t,{H:()=>n,L7:()=>c,Ny:()=>i,XT:()=>l,_K:()=>a,h9:()=>s,z1:()=>o})},177764:(e,t,r)=>{r.d(t,{i:()=>x});var i=r(324586),n=(r(379321),r(289111)),o=r.n(n);function s(e,t){let r=e;if(0===r.length)return;const i="italic"===t.style?t.italicStrength??1:0,n="oblique"===t.style?t.obliqueAngle??14:0,o=r.find(function(e,t,r){return i=>e.stretch>=i.minStretch&&e.stretch<=i.maxStretch&&e.weight>=i.minWeight&&e.weight<=i.maxWeight&&t>=i.minItalic&&t<=i.maxItalic&&r>=i.minObliqueAngle&&r<=i.maxObliqueAngle}(t,i,n));return void 0!==o?o:(r=function(e,t){if(e.length<=1)return e;const r=e.filter(c(t));if(r.length>0)return r;const[i,n]=a(t,e,(e=>[e.minStretch,e.maxStretch]));let o;return o=t<=100?i??n:n??i,void 0===o?[]:e.filter(c(o))}(r,t.stretch),r=function(e,t,r,i){if(e.length<=1)return e;if("italic"===t)return function(e,t){const r=e.filter(l(t));if(r.length>0)return r;const[i,n]=a(t,e,(e=>[e.minItalic,e.maxItalic])),o=n??i;if(void 0!==o&&o>0)return e.filter(l(o));const[s,c]=a(11,e,(e=>[e.minObliqueAngle,e.maxObliqueAngle])),u=c??s;return void 0!==u&&u>0?e.filter(d(u)):void 0!==o?e.filter(l(o)):void 0!==u?e.filter(d(u)):[]}(e,r);if("oblique"===t){const t=e.filter(d(i));return t.length>0?t:i>=11?u(e,i,1):i>=0?h(e,i,1):i>-11?h(e,-i,-1):u(e,-i,-1)}return function(e){const[t,r]=a(0,e,(e=>[e.minObliqueAngle,e.maxObliqueAngle]));if(void 0!==r)return e.filter(d(r));const[i,n]=a(0,e,(e=>[e.minItalic,e.maxItalic]));return void 0!==n?e.filter(l(n)):void 0!==t?e.filter(d(t)):void 0!==i?e.filter(l(i)):[]}(e)}(r,t.style,i,n),r=function(e,t){if(e.length<=1)return e;const r=e.filter(p(t));if(r.length>0)return r;const[i,n]=a(t,e,(e=>[e.minWeight,e.maxWeight]));let o;return o=t>=400&&t<=500?void 0!==n&&n<=500?n:i??n:t<400?i??n:n??i,void 0===o?[]:e.filter(p(o))}(r,t.weight),r.at(0))}function a(e,t,r){let i,n;for(const o of t){const[t,s]=r(o),a=s-e,c=t-e;a<0&&(i=void 0===i?a:Math.max(a,i)),c>0&&(n=void 0===n?c:Math.min(c,n))}return[void 0===i?void 0:e+i,void 0===n?void 0:e+n]}function c(e){return t=>e>=t.minStretch&&e<=t.maxStretch}function l(e){return t=>e>=t.minItalic&&e<=t.maxItalic}function d(e){return t=>e>=t.minObliqueAngle&&e<=t.maxObliqueAngle}function u(e,t,r){const[i,n]=a(t,e,(e=>[e.minObliqueAngle*r,e.maxObliqueAngle*r])),o=n??i;if(void 0!==o&&o>0)return e.filter(d(o*r));const[s,c]=a(1,e,(e=>[e.minItalic,e.maxItalic])),u=c??s;return void 0!==u&&u>0?e.filter(l(u)):void 0!==i&&i<=0?e.filter(d(i*r)):void 0!==s&&s<=0?e.filter(l(s)):[]}function h(e,t,r){const[i,n]=a(t,e,(e=>[e.minObliqueAngle*r,e.maxObliqueAngle*r]));if(void 0!==i&&i>0)return e.filter(d(i*r));if(void 0!==n)return e.filter(d(n*r));const[o,s]=a(1,e,(e=>[e.minItalic,e.maxItalic]));return void 0!==o&&o>0?e.filter(l(o)):void 0!==s?e.filter(l(s)):void 0!==i&&i<=0?e.filter(d(i*r)):void 0!==o?e.filter(l(o)):[]}function p(e){return t=>e>=t.minWeight&&e<=t.maxWeight}var m=r(773395),f=r(104173),g=r(751203);function A([e,t],r){return[e*Math.cos(r)-t*Math.sin(r),e*Math.sin(r)+t*Math.cos(r)]}const v=/^\s*(-?\d+(?:\.\d+)?)(?::(-?\d+(?:\.\d+)?))?\s*$/;function y(e){const[t,r]=function(e){const t=e.raw?function(e){return e.streams.find((e=>"video"===e.codec_type))}(e.raw):void 0;if(void 0===t)return[1,1];const r=function(e,t){if("number"==typeof e)return e;if("string"==typeof e){const r=t.exec(e);if(r){const e=Number.parseFloat(r[1]),t=Number.parseFloat(r[2]);if(Number.isNaN(t))return e;if(!Number.isNaN(e))return e/t}return Number.NaN}return Number.NaN}(t.sample_aspect_ratio,v);return Number.isNaN(r)?[1,1]:r<1?[1,1/r]:[r,1]}(e);return function([e,t],r){const[i,n]=A([e/2,t/2],r),[o,s]=A([e/2,-t/2],r),[a,c]=A([-e/2,-t/2],r),[l,d]=A([-e/2,t/2],r),u=Math.min(i,o,a,l),h=Math.min(n,s,c,d);return[Math.max(i,o,a,l)-u,Math.max(n,s,c,d)-h]}([(e.width??0)*t,(e.height??0)*r],(e.rotation??0)*Math.PI/180)}function b(e){return e.fadeInOut?{fadeInOut:e.fadeInOut}:void 0}const w={"1:1":1,"4:3":4/3,"21:9":21/9,"9:16":9/16,"16:9":16/9,"4:5":.8,"2:3":2/3};class x{constructor(e,t,r,n,o){(0,i.A)(this,"lastStreams",[]),(0,i.A)(this,"lastRendererState",{getStreamForTrackItem:()=>{},getFontsForTrackItem:()=>[],streams:[],project:void 0}),(0,i.A)(this,"lastMixerState",{getStreamForTrackItem:()=>{},streams:[]}),this.setStreams=e,this.setRendererState=t,this.setMixerState=r,this.options=n,this.clock=o}getRendererState(){return this.lastRendererState}getMixerState(){return this.lastMixerState}updateProject(e){const t=[],r=[],i=new Map,n=new Map,s=[],a=new Map,c=(e,n,o,s,a)=>{const c=`${e}-video`;t.push({id:c,type:"video",assetId:n,config:s,timing:a});const l=function(e,t){const[r,i]=y(e.metadata);return{id:t,metadata:{displayWidth:r,displayHeight:i,displayRotationRads:-(e.metadata?.rotation??0)*Math.PI/180}}}(o,c);r.push(l),i.set(e,l)},l=(e,r,i,n,o)=>{const c=`${e}-audio`;t.push({id:c,type:"audio",assetId:i,config:n,timing:o});const l=function(e,t,r,i){return{id:t,volume:e.volume??1,timingTicks:r,timing:{startSeconds:i.ticksToSeconds(r.start),durationSeconds:i.ticksToSeconds((0,f.h9)(r.start,r.end))},effects:b(e)}}(r,c,o,this.clock);s.push(l),a.set(e,l)},d=(e,r,i,o)=>{const s=[];n.set(e,s);for(const n of r){if(s.some((e=>e.assetId===n.assetId&&e.family===n.family)))continue;const r=`${e}-${n.assetId}-${n.family}-font`;t.push({id:r,type:"font",assetId:n.assetId,config:i,timing:o}),s.push({id:r,assetId:n.assetId,family:n.family})}};for(const t of e.items.allIds)this.insertItem(e,t,c,l,d);o()(t,this.lastStreams)||(this.lastStreams=t,this.setStreams(t)),this.lastRendererState={getStreamForTrackItem:e=>i.get(e),getFontsForTrackItem:e=>n.get(e)??[],streams:r,project:e},this.setRendererState(this.lastRendererState),o()(s,this.lastMixerState.streams)||(this.lastMixerState={getStreamForTrackItem:e=>a.get(e),streams:s},this.setMixerState(this.lastMixerState))}insertItem(e,t,r,i,n){const o=e.items.byId[t],s=o.speed??1,a=S(s),c={start:this.clock.mediaSecondsToTicks(o.startTime),end:this.clock.mediaSecondsToTicks(o.startTime+o.duration),offset:this.clock.durationSecondsToTicks(o.trim.from/s),preload:this.options.preload,gap:this.options.gap,unload:this.options.unload};if(function(e){return void 0!==e.rootEntity}(o))return void this.insertComponentFonts(e,t,o.rootEntity,c,n);const l=e.assets.byId[o.assetId];if(void 0!==l){if("video"===l.type){const e={playbackRate:a,loop:l.loop??!1};r(t,o.assetId,l,e,c)}if("image"===l.type){const e={playbackRate:a,loop:!1};r(t,o.assetId,l,e,c)}if("video"===l.type&&void 0!==l.metadata.audio||"audio"===l.type){const e={playbackRate:a,loop:l.loop??!1};i(t,o,o.assetId,e,c)}if(o.filters)for(const i of o.filters)this.insertItemFilter(e,i.filterId,t,c,r);!this.options.__webDisableFonts&&o.entities&&this.insertItemFonts(e,t,o.entities,c,n),void 0!==o.transitionOutId&&this.insertItemTransition(e,o.transitionOutId,o.startTime+o.duration,r)}}insertItemFilter(e,t,r,i,n){const o=e.assets.byId[t];void 0!==o&&"filter"===o.type&&o.preset.lutSrc&&n(`${r}-${t}`,t,{id:"",name:"",hidden:!1,type:"image",metadata:{size:0,width:512,height:512,rotation:0}},{playbackRate:1,loop:!0},{...i,offset:(0,f.z1)(i.start)})}insertComponentFonts(e,t,r,i,n){const o=new m.f(0);o.set(g.Iz,e);const a=o.read(g.q5,r),c=[];for(const{fontId:t,fontWeight:r,isItalic:i}of a){if(!t)continue;const n=e.assets.byId[t];if("fontfamily"!==n?.type)continue;const o=s(n.faceAssets.map((t=>e.assets.byId[t])).filter((e=>"fontface"===e?.type)),{stretch:100,weight:r??400,style:i?"italic":"normal"});void 0!==o&&c.push({family:t,assetId:o.id})}n(t,c,{playbackRate:1,loop:!0},{...i,offset:(0,f.z1)(i.start)})}insertItemFonts(e,t,r,i,n){const o=r.flatMap((e=>e.segments)).flatMap((e=>"com.clipchamp.text"===e.type?e.properties.content??[]:[])),a=[];for(const t of o){if(!t.fontId)continue;const r=e.assets.byId[t.fontId];if("fontfamily"!==r?.type)continue;const i=s(r.faceAssets.map((t=>e.assets.byId[t])).filter((e=>"fontface"===e?.type)),{stretch:100,weight:t.fontWeight??400,style:t.isItalic?"italic":"normal"});void 0!==i&&a.push({family:t.fontId,assetId:i.id})}n(t,a,{playbackRate:1,loop:!0},{...i,offset:(0,f.z1)(i.start)})}insertItemTransition(e,t,r,i){const n=e.items.transitions[t],o=e.assets.byId[n.asset];if(void 0===o||"transition"!==o.type||"mask"!==o.transitionType||0===o.maskAssets.length)return;const s=w[e.aspectRatio],a=o.maskAssets.reduce(((e,t)=>Math.abs(t.idealAspectRatio-s)<Math.abs(e.idealAspectRatio-s)?t:e)),c=e.assets.byId[a.assetId],l=S((c.metadata?.duration??0)/n.durationInS),d=r-n.durationInS,u={playbackRate:l,loop:!1},h={start:this.clock.mediaSecondsToTicks(d),end:this.clock.mediaSecondsToTicks(d+n.durationInS),offset:(0,f.z1)(0),preload:this.options.preload,gap:this.options.gap,unload:this.options.unload};i(t,a.assetId,c,u,h)}}function S(e){return Math.max(.0625,Math.min(16,e))}},167648:(e,t,r)=>{r.d(t,{By:()=>u,CO:()=>f,Eb:()=>d,Ux:()=>m,eC:()=>h,q_:()=>g}),r(379321);var i=r(310120),n=r(902851),o=r(173013),s=r(636730),a=r(751203),c=r(829191),l=r(943873);const d=(0,i.u)((function(e,t,r){const i=(0,a.yD)(e,t,"brushFont");for(const t of i)if((0,a.pS)(e,t,"brush")===r)return{fontFamily:(0,a.pS)(e,t,"fontFamily"),fontSize:(0,a.pS)(e,t,"fontSize"),fontWeight:(0,a.pS)(e,t,"fontWeight"),isItalic:(0,a.pS)(e,t,"isItalic"),isUnderline:(0,a.pS)(e,t,"isUnderline"),lineHeight:(0,a.pS)(e,t,"lineHeight"),letterSpacing:(0,a.pS)(e,t,"letterSpacing")};return{fontFamily:s.N.brushFont.fontFamily,fontSize:s.N.brushFont.fontSize,fontWeight:s.N.brushFont.fontWeight,isItalic:s.N.brushFont.isItalic,isUnderline:s.N.brushFont.isUnderline,lineHeight:s.N.brushFont.lineHeight,letterSpacing:s.N.brushFont.letterSpacing}})),u=(0,i.u)((function(e,t,r){const i=(0,a.yD)(e,t,"brushFill"),s=[],l=[];for(const t of i){if((0,a.pS)(e,t,"brush")!==r)continue;const i=(0,a.pS)(e,t,"paint"),n=(0,o.m9)(e,i).clone();s.push(n.value),l.push(n)}return c.Rc.create(s,(()=>{for(const e of l)e[n.S]()}))})),h=(0,i.u)((function(e,t,r,i){const s=(0,a.yD)(e,t,"brushStroke"),l=[],d=[];for(const t of s){if((0,a.pS)(e,t,"brush")!==r)continue;const n=(0,a.pS)(e,t,"paint"),s=(0,a.pS)(e,t,"thickness"),c=(0,a.pS)(e,t,"lineCap"),u=(0,a.pS)(e,t,"lineJoin"),h=(0,a.pS)(e,t,"miterLimit"),p=(0,o.fv)(e,n,s*i,c,u,h).clone();l.push(p.value),d.push(p)}return c.Rc.create(l,(()=>{for(const e of d)e[n.S]()}))})),p=(0,i.u)((function(e,t,r){const i=(0,a.yD)(e,t,"brushShadow"),s=[],l=[];for(const t of i){if((0,a.pS)(e,t,"brush")!==r)continue;const i=(0,a.pS)(e,t,"paint"),n=(0,a.pS)(e,t,"offset"),c=(0,a.pS)(e,t,"radius"),d=(0,o.B)(e,i,n,c).clone();s.push(d.value),l.push(d)}return c.Rc.create(s,(()=>{for(const e of l)e[n.S]()}))})),m=(0,i.u)((function(e,t,r,i){const o=(0,a.yD)(e,t,"brushHighlight"),s=[],l=[];for(const n of o){if((0,a.pS)(e,n,"brush")!==r)continue;const o=(0,a.pS)(e,n,"highlightBrush"),c=(0,a.pS)(e,n,"cornerRadius"),d=(0,a.pS)(e,n,"margins"),u=g(e,t,o,i).clone();s.push({paints:u.value,cornerRadius:c,margins:d}),l.push(u)}return c.Rc.create(s,(()=>{for(const e of l)e[n.S]()}))}));function f(e,t,r){for(const i of r.shadowPaints)e.drawPath(t,i);if(r.strokePaints.length>0){e.saveLayer();for(const i of r.strokePaints)e.drawPath(t,i);e.drawPath(t,r.maskPaint),e.restore()}for(const i of r.fillPaints)e.drawPath(t,i)}const g=(0,i.u)((function(e,t,r,i){const o=p(e,t,r).clone(),s=h(e,t,r,i).clone(),a=u(e,t,r).clone(),d=(0,l.jp)(e),m=new d.Paint;return m.setAntiAlias(!0),m.setColor(d.BLACK),m.setBlendMode(d.BlendMode.DstOut),c.Rc.create({maskPaint:m,shadowPaints:o.value,strokePaints:s.value,fillPaints:a.value},(()=>{m.delete(),o[n.S](),s[n.S](),a[n.S]()}))}))},432214:(e,t,r)=>{r.d(t,{Ri:()=>T,cf:()=>w}),r(379321);var i=r(463716),n=r(310120),o=r(902851),s=r(173013),a=r(602284),c=r(957529),l=r(751203),d=r(829191),u=r(943873),h=r(167648);function p(e,t){if(e.leaf){if(e.filled)return e;if(t.left<=e.bounds.left&&t.top<=e.bounds.top&&t.right>=e.bounds.right&&t.bottom>=e.bounds.bottom)return{leaf:!0,bounds:e.bounds,filled:!0};const r=t.left>e.bounds.left?t.left:t.right<e.bounds.right?t.right:(e.bounds.left+e.bounds.right)/2,i=t.top>e.bounds.top?t.top:t.bottom<e.bounds.bottom?t.bottom:(e.bounds.top+e.bounds.bottom)/2,n={left:e.bounds.left,top:e.bounds.top,right:r,bottom:i},o={left:r,top:e.bounds.top,right:e.bounds.right,bottom:i},s={left:e.bounds.left,top:i,right:r,bottom:e.bounds.bottom},a={left:r,top:i,right:e.bounds.right,bottom:e.bounds.bottom};return p({leaf:!1,bounds:e.bounds,x:r,y:i,topLeft:{leaf:!0,bounds:n,filled:!1},topRight:{leaf:!0,bounds:o,filled:!1},bottomLeft:{leaf:!0,bounds:s,filled:!1},bottomRight:{leaf:!0,bounds:a,filled:!1}},t)}const r=t.left<e.x,i=t.right>e.x,n=t.top<e.y,o=t.bottom>e.y,s=n&&r?p(e.topLeft,t):e.topLeft,a=n&&i?p(e.topRight,t):e.topRight,c=o&&r?p(e.bottomLeft,t):e.bottomLeft,l=o&&i?p(e.bottomRight,t):e.bottomRight;return s.leaf&&a.leaf&&c.leaf&&l.leaf&&s.filled===a.filled&&s.filled===c.filled&&s.filled===l.filled?{leaf:!0,bounds:e.bounds,filled:s.filled}:{leaf:!1,bounds:e.bounds,x:e.x,y:e.y,topLeft:s,topRight:a,bottomLeft:c,bottomRight:l}}function m(e,t,r){if(e.leaf)return(e.filled&&t===e.bounds.left||!e.filled&&t===e.bounds.right)&&r!==e.bounds.top?{moveUp:e.bounds.top}:(e.filled&&t===e.bounds.right||!e.filled&&t===e.bounds.left)&&r!==e.bounds.bottom?{moveDown:e.bounds.bottom}:(e.filled&&r===e.bounds.top||!e.filled&&r===e.bounds.bottom)&&t!==e.bounds.right?{moveRight:e.bounds.right}:(e.filled&&r===e.bounds.bottom||!e.filled&&r===e.bounds.top)&&t!==e.bounds.left?{moveLeft:e.bounds.left}:{};if(t<e.x&&r<e.y)return m(e.topLeft,t,r);if(t>e.x&&r<e.y)return m(e.topRight,t,r);if(t<e.x&&r>e.y)return m(e.bottomLeft,t,r);if(t>e.x&&r>e.y)return m(e.bottomRight,t,r);if(t===e.x&&r!==e.y){const i=r<e.y?e.topLeft:e.bottomLeft,n=r<e.y?e.topRight:e.bottomRight,o=m(i,t,r),s=m(n,t,r);return{moveLeft:o.moveLeft,moveRight:s.moveRight,moveUp:void 0!==o.moveUp&&void 0!==s.moveUp?Math.max(o.moveUp,s.moveUp):void 0,moveDown:void 0!==o.moveDown&&void 0!==s.moveDown?Math.min(o.moveDown,s.moveDown):void 0}}if(r===e.y&&t!==e.x){const i=t<e.x?e.topLeft:e.topRight,n=t<e.x?e.bottomLeft:e.bottomRight,o=m(i,t,r),s=m(n,t,r);return{moveLeft:void 0!==o.moveLeft&&void 0!==s.moveLeft?Math.max(o.moveLeft,s.moveLeft):void 0,moveRight:void 0!==o.moveRight&&void 0!==s.moveRight?Math.min(o.moveRight,s.moveRight):void 0,moveUp:o.moveUp,moveDown:s.moveDown}}const i=m(e.topLeft,t,r),n=m(e.topRight,t,r),o=m(e.bottomLeft,t,r),s=m(e.bottomRight,t,r);return{moveLeft:void 0!==i.moveLeft&&void 0!==o.moveLeft?Math.max(i.moveLeft,o.moveLeft):void 0,moveRight:void 0!==n.moveRight&&void 0!==s.moveRight?Math.min(n.moveRight,s.moveRight):void 0,moveUp:void 0!==i.moveUp&&void 0!==n.moveUp?Math.max(i.moveUp,n.moveUp):void 0,moveDown:void 0!==o.moveDown&&void 0!==s.moveDown?Math.min(o.moveDown,s.moveDown):void 0}}function f(e,t,r){const i=m(e,t,r);return t===e.bounds.left?{moveUp:i.moveUp,moveRight:i.moveRight}:t===e.bounds.right?{moveDown:i.moveDown,moveLeft:i.moveLeft}:r===e.bounds.top?{moveRight:i.moveRight,moveDown:i.moveDown}:r===e.bounds.bottom?{moveLeft:i.moveLeft,moveUp:i.moveUp}:i}function*g(e){if(e.leaf)return{topLeft:e.filled,topRight:e.filled,bottomLeft:e.filled,bottomRight:e.filled};const t=yield*g(e.topLeft),r=yield*g(e.topRight),i=yield*g(e.bottomLeft),n=yield*g(e.bottomRight),o={topLeft:t.bottomRight,topRight:r.bottomLeft,bottomLeft:i.topRight,bottomRight:n.topLeft};return o.topLeft===o.topRight&&o.topRight===o.bottomRight&&o.bottomRight===o.bottomLeft||(yield[e.x,e.y]),o}function A(e,t,r,i){switch(e){case 0:return void 0!==i.moveLeft?[i.moveLeft,r]:void 0;case 1:return void 0!==i.moveUp?[t,i.moveUp]:void 0;case 2:return void 0!==i.moveRight?[i.moveRight,r]:void 0;case 3:return void 0!==i.moveDown?[t,i.moveDown]:void 0}}function*v(e,t,r){let i=t,n=r,o=1;for(;;){let t=i,r=n;const s=f(e,i,n);for(let e=0;e<4;e++){const a=(o+e)%4,c=A(a,i,n,s);if(void 0!==c){[t,r]=c,o=a;break}}yield[t,r],i=t,n=r}}function*y(e){const t=new Map,r=(e,r)=>{let i=t.get(e);void 0===i&&(i=new Set,t.set(e,i)),i.add(r)},i=(e,r)=>{const i=t.get(e);void 0!==i&&(i.delete(r),0===i.size&&t.delete(e))};for(const[t,i]of g(e))r(t,i);for(;;){const r=t.entries().next();if(r.done)break;const[n,o]=r.value,s=o.values().next();if(s.done)break;const a=s.value;i(n,a);const c=v(e,n,a),l=[[n,a]];let d=0,u=0,h=!1,p=!1;for(const[e,t]of c){i(e,t),h||(d=e,u=t,h=!0);const r=e===n&&t===a;for(l.push([e,t]),r&&l.push([d,u]);l.length>=3;){const e=l[0][0]===l[1][0]&&l[1][0]===l[2][0],t=l[0][1]===l[1][1]&&l[1][1]===l[2][1];e||t||(p=!0,yield{verb:1,x:l[1][0],y:l[1][1]}),l.shift()}if(r)break}p&&(yield{verb:0})}}function b(e,t,r,i){if(0===t.length)return new e.Path;const n={left:1/0,top:1/0,right:-1/0,bottom:-1/0};for(const[e,r,i,o]of t)i<=e||o<=r||(n.left=Math.min(n.left,e),n.top=Math.min(n.top,r),n.right=Math.max(n.right,i),n.bottom=Math.max(n.bottom,o));if(n.left===n.right||n.top===n.bottom||n.left===1/0||n.top===1/0||n.right===-1/0||n.bottom===-1/0)return new e.Path;const o=function(e,t){let r={leaf:!0,bounds:t,filled:!1};if(0===e.length)return r;for(const[t,i,n,o]of e)r=p(r,{left:t,top:i,right:n,bottom:o});return r}(t,n);if(o.leaf){const t=new e.Path;return o.filled?(t.addRRect(e.RRectXY(e.LTRBRect(o.bounds.left,o.bounds.top,o.bounds.right,o.bounds.bottom),r,i)),t):t}const s=y(o),a=new e.Path,c=(e,t,n,o,s,c)=>{const l=Math.min(r,Math.abs(s-e)/2),d=Math.min(i,Math.abs(c-t)/2);if(0===l||0===d)return void a.lineTo(n,o);const u=n-l*Math.sign(n-e),h=o-d*Math.sign(o-t),p=n+l*Math.sign(s-n),m=o+d*Math.sign(c-o),f=function(e,t,r,i,n,o){return(r-e)*(o-t)-(i-t)*(n-e)<0}(e,t,n,o,s,c);a.lineTo(u,h),a.arcToRotated(l,d,0,!0,f,p,m)},l=[];let d=!0,u=0,h=0,m=0,f=0;for(const e of s){if(0===e.verb?l.push([u,h],[m,f]):l.push([e.x,e.y]),d&&l.length>=2){u=l[0][0],h=l[0][1],m=l[1][0],f=l[1][1];const e=Math.min(r,Math.abs(m-u)/2),t=Math.min(i,Math.abs(f-h)/2);a.moveTo(u+e*Math.sign(m-u),h+t*Math.sign(f-h)),d=!1}for(;l.length>=3;)c(l[0][0],l[0][1],l[1][0],l[1][1],l[2][0],l[2][1]),l.shift();0===e.verb&&(a.close(),l.length=0,d=!0)}return a}r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);const w=(0,n.u)((function(e,t,r){const i=C(e,t,r);if(void 0===i)return{width:0,height:0};const n=i.value.measure,o=(0,u.H5)(e);return{width:n.getLongestLine()/o,height:n.getHeight()/o}})),x=(0,n.u)((function(e,t){const r=(0,a.z7)(e,t),i=w(e,t,r);return(0,c.TF)(e,t,i)})),S=(0,n.u)((function(e,t){const r=x(e,t),i=(0,c.a5)(e,t),n=(0,c.iE)(e,t);return r.multiply(i).multiply(n)})),T=(0,n.u)((function(e,t){const r=(0,a.z7)(e,t),n=C(e,t,r);if(void 0===n)return;const c=_(e,t,r),p=n.value.measure,m=(0,u.H5)(e),f=p.getMaxWidth()-p.getLongestLine(),g=(0,l.zv)(e,t,"contentPlacement","position");let A=0;g.x>=s.GE?A=f:g.x>s.l9&&(A=f/2);const v=i.d.translate(-A,0).multiply(i.d.scale(1/m,1/m).multiply(S(e,t))),y=n.clone(),b=c?.clone();return d.Rc.create((e=>{const t=y.value;if(e.save(),e.concat(v.m),void 0!==b)for(const t of b.value)(0,h.CO)(e,t.path,t.paints);if(void 0!==t.fillMask){e.saveLayer();for(const r of t.strokes)e.drawParagraph(r,0,0);e.drawParagraph(t.fillMask,0,0),e.restore()}for(const r of t.fills)e.drawParagraph(r,0,0);e.restore()}),(()=>{y[o.S](),b?.[o.S]()}))})),C=(0,n.u)((function(e,t,r){const i=(0,l.yD)(e,t,"displayText");if(0===i.length)return;const n=(0,u.jp)(e),a=(0,u.Ob)(e),c=(0,u.H5)(e),p=new n.Paint;p.setColor(n.TRANSPARENT);const m=new n.Paint;m.setAntiAlias(!0),m.setColor(n.BLACK),m.setBlendMode(n.BlendMode.DstOut);const f=(0,l.zv)(e,t,"contentPlacement","position"),g=new n.ParagraphStyle({textStyle:{},disableHinting:!0,textAlign:(0,s.ZQ)(n,f.x),textHeightBehavior:n.TextHeightBehavior.DisableAll,replaceTabCharacters:!0}),A=i.map((r=>{const i=(0,l.pS)(e,r,"brush"),n=(0,l.pS)(e,r,"fill");let a;if(n){const t=(0,s.m9)(e,n).clone();a=d.Rc.create([t.value],(()=>t[o.S]()))}else a=(0,h.By)(e,t,i);return{fills:a,strokes:(0,h.eC)(e,t,i,c)}})),v=A.reduce(((e,t)=>Math.max(e,t.fills.value.length)),0),y=A.reduce(((e,t)=>Math.max(e,t.strokes.value.length)),0),b=[];for(let e=0;e<v;e++)b.push(n.ParagraphBuilder.MakeFromFontCollection(g,a));const w=[];for(let e=0;e<y;e++)w.push(n.ParagraphBuilder.MakeFromFontCollection(g,a));let x;w.length>0&&(x=n.ParagraphBuilder.MakeFromFontCollection(g,a));const S=(0,l.yD)(e,t,"brushShadow");for(const[r,o]of i.entries()){const i=(0,l.pS)(e,o,"text"),a=(0,l.pS)(e,o,"brush"),d=[];for(const t of S){if((0,l.pS)(e,t,"brush")!==a)continue;const r=(0,l.pS)(e,t,"paint");if("solidColor"!==r.type)continue;const i=r,n=(0,l.pS)(e,t,"offset"),o=(0,l.pS)(e,t,"radius");d.push({color:(0,s.Qy)(i),offset:[n.x*c,n.y*c],blurRadius:o*c})}const u=(0,h.Eb)(e,t,a),f=(0,l.pS)(e,o,"fontFamily")??u.fontFamily,g=(0,l.pS)(e,o,"fontWeight")??u.fontWeight,v=(0,l.pS)(e,o,"isItalic")??u.isItalic,y=(0,l.pS)(e,o,"fontSize")??u.fontSize,T=(0,l.pS)(e,o,"letterSpacing")??u.letterSpacing,C=(0,l.pS)(e,o,"lineHeight")??u.lineHeight,_={fontFamilies:[f],fontStyle:{weight:(0,s.eW)(n,g),width:n.FontWidth.Normal,slant:v?n.FontSlant.Italic:n.FontSlant.Upright},letterSpacing:T*y*c,fontSize:y*c,heightMultiplier:C??void 0,fontVariations:[{axis:"wght",value:g},{axis:"ital",value:v?1:0}]},k=new n.TextStyle(_),E=new n.TextStyle({..._,shadows:d}),I=A[r];for(const[e,t]of w.entries()){const r=I.strokes.value.at(e)??p,n=0===e?E:k;t.pushPaintStyle(n,r,p),t.addText(i),t.pop()}for(const[e,t]of b.entries()){const r=I.fills.value.at(e)??p,n=0===e&&0===w.length?E:k;t.pushPaintStyle(n,r,p),t.addText(i),t.pop()}x&&(x.pushPaintStyle(k,m,p),x.addText(i),x.pop())}p.delete(),m.delete();const T=r.maxWidth*c,C=[];for(const e of b){const t=e.build();e.delete(),t.layout(T),C.push(t)}let _;x&&(_=x.build(),x.delete(),_.layout(T));const k=[];for(const e of w){const t=e.build();e.delete(),t.layout(T),k.push(t)}const E=C.at(0)??_??k.at(0);return void 0!==E?d.Rc.create({measure:E,fills:C,fillMask:_,strokes:k},(()=>{for(const e of C)e.delete();_?.delete();for(const e of k)e.delete()})):void 0})),_=(0,n.u)((function(e,t,r){const i=C(e,t,r);if(void 0===i)return;const n=(0,u.jp)(e),s=(0,u.H5)(e),a=i.value.strokes.at(-1)??i.value.measure,c=(0,l.yD)(e,t,"displayText"),p=new Map;let m=0;for(const t of c){const r=(0,l.pS)(e,t,"brush");let i=p.get(r);void 0===i&&(i=[],p.set(r,i));const o=m;m+=(0,l.pS)(e,t,"text").length;const s=m,c=a.getRectsForRange(o,s,n.RectHeightStyle.Max,n.RectWidthStyle.Tight);for(const e of c)i.push(e.rect)}const f=[],g=[];for(const[r,i]of p){const o=(0,h.Ux)(e,t,r,s).clone();g.push(o);for(const e of o.value){const t=i.map((([t,r,i,o])=>n.LTRBRect(t-e.margins.left*s,r-e.margins.top*s,i+e.margins.right*s,o+e.margins.bottom*s))),r=b(n,t,e.cornerRadius.width*s,e.cornerRadius.height*s);f.push({path:r,paints:e.paints})}}return d.Rc.create(f,(()=>{for(const e of f)e.path.delete();for(const e of g)e[o.S]()}))}))},173013:(e,t,r)=>{r.d(t,{B:()=>h,GE:()=>a,Qy:()=>c,ZQ:()=>p,eW:()=>m,fv:()=>u,l9:()=>s,m9:()=>d}),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);var i=r(310120),n=r(829191),o=r(943873);const s=.3,a=.7;function c(e){const t=e.hex>>16,r=e.hex>>8&255,i=255&e.hex;return new Float32Array([t/255,r/255,i/255,e.alpha])}function l(e,t){const r=new e.Paint;switch(r.setAntiAlias(!0),t.type){case"solidColor":r.setColor(c(t));break;case"linearGradient":{const i=t,n=e.Shader.MakeLinearGradient([i.x1,i.y1],[i.x2,i.y2],i.stops.map((e=>c(e.color))),i.stops.map((e=>e.offset)),e.TileMode.Clamp);r.setShader(n);break}case"radialGradient":{const i=t,n=e.Shader.MakeRadialGradient([i.cx,i.cy],i.r,i.stops.map((e=>c(e.color))),i.stops.map((e=>e.offset)),e.TileMode.Clamp);r.setShader(n);break}}return r}const d=(0,i.u)((function(e,t){const r=l((0,o.jp)(e),t);return n.Rc.create(r,(()=>r.delete()))})),u=(0,i.u)((function(e,t,r,i,s,a){const c=(0,o.jp)(e),d=l(c,t);return d.setStyle(c.PaintStyle.Stroke),d.setStrokeWidth(2*r),d.setStrokeCap(function(e,t){switch(t){case"butt":return e.StrokeCap.Butt;case"round":return e.StrokeCap.Round;case"square":return e.StrokeCap.Square}}(c,i)),d.setStrokeJoin(function(e,t){switch(t){case"bevel":return e.StrokeJoin.Bevel;case"miter":return e.StrokeJoin.Miter;case"round":return e.StrokeJoin.Round}}(c,s)),d.setStrokeMiter(a),n.Rc.create(d,(()=>d.delete()))})),h=(0,i.u)((function(e,t,r,i){const s=(0,o.jp)(e),a=new s.Paint;if("solidColor"===t.type){const e=s.ImageFilter.MakeDropShadowOnly(r.x/2,r.y/2,i,i,c(t),null);a.setImageFilter(e)}return n.Rc.create(a,(()=>a.delete()))}));function p(e,t){return t<=s?e.TextAlign.Left:t>=a?e.TextAlign.Right:e.TextAlign.Center}function m(e,t){return t>=950?e.FontWeight.ExtraBlack:t>=900?e.FontWeight.Black:t>=800?e.FontWeight.ExtraBold:t>=700?e.FontWeight.Bold:t>=600?e.FontWeight.SemiBold:t>=500?e.FontWeight.Medium:t>=400?e.FontWeight.Normal:t>=300?e.FontWeight.Light:t>=200?e.FontWeight.ExtraLight:t>=100?e.FontWeight.Thin:e.FontWeight.Invisible}},636730:(e,t,r)=>{r.d(t,{N:()=>n});const i={type:"solidColor",hex:0,alpha:0},n={displayRectangle:{brush:0,cornerRadius:{width:0,height:0}},displayPath:{brush:0,path:"",viewBox:null},displayText:{text:"",brush:0,fill:null,fontFamily:null,fontSize:null,fontWeight:null,isItalic:null,isUnderline:null,lineHeight:null,letterSpacing:null},brushFill:{brush:0,paint:i,insideRule:"nonzero"},brushStroke:{brush:0,paint:i,thickness:0,lineCap:"round",lineJoin:"round",miterLimit:4},brushShadow:{brush:0,paint:i,offset:{x:0,y:0},radius:0},brushHighlight:{brush:0,highlightBrush:0,margins:{left:0,top:0,right:0,bottom:0},cornerRadius:{width:0,height:0}},brushFont:{brush:0,fontFamily:"",fontSize:0,fontWeight:400,isItalic:!1,isUnderline:!1,lineHeight:null,letterSpacing:0},contentFixedWidth:{width:0},contentFixedHeight:{height:0},contentPlacement:{margins:{left:0,top:0,right:0,bottom:0},fit:null,position:{x:0,y:0},direction:"horizontal",gap:0},layoutAbsolute:{anchorPos:{x:0,y:0},targetPos:{x:0,y:0}},layoutFlex:{weight:1},transformScale:{origin:{x:0,y:0},scale:{x:1,y:1}},transformRotate:{origin:{x:0,y:0},rotation:0},transformTranslate:{offset:{x:0,y:0}},variableDefine:{name:"",value:void 0},variableUse:{name:"",segment:null,property:""}}},579104:(e,t,r)=>{r.d(t,{e:()=>o});var i=r(310120),n=r(751203);const o=(0,i.u)((function(e,t){return void 0===(0,n.V)(e,t,"layoutAbsolute")}))},602284:(e,t,r)=>{r.d(t,{JH:()=>c,fF:()=>l,z7:()=>u,zJ:()=>a});var i=r(310120),n=r(432214),o=r(751203),s=r(579104);const a=(0,i.u)((function(e,t){const r=d(e,t);return h(e,t,r)})),c=(0,i.u)((function(e,t){const r=u(e,t);return f(e,t,r)})),l=(0,i.u)((function(e,t){const r=u(e,t);return g(e,t,r)})),d=(0,i.u)((function(e,t){const r=(0,o.ue)(e,t);if(void 0===r){const t=(0,o.B0)(e);return{isWidthFixed:!1,maxWidth:t.width,isHeightFixed:!1,maxHeight:t.height}}const i=u(e,r);return v(e,r,t,i)})),u=(0,i.u)((function(e,t){return m(p(e,t,d(e,t)),(0,o.zv)(e,t,"contentPlacement","margins"))})),h=(0,i.u)((function(e,t,r){const i=p(e,t,r);if(i.isWidthFixed&&i.isHeightFixed)return{width:i.maxWidth,height:i.maxHeight};const n=(0,o.zv)(e,t,"contentPlacement","margins"),s=m(i,n),a=f(e,t,s);return{width:i.isWidthFixed?i.maxWidth:Math.min(i.maxWidth,a.width+n.left+n.right),height:i.isHeightFixed?i.maxHeight:Math.min(i.maxHeight,a.height+n.top+n.bottom)}}));function p(e,t,r){const i=(0,o.V)(e,t,"contentFixedWidth"),n=(0,o.V)(e,t,"contentFixedHeight"),s=void 0===i?void 0:(0,o.pS)(e,i,"width"),a=void 0===n?void 0:(0,o.pS)(e,n,"height");return{isWidthFixed:r.isWidthFixed||void 0!==s,maxWidth:s??r.maxWidth,isHeightFixed:r.isHeightFixed||void 0!==a,maxHeight:a??r.maxHeight}}function m(e,t){return{isWidthFixed:e.isWidthFixed,maxWidth:Math.max(0,e.maxWidth-t.left-t.right),isHeightFixed:e.isHeightFixed,maxHeight:Math.max(0,e.maxHeight-t.top-t.bottom)}}const f=(0,i.u)((function(e,t,r){const i=g(e,t,r),o=(0,n.cf)(e,t,r);return{width:Math.max(i.width,o.width),height:Math.max(i.height,o.height)}})),g=(0,i.u)((function(e,t,r){const i={width:0,height:0},n=(0,o.Br)(e,t),a=n.filter((t=>(0,s.e)(e,t)));if(0===a.length)return i;const c=Math.max(0,a.length-1);let l=0;c>0&&(l=c*(0,o.zv)(e,t,"contentPlacement","gap"));const d=(0,o.zv)(e,t,"contentPlacement","direction");"vertical"===d?i.height=l:i.width=l;for(const o of n){const n=v(e,t,o,r),s=h(e,o,n);"vertical"===d?(i.width=Math.max(i.width,s.width),i.height+=s.height):(i.width+=s.width,i.height=Math.max(i.height,s.height))}return i})),A=(0,i.u)((function(e,t,r){const i=new Map,n=(0,o.Br)(e,t).filter((t=>(0,s.e)(e,t)));if(0===n.length)return i;const a=Math.max(0,n.length-1);let c=0;a>0&&(c=a*(0,o.zv)(e,t,"contentPlacement","gap"));const l=(0,o.zv)(e,t,"contentPlacement","direction");let d="vertical"===l?r.maxHeight:r.maxWidth;d=Math.max(0,d-c);let u=0;for(const t of n){const n=(0,o.V)(e,t,"layoutFlex");if(void 0!==n){u+=(0,o.pS)(e,n,"weight");continue}let s;s="vertical"===l?{isWidthFixed:r.isWidthFixed,maxWidth:r.maxWidth,isHeightFixed:!1,maxHeight:d}:{isWidthFixed:!1,maxWidth:d,isHeightFixed:r.isHeightFixed,maxHeight:r.maxHeight},i.set(t,s);const a=h(e,t,s),c="vertical"===l?a.height:a.width;d=Math.max(0,d-c)}const p=0===u?0:d/u;for(const t of n){const n=(0,o.V)(e,t,"layoutFlex");if(void 0===n)continue;const s=p*(0,o.pS)(e,n,"weight");let a;a="vertical"===l?{isWidthFixed:r.isWidthFixed,maxWidth:r.maxWidth,isHeightFixed:r.isHeightFixed,maxHeight:s}:{isWidthFixed:r.isWidthFixed,maxWidth:s,isHeightFixed:r.isHeightFixed,maxHeight:r.maxHeight},i.set(t,a)}return i})),v=(0,i.u)((function(e,t,r,i){if(void 0!==(0,o.V)(e,r,"layoutAbsolute")){const r=f(e,t,i);return{isWidthFixed:!1,maxWidth:r.width,isHeightFixed:!1,maxHeight:r.height}}const n=A(e,t,i).get(r);if(void 0===n)throw new Error("Assertion failed: entity is missing child constraint");return n}))},957529:(e,t,r)=>{r.d(t,{TF:()=>p,a5:()=>h,iE:()=>c});var i=r(463716),n=r(310120),o=r(751203),s=r(579104),a=r(602284);const c=(0,n.u)((function(e,t){const r=l(e,t);return u(e,t).multiply(r)})),l=(0,n.u)((function(e,t){const r=(0,o.ue)(e,t),n=void 0===r?i.d.identity:d(e,r),s=g(e,r,t);return i.d.translate(s.x,s.y).multiply(n)})),d=(0,n.u)((function(e,t){const r=c(e,t),i=h(e,t);return m(e,t).multiply(i).multiply(r)})),u=(0,n.u)((function(e,t){let r=i.d.identity;const n=(0,o.V)(e,t,"transformScale");if(n){const s=(0,o.pS)(e,n,"scale"),c=(0,o.pS)(e,n,"origin"),l=(0,a.zJ)(e,t),d=c.x*l.width,u=c.y*l.height;1===s.x&&1===s.y||(r=r.multiply(i.d.translate(-d,-u)).multiply(i.d.scale(s.x,s.y)).multiply(i.d.translate(d,u)))}const s=(0,o.V)(e,t,"transformRotate");if(s){const n=(0,o.pS)(e,s,"rotation"),c=(0,o.pS)(e,s,"origin"),l=(0,a.zJ)(e,t),d=c.x*l.width,u=c.y*l.height;0!==n&&(r=r.multiply(i.d.translate(-d,-u)).multiply(i.d.rotate(n)).multiply(i.d.translate(d,u)))}const c=(0,o.V)(e,t,"transformTranslate");if(c){const n=(0,o.pS)(e,c,"offset");if(0!==n.x||0!==n.y){const o=(0,a.zJ)(e,t),s=n.x*o.width*2,c=n.y*o.height*2;r=r.multiply(i.d.translate(s,c))}}return r})),h=(0,n.u)((function(e,t){const r=(0,a.zJ)(e,t),n=(0,a.JH)(e,t),s=r.width-n.width,c=r.height-n.height,l=(0,o.zv)(e,t,"contentPlacement","margins"),d=l.left+l.right,u=l.top+l.bottom;let h=1;0!==d&&(h=s/d,h=Math.max(0,Math.min(1,h)));let p=1;0!==u&&(p=c/u,p=Math.max(0,Math.min(1,p)));const m=(0,o.zv)(e,t,"contentPlacement","position"),f=(s-d*h)*m.x,g=(c-u*p)*m.y;return i.d.translate(l.left*h+f,l.top*p+g)}));function p(e,t,r){const n=(0,a.JH)(e,t),s=(0,o.zv)(e,t,"contentPlacement","position"),c=(0,o.zv)(e,t,"contentPlacement","fit");let l=i.d.identity;const d=0===r.width?1:n.width/r.width,u=0===r.height?1:n.height/r.height;switch(c){case"contain":{const e=Math.min(d,u);l=i.d.scale(e,e);break}case"cover":{const e=Math.max(d,u);l=i.d.scale(e,e);break}case"fill":l=i.d.scale(d,u)}const[h,p]=l.apply2([r.width,r.height]),m=(n.width-h)*s.x,f=(n.height-p)*s.y;return i.d.translate(m,f).multiply(l)}const m=(0,n.u)((function(e,t){return p(e,t,(0,a.fF)(e,t))})),f=(0,n.u)((function(e,t){const r=new Map,i=(0,o.Br)(e,t).filter((t=>(0,s.e)(e,t)));if(0===i.length)return r;const n=(0,o.zv)(e,t,"contentPlacement","gap"),c=(0,o.zv)(e,t,"contentPlacement","direction"),l=(0,o.zv)(e,t,"contentPlacement","position"),d=(0,a.fF)(e,t);let u=0;for(const t of i){const i=(0,a.zJ)(e,t);"vertical"===c?(r.set(t,{x:(d.width-i.width)*l.x,y:u}),u+=i.height):(r.set(t,{x:u,y:(d.height-i.height)*l.y}),u+=i.width),u+=n}return r})),g=(0,n.u)((function(e,t,r){const i=(0,o.V)(e,r,"layoutAbsolute");if(void 0!==i){const n=(0,o.pS)(e,i,"targetPos");let s=0,c=0;if(0!==n.x||0!==n.y){const r=void 0===t?(0,o.B0)(e):(0,a.JH)(e,t);s=n.x*r.width,c=n.y*r.height}const l=(0,o.gL)(e,i,"anchorPos",n);let d=0,u=0;if(0!==l.x||0!==l.y){const t=(0,a.zJ)(e,r);d=l.x*t.width,u=l.y*t.height}return{x:s-d,y:c-u}}if(void 0===t)return{x:0,y:0};const n=f(e,t).get(r);if(void 0===n)throw new Error("Assertion failed: entity is missing child offset");return n}))},751203:(e,t,r)=>{r.d(t,{B0:()=>l,Br:()=>m,Iz:()=>c,V:()=>A,gL:()=>y,pS:()=>b,q5:()=>C,ue:()=>p,yD:()=>g,zv:()=>f}),r(379321);var i=r(595781),n=r(310120),o=r(167648),s=r(636730);function a(e,t){return t.type===e}const c=(0,i.h)({entities:{}}),l=(0,i.h)({width:1,height:1}),d=(0,n.u)((function(e,t){return c(e).entities?.[t]})),u=(0,n.u)((function(e){const t=c(e);return t.entities?Object.keys(t.entities):[]})),h=(0,n.u)((function(e){const t=u(e),r=new Map;for(const i of t){const t=m(e,i);for(const e of t)r.set(e,i)}return r})),p=(0,n.u)((function(e,t){return h(e).get(t)})),m=(0,n.u)((function(e,t){const r=d(e,t);return r?.children??[]})),f=(0,n.u)((function(e,t,r,i){const n=A(e,t,r);return void 0===n?s.N[r][i]:b(e,n,i)})),g=(0,n.u)((function(e,t,r){const i=d(e,t);if(void 0===i)return[];const n=[];for(const e of i.segments)a(r,e)&&n.push({entityId:t,segment:e});return n})),A=(0,n.u)((function(e,t,r){const i=d(e,t);if(void 0!==i)for(const e of i.segments)if(a(r,e))return{entityId:t,segment:e}}));function v(e,t,r){let i;return function(e,t){return void 0!==A(e,t,"variableUse")}(e,t.entityId)&&(i=w(e,t.entityId,t.segment.type,t.segment.id,r)),void 0===i?t.segment.properties[r]:T(e,t.entityId,i)}function y(e,t,r,i){return v(e,t,r)??i}function b(e,t,r){return y(e,t,r,s.N[t.segment.type][r])}const w=(0,n.u)((function(e,t,r,i,n){if(void 0!==i){const r=x(e,t,i,n);if(void 0!==r)return r}return S(e,t,r,n)})),x=(0,n.u)((function(e,t,r,i){const n=g(e,t,"variableUse");for(const t of n){if(t.segment.id===r)continue;const n=b(e,t,"segment");if(null!==n&&"one"===n.type&&n.id===r&&b(e,t,"property")===i)return b(e,t,"name")}})),S=(0,n.u)((function(e,t,r,i){if("variableUse"===r)return;const n=g(e,t,"variableUse");for(const t of n){const n=b(e,t,"segment");if(null!==n&&"any"===n.type&&n.segment===r&&b(e,t,"property")===i)return b(e,t,"name")}})),T=(0,n.u)((function e(t,r,i){const n=g(t,r,"variableDefine");for(const e of n)if(b(t,e,"name")===i)return v(t,e,"value");const o=p(t,r);return void 0===o?void 0:e(t,o,i)})),C=(0,n.u)((function e(t,r){const i=new Map,n=d(t,r);if(void 0===n)return[];const s=g(t,r,"displayText"),a=({fontId:e,fontWeight:t,isItalic:r})=>{i.set(`${e}-${t}-${r}`,{fontId:e,fontWeight:t,isItalic:r})};for(const e of s){const i=b(t,e,"brush"),n=(0,o.Eb)(t,r,i);a({fontId:e.segment.properties.fontFamily??n.fontFamily,fontWeight:e.segment.properties.fontWeight??n.fontWeight,isItalic:e.segment.properties.isItalic??n.isItalic})}for(const r of n.children){const i=e(t,r);for(const e of i)a(e)}return[...i.values()]}))},829191:(e,t,r)=>{r.d(t,{Rc:()=>o});var i=r(268161),n=r(902851);class o{get value(){if(void 0===this.shared)throw new Error("accessing value on destroyed Rc");return this.shared.value}static create(e,t){return new o({value:e,destroy:t,refs:1})}constructor(e){this.shared=e}clone(){if(void 0===this.shared)throw new Error("cloning a destroyed Rc");return this.shared.refs++,new o(this.shared)}[i.tW](e){if(void 0===this.shared)throw new Error("hashing a destroyed Rc");e(this.shared.value)}[i.LC](e){if(!(e instanceof o))return!1;if(void 0===this.shared||void 0===e.shared)throw new Error("comparing a destroyed Rc");return this.shared.value===e.shared.value}[n.S](){if(void 0===this.shared)throw new Error("destroying a destroyed Rc");this.shared.refs--,this.shared.refs<=0&&this.shared.destroy(),this.shared=void 0}}},943873:(e,t,r)=>{r.d(t,{FQ:()=>g,Db:()=>f,Qk:()=>A,H5:()=>v,jp:()=>b,Ob:()=>w,eY:()=>x}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(595781),n=r(310120),o=r(902851),s=(r(379321),r(463716)),a=r(602284),c=r(957529),l=r(751203),d=r(829191),u=r(167648);const h=(0,n.u)((function(e,t){const r=(0,c.iE)(e,t),i=p(e,t);if(0===i.value.length)return;const n=i.clone();return d.Rc.create((e=>{e.save(),e.concat(r.m);for(const t of n.value)(0,u.CO)(e,t.path,t.paints);e.restore()}),(()=>n[o.S]()))})),p=(0,n.u)((function(e,t){const r=b(e),i=(0,a.zJ)(e,t),n=(0,l.yD)(e,t,"displayRectangle"),c=(0,l.yD)(e,t,"displayPath"),h=[],p=[],m=(r,i)=>{const n=(0,u.q_)(e,t,i,1).clone();h.push({path:r,paints:n.value}),p.push(n)};for(const t of n){const n=(0,l.pS)(e,t,"brush"),o=(0,l.pS)(e,t,"cornerRadius"),s=new r.Path;s.addRRect(r.RRectXY(r.LTRBRect(0,0,i.width,i.height),o.width,o.height)),m(s,n)}for(const t of c){const n=(0,l.pS)(e,t,"brush"),o=(0,l.pS)(e,t,"path");let a=(0,l.pS)(e,t,"viewBox");const c=r.Path.MakeFromSVGString(o);if(null===c)continue;if(null===a){const[e,t,r,i]=c.getBounds();a={minX:e,minY:t,maxX:r,maxY:i}}const d=s.d.translate(-a.minX,-a.minY).multiply(s.d.scale(i.width/(a.maxX-a.minX),i.height/(a.maxY-a.minY)));c.transform(d.m),m(c,n)}return d.Rc.create(h,(()=>{for(const e of h)e.path.delete();for(const e of p)e[o.S]()}))}));var m=r(432214);const f=(0,i.h)(new Set),g=(0,i.h)(void 0),A=(0,i.h)(void 0),v=(0,i.h)(0),y=(0,i.h)(!1);function b(e){const t=g(e);if(void 0===t)throw new Error("CanvasKit instance has not been defined");return t}function w(e){const t=A(e);if(void 0===t)throw new Error("FontCollection instance has not been defined");return t}const x=(0,n.u)((function(e,t){const r=(0,l.Br)(e,t).map((t=>x(e,t).clone())),i=h(e,t)?.clone(),n=(0,m.Ri)(e,t)?.clone(),s=f(e).has(t),a=y(e)?S(e,t).clone():void 0;return d.Rc.create((e=>{i?.value(e);for(const t of r)t.value(e);s||n?.value(e),a?.value(e)}),(()=>{for(const e of r)e[o.S]();i?.[o.S](),n?.[o.S](),a?.[o.S]()}))})),S=(0,n.u)((function(e,t){const r=(0,c.iE)(e,t),i=(0,c.a5)(e,t),n=(0,a.zJ)(e,t),o=(0,a.JH)(e,t),s=T(e,1,0,1,1,0).copy(),l=T(e,0,1,1,1,0).copy();return d.Rc.create((e=>{e.save(),e.concat(r.m),e.drawRect([0,0,n.width,n.height],s),e.concat(i.m),e.drawRect([0,0,o.width,o.height],l),e.restore()}),(()=>{s.delete(),l.delete()}))})),T=(0,n.u)((function(e,t,r,i,n,s){const a=b(e),c=new a.Paint;return c.setColor([t,r,i,n]),c.setAntiAlias(!0),void 0!==s&&(c.setStyle(a.PaintStyle.Stroke),c.setStrokeWidth(s)),c[o.S]=()=>{c.delete()},c}))},801080:(e,t,r)=>{r.d(t,{v:()=>n});const i=(0,r(776016).u)("3gp","aac","adts","avi","bmp","flac","flv","gif","heic","heif","heifs","jpg","jpeg","jfif","m4a","m4v","mkv","mov","mp3","mp4","mpg","mpeg","mts","m2ts","ogg","png","svg","tif","tiff","vob","wav","webm","webp","wma","wmv","accdb","accde","accdr","accdt","mdb","aspx","bat","bin","cab","clipchamp","csv","dif","dll","doc","docm","docx","dot","dotx","wbk","eml","eps","exe","gz","htm","html","ini","iso","jar","json","mid","midi","msi","mui","pdf","pot","potm","potx","ppam","pps","ppsm","ppsx","ppt","pptm","pptx","sldm","sldx","psd","pst","pub","rar","rtf","swf","sys","tar","tmp","txt","vsd","vsdm","vsdx","vss","vssm","vst","vstm","vstx","wks","wmd","wmz","wms","wpd","wp5","xla","xlam","xll","xlm","xls","xlsm","xlsx","xlt","xltm","xltx","xps","zip");function n(e){return i(e)?e:"unknown"}},944355:(e,t,r)=>{r.d(t,{a:()=>n});const i=(0,r(776016).u)("application/atom+xml","application/epub+zip","application/gzip","application/java-archive","application/json","application/ld+json","application/ms-fontobject","application/ms-word","application/octet-stream","application/ogg","application/pdf","application/vnd.amazon.ebook","application/vnd.apple.installer+xml","application/vnd.ms-excel","application/vnd.ms-powerpoint","application/vnd.mozilla.xul+xml","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.text","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/x-7z-compressed","application/x-abiword","application/x-bzip","application/x-bzip2","application/x-cdf","application/x-csh","application/x-freearc","application/x-httpd-php","application/x-sh","application/x-tar","application/xhtml+xml","application/xml","application/zip","audio/3gpp","audio/3gpp2","audio/aac","audio/midi","audio/mp4","audio/mpeg","audio/ogg","audio/opus","audio/vnd.adobe.flash.midi","audio/wav","audio/webm","font/otf","font/ttf","font/woff","font/woff2","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/tiff","image/vnd.microsoft.icon","image/webp","text/calendar","text/css","text/csv","text/html","text/javascript","text/plain","text/xml","video/3gpp","video/3gpp2","video/dvd","video/mp2t","video/mp4","video/mpeg","video/ogg","video/quicktime","video/webm","video/x-msvideo","video/x-ms-vob","video/x-ms-wmv");function n(e){return i(e)?e:"unknown"}},845505:(e,t,r)=>{r.d(t,{a:()=>m});var i=r(324586),n=r(815731),o=r(562229),s=r(563696),a=r(776016),c=r(406887);r(95732);class l{constructor(e){(0,i.A)(this,"image",document.createElement("img")),this.context=e}scale(e){this.context.canvas.width=e.width*window.devicePixelRatio,this.context.canvas.height=e.height*window.devicePixelRatio,this.context.scale(window.devicePixelRatio,window.devicePixelRatio)}get ready(){return this.image.complete?Promise.resolve():new Promise(((e,t)=>{const r=setTimeout((()=>{console.error("Timeout loading image",this.svg),t(new Error("Timeout loading image"))}),5e3);this.image.onload=()=>{clearTimeout(r),e()},this.image.onerror=()=>{console.error("Error loading SVG element",this.svg),clearTimeout(r),t(new Error("Error loading SVG element"))}}))}}class d{constructor(e,t){(0,i.A)(this,"textX",void 0),(0,i.A)(this,"textY",void 0),(0,i.A)(this,"imageX",void 0),(0,i.A)(this,"imageY",void 0);const r=e.canvas.width/window.devicePixelRatio,n=e.canvas.height/window.devicePixelRatio;e.textBaseline="bottom",e.font="normal 400 18px /140% 'Segoe UI'";const o=e.measureText(t),s=Math.round(o.width),a=Math.round(1.4*o.actualBoundingBoxAscent)+10+48;this.imageX=Math.round((r-48)/2),this.imageY=Math.round((n-a)/2),this.textX=Math.round((r-s)/2),this.textY=Math.round((n+a)/2)}}class u extends l{constructor(e,t){super(e),(0,i.A)(this,"parameters",void 0),(0,i.A)(this,"svg",'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M24 4C35.0457 4 44 12.9543 44 24C44 35.0457 35.0457 44 24 44C12.9543 44 4 35.0457 4 24C4 12.9543 12.9543 4 24 4ZM24 6.5C14.335 6.5 6.5 14.335 6.5 24C6.5 33.665 14.335 41.5 24 41.5C33.665 41.5 41.5 33.665 41.5 24C41.5 14.335 33.665 6.5 24 6.5ZM32.6339 17.6161C33.122 18.1043 33.122 18.8957 32.6339 19.3839L21.6339 30.3839C21.1457 30.872 20.3543 30.872 19.8661 30.3839L15.3661 25.8839C14.878 25.3957 14.878 24.6043 15.3661 24.1161C15.8543 23.628 16.6457 23.628 17.1339 24.1161L20.75 27.7322L30.8661 17.6161C31.3543 17.128 32.1457 17.128 32.6339 17.6161Z" fill="white"/></svg>'),this.pipMessage=t,this.parameters=new d(this.context,this.pipMessage),this.image.src=`data:image/svg+xml;base64,${btoa(this.svg)}`}scale(e){super.scale(e),this.parameters=new d(this.context,this.pipMessage)}async draw(){this.context.fillStyle="opaque",this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.context.fillStyle="white",this.context.textBaseline="bottom",this.context.font="normal 400 18px /140% 'Segoe UI'",this.context.fillText(this.pipMessage,this.parameters.textX,this.parameters.textY),await this.ready,this.context.drawImage(this.image,this.parameters.imageX,this.parameters.imageY,48,48)}}r(379321);class h{constructor(e,t,r){(0,i.A)(this,"transparentGradient",void 0),(0,i.A)(this,"bottomTextLines",void 0),(0,i.A)(this,"percentY",void 0),(0,i.A)(this,"logoX",void 0),(0,i.A)(this,"logoY",void 0),(0,i.A)(this,"videoX",void 0),(0,i.A)(this,"videoY",void 0),(0,i.A)(this,"videoWidth",void 0),(0,i.A)(this,"videoHeight",void 0);const n=e.canvas.width/window.devicePixelRatio,o=e.canvas.height/window.devicePixelRatio;this.transparentGradient=this.createCanvasGradient(e,o),e.textBaseline="bottom",e.font="normal 400 18px /140% 'Segoe UI'";const s=Math.round(1.4*e.measureText(r).actualBoundingBoxAscent);this.bottomTextLines=this.segmentText(e,n,r,s);const a=o-(this.bottomTextLines.at(-1).y+s);this.bottomTextLines=this.bottomTextLines.map((({y:e,...t})=>({...t,y:e+a}))),this.percentY=a-s-6,this.logoX=n-48-24,this.logoY=24;const c=t.globalRoot.defaultTarget.canvas.width/t.globalRoot.defaultTarget.canvas.height;n/o>c?(this.videoHeight=o,this.videoWidth=Math.floor(o*c),this.videoX=Math.round((n-this.videoWidth)/2),this.videoY=0):(this.videoHeight=Math.floor(n/c),this.videoWidth=n,this.videoX=0,this.videoY=Math.round((o-this.videoHeight)/2))}segmentText(e,t,r,i){const n=t-48,o=[];let s="",a=0;return r.split(" ").forEach(((t,r)=>{const c=`${s}${t} `,{width:l}=e.measureText(c);l>n&&r>0?(o.push({text:s,y:a}),s=`${t} `,a+=i):s=c})),o.push({text:s,y:a}),o}createCanvasGradient(e,t){const r=e.createLinearGradient(0,0,0,t-1);return r.addColorStop(.2865,"rgba(0,0,0,0.27)"),r.addColorStop(.5885,"rgba(0,0,0,0.67)"),r.addColorStop(1,"rgba(0,0,0,0.91)"),r}}class p extends l{constructor(e,t,r,n,o){super(e),(0,i.A)(this,"svg",'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M39.75 15.9999H26.9L39.03 13.1999C39.98 12.9799 40.79 12.3999 41.3 11.5799C41.82 10.7499 41.98 9.76988 41.76 8.81988L41.12 6.03988C40.9 5.08988 40.32 4.27988 39.5 3.76988C38.67 3.24988 37.7 3.08988 36.74 3.30988L7.29 10.1099C5.33 10.5599 4.01 12.3199 4 14.2499V39.7499C4 42.0899 5.91 43.9999 8.25 43.9999H39.75C42.09 43.9999 44 42.0899 44 39.7499V20.2499C44 17.9099 42.09 15.9999 39.75 15.9999ZM41.5 20.2499V24.4999H31.5V18.4999H39.75C40.71 18.4999 41.5 19.2899 41.5 20.2499ZM6.5 18.1099C7.04 18.3499 7.62 18.4999 8.25 18.4999H29V24.4999H8.25C7.29 24.4999 6.5 23.7099 6.5 22.7499V18.1099ZM19 26.9999H41.5V32.9999H19V26.9999ZM6.5 26.6099C7.04 26.8499 7.62 26.9999 8.25 26.9999H16.5V32.9999H8.25C7.29 32.9999 6.5 32.2099 6.5 31.2499V26.6099ZM39.75 41.4999H8.25C7.29 41.4999 6.5 40.7099 6.5 39.7499V35.1099C7.04 35.3499 7.62 35.4999 8.25 35.4999H41.5V39.7499C41.5 40.7099 40.71 41.4999 39.75 41.4999Z" fill="white"/></svg>'),(0,i.A)(this,"parameters",void 0),this.globalContext=t,this.status=r,this.initialMessage=n,this.inProgressMessage=o,this.parameters=this.initViewParameters(),this.image.src=`data:image/svg+xml;base64,${btoa(this.svg)}`}scale(e){super.scale(e),this.parameters=this.initViewParameters()}async draw(){this.context.fillStyle="opaque",this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.context.drawImage(this.globalContext.globalRoot.defaultTarget.canvas,this.parameters.videoX,this.parameters.videoY,this.parameters.videoWidth,this.parameters.videoHeight),this.context.fillStyle=this.parameters.transparentGradient,this.context.fillRect(0,0,this.context.canvas.width,this.context.canvas.height),this.context.fillStyle="white",this.context.textBaseline="bottom",this.context.font="normal 400 18px /140% 'Segoe UI'",this.parameters.bottomTextLines.forEach((({text:e,y:t})=>{this.context.fillText(e,24,t)})),this.context.font="normal 600 45px /100% 'Segoe UI'",this.context.fillText(`${Math.floor(this.status.progress)}%`,24,this.parameters.percentY),await this.ready,this.context.drawImage(this.image,this.parameters.logoX,this.parameters.logoY,48,48)}setStatus(e){this.status=e}initViewParameters(){let e=this.inProgressMessage;return"initial"===this.status.phase&&(e=this.initialMessage),new h(this.context,this.globalContext,e)}}class m{constructor(e,t,r,a,c,l){(0,i.A)(this,"status",{phase:"initial",progress:0}),(0,i.A)(this,"progressView",void 0),(0,i.A)(this,"finishedView",void 0),(0,i.A)(this,"drawQueue",new s.$),(0,i.A)(this,"open$",new n.t(!1)),this.pipVideo=e,this.pipContext=t,this.globalContext=r,this.pipMessageInitial=a,this.pipMessageProgress=c,this.pipMessageFinished=l,this.progressView=new p(this.pipContext,this.globalContext,this.status,this.pipMessageInitial,this.pipMessageProgress),this.finishedView=new u(this.pipContext,this.pipMessageFinished),this.openPictureInPicture().catch((e=>{o.z.logEvent("Usage - cPiP Opened Error"),console.warn("Could not request picture-in-picture",e)}));const d=()=>{"finished"!==this.status.phase||document.hidden||(m.closePictureInPicture(),document.removeEventListener("visibilitychange",d))};document.addEventListener("visibilitychange",d)}async openPictureInPicture(){if((0,c.gl)(this.pipVideo)){this.pipVideo.addEventListener("enterpictureinpicture",(()=>{this.open$.next(!0)})),this.pipVideo.addEventListener("leavepictureinpicture",(()=>{this.open$.next(!1),"finished"!==this.status.phase&&o.z.logEvent("Usage - cPiP Closed")}));const e=await this.pipVideo.requestPictureInPicture();e.addEventListener("resize",(()=>{this.onPipWindowScaled(e)})),this.onPipWindowScaled(e)}}onPipWindowScaled(e){this.drawQueue.enqueuePromise((async()=>{this.finishedView.scale(e),this.progressView.scale(e),await this.updatePictureInPicture()})).catch((e=>{console.error("Error while scaling PiP preview window",e)}))}async updatePictureInPicture(){const e=this.pipVideo.srcObject;if(document.pictureInPictureElement===this.pipVideo&&(0,c.NZ)(e))try{"finished"===this.status.phase?await this.finishedView.draw():await this.progressView.draw()}finally{e.getTracks()[0].requestFrame()}}setStatus(e){this.status={...this.status,...e},this.progressView.setStatus(this.status)}static closePictureInPicture(){(0,c.MF)(document)&&(0,a.O9)(document.pictureInPictureElement)&&document.exitPictureInPicture().catch((e=>{}))}next(e){this.drawQueue.enqueuePromise((async()=>{this.setStatus({phase:"in_progress",progress:e}),await this.updatePictureInPicture()})).catch((t=>{console.error(`Unable to show updated progress (${e}%) in PiP preview window`,t)}))}complete(){this.drawQueue.discardQueued(),this.drawQueue.enqueuePromise((async()=>{this.setStatus({phase:"finished"}),document.hidden?await this.updatePictureInPicture():m.closePictureInPicture()})).catch((e=>{console.error("Unable to show final screen in PiP preview window",e)}))}error(){this.setStatus({phase:"errored"}),m.closePictureInPicture()}}},406887:(e,t,r)=>{function i(e){return"function"==typeof e.requestPictureInPicture}function n(e){return"function"==typeof e.captureStream}function o(e){return"function"==typeof e.exitPictureInPicture}function s(e){if(e&&"function"==typeof e.getTracks){const t=e.getTracks();return 1===t.length&&"function"==typeof t[0].requestFrame}return!1}r.d(t,{Bl:()=>n,MF:()=>o,NZ:()=>s,gl:()=>i})},673130:(e,t,r)=>{r.d(t,{BT:()=>o,BV:()=>s});const i="ClipchampExportSettingsManager.enableHardwareAcceleration",n="true";function o(){return!0===JSON.parse(window.localStorage.getItem(i)??n)}function s(e){window.localStorage.setItem(i,`${e}`)}},913807:(e,t,r)=>{r.d(t,{b:()=>k,_:()=>E});var i=r(324586),n=r(815731),o=r(217563),s=r(251260),a=r(162036),c=r(515956),l=r(562229),d=r(187974),u=r(854483),h=r(589084),p=r(930394),m=r(555089),f=r(133743),g=r(138615),A=r(573340),v=r(10960),y=r(7089),b=r(822829),w=r(845505),x=r(193308),S=r(673130);const T=1e3;class C{constructor(e){(0,i.A)(this,"timeoutId",setTimeout((()=>{this.checkThrottling()}),T)),(0,i.A)(this,"lastTimestamp",Date.now()),(0,i.A)(this,"throttlingStatus","unthrottled"),this.exportIdentifier=e}checkThrottling(){const e=Date.now(),t=e-this.lastTimestamp;this.lastTimestamp=e,"unthrottled"===this.throttlingStatus?(t>=1500&&(this.throttlingStatus="throttled",l.z.logEvent("Warning - Page Throttled",{exportIdentifier:this.exportIdentifier,timerLateByMs:t-T})),this.timeoutId=setTimeout((()=>{this.checkThrottling()}),T)):"throttled"===this.throttlingStatus&&(t<1500?(this.throttlingStatus="unthrottled",l.z.logEvent("Warning - Page Unthrottled",{exportIdentifier:this.exportIdentifier})):this.timeoutId=setTimeout((()=>{this.checkThrottling()}),T))}finish(){clearTimeout(this.timeoutId)}}var _=r(972389);const k="exportService";class E{get hasStarted(){return this._exportIsRunning}constructor(e,t){(0,i.A)(this,"peppermintManager",void 0),(0,i.A)(this,"cancel$",void 0),(0,i.A)(this,"exportFormat",new n.t(void 0)),(0,i.A)(this,"_exportIsRunning",!1),(0,i.A)(this,"cancel",new o.B),(0,i.A)(this,"output",new s.m(1)),(0,i.A)(this,"progress",new n.t(0)),(0,i.A)(this,"uploadProgress$",new n.t(0)),(0,i.A)(this,"uploadDisabled$",new n.t(!1)),(0,i.A)(this,"upload",void 0),(0,i.A)(this,"uploading",new n.t(!1)),(0,i.A)(this,"uploadResult",new s.m(1)),(0,i.A)(this,"brokenFile$",new o.B),(0,i.A)(this,"exportFailed$",new o.B),this.globalCtx=e,this.timelineRecorderFactory=t,this.cancel$=this.cancel.asObservable()}getProgress$(){return this.progress.asObservable()}getUploadProgress$(){return this.uploadProgress$.asObservable()}getUploadDisabled$(){return this.uploadDisabled$.asObservable()}getResult$(){return this.output.asObservable()}getUploadResult$(){return this.uploadResult.asObservable()}getBrokenFile$(){return this.brokenFile$.asObservable()}getExportFailed(){return this.exportFailed$.asObservable()}ensureOneExport(){const e=!this._exportIsRunning;return e&&this.stop(),this._exportIsRunning=!0,e}async probeWebcodecsConfiguration(e,t){await(0,m.g)();const r=await async function(e,t){const r=(0,S.BT)()&&(0,g.G7)("iet__webcodecs_allow_hardware_encoding")?"no-preference":"prefer-software";try{return await async function(e,t,r){if("mp4"!==t.format)return;if("undefined"==typeof VideoEncoder)return;const i={...e,displayWidth:e.width,displayHeight:e.height,codec:(0,h.aj)({profile:(0,h.If)(d.p0.h264Profile),level:(0,h.Dy)((0,u.g)(e,t.framerate))}),bitrate:(0,d.oR)(d.p0.dynamicBitrate,e,t.framerate),avc:{format:"annexb"},hardwareAcceleration:r,latencyMode:"quality",bitrateMode:"variable",framerate:t.framerate};if(VideoEncoder.isConfigSupported){const{config:e,supported:t}=await VideoEncoder.isConfigSupported(i);t||console.warn("WebCodecs video encoder reports this configuration as not supported, cloned configuration is",e)}return{h264Extradata:await(0,p.H8)(i),hardwareAcceleration:r}}(e,t,r)}catch(e){console.warn("An uncaught error occurred while testing WebCodecs",e)}}(e,{framerate:t.fps,format:t.transcodingFormat});return{webcodecsConfiguration:r,useHardwareFrames:void 0!==r&&(0,g.G7)("iet__external_frame_stream")&&(0,g.G7)("iet__hardware_video_frames")}}async checkOutputFile(e,t,r,i){return(0,x.s7)(e,t,r,i).catch((()=>{})),await(0,x.CK)(e)}async runExport(e,t,r,i,o,s){const d=(0,y.u)();this.onStart(d,e,t.height,i);const u=new C(d);this.exportFormat.next(e.transcodingFormat);const h=performance.now(),p=this.timelineRecorderFactory.createTimelineRecorder(),m=i.tracks.filter((e=>!i.metadata?.captions?.hideCaptionsInPreview||"caption"!==e.type)),g=p.recordTimeline(m,e,t,r,o,s,this.upload),w=new n.t("start-export");g.encoderState.subscribe(w);const S=(0,x.P9)(g.progress,g.assetLoadStream,(()=>{g.progress.pipe((0,a.$)()).subscribe((t=>this.onStall(d,(performance.now()-h)/1e3,g.durationSeconds,t,w.value,e,m)))})),T=(0,b.D)(this.globalCtx.globalPerf,l.z,(e=>({export:e})));let k;const E=this.cancel.pipe((0,c.s)(1)).subscribe((e=>{k=e,g.cancel()}));g.progress.subscribe(this.progress);try{let n=await g.recordedVideoBlob;if(this._exportIsRunning=!1,k)throw new _.O(k);"mp4"===e.transcodingFormat&&(n=await this.checkOutputFile(n,e,(0,v.CF)(m),t));const o=performance.now()-h,s=o/1e3,a=r.manager.timer;this.onSuccess(d,e,t.height,i,g,s,n.size,{decoderPercentageUsage:a.getPercentageUsage(o),compositorPercentageUsage:g.compositorTimer.getPercentageUsage(o),encoderPercentageUsage:g.encoderTimer.getPercentageUsage(o)}),this.output.next({file:n,duration:g.durationSeconds,name:i.name,exportTime:s,format:e.transcodingFormat})}catch(t){this._exportIsRunning=!1,this.upload&&this.upload.cancel().catch((e=>console.error(e)));const r=(performance.now()-h)/1e3;t instanceof _.O?this.onCancel(d,e,g,i,r,t):(this.onFail(d,e,g,i,r,t),this.stop(),A.Vy.error(t),t instanceof f.c?this.brokenFile$.next(t.fileName):this.exportFailed$.next())}finally{u.finish(),E.unsubscribe(),S.unsubscribe(),T(),g.destroy()}}stop(e){w.a.closePictureInPicture(),this._exportIsRunning=!1,this.cancel.next(e),this.output.complete(),this.output=new s.m(1),this.progress.complete(),this.progress=new n.t(0)}}},193308:(e,t,r)=>{r.d(t,{CK:()=>$,P9:()=>L,ST:()=>X,Tl:()=>N,Qn:()=>Y,nS:()=>K,nK:()=>M,_z:()=>O,of:()=>D,tY:()=>B,s7:()=>Z}),r(379321),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(640972),n=r(703619),o=r(396159),s=r(577520),a=r(791252),c=r(562229),l=r(187974),d=r(126714);r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);const u=new Uint32Array(new Uint8Array([0,0,0,32,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,97,118,99,49,109,112,52,49]).buffer);function h(e){return[...new Uint8Array(e,0,u.byteLength)].map((e=>e.toString(16))).join(" ")}var p=r(138615),m=r(922557),f=r(215363),g=r(327443),A=r(966139),v=r(680804),y=r(940069),b=r(74987),w=r(776016),x=r(871287),S=r(973622),T=r(486690),C=r(268774),_=r(650882);function k(e,t,r){return Math.abs(t-e)<=r}const E=1,I=1,R="Error - invalid output file";function F(e,t,r,i){try{!function(e,t){if(!function(e,t){return k(e,t,E)}(e.duration,t))throw new Error(`Exported video duration (${e.duration}s) substantially different from project duration (${t}s)`);if("mov,mp4,m4a,3gp,3g2,mj2"!==e.raw.format.format_name)throw new Error(`Exported video has wrong format (${e.raw.format.format_name})`);if((e.raw.format.nb_streams||0)<1||(e.raw.format.nb_streams||0)>2)throw new Error(`Invalid number of streams in output file (${e.raw.format.nb_streams})`)}(e,t);const n=e.raw.streams.find((e=>"video"===e.codec_type));if(!n)throw new Error("Video stream missing from output file");if(function(e,t,r){if("h264"!==e.codec_name)throw new Error(`Invalid video codec in output file (${e.codec_name})`);if(!function(e,t){return k((0,l.at)(e.avg_frame_rate),t.fps,I)}(e,t))throw new Error(`Invalid framerate in output file (${e.avg_frame_rate} <> ${t.fps})`);if(e.width!==r.width||e.height!==r.height)throw new Error(`Invalid resolution in output file (${e.width}x${e.height} <> ${r.width}x${r.height})`)}(n,i,r),2===e.raw.format.nb_streams){const t=e.raw.streams.find((e=>"audio"===e.codec_type));if(!t)throw new Error("Audio stream missing from output file");!function(e){if("aac"!==e.codec_name)throw new Error(`Invalid audio codec in output file (${e.codec_name})`);if(![l.xc.presets.createExport.formats.mp4.global.samplingFrequency,l.xc.presets.createTeamsExport.formats.mp4.global.samplingFrequency].includes(Number.parseInt(e.sample_rate)))throw new Error(`Invalid audio sample rate (${e.sample_rate} <> ${l.xc.presets.createExport.formats.mp4.global.samplingFrequency})`)}(t)}}catch(e){const t=(0,_.xM)(e,"Metadata check failed");throw c.z.logEvent(R,{type:"metadata",message:t.message}),t}}const P=3e5;function L(e,t,r){return(0,i.c)([e.pipe((0,o.F)()),t],n.E).pipe((0,s.U)(),(0,a.w)(P)).subscribe({error:r})}function N(e){return{exportTime:Math.floor(e.exportTime),duration:Math.floor(e.duration)}}function M(e){return{exportFormat:e.transcodingFormat,exportPreset:e.transcodingPreset,exportFps:e.fps,exportPresetId:e.id}}function B(e){const t=[],r=[];return e?.tracks.forEach((e=>{e.items.forEach((e=>{t.push(e.asset.id),r.push(e.asset.name)}))})),{timelineAssetIds:t,timelineAssetNames:r}}function D(e){return e.update((e=>(e.successfulExports=(e.successfulExports??0)+1,e.successfulExports??0)),"overwrite")}function O(e){const t={templatesAdded:e.templatesAdded,templatesAddedCount:e.templatesAddedCount,includesProjectTemplate:e.includesProjectTemplate,includesComponentTemplate:e.includesComponentTemplate,templateId:e.firstTemplateId,templateName:e.firstTemplateName};if("template"===e.flavor){const r=e.flavorData;r?.templateId&&(t.templateId=r.templateId),r?.templateName&&(t.templateName=r.templateName)}return t}function j(e,t){return Array.isArray(t)?t.includes(e.cloud.provider):e.cloud.provider===t}function U(e,t){(0,m.n)(e)&&((0,f.G)(e.asset)&&j(e.asset,"videoblocks")?"image"===e.asset.type?t.stockImage.push(e.asset.cloud.id):t.stockVideo.push(e.asset.cloud.id):(0,f.G)(e.asset)&&j(e.asset,"giphy")?t.giphy.push(e.asset.cloud.id):(0,g.F_)(e.asset)&&(t.elementIds.push(e.asset.id),t.elementNames.push(e.asset.name),t.elementSubtypes.push(e.asset.subtype)),e.filters&&(t.filterIds.push(...e.filters.map((e=>e.filter.id))),t.filterNames.push(...e.filters.map((e=>e.filter.name)))))}function z(e,t){"audio"===e.asset.type&&(0,f.G)(e.asset)&&j(e.asset,"videoblocks")&&t.stockAudio.push(e.asset.cloud.id)}function W(e,t){var r;(0,A.p)(e)&&(t.fonts=t.fonts.concat(e.asset.options.fields.filter((e=>"font"===e.type)).map((t=>e.fields[t.id]??t.defaultValue))),t.titleIds.push(e.asset.id),t.titleNames.push("overlay"===(r=e.asset).appearAsType?"Overlay: "+r.name:"IntroOutro"===r.category?"Intro/Outro: "+r.name:r.name))}function V(e,t){(0,v.uF)(e)&&(t.fonts=t.fonts.concat(e.asset.entities.flatMap((e=>e.segments.filter((e=>"com.clipchamp.text"===e.type)).flatMap((e=>e.properties.content?.flatMap((e=>e.fontId))?.filter((e=>!!e))??[]))))),t.proceduralIds.push(e.asset.id),t.proceduralNames.push(e.asset.name))}function H(e,t){"background"===e.asset.type&&t.backgroundIds.push(e.asset.id)}function G(e,t){t.transitionIds.push(...e.transitions.map((e=>e.asset.id))),t.transitionNames.push(...e.transitions.map((e=>e.asset.name)))}function q(e,t){(0,y.HS)(e.asset)&&(t.voicesUsed.push(e.asset.voiceId),t.voiceoverTextLength+=e.asset.text.length,t.voiceoverDuration+=e.asset.metadata.duration)}function Q(e,t){if((0,f.G)(e.asset)&&j(e.asset,["clipchamp","clipchamp_stock"]))switch(e.asset.type){case"image":t.stockImage.push(e.asset.cloud.id);break;case"video":t.stockVideo.push(e.asset.cloud.id);break;case"audio":t.stockAudio.push(e.asset.cloud.id)}}function K(e){const t={filterIds:[],filterNames:[],titleIds:[],titleNames:[],proceduralIds:[],proceduralNames:[],transitionIds:[],transitionNames:[],templateId:void 0,templateName:void 0,backgroundIds:[],fonts:[],stockVideo:[],stockAudio:[],stockImage:[],giphy:[],elementIds:[],elementNames:[],elementSubtypes:[],voicesUsed:[],voiceoverTextLength:0,voiceoverDuration:0},r=(0,p.Us)("ks_con__export_logging");for(const i of e){for(const e of i.items)U(e,t),z(e,t),W(e,t),V(e,t),H(e,t),q(e,t),r&&Q(e,t);G(i,t)}return function(e){for(const t of Object.keys(e)){const r=e[t];Array.isArray(r)&&(e[t]=[...new Set(r)])}return e}(t)}const X=e=>{const t={cloudBackup:e.isCloudBackupEnabled??!1,logo:!1,pip:!1,aiImgBackgroundRemoved:!1,usedRecordingAssetAudio:!1,usedRecordingAssetScreen:!1,usedRecordingAssetWebcam:!1,usedRecordingAssetWebcamScreen:!1,usedSpeakerCoach:!1};return e?.tracks.forEach((e=>{e.items.forEach((e=>{if(!(0,m.n)(e)&&!(0,b.R)(e))return;switch(e.asset.metadata.origin){case"webcam":t.usedRecordingAssetWebcam=!0;break;case"screenRecorder":t.usedRecordingAssetScreen=!0;break;case"webcam+screen":t.usedRecordingAssetWebcamScreen=!0;break;case"audioRecorder":t.usedRecordingAssetAudio=!0}const r=e.asset.metadata.assistiveIntelligence;r&&r.includes("speakerCoach")&&(t.usedSpeakerCoach=!0),(0,m.n)(e)&&("logo"===e.asset.appearAsType?t.logo=!0:"auto-place"===e.transform?.strategy&&(t.pip=!0)),e.asset.name.startsWith("background removed - ")&&(t.aiImgBackgroundRemoved=!0)}))})),t};function Y(e){const t={video:{},audio:{},image:{}};for(const r of e)for(const e of r.items)switch(e.asset.type){case"video":{const r=(0,l.yL)(e.asset.metadata.raw)?.codec_name;(0,w.O9)(r)&&(t.video[r]=(t.video[r]??0)+1);const i=(0,d.xF)(e.asset.metadata.raw)?.codec_name;(0,w.O9)(i)&&(t.audio[i]=(t.audio[i]??0)+1);break}case"audio":{const r=(0,d.xF)(e.asset.metadata.raw)?.codec_name;(0,w.O9)(r)&&(t.audio[r]=(t.audio[r]??0)+1);break}case"image":{const r=(0,l.$g)(e.asset.metadata.raw)?.codec_name;(0,w.O9)(r)&&(t.image[r]=(t.image[r]??0)+1);break}}return t}async function Z(e,t,r,i){try{const n=await async function(e){try{return await(0,S.sw)((0,C.A)(e))}catch(t){const r=(0,_.xM)(t,"Metadata probe failed");throw c.z.logEvent(R,{type:"probing",size:e.size,message:r.message}),r}}(e);F(n,r,i,t),await async function(e,t){try{const{handling:r}=await(new T.j).canPlay(e,t.raw);if("keep-as-is"!==r)throw new Error(`Playability handling was determined to be ${r}`)}catch(e){const t=(0,_.xM)(e,"Playability check failed");throw c.z.logEvent(R,{type:"playability",message:t.message}),t}}(e,n)}catch(e){console.error("Exported video file was determined to be invalid",e)}}const J=128;async function $(e){if(e.size<=J)throw new Error(`Output file too small (${e.size} bytes)`);const t=await(0,x.gm)(e.slice(0,u.byteLength));return new Uint32Array(t,0,u.length).every(((e,t)=>e===u[t]))?e:(c.z.logEvent("Error - Invalid ftyp atom",{expected:h(u.buffer),received:h(t)}),new Blob([u,e.slice(u.byteLength)],{type:e.type}))}},855507:(e,t,r)=>{r.d(t,{D:()=>s,d:()=>o});var i=r(187974),n=r(800256);function o(e){const t=(0,i.Ic)({preset:e.transcodingPreset,format:e.transcodingFormat}),r=t.samplingFrequency??n.kX,o=r/e.fps;if(o%1!=0)throw new Error(`Sample-rate should be evenly divisible by FPS (${r} / ${e.fps} = ${o})`);return{sampleRate:r,bufferLength:o,channelCount:t.audioChannels}}function s(e){return"flt"!==(0,i.Ic)({preset:e.transcodingPreset,format:e.transcodingFormat}).samplingFormat}},633110:(e,t,r)=>{let i;async function n(e,[t,r]){i=e;try{return await Promise.all([Promise.resolve(t).finally((()=>i=`${e}-audio`)),Promise.resolve(r).finally((()=>i=`${e}-video`))])}finally{i=void 0}}function o(){return i}r.d(t,{F_:()=>n,PE:()=>o})},972389:(e,t,r)=>{r.d(t,{O:()=>bt,c:()=>wt}),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var i=r(217563),n=r(584571),o=r(508487),s=r(673101),a=r(801330),c=r(562229),l=r(187974),d=r(957734),u=r(867312),h=r(138615),p=r(889688),m=r(573340),f=r(10960),g=r(471189),A=r(709134),v=r(82979),y=(r(34456),r(159129),r(940233),r(270818),r(513173),r(205218),r(987089)),b=r(324586),w=r(945596),x=r(979820);class S extends w.A{constructor(e){const t=e.createShader(e.gl.VERTEX_SHADER,"#version 300 es\nin vec2 vertexPos;\nin vec2 vertexUV;\nout vec2 texCoords;\nvoid main() {\n    texCoords = vertexUV;\n    gl_Position = vec4(vertexPos, 0, 1);\n}\n"),r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 300 es\nprecision mediump float;\n\nuniform sampler2D colorSampler;\nuniform int bufferChannel; // 0=Y, 1=U, 2=V\nin vec2 texCoords;\nout float outColor;\n\nvec3 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec3(0.);\n    return color.rgb / color.a;\n}\n\nvoid main() {\n    vec2 flippedCoords = vec2(texCoords.x, 1. - texCoords.y);\n    vec3 rgb = unmultAlpha(texture(colorSampler, flippedCoords));\n\n    float y = dot(rgb, vec3(0.2126, 0.7152, 0.0722));\n    if (bufferChannel == 0) {\n        outColor = (219.0 * y + 16.0) / 255.0;\n    } else if (bufferChannel == 1) {\n        float u = (rgb.b - y) / 1.8556;\n        outColor = (224.0 * u + 128.0) / 255.0;\n    } else if (bufferChannel == 2) {\n        float v = (rgb.r - y) / 1.5748;\n        outColor = (224.0 * v + 128.0) / 255.0;\n    }\n}\n"),i=e.createProgram(t,r);e.gl.deleteShader(t),e.gl.deleteShader(r),super(e,i),(0,b.A)(this,"bufferChannel",void 0),(0,b.A)(this,"colorSampler",void 0),this.bufferChannel=this.uniform("bufferChannel",x.A.INTEGER),this.colorSampler=this.sampler("colorSampler")}}var T=r(635311),C=r(571056),_=r(692701),k=r(293413),E=r(645375),I=r(402850),R=r(764662),F=r(908545),P=r(272885),L=r(104173),N=(r(379321),r(602445));class M{constructor(){(0,b.A)(this,"events",new Map)}createHandle(){let e=[];return{setEvents:t=>{for(const t of e)this.removeEvent(t);e=t;for(const e of t){const t=this.events.get(e.time);t?t.push(e.callback):this.events.set(e.time,[e.callback])}}}}updateTime(e){const t=[...this.events].filter((([t])=>t<=e));t.sort((([e],[t])=>e-t));for(const[e,r]of t){for(const t of r)t(e);this.removeBucket(e)}}destroy(){this.events.clear()}removeEvent(e){const t=this.events.get(e.time);t&&(t.splice(t.indexOf(e.callback),1),0===t.length&&this.events.delete(e.time))}removeBucket(e){this.events.get(e)&&this.events.delete(e)}}var B=r(177764);const D={type:"playing",mediaDelta:(0,L.z1)(0)};class O{constructor(e,t,r){(0,b.A)(this,"scheduler",void 0),(0,b.A)(this,"cache",void 0),(0,b.A)(this,"interpreter",void 0),(0,b.A)(this,"devices",[]),this.clock=e,this.scheduler=new M,this.cache=new N.r(t,this.scheduler,(e=>e()),e,{}),this.interpreter=new B.i((e=>this.cache.setStreams(e)),(e=>this.updateDeviceRendererState(e)),(e=>this.updateDeviceMixerState(e)),r,e),this.cache.updatePlayback(D)}attachDevice(e){const t=this.scheduler.createHandle(),r=e(this.cache,{setIsWaiting:()=>{}},t);return this.devices.push(r),r.updatePlayback(D),r.setRenderState?.(this.interpreter.getRendererState()),r.setMixerState?.(this.interpreter.getMixerState()),[r,()=>{r.destroy(),t.setEvents([]);const e=this.devices.indexOf(r);-1!==e&&this.devices.splice(e,1)}]}updateTime(){this.scheduler.updateTime(this.clock.getTime())}destroy(){this.cache.destroy()}updateProject(e){this.interpreter.updateProject(e)}updateDeviceRendererState(e){for(const t of this.devices)t.setRenderState?.(e)}updateDeviceMixerState(e){for(const t of this.devices)t.setMixerState?.(e)}}var j=r(626395),U=r(830349),z=r(707050),W=r(650882),V=r(164768),H=r(204643),G=r(784087),q=(r(584570),r(82265),r(988124),r(268774)),Q=r(126714),K=r(941750),X=r(668359),Y=r(708451),Z=r(133743),J=r(777689),$=r(476807),ee=r(647306),te=r(641306),re=r(540076),ie=r(406262),ne=r(833665),oe=r(416162);class se{constructor(e,t){(0,b.A)(this,"effectWrapper",void 0),this.effectRenderer=e,this.effectWrapper=new oe.$({engine:e.engine,vertexShader:"attribute vec2 position;\n\nvarying vec2 texCoords;\n\nvoid main() {\n    texCoords = position * 0.5 + 0.5;\n    gl_Position = vec4(position, 0, 1);\n}\n",...t})}destroy(){this.effectWrapper.dispose()}renderTo(e){e.renderTarget&&this.effectRenderer.render(this.effectWrapper,e)}}class ae{constructor(e,t,r){this.effectRenderer=e,this.effectWrapper=t,this.samplerName=r}set(e){this.effectRenderer.applyEffectWrapper(this.effectWrapper),this.effectWrapper.effect.setTexture(this.samplerName,e)}}const ce={name:"YuvToRgbRenderer",fragmentShader:"precision mediump float;\n\nuniform sampler2D yTex;\nuniform sampler2D uTex;\nuniform sampler2D vTex;\nuniform sampler2D aTex;\n\nuniform vec2 textureStretch; // >1 shrinks, <1 expands\nuniform vec2 textureOffset;\nuniform bool useAlpha;\nvarying vec2 texCoords;\n\nvoid main() {\n    vec2 modifiedCoords = texCoords * textureStretch + textureOffset;\n\n    float y = (texture2D(yTex, modifiedCoords).r * 255.0 - 16.0) / 219.0;\n    float u = (texture2D(uTex, modifiedCoords).r * 255.0 - 128.0) / 224.0;\n    float v = (texture2D(vTex, modifiedCoords).r * 255.0 - 128.0) / 224.0;\n    float alpha = useAlpha ? texture2D(aTex, modifiedCoords).r : 1.0;\n\n    float r = v * 1.5748 + y;\n    float b = u * 1.8556 + y;\n    float g = (y - 0.2126 * r - 0.0722 * b) / 0.7152;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * alpha;\n}\n",uniformNames:["useAlpha","textureOffset","textureStretch"],samplerNames:["aTex","yTex","uTex","vTex"]};class le extends se{constructor(e){super(e,ce),(0,b.A)(this,"ySampler",void 0),(0,b.A)(this,"uSampler",void 0),(0,b.A)(this,"vSampler",void 0),(0,b.A)(this,"aSampler",void 0),this.ySampler=new ae(this.effectRenderer,this.effectWrapper,"yTex"),this.uSampler=new ae(this.effectRenderer,this.effectWrapper,"uTex"),this.vSampler=new ae(this.effectRenderer,this.effectWrapper,"vTex"),this.aSampler=new ae(this.effectRenderer,this.effectWrapper,"aTex")}setTextureStretch(e){this.effectWrapper.effect.setArray2("textureStretch",e)}setTextureOffset(e){this.effectWrapper.effect.setArray2("textureOffset",e)}setUseAlpha(e){this.effectWrapper.effect.setFloat("useAlpha",e?1:0)}}r(116962);var de=r(912170);class ue{get texture(){if(!this._texture)throw new Error("Attempting to get texture before upload or after disposal");return this._texture}constructor(e){(0,b.A)(this,"_texture",void 0),this.engine=e}destroy(){this._texture?.dispose()}upload(e,t){const r=(i=e)instanceof HTMLImageElement?{width:i.naturalWidth,height:i.naturalHeight}:i instanceof HTMLVideoElement?{width:i.videoWidth,height:i.videoHeight}:i instanceof VideoFrame?{width:i.displayWidth,height:i.displayHeight}:{width:i.width,height:i.height};var i;if(0===r.width||0===r.height)return;const n=this._initTextureForUpload(r.width,r.height);this.engine.updateDynamicTexture(n,e,!t.yFlipped,t.isAlreadyPremult)}uploadBuffer(e,t,r,i){const n=this._initTextureForUpload(t,r),o=this.engine._gl;o&&(o.bindTexture(WebGLRenderingContext.TEXTURE_2D,n._hardwareTexture?.underlyingResource),o.pixelStorei(WebGLRenderingContext.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.isAlreadyPremult?0:1),o.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,i.yFlipped?0:1),o.pixelStorei(WebGLRenderingContext.UNPACK_ALIGNMENT,1),o.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,i.imageFormat.internalFormat,t,r,0,i.bufferFormat.channels,i.bufferFormat.type,e)),n.isReady=!0}_initTextureForUpload(e,t){if(this._texture){const r=this._texture.getInternalTexture();if(r&&(e===r.baseWidth||t===r.baseHeight))return r}this._texture&&this._texture.dispose();const r=this.engine.createDynamicTexture(e,t,!1,0);return this._texture=new de.D(r),(0,ne.S)(this._texture),r}}class he{constructor(e){(0,b.A)(this,"effectRenderer",void 0),(0,b.A)(this,"renderer",void 0),(0,b.A)(this,"yTex",void 0),(0,b.A)(this,"uTex",void 0),(0,b.A)(this,"vTex",void 0),(0,b.A)(this,"aTex",void 0),(0,b.A)(this,"frameHeight",0),(0,b.A)(this,"frameWidth",0),(0,b.A)(this,"useAlpha",!1),this.engine=e,this.effectRenderer=new oe.J(this.engine),this.renderer=new le(this.effectRenderer),this.yTex=new ue(this.engine),this.uTex=new ue(this.engine),this.vTex=new ue(this.engine)}bindToRenderer(e,t=0){const{width:r,height:i}=e;this.renderer.setTextureStretch([r/this.frameWidth,i/this.frameHeight]),this.renderer.setTextureOffset([0,1-(t+i)/this.frameHeight]),this.renderer.setUseAlpha(this.useAlpha),this.renderer.ySampler.set(this.yTex.texture),this.renderer.uSampler.set(this.uTex.texture),this.renderer.vSampler.set(this.vTex.texture),void 0!==this.aTex&&this.renderer.aSampler.set(this.aTex.texture)}renderTo(e){this.renderer.renderTo(e)}uploadFrame(e){const t=e.resolution.width,r=e.resolution.height,i=e.chromaResolution.width,n=e.chromaResolution.height,o={isAlreadyPremult:!0,yFlipped:!1,imageFormat:{internalFormat:WebGLRenderingContext.LUMINANCE},bufferFormat:{channels:WebGLRenderingContext.LUMINANCE,type:WebGLRenderingContext.UNSIGNED_BYTE}};this.yTex.uploadBuffer(e.yBuffer,t,r,o),this.uTex.uploadBuffer(e.uBuffer,i,n,o),this.vTex.uploadBuffer(e.vBuffer,i,n,o),void 0!==e.aBuffer?(this.useAlpha=!0,void 0===this.aTex&&(this.aTex=new ue(this.engine)),this.aTex.uploadBuffer(e.aBuffer,t,r,o)):this.useAlpha=!1,this.frameWidth=t,this.frameHeight=r}destroy(){this.yTex.destroy(),this.uTex.destroy(),this.vTex.destroy(),this.aTex?.destroy(),this.effectRenderer.dispose(),this.renderer.destroy()}}class pe{constructor(e){(0,b.A)(this,"availableBuffers",[]),(0,b.A)(this,"converter",void 0),(0,b.A)(this,"rgbTexture",void 0),this.engine=e}getConverter(){return this.converter??=new he(this.engine),this.converter}getRgbTexture(e,t){if(0===e||0===t)throw new Error("Cannot create a zero sized texture");const r=this.rgbTexture;if(void 0!==r){const i=r.getInternalTexture();if(i&&i.baseWidth===e&&i.baseHeight===t)return r}return this.rgbTexture?.dispose(!1),this.rgbTexture=new ie.s(this.engine,{width:e,height:t},{generateDepthBuffer:!1}),(0,ne.S)(this.rgbTexture),this.rgbTexture}destroy(){this.converter?.destroy(),this.rgbTexture?.dispose(!1)}}class me{constructor(e,t,r){(0,b.A)(this,"type","data"),this.frame=e,this.sharedData=t,this.startTime=r}value(){return"raw"===this.frame.type?this.renderRaw(this.frame):this.renderWebCodec(this.frame)}destroy(){"raw"===this.frame.type?this.sharedData.availableBuffers.push(this.frame.data.buffer):this.frame.data.close()}renderWebCodec(e){const t=this.sharedData.getRgbTexture(e.data.displayWidth,e.data.displayHeight),r=t.getInternalTexture(),i=this.sharedData.engine._webGLVersion;return this.sharedData.engine._webGLVersion=1,this.sharedData.engine.updateDynamicTexture(r,e.data,!0,!0),this.sharedData.engine._webGLVersion=i,t}renderRaw(e){const{engine:t}=this.sharedData,{width:r,height:i}=(0,$.tm)(e),n=this.sharedData.getRgbTexture(r,i),o=this.sharedData.getConverter(),s={width:r,height:i};o.uploadFrame(function(e,t,r=!1){const i=Math.ceil(t.width/2),n=Math.ceil(t.height/2),o=t.width*t.height,s=o,a=i*n,c=s+a,l=c+a,d={resolution:t,chromaResolution:{width:i,height:n},yBuffer:e.subarray(0,s),uBuffer:e.subarray(s,c),vBuffer:e.subarray(c,l)};if(r){const t=l+o;d.aBuffer=e.subarray(l,t)}return d}(e.data,s,e.format===K.Ng.Yuva420P)),o.bindToRenderer(s);const a=t.getAlphaMode();return t.setAlphaMode(0),o.renderTo(n),t.setAlphaMode(a),n}}class fe{constructor(e){(0,b.A)(this,"availableBuffers",[]),(0,b.A)(this,"startTime",0),(0,b.A)(this,"activeValue",void 0),this.config=e}seek(e){this.startTime=e}nextStartTime(){const e=(0,L.H)(this.startTime);return this.startTime+=1,e}setActiveValue(e){this.activeValue?.destroy(),this.activeValue=e}}class ge{constructor(e,t){(0,b.A)(this,"type","data"),(0,b.A)(this,"startTime",void 0),(0,b.A)(this,"refCount",1),this.audio=e,this.sharedData=t,this.startTime=t.nextStartTime()}value(){return this.refCount+=1,this.sharedData.setActiveValue(this),this.audio.data}destroy(){this.refCount-=1,0===this.refCount&&this.sharedData.availableBuffers.push(this.audio.data.buffer)}}class Ae{constructor(e,t,r,i){(0,b.A)(this,"streams",[]),(0,b.A)(this,"playbackRate",1),(0,b.A)(this,"frameData",void 0),(0,b.A)(this,"audioData",void 0),this.demuxer=e,this.asset=t,this.clock=i,void 0!==e.config.video&&(this.frameData=new pe(r),this.streams.push("video"));const n=e.config.audio;void 0!==n&&((0,re.vA)(n.samplesPerChunk===n.sampleRate/i.timebase),this.audioData=new fe(n),this.streams.push("audio"))}readNext(e){const{frameData:t,audioData:r}=this;return(0,ee.y)(e,{video:t?()=>this.readNextVideo(t):void 0,audio:r?()=>this.readNextAudio(r):void 0})}handleError(e){if(e instanceof J.DP)return te.K;if(e instanceof J.qB)return te.y;throw Z.c.fromUnknownError(this.asset,e)}async readNextVideo(e){const t=e.availableBuffers.pop();let r;try{r=await this.demuxer.decodeVideo(t)}catch(e){return this.handleError(e)}const i=(0,$.v1)(r),n=this.clock.mediaSecondsToTicks(i/this.playbackRate);return new me(r,e,n)}async readNextAudio(e){const t=e.availableBuffers.pop();let r;try{r=await this.demuxer.decodeAudio(t)}catch(t){const i=this.handleError(t);return"end"===i.type?(r={type:"raw",data:new Float32Array(e.config.samplesPerChunk*e.config.channelCount)},{type:"end",lastData:new ge(r,e)}):i}return new ge(r,e)}seek(e){const t=this.clock.ticksToSeconds(e)*this.playbackRate;this.demuxer.seek(t).catch((e=>console.error(e))),this.audioData?.seek(e)}setConfig(e){const t=this.demuxer.config.audio;if(void 0!==t&&(t?.playbackRate??1)!==e.playbackRate)throw new Error("Changing Peppermint audio playback-rate currently unsupported");this.playbackRate=e.playbackRate}destroy(){this.demuxer.destroy().catch((e=>console.error(e))),this.frameData?.destroy()}}class ve extends X.K{constructor(e,t,r,i,n,o,s){super(),this.url=e,this.asset=t,this.engine=r,this.clock=i,this.peppermintConfig=n,this.enabledStreams=o,this.config=s,this.setInner(this.createPeppermintSource())}setConfig(e){this.config.playbackRate!==e.playbackRate&&(this.config=e,this.enabledStreams.has("audio")&&this.setInner(this.createPeppermintSource())),super.setConfig(e)}createPeppermintSource(){const{url:e,asset:t,enabledStreams:r,peppermintConfig:i,engine:n,clock:o}=this;return new z._((async()=>{const s={inputFile:await(0,q.Y)(new URL(e,"file:///mnt/vss/_work/1/s/libs/superfill-web/src/sources/peppermint-source.ts"),t.metadata.importedSize??t.metadata.size)};if(r.has("video")){let e;e=void 0===t.metadata.raw||(0,Q.il)(t.metadata.raw)?K.Ng.Yuva420P:K.Ng.Yuv420P,s.video={pixelFormat:e}}r.has("audio")&&(this.updatePlaybackRate(),s.audio=i.audio);const a=await i.manager.createFormatDemuxer(s),c=new Ae(a,t,n,o);return(0,Y.I)(c,o,{maxLookAheadDuration:o.durationSecondsToTicks(i.maxLookAheadSeconds),loopDuration:o.durationSecondsToTicks(t.metadata.duration??0)})})())}updatePlaybackRate(){this.enabledStreams.has("audio")&&this.peppermintConfig.audio&&this.peppermintConfig.audio.playbackRate!==this.config.playbackRate&&(this.peppermintConfig.audio={...this.peppermintConfig.audio,playbackRate:this.config.playbackRate})}}function ye(e,t,r,i){return(n,o,s)=>new z._((async(n,o,s)=>{const[a,c]=await i(n)??[];if(void 0===a||void 0===c)throw new W.g9("Unresolved asset",{assetId:n});switch(c.type){case"fontface":return new H.j(a);case"video":case"audio":return function(e,t,r,i,n,o,s){return new ve(e,t,r,i,n,o,s)}(a,c,e,t,r,o,s);case"image":return new G.q(a,(l=c.metadata).raw&&l.raw.streams.length>0&&"svg"===l.raw.streams[0].codec_name?"vector":"bitmap",e);case"filter":return new G.q(a,"bitmap",e);default:throw new W.g9("Unsupported asset type",{type:c.type})}var l})(n,o,s).catch((t=>(console.error(t),new V.g(e,void 0)))))}var be=r(105263),we=r(736965),xe=r(116924),Se=r(800256);class Te extends be.S{get bufferLength(){return this.supermixOptions.bufferLength??Se.Ib}get channelCount(){return this.supermixOptions.channelCount??Se.cA}constructor(e,t,r,i,n){super(r,i,{maxActiveStreams:n.maxActiveStreams},{updateStreamState:()=>{this.mixerStateChanged=!0},updateConnectionState:()=>{this.connectionStateChanged=!0}}),(0,b.A)(this,"pendingStreams",new Set),(0,b.A)(this,"supermixContextId",void 0),(0,b.A)(this,"mixerStateChanged",!1),(0,b.A)(this,"connectionStateChanged",!1),(0,b.A)(this,"isProcessing",!1),(0,b.A)(this,"inputBuffer",void 0),this.worker=e,this.streamReader=t,this.supermixOptions=n,this.inputBuffer=new Float32Array(this.bufferLength*this.channelCount*this.maxActiveStreams)}async getOutputBuffer(e){if(this.isProcessing)throw new Error("Cannot call getOutputBuffer while processing");this.isProcessing=!0,void 0===e&&(e=new Float32Array(this.bufferLength*this.channelCount));const t=(0,we._)(this.playbackState,this.clock),r=await Promise.all([...this.connections].map((([e,r])=>this.getInputEntry(e,r,t))));return e=await this.workerProcess(e,new Map(r),this.clock.ticksToSeconds(t)),this.isProcessing=!1,e}createActiveStream(e){return{activeStream:{streamId:e},connectionIndex:(0,xe.t)(this.connections,this.maxActiveStreams)}}removeActiveStream(e){}async getInputEntry(e,t,r){const i=await(0,j.L)((e=>this.streamReader.pollRead(e,t,r,{}))),n=this.bufferLength*this.channelCount,o=e*n,s=this.inputBuffer.subarray(o,o+n);s.set(i);const a=[];for(let e=0;e<n;e+=this.bufferLength)a.push(s.subarray(e,e+this.bufferLength));return[e,a]}async workerCreate(){const{supermixContextId:e}=await this.worker.call("supermix-create",this.supermixOptions,[],(()=>{}));return e}async workerProcess(e,t,r){void 0===this.supermixContextId&&(this.supermixContextId=await this.workerCreate());const i=await this.worker.call("supermix-process",{supermixContextId:this.supermixContextId,inputBuffer:this.inputBuffer,outputBuffer:e,inputs:t,timeSeconds:r,streams:this.mixerStateChanged?this.streams:void 0,connections:this.connectionStateChanged?this.connections:void 0},[this.inputBuffer.buffer,e.buffer],(()=>{}));return this.inputBuffer=i.inputBuffer,this.mixerStateChanged=!1,this.connectionStateChanged=!1,i.outputBuffer}workerDestroy(){this.supermixContextId&&this.worker.call("supermix-destroy",{supermixContextId:this.supermixContextId},[],(()=>{})).catch((e=>{console.error("Failed to destroy Supermix context:",e)}))}destroy(){super.destroy(),this.workerDestroy()}}var Ce=r(615101),_e=r(623198);r(560007),r(507851);const ke={name:"RgbToYuvConverter",fragmentShader:"#version 300 es\nprecision mediump float;\n\nuniform sampler2D colorSampler;\nuniform int bufferChannel; // 0=Y, 1=U, 2=V\nin vec2 texCoords;\nout vec4 outColor;\n\nvec3 unmultAlpha(vec4 color) {\n    return color.rgb;\n}\n\nvoid main() {\n    vec2 flippedCoords = vec2(texCoords.x, 1. - texCoords.y);\n    vec3 rgb = unmultAlpha(texture(colorSampler, flippedCoords));\n\n    float outChannel = 0.0;\n    float y = dot(rgb, vec3(0.2126, 0.7152, 0.0722));\n    if (bufferChannel == 0) {\n        outChannel = (219.0 * y + 16.0) / 255.0;\n    } else if (bufferChannel == 1) {\n        float u = (rgb.b - y) / 1.8556;\n        outChannel = (224.0 * u + 128.0) / 255.0;\n    } else if (bufferChannel == 2) {\n        float v = (rgb.r - y) / 1.5748;\n        outChannel = (224.0 * v + 128.0) / 255.0;\n    }\n    // There seems to be an issue in Chrome where for some reason this shader produces garbage unless\n    // all channels are written to, despite the target texture only being single-channel anyway.\n    outColor = vec4(vec3(outChannel), 1.0);\n}\n",uniformNames:["bufferChannel"],samplerNames:["colorSampler"]};class Ee extends se{constructor(e){super(e,ke),(0,b.A)(this,"colorSampler",void 0),this.colorSampler=new ae(this.effectRenderer,this.effectWrapper,"colorSampler")}setBufferChannel(e){this.effectWrapper.effect.setInt("bufferChannel",e)}}class Ie{get isCurrentlyConverting(){return this._isCurrentlyConverting}constructor(e,t,r){if((0,b.A)(this,"_isCurrentlyConverting",!1),(0,b.A)(this,"effectRenderer",void 0),(0,b.A)(this,"renderer",void 0),(0,b.A)(this,"yTex",void 0),(0,b.A)(this,"uTex",void 0),(0,b.A)(this,"vTex",void 0),(0,b.A)(this,"bufferData",void 0),this.engine=e,e._gl.isContextLost())throw new Error("RGB to YUV converter is not supported on this device: WebGL context is currently lost");const i=Math.ceil(t/2),n=Math.ceil(r/2),o=t*r,s=i*n,a=o+s,c=a+s;if(2!==e.version)throw new Error("RGB to YUV converter is not supported on this device: WebGL2 is not available");this.effectRenderer=new oe.J(this.engine),this.renderer=new Ee(this.effectRenderer),this.yTex=Re(e,t,r),this.uTex=Re(e,i,n),this.vTex=Re(e,i,n);const l=e._gl.createBuffer();if(null===l)throw new Error("Failed to create async buffer");e._gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,l),e._gl.bufferData(WebGL2RenderingContext.PIXEL_PACK_BUFFER,c,WebGL2RenderingContext.STREAM_READ),e._gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,null);const d=e._currentRenderTarget;this.yTex.renderTarget&&e.bindFramebuffer(this.yTex.renderTarget);const u=e._gl.getParameter(WebGL2RenderingContext.IMPLEMENTATION_COLOR_READ_FORMAT);if(d&&e.bindFramebuffer(d),this._isCurrentlyConverting=!1,this.bufferData={asyncBuffer:l,readFormat:u,yDataEnd:o,uDataEnd:a,bufferSize:c},u!==WebGL2RenderingContext.LUMINANCE&&u!==WebGL2RenderingContext.RED)throw this.destroy(),new Error("RGB to YUV converter is not supported on this device: single-channel download not available")}destroy(){this.yTex.dispose(),this.uTex.dispose(),this.vTex.dispose(),this.engine._gl.deleteBuffer(this.bufferData.asyncBuffer),this.effectRenderer.dispose(),this.renderer.destroy()}beginAsyncConvert(e){const{asyncBuffer:t,yDataEnd:r,uDataEnd:i}=this.bufferData;this._isCurrentlyConverting=!0,this.renderYuvTextures(e),this.engine._gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,t),this.downloadWebGL2Buffer(this.yTex,0),this.downloadWebGL2Buffer(this.uTex,r),this.downloadWebGL2Buffer(this.vTex,i),this.engine._gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,null)}endAsyncConvert(e){const{asyncBuffer:t}=this.bufferData;return e=this.recycleBuffer(e),this.engine._gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,t),this.engine._gl.getBufferSubData(WebGL2RenderingContext.PIXEL_PACK_BUFFER,0,e),this.engine._gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,null),this._isCurrentlyConverting=!1,e}recycleBuffer(e){const{bufferSize:t}=this.bufferData;return void 0===e||e.byteLength<t?(console.warn(`RGB-to-YUV converter received recycled ${e?.byteLength??0}-byte buffer, however ${t} bytes are required.`),new Uint8Array(t)):e}renderYuvTextures(e){this.renderer.colorSampler.set(e);const t=this.engine.getAlphaMode();this.engine.setAlphaMode(0),this.renderer.setBufferChannel(0),this.renderer.renderTo(this.yTex),this.renderer.setBufferChannel(1),this.renderer.renderTo(this.uTex),this.renderer.setBufferChannel(2),this.renderer.renderTo(this.vTex),this.engine.setAlphaMode(t)}downloadWebGL2Buffer(e,t){const r=e.getInternalTexture();if(!e.renderTarget||!r)throw new Error("No render target");const i=this.engine._currentRenderTarget;this.engine._gl.pixelStorei(WebGL2RenderingContext.PACK_ALIGNMENT,1),this.engine.bindFramebuffer(e.renderTarget),this.engine._gl.readPixels(0,0,r.baseWidth,r.baseHeight,this.bufferData.readFormat,WebGL2RenderingContext.UNSIGNED_BYTE,t),i&&this.engine.bindFramebuffer(i)}}function Re(e,t,r){const i=new ie.s(e,{width:t,height:r},{format:6,generateDepthBuffer:!1});return(0,ne.S)(i),i}const Fe={name:"YFlip",fragmentShader:"precision mediump float;\n\nuniform sampler2D inTex;\n\nvarying vec2 texCoords;\n\nvoid main() {\n    vec2 flippedTexCoord = vec2(texCoords.x, 1.0 - texCoords.y);\n    gl_FragColor = texture2D(inTex, flippedTexCoord);\n}\n",uniformNames:[],samplerNames:["inTex"]};class Pe extends se{constructor(e){super(e,Fe),(0,b.A)(this,"inTex",void 0),this.inTex=new ae(this.effectRenderer,this.effectWrapper,"inTex")}}class Le{constructor(e,t,r){(0,b.A)(this,"renderer",void 0),(0,b.A)(this,"target",void 0),(0,b.A)(this,"effectRenderer",void 0),this.effectRenderer=new oe.J(e),this.renderer=new Pe(this.effectRenderer),this.target=new ie.s(e,{width:t,height:r},{generateDepthBuffer:!1}),(0,ne.S)(this.target)}get renderTarget(){if(!this.target.renderTarget)throw new Error("Expected render target to be defined");return this.target.renderTarget}flip(e){this.renderer.inTex.set(e),this.renderer.renderTo(this.target)}destroy(){this.renderer.destroy(),this.target.dispose(),this.effectRenderer.dispose()}}class Ne{constructor(e,t,r,i,n,{supermixOptions:o}){(0,b.A)(this,"superfillRecorder",void 0),(0,b.A)(this,"project",void 0),(0,b.A)(this,"assetMap",{}),(0,b.A)(this,"clock",void 0),(0,b.A)(this,"durationTicks",(0,L.H)(0)),(0,b.A)(this,"engine",void 0),(0,b.A)(this,"rendererDevice",void 0),(0,b.A)(this,"mixerDevice",void 0),(0,b.A)(this,"_rgbToYuvConverter",void 0),(0,b.A)(this,"_YFlipper",void 0),this.renderCtx=e,this.resolution=r;const{width:s,height:a}=r;this.clock=new R.A4(i),this.engine=new T.w(e.gl.canvas,!1),this.engine.preventCacheWipeBetweenFrames=!0,this.engine.setSize(s,a);const c={manager:t,maxLookAheadSeconds:0};if(void 0!==o&&(c.audio={sampleRate:o.sampleRate??Se.kX,channelCount:o.channelCount??Se.cA,samplesPerChunk:o.bufferLength??Se.Ib}),this.superfillRecorder=new O(this.clock,ye(this.engine,this.clock,c,function(e){const t=(0,p.W)(C.e);return async r=>{const i=e(r);if(void 0===i)throw new W.g9((0,Ce.vU)("Unresolved asset"),{assetId:r});if("filter"===i.type&&void 0!==i.preset.lutSrc)return[i.preset.lutSrc,i];const n=i,o=await t.fetch(n),s=e(n.id)??i;return[o.permanentUrl,s]}}((e=>this.assetMap[e]))),{preload:this.clock.durationSecondsToTicks(0),gap:this.clock.durationSecondsToTicks(0),unload:this.clock.durationSecondsToTicks(.5)}),[this.rendererDevice]=this.superfillRecorder.attachDevice((0,U.a7)(this.engine,new E.X(this.engine,I),this.clock,{deprecated__canvaskitWasmUrl:k,deprecated__createExternalMapper:(0,_e.Y)(n,new Map)})),void 0!==o){const{mixerWorker:e}=(0,_.w)(),[t]=this.superfillRecorder.attachDevice(function(e,t,r){return(i,n,o)=>new Te(e,i,t,o,r)}(e,this.clock,o));this.mixerDevice=t}try{this._rgbToYuvConverter=new Ie(this.engine,s,a)}catch(e){console.warn(e)}}get rgbToYuvConverter(){return this._rgbToYuvConverter}get yFlipper(){return this._YFlipper||(this._YFlipper=new Le(this.engine,this.resolution.width,this.resolution.height)),this._YFlipper}getTick(){return this.clock.getTime()}nextTick(){this.clock.nextTick(),this.superfillRecorder.updateTime()}hasFinished(){return this.clock.getTime()>=this.durationTicks}readVideoFrame(){return(0,j.L)((e=>this.rendererDevice.pollRenderFrame(e)))}async updateProject(e){if(this.project&&e.assets===this.project.assets&&e.items===this.project.items&&e.tracks===this.project.tracks&&e.entities===this.project.entities)return;this.project=e;const t=(0,F.n)(e.assets,(0,P.eS)());this.assetMap=t,this.superfillRecorder.updateProject({aspectRatio:e.aspectRatio,tracks:e.tracks,items:e.items,assets:{byId:t},entities:e.entities}),this.durationTicks=this.clock.mediaSecondsToTicks(function(e){return e.tracks.allIds.reduce(((t,r)=>{const i=e.tracks.byId[r];if(void 0===i)return t;const n=i.itemIds.reduce(((t,r)=>{const i=e.items.byId[r];if(void 0===i)return t;const n=i.startTime+i.duration;return Math.max(t,n)}),0);return Math.max(t,n)}),0)}(e))}destroy(){this._YFlipper?.destroy(),this.rgbToYuvConverter?.destroy(),this.engine.dispose(),this.superfillRecorder.destroy()}}var Me=r(925440);class Be extends be.S{get bufferLength(){return this.supermixOptions.bufferLength??Se.Ib}get channelCount(){return this.supermixOptions.channelCount??Se.cA}constructor(e,t,r,i,n){super(r,i,{maxActiveStreams:n.maxActiveStreams},{updateStreamState:()=>{this.mixerStateChanged=!0},updateConnectionState:()=>{this.connectionStateChanged=!0}}),(0,b.A)(this,"pendingStreams",new Set),(0,b.A)(this,"supermixContextId",void 0),(0,b.A)(this,"mixerStateChanged",!1),(0,b.A)(this,"connectionStateChanged",!1),(0,b.A)(this,"isProcessing",!1),(0,b.A)(this,"inputBuffer",void 0),this.worker=e,this.streamReader=t,this.supermixOptions=n,this.inputBuffer=new Float32Array(this.bufferLength*this.channelCount*this.maxActiveStreams)}async getOutputBuffer(e){if(this.isProcessing)throw new Error("Cannot call getOutputBuffer while processing");this.isProcessing=!0,void 0===e&&(e=new Float32Array(this.bufferLength*this.channelCount));const t=(0,we._)(this.playbackState,this.clock),r=await Promise.all([...this.connections].map((([e,r])=>this.getInputEntry(e,r,t))));return e=await this.workerProcess(e,new Map(r),this.clock.ticksToSeconds(t)),this.isProcessing=!1,e}createActiveStream(e){return{activeStream:{streamId:e},connectionIndex:(0,xe.t)(this.connections,this.maxActiveStreams)}}removeActiveStream(e){}async getInputEntry(e,t,r){const i=await(0,j.L)((e=>this.streamReader.pollRead(e,t,r,{}))),n=this.bufferLength*this.channelCount,o=e*n,s=this.inputBuffer.subarray(o,o+n);s.set(i);const a=[];for(let e=0;e<n;e+=this.bufferLength)a.push(s.subarray(e,e+this.bufferLength));return[e,a]}async workerCreate(){const{supermixContextId:e}=await this.worker.call("supermix-create",this.supermixOptions,[],(()=>{}));return e}async workerProcess(e,t,r){void 0===this.supermixContextId&&(this.supermixContextId=await this.workerCreate());const i=await this.worker.call("supermix-process",{supermixContextId:this.supermixContextId,inputBuffer:this.inputBuffer,outputBuffer:e,inputs:t,timeSeconds:r,streams:this.mixerStateChanged?this.streams:void 0,connections:this.connectionStateChanged?this.connections:void 0},[this.inputBuffer.buffer,e.buffer],(()=>{}));return this.inputBuffer=i.inputBuffer,this.mixerStateChanged=!1,this.connectionStateChanged=!1,i.outputBuffer}workerDestroy(){this.supermixContextId&&this.worker.call("supermix-destroy",{supermixContextId:this.supermixContextId},[],(()=>{})).catch((e=>{console.error("Failed to destroy Supermix context:",e)}))}destroy(){super.destroy(),this.workerDestroy()}}var De=r(751203),Oe=r(299848);class je{constructor(e,t,{width:r,height:i},n,{supermixOptions:o}){(0,b.A)(this,"superfillRecorder",void 0),(0,b.A)(this,"target",void 0),(0,b.A)(this,"project",void 0),(0,b.A)(this,"assetMap",{}),(0,b.A)(this,"clock",void 0),(0,b.A)(this,"compatDevice",void 0),(0,b.A)(this,"mixerDevice",void 0),this.root=e,this.clock=new R.A4(n);const s={manager:t,maxLookAheadSeconds:0};void 0!==o&&(s.audio={sampleRate:o.sampleRate??Se.kX,channelCount:o.channelCount??Se.cA,samplesPerChunk:o.bufferLength??Se.Ib}),this.superfillRecorder=new O(this.clock,(0,Me.$)(e,this.clock,s,(e=>this.assetMap[e])),{preload:this.clock.durationSecondsToTicks(0),gap:this.clock.durationSecondsToTicks(0),unload:this.clock.durationSecondsToTicks(.5)});const[a]=this.superfillRecorder.attachDevice((0,Oe.z)(this.clock,{enableMixer:!1}));if(this.compatDevice=a,void 0!==o){const{mixerWorker:e}=(0,_.w)(),[t]=this.superfillRecorder.attachDevice(function(e,t,r){return(i,n,o)=>new Be(e,i,t,o,r)}(e,this.clock,o));this.mixerDevice=t}this.target=e.defaultTarget,this.target.width=r,this.target.height=i}nextTick(){this.clock.nextTick(),this.superfillRecorder.updateTime()}async updateProject(e){if(this.project&&e.assets===this.project.assets&&e.items===this.project.items&&e.tracks===this.project.tracks&&e.entities===this.project.entities)return;this.project=e;const t=(0,F.n)(e.assets,(0,P.eS)());this.assetMap=t,this.root.db.set(De.Iz,{entities:e.entities}),this.superfillRecorder.updateProject({aspectRatio:e.aspectRatio,tracks:e.tracks,items:e.items,assets:{byId:t},entities:{}})}destroy(){this.superfillRecorder.destroy()}}var Ue=r(855507);const ze=l.xc.presets.createExport.formats.mp4.global.samplingFrequency,We=l.xc.presets.createExport.formats.mp4.global.samplingFormat;function Ve(e){const t=e.streams.filter((e=>"audio"===e.codec_type));if(1===t.length){const e=t[0];if(("stereo"===e.channel_layout||2===Number.parseInt(e.channels))&&Number.parseInt(e.sample_rate)===ze&&e.sample_fmt===We)return!1}return!0}var He=r(74987),Ge=r(847269);var qe=r(432300),Qe=r(463716),Ke=r(507243),Xe=r(439921),Ye=r(256070),Ze=r(943134),Je=r(942552),$e=r(782668),et=r(835592),tt=r(770202);function rt(e,t,r=.001){return t-e>=r}function it(e,t,r=.001){return e-t>=r}function nt(e,t,r=.01){return(0,tt.h)(e,t,r)}const ot=Math.PI/2;function st(e,t){const r=e/("radians"===t?ot:90);return nt(r,Math.round(r))?Math.round(r)%2==0?"original":"right-angle":"not-right-angle"}function at(e,t){if(e.filters?.some((e=>e.filter.hasTransparency)))return!1;switch(e.transform?.strategy){case"fill":return!0;case"fit":const r=function(e){const t=(r=e,st(r.transform?.rotation??0,"radians"));var r;if("not-right-angle"!==t){const r=function(e){const t=(0,l.yL)(e.asset.metadata.raw);return t?st(Number.parseFloat((t.tags||{}).rotate)||0,"degrees"):"not-right-angle"}(e);if("not-right-angle"!==r)return"right-angle"===t?"right-angle"===r?"original":"right-angle":"right-angle"===r?"right-angle":"original"}return"not-right-angle"}(e);if("not-right-angle"!==r){const i=function(e,t){const r=(0,l.$g)(e.asset.metadata.raw);if(r){const e={width:t?r.height:r.width,height:t?r.width:r.height};return e.width/e.height}return console.warn("Visual track item has no video track",e),Number.NaN}(e,"right-angle"===r),n=function(e){return e.baseWidth/e.baseHeight}(t);return nt(i,n)}return!1;default:return!1}}var ct=r(922557);function lt(e,t,r){const i=function(e){if((0,ct.n)(e)&&function(e){return function(e){return"number"!=typeof e.alpha||1===e.alpha}(e)&&!(0,Q.il)(e.asset.metadata.raw)}(e))return function(e,t,r){const i=Math.max(t.fadeInSeconds,r.transitionInSeconds),n=Math.max(t.fadeOutSeconds,r.transitionOutSeconds);return{...e,transitionIn:void 0,transitionOut:void 0,fadeInOut:{fadeInSeconds:0,fadeOutSeconds:0},startTime:e.startTime+i,duration:e.duration-(i+n),trim:{from:e.trim.from+i,to:e.trim.to}}}(e,e.fadeInOut||{fadeInSeconds:0,fadeOutSeconds:0},{transitionInSeconds:e.transitionIn?e.transitionIn.durationInS:0,transitionOutSeconds:e.transitionOut?e.transitionOut.durationInS:0})}(t);if(i&&at(i,r)){const t={startSeconds:i.startTime,endSeconds:i.startTime+i.duration},r={startSeconds:e.globalOffsetInSeconds,endSeconds:e.globalOffsetInSeconds+e.durationInSeconds},n=function(e,t){if(rt(e.startSeconds,t.endSeconds)&&it(e.endSeconds,t.startSeconds))return it(e.startSeconds,t.startSeconds)?rt(e.endSeconds,t.endSeconds)?"center-overlap":"end-overlap":rt(e.endSeconds,t.endSeconds)?"start-overlap":"full-overlap"}(t,r);if(void 0!==n)return function(e,t,r,i){const n=t.endSeconds-r.startSeconds,o=r.endSeconds-t.startSeconds;switch(e){case"full-overlap":return[];case"start-overlap":return[{...i,globalOffsetInSeconds:t.endSeconds,startTimeInSeconds:i.startTimeInSeconds+n,durationInSeconds:i.durationInSeconds-n}];case"end-overlap":return[{...i,durationInSeconds:i.durationInSeconds-o}];case"center-overlap":return[{...i,durationInSeconds:i.durationInSeconds-o},{...i,globalOffsetInSeconds:i.globalOffsetInSeconds+n,startTimeInSeconds:i.startTimeInSeconds+n,durationInSeconds:i.durationInSeconds-n}];default:throw new Error(`Unreachable, overlap type is ${e}`)}}(n,t,r,e)}}function dt(e,t,r){const i=t.pop();if(i){const n=lt(e,i,r);return void 0===n?dt(e,t,r):function(e,t,r){return 0===e.length?[]:1===e.length?dt(e[0],t,r):[...dt(e[0],[...t],r),...dt(e[1],t,r)]}(n,t,r)}return[e]}function ut(e,t,r){const i=function(e,t){for(let r=0,i=t.length;r<i;++r){const i=t[r].items;for(let t=0,n=i.length;t<n;++t)if(i[t].id===e.trackItemId)return r}console.warn(`Cannot find track of track item ${e.trackItemId} on timeline`,t)}(e,t),n=[];if(void 0!==(o=i)&&!Number.isNaN(o)&&o>=0&&Math.floor(o)===o)for(let e=0;e<i;++e)n.push(...t[e].items);else console.warn("Cannot locate background track item on given tracks",e,t);var o;return dt(e,n,r)}function ht(e,t){return function(e,t){return e.map((r=>({...r,items:r.items.map((r=>function(e,t,r){return 1!==e.speed?[e]:ut({trackItemId:e.id,globalOffsetInSeconds:e.startTime,durationInSeconds:e.duration,startTimeInSeconds:e.trim?.from||0,originalObject:e},t,r).map((e=>({...e.originalObject,startTime:e.globalOffsetInSeconds,duration:e.durationInSeconds,trim:{from:e.startTimeInSeconds,to:e.originalObject.trim?.to||e.startTimeInSeconds+e.durationInSeconds}})))}(r,e,t))).reduce(((e,t)=>[...e,...t]),[])})))}(e.map((e=>({...e,items:e.items.filter((e=>{return!("audio"===(t=e.asset).type||"video"===t.type&&void 0===(0,l.$g)(t.metadata.raw)&&void 0!==(0,Q.xF)(t.metadata.raw));var t}))}))).filter((e=>e.items.length>0)),t)}async function pt(e,t,r,i){if(e.useHardwareFrames)return function(e,t){return new VideoFrame(e.root.gl.canvas,{timestamp:Math.round(t*qe.c6/e.exportPreset.fps),duration:Math.round(qe.c6/e.exportPreset.fps),displayWidth:e.exportResolution.width,displayHeight:e.exportResolution.height,alpha:"discard"})}(e,t);if(void 0===e.rgbToYuvConverter)return await async function(e,t,r){const i=(0,Xe.L)(t,y.Ou);void 0===r?r=new Uint8Array(i):r.byteLength<i&&(console.warn(`Encoder queue has provided recycled ${r.byteLength}-byte buffer, however ${i} bytes are required.`),r=new Uint8Array(i));const n=r,o=e.root.cloneImage(t);try{const r=e.root.ctx.renderers.get(Ye.l);r.matrix.setMatrix3(Qe.d.scale(1,-1)),(0,Ze.C)(r,o,t),await o.value.downloadBuffer(n,y.Ou)}finally{o.free()}return n}(e,r,i);{let t;return e.rgbToYuvConverter.isCurrentlyConverting&&(t=e.rgbToYuvConverter.endAsyncConvert(i)),e.rgbToYuvConverter.beginAsyncConvert(r),t}}function mt(e){return(0,g._y)(async function(e){const t=e.graphContext.resourceManager,r=e.startTimeSeconds??0;let i=e.durationSeconds??(0,f.CF)(e.tracks);if(e.superfillContext){const{clock:t}=e.superfillContext;i=t.ticksToSeconds(t.mediaSecondsToTicks(i))}const{width:n,height:o}=e.exportResolution,s=new Je.O(e.root,n,o);s.bind();const a=await async function(e){const t=new $e.M(e.root,e.graphContext,{updatesLoadState:!1});if(e.superfillContext){const t=(0,Ke.DT)();(0,Ge.iY)(t,"Project missing, no export"),await e.superfillContext.updateProject(t)}const r=ht(e.tracks,t);return await et.R.updateTracks(t,r),t}(e);e.graphContext.resourceManager.at(r);const c=a.getExportStream(e.exportPreset.fps,r,i);let l=await c.next;const d=function(e,t,r){let i=!0,n=0;return(0,g.tk)((async o=>{for(;i;){await t.root.ctx.contextPromise();const i=e.startTimeSeconds??0,s=t.root.render(r,t,i+n/e.exportPreset.fps,!1,"managed");++n,await o(s.value)}}),(()=>i=!1))}(e,a,s);e.compositorTimer?.start();let u,h=await d.next,p=!0,m=0;return(0,g.tk)((async i=>{for(;p&&!l.finished&&!h.finished;){const n=await pt(e,m,h,u);if(e.compositorTimer?.stop(),void 0!==n){const{video:e}=await i({video:n});u=e}m+=1,e.superfillContext&&e.superfillContext.nextTick(),t.at(r+m/e.exportPreset.fps),l=await l.continue(),e.compositorTimer?.start(),l.finished||(h=await h.continue())}let n;p&&void 0!==e.rgbToYuvConverter&&e.rgbToYuvConverter.isCurrentlyConverting&&(n=e.rgbToYuvConverter.endAsyncConvert(u)),e.compositorTimer?.stop(),void 0!==n&&await i({video:n})}),(()=>{c.cleanup(),d.cleanup(),e.rgbToYuvConverter?.free(),t.cleanup(),p=!1}))}(e))}async function ft(e,t,r){const i=(0,Ge.sw)(e.superfillBabylonContext,"Expected superfill babylon context to be defined"),{rgbToYuvConverter:n}=i;if(e.useHardwareFrames)return function(e,t){return new VideoFrame(t.renderCtx.gl.canvas,{timestamp:Math.round(t.getTick()*qe.c6/e.exportPreset.fps),duration:Math.round(qe.c6/e.exportPreset.fps),displayWidth:e.exportResolution.width,displayHeight:e.exportResolution.height,alpha:"discard"})}(e,i);if(void 0===n)return await async function(e,t,r){const i=(0,Ge.sw)(e.superfillBabylonContext,"Expected superfill babylon context to be defined"),{engine:n,yFlipper:o}=i,{width:s,height:a}=e.exportResolution,c=s*a*(0,y.j7)(y.Ou);void 0===r?r=new Uint8Array(c):r.byteLength<c&&(console.warn(`Encoder queue has provided recycled ${r.byteLength}-byte buffer, however ${c} bytes are required.`),r=new Uint8Array(c));const l=r,d=n._currentRenderTarget;return o.flip(t),n.bindFramebuffer(o.renderTarget),n._gl.readPixels(0,0,s,a,y.Ou.channels,y.Ou.type,r),d&&n.bindFramebuffer(d),l}(e,t,r);{let e;return n.isCurrentlyConverting&&(e=n.endAsyncConvert(r)),n.beginAsyncConvert(t),e}}function gt(e){return(0,g._y)(async function(e){const t=(0,Ge.sw)(e.superfillBabylonContext,"Expected superfill babylon context to be defined"),r=(0,Ge.sw)((0,Ke.DT)(),"Project missing, no export");await t.updateProject(r);const i=function(e){const t=(0,Ge.sw)(e.superfillBabylonContext,"Expected superfill babylon context to be defined");let r,i=!0;return(0,g.tk)((async n=>{for(;i;){await t.renderCtx.contextPromise();const i=await t.readVideoFrame(),o=await ft(e,i,r);r=await n(o)}}),(()=>i=!1))}(e),n=function(e){const t=(0,Ge.sw)(e.superfillBabylonContext,"Expected superfill babylon context to be defined"),r=(0,Ge.sw)(t.mixerDevice,"Expected mixer device to be defined");let i,n=!0;return(0,g.tk)((async e=>{for(;n;){const t=await r.getOutputBuffer(i);i=await e(t)}}),(()=>n=!1))}(e);let[o,s]=await Promise.all([i.next,n.next]),a=!0,c={};const l=[];return(0,g.tk)((async r=>{for(;a&&!o.finished&&!s.finished&&!t.hasFinished()&&(void 0!==s&&l.push(s.value),void 0!==o.value&&(c=await r({video:o.value,audio:l.shift()})),t.nextTick(),!t.hasFinished());)[o,s]=await Promise.all([o.continue(c.video),s.continue(c.audio)]);let i;a&&void 0!==t.rgbToYuvConverter&&t.rgbToYuvConverter.isCurrentlyConverting&&(i=t.rgbToYuvConverter.endAsyncConvert(c.video)),e.compositorTimer?.stop(),void 0!==i&&await r({video:i,audio:l.shift()})}),(()=>{i.cleanup(),n.cleanup(),a=!1}))}(e))}var At=r(633110);async function vt(e,t,r,i){if(e.useHardwareFrames)return function(e,t){return new VideoFrame(e.root.gl.canvas,{timestamp:Math.round(t*qe.c6/e.exportPreset.fps),duration:Math.round(qe.c6/e.exportPreset.fps),displayWidth:e.exportResolution.width,displayHeight:e.exportResolution.height,alpha:"discard"})}(e,t);if(void 0===e.rgbToYuvConverter)return await async function(e,t,r){const i=(0,Xe.L)(t,y.Ou);void 0===r?r=new Uint8Array(i):r.byteLength<i&&(console.warn(`Encoder queue has provided recycled ${r.byteLength}-byte buffer, however ${i} bytes are required.`),r=new Uint8Array(i));const n=r,o=e.root.cloneImage(t);try{const r=e.root.ctx.renderers.get(Ye.l);r.matrix.setMatrix3(Qe.d.scale(1,-1)),(0,Ze.C)(r,o,t),await o.value.downloadBuffer(n,y.Ou)}finally{o.free()}return n}(e,r,i);{let t;return e.rgbToYuvConverter.isCurrentlyConverting&&(t=e.rgbToYuvConverter.endAsyncConvert(i)),e.rgbToYuvConverter.beginAsyncConvert(r),t}}function yt(e){return(0,g._y)(async function(e){const t=e.graphContext.resourceManager,r=e.startTimeSeconds??0,{width:i,height:n}=e.exportResolution,o=new Je.O(e.root,i,n);o.bind();const s=await async function(e){const t=new $e.M(e.root,e.graphContext,{updatesLoadState:!1});if(e.superfillContext){const t=(0,Ke.DT)();(0,Ge.iY)(t,"Project missing, no export"),await e.superfillContext.updateProject(t)}const r=ht(e.tracks,t);return await et.R.updateTracks(t,r),t}(e);e.graphContext.resourceManager.at(r);const a=await async function(e,t,r){const i=e.startTimeSeconds??0;let n=e.durationSeconds??(0,f.CF)(e.tracks);if(e.superfillContext){const{clock:t}=e.superfillContext;n=t.ticksToSeconds(t.mediaSecondsToTicks(n))}const o=t.getExportStream(e.exportPreset.fps,i,n);let s,a=await o.next,c=!0,l=0;return(0,g.tk)((async n=>{for(;c&&!a.finished;){await t.root.ctx.contextPromise();const o=t.root.render(r,t,i+l/e.exportPreset.fps,!1,"managed"),c=await vt(e,l,o,s);s=await n(c),++l,a=await a.continue()}}),(()=>c=!1))}(e,s,o),c=function(e){const t=e.superfillContext?.mixerDevice;if(void 0===t)return;let r,i=!0;return(0,g.tk)((async e=>{for(;i;){const i=await t.getOutputBuffer(r);r=await e(i)}}),(()=>i=!1))}(e);let[l,d]=await(0,At.F_)("begin-compositing",[a.next,c?.next]),u=!0,h=0,p={};const m=[];return(0,g.tk)((async i=>{for(;u&&!l.finished&&(void 0===d||!d.finished);)void 0!==d&&m.push(d.value),void 0!==l.value&&(p=await i({video:l.value,audio:m.shift()})),h+=1,e.superfillContext&&e.superfillContext.nextTick(),t.at(r+h/e.exportPreset.fps),[l,d]=await(0,At.F_)("compositing",[l.continue(p.video),d?.continue(p.audio)]);let n;u&&void 0!==e.rgbToYuvConverter&&e.rgbToYuvConverter.isCurrentlyConverting&&(n=e.rgbToYuvConverter.endAsyncConvert(p.video)),e.compositorTimer?.stop(),void 0!==n&&await i({video:n,audio:m.shift()})}),(()=>{a.cleanup(),c?.cleanup(),e.rgbToYuvConverter?.free(),t.cleanup(),u=!1}))}(e))}class bt extends Error{constructor(e,t){super(t||"Export cancelled by user"),this.reason=e}}class wt{getGraphContext(e,t,r){return this.graphContextFactory.createGraphContext({useManagedMediaNodes:!0},this.globalCtx.globalRoot,t,(()=>(0,v.Q)({tracks:e},this.assetCache.assetAudioCache)),void 0,(()=>{}),r)}createRgbToYuvConverter(e){const t=function(e,t,r){if(e.ctx.isContextLost())return void console.warn("RGB to YUV converter is not supported on this device: WebGL context is currently lost");const i=Math.ceil(t/2),n=Math.ceil(r/2),o=t*r,s=i*n,a=o+s,c=a+s;if(void 0===e.ctx.gl2)return void console.warn("RGB to YUV converter is not supported on this device: WebGL2 is not available");const l=e.allocImage(!1,t,r,y.Tx),d=e.allocImage(!1,i,n,y.Tx),u=e.allocImage(!1,i,n,y.Tx),h=e.ctx.gl.createBuffer();e.ctx.gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,h),e.ctx.gl.bufferData(WebGL2RenderingContext.PIXEL_PACK_BUFFER,c,WebGL2RenderingContext.STREAM_READ),e.ctx.gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,null);const p=()=>{l.free(),d.free(),u.free(),e.ctx.gl.deleteBuffer(h)};l.value.bindFb();const m={channels:e.ctx.gl2.getParameter(WebGL2RenderingContext.IMPLEMENTATION_COLOR_READ_FORMAT),type:WebGL2RenderingContext.UNSIGNED_BYTE};if(1!==(0,y.j7)(m))return p(),void console.warn("RGB to YUV converter is not supported on this device: single-channel download not available");let f=!1;return{get isCurrentlyConverting(){return f},free:p,beginAsyncConvert(t){f=!0,(t=>{const r=e.ctx.renderers.get(S);r.colorSampler.set(t.value.bindSampler(0)),r.bufferChannel.setInteger(0),r.renderTo(l),r.bufferChannel.setInteger(1),r.renderTo(d),r.bufferChannel.setInteger(2),r.renderTo(u)})(t),e.ctx.gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,h),l.value.downloadWebGL2Buffer(0,m),d.value.downloadWebGL2Buffer(o,m),u.value.downloadWebGL2Buffer(a,m),e.ctx.gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,null)},endAsyncConvert:t=>(t=(e=>void 0===e||e.byteLength<c?(console.warn(`RGB-to-YUV converter received recycled ${e?.byteLength??0}-byte buffer, however ${c} bytes are required.`),new Uint8Array(c)):e)(t),e.ctx.gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,h),e.ctx.gl2?.getBufferSubData(WebGL2RenderingContext.PIXEL_PACK_BUFFER,0,t),e.ctx.gl.bindBuffer(WebGL2RenderingContext.PIXEL_PACK_BUFFER,null),f=!1,t)}}(this.globalCtx.globalRoot,e.width,e.height);return c.z.setUserProperties({supportsYuvCompositorOutput:void 0!==t}),t}static weighProgress(e,t){return.7*e+.3*t}constructor(e,t,r,i){this.globalCtx=e,this.graphContextFactory=t,this.videoExporter=r,this.assetCache=i}buildAudioGraphFromTracksHelper(e){return function(e,t){return e.map((e=>e.items.filter(He.j).filter((e=>{return 0!==e.volume&&!!(t=e.asset).metadata&&t.metadata.raw.streams.some((e=>"audio"===e.codec_type));var t})))).reduce(((e,t)=>e.concat(t)),[]).map((e=>{const r=function(e){const t={fadeInSeconds:0,fadeOutSeconds:0,...e.fadeInOut};return e.transitionIn&&(t.fadeInSeconds=Math.max(t.fadeInSeconds,e.transitionIn.durationInS)),e.transitionOut&&(t.fadeOutSeconds=Math.max(t.fadeOutSeconds,e.transitionOut.durationInS)),t}(e),i=(0,Ge.sw)(e.asset.metadata,"Expected trackItem metadata to be defined when building graph").raw;return{inputFile:{permanentUrl:t(e.asset.id),fileName:e.asset.name},needsResampling:Ve(i),audioVolume:void 0===e.volume?1:e.volume,durationInSeconds:e.duration*e.speed,globalOffsetInSeconds:e.startTime,localOffsetInSeconds:e.trim.from,fadeInDurationInSeconds:r.fadeInSeconds,fadeOutDurationInSeconds:r.fadeOutSeconds,rate:e.speed}}))}(e,(0,p.W)(u.OZ))}recordTimeline(e,t,r,c,u,p,v){const y=new i.B,b=new A.U,w=(0,h.G7)("ren__export_sources"),x=w&&(0,h.G7)("ren__supermix_export")&&(0,l.no)({preset:t.transcodingPreset,format:t.transcodingFormat}),S=w&&(0,h.G7)("ren__babylon_export");let T,C,_,k=!1;const E=x?(0,Ue.d)(t):void 0;if(w){if("export:peppermint"!==c.type)throw new Error("Invalid graph context profile");S?(_=this.getGraphContext(e,c,void 0),C=new Ne(this.globalCtx.exportRenderCtx,c.manager,r,t.fps,_,{supermixOptions:E}),void 0!==C.rgbToYuvConverter&&(k=!0)):T=new je(this.globalCtx.globalRoot,c.manager,r,t.fps,{supermixOptions:E})}let I;_||(_=this.getGraphContext(e,c,T?.compatDevice)),S||(I=this.createRgbToYuvConverter(r),void 0!==I&&(k=!0));const R=(S?gt:x?yt:mt)({root:this.globalCtx.globalRoot,tracks:e,exportPreset:t,exportResolution:r,assetLoadSubject:y,graphContext:_,rgbToYuvConverter:I,compositorTimer:b,useHardwareFrames:p,superfillContext:T,superfillBabylonContext:C}),F=new i.B,P=(0,f.CF)(e),L=t.fps*P,N=(0,g.BJ)(R,((e,t)=>(F.next((t+1)/L*100),Promise.resolve(e))),(()=>{F.next(100),F.complete()})),M=new i.B,B=this.buildAudioGraphFromTracksHelper(e),D=new Set;k&&D.add("yuv420p-input"),x&&D.add("supermix");const O=this.videoExporter.exportVideo(N,B,t,L,r,D,u,p,v);O.progress.subscribe(M);const j=new A.U;return O.state.subscribe((e=>{"end"===e||e.endsWith("fetching")?j.stop():j.start()})),{assetLoadStream:y,durationSeconds:P,progress:(0,n.z)([F.pipe((0,o.Z)(0)),M.pipe((0,o.Z)(0))]).pipe((0,s.T)((([e,t])=>wt.weighProgress(e,t))),(0,a.t)(1)),encoderState:O.state,encoderRunStatistics:O.transcodedBlob.then((e=>e.transcoderRunStatistics)).catch((()=>{})),recordedVideoBlob:O.transcodedBlob.then((e=>e.exportedVideoBlob)).catch((e=>{if(e instanceof d.c)throw new bt("Transcode Error");throw e})),compositorTimer:b,encoderTimer:j,cancel:()=>{N.cleanup(),O.cancelExport().catch((e=>{m.Vy.log("Failed to cancel export"),m.Vy.error(e)}))},destroy:()=>{T?.destroy(),C?.destroy()}}}}},175358:(e,t,r)=>{r.d(t,{bS:()=>s,mj:()=>o,x6:()=>a});var i=r(247498),n=r(277277);const o=(e,t)=>e,s=e=>e;function a({children:e,...t}){const{t:r}=(0,i.Bd)();return(0,n.jsx)(i.x6,{t:r,...t,children:e})}},553191:(e,t,r)=>{r.d(t,{Fh:()=>p,Hf:()=>u,MI:()=>d,OM:()=>l,Up:()=>o,e7:()=>s,mJ:()=>h,ui:()=>c,xN:()=>n});var i=r(776016);const n="en-US",o=[n,"af-ZA","az-Latn-AZ","ms-MY","bs-Latn-BA","ca-ES","cs-CZ","cy-GB","da-DK","de-DE","et-EE","en-GB","es-ES","es-MX","eu-ES","fil-PH","fr-CA","fr-FR","ga-IE","gl-ES","hr-HR","id-ID","is-IS","it-IT","lv-LV","lb-LU","lt-LT","hu-HU","mt-MT","nl-NL","nb-NO","nn-NO","uz-Latn-UZ","pl-PL","pt-BR","pt-PT","quz-PE","ro-RO","sq-AL","sk-SK","sl-SI","sr-Latn-RS","fi-FI","sv-SE","mi-NZ","vi-VN","tr-TR","ca-Es-VALENCIA","el-GR","bg-BG","kk-KZ","mk-MK","ru-RU","sr-Cyrl-BA","tt-RU","uk-UA","ka-GE","hy-AM","he-IL","ar-SA","fa-IR","am-ET","kok-IN","ne-NP","mr-IN","hi-IN","as-IN","bn-IN","pa-IN","gu-IN","or-IN","ta-IN","te-IN","kn-IN","ml-IN","th-TH","lo-LA","km-KH","ko-KR","zh-CN","ja-JP","zh-TW"],s=(0,i.u)(...o),a=[n,"en-GB"],c={"en-US":"English (US)","az-Latn-AZ":"Azərbaycan (Azərbaycan)","af-ZA":"Afrikaans (Suid-Afrika)","bs-Latn-BA":"Bosanski (Bosna i Hercegovina)","ca-ES":"Català (català)","ca-Es-VALENCIA":"Valencià (Espanya)","cs-CZ":"Čeština (Česko)","cy-GB":"Cymraeg (Y Deyrnas Unedig)","id-ID":"Indonesia (Indonesia)","ms-MY":"Melayu (Malaysia)","da-DK":"Dansk (Danmark)","de-DE":"Deutsch (Deutschland)","et-EE":"Eesti (Eesti)","en-GB":"English (United Kingdom)","es-MX":"Español (México)","es-ES":"Español (España, alfabetización internacional)","eu-ES":"Euskara (Euskara)","fr-FR":"Français (France)","fr-CA":"Français (Canada)","fil-PH":"Filipino (Pilipinas)","ga-IE":"Gaeilge (Éire)","gl-ES":"Galego (Galego)","hr-HR":"Hrvatski (Hrvatska)","is-IS":"Íslenska (ísland)","it-IT":"Italiano (Italia)","lv-LV":"Latviešu (Latvija)","lb-LU":"Lëtzebuergesch (Lëtzebuerg)","lt-LT":"Lietuvių (Lietuva)","mt-MT":"Malti (Malta)","hu-HU":"Magyar (Magyarország)","nl-NL":"Nederlands (Nederland)","nb-NO":"Norsk (Norge)","nn-NO":"Nynorsk (Noreg)","uz-Latn-UZ":"o'zbek (O'zbekiston)","pl-PL":"Polski (Polska)","pt-BR":"Português (Brasil)","pt-PT":"Português (Portugal)","quz-PE":"Quechua (Perú)","ro-RO":"Română (România)","sq-AL":"Shqip (Shqipëri)","sk-SK":"Slovenčina (Slovensko)","sl-SI":"Slovenščina (Slovenija)","fi-FI":"Suomi (Suomi)","sr-Latn-RS":"Srpski (Rep. Srbija i Rep. Crna Gora)","sv-SE":"Svenska (Sverige)","tt-RU":"Tatarça (Rusiya)","mi-NZ":"Te Reo Māori (Aotearoa)","vi-VN":"Tiếng Việt (Việt Nam)","tr-TR":"Türkçe (Türkiye)","mk-MK":"македонски (Република Македонија)","bg-BG":"Български (България)","hy-AM":"Հայերեն (Հայաստան)","el-GR":"Ελληνικά (Ελλάδα)","ru-RU":"Русский (Россия)","uk-UA":"Українська (Україна)","kk-KZ":"Қазақ тілі (Қазақстан)","sr-Cyrl-BA":"српски (Босна и Херцеговина)","fa-IR":"فارسی (ایران)","he-IL":"עברית (ישראל)","ar-SA":"عربي (المنطقة العربية)","ne-NP":"नेपाली (नेपाल)","bn-IN":"বাংলা (ভারত)","as-IN":"অসমীয়া (ভাৰত)","pa-IN":"ਪੰਜਾਬੀ (ਭਾਰਤ)","kok-IN":"कोंकणी (भारत)","hi-IN":"हिन्दी (भारत)","kn-IN":"ಕನ್ನಡ (ಭಾರತ)","gu-IN":"ગુજરાતી (ભારત)","mr-IN":"मराठी (भारत)","ta-IN":"தமிழ் (இந்தியா)","te-IN":"తెలుగు (భారతదేశం)","ml-IN":"മലയാളം (ഇന്ത്യ)","or-IN":"ଓଡ଼ିଆ (ଭାରତ)","am-ET":"አማርኛ (ኢትዮጵያ)","th-TH":"ไทย (ไทย)","lo-LA":"ລາວ (ລາວ)","zh-CN":"中文(中国)","zh-TW":"中文(台灣)","ja-JP":"日本語 (日本)","ko-KR":"한국어(대한민국)","ka-GE":"ქართული (საქართველო)","km-KH":"ភាសាខ្មែរ (កម្ពុជា)"},l=["zz-ZZ","zz-ZZZZ","zz-RTL"],d=(0,i.u)(...l),u=e=>s(e)||d(e);function h(e){return a.includes(e)}function p(...e){return 0===e.length?o:o.filter((t=>!e.includes(t)))}},620397:(e,t,r)=>{r.d(t,{H:()=>a,o:()=>s});var i=r(26985),n=r(247498),o=r(422226);const s=()=>{const{i18n:e}=(0,n.Bd)(),t=(0,o.Z)((t=>{t!==e.resolvedLanguage&&e.changeLanguage(t).catch((e=>{console.error("||| Error changing language",e)}))}));return[e.resolvedLanguage,t]},a=()=>{const{i18n:e}=(0,n.Bd)(),t=e.dir(),[r,o]=(0,i.useState)(t);return(0,i.useEffect)((()=>{"zz-RTL"===e.resolvedLanguage?o("rtl"):t!==r&&o(t)}),[e.resolvedLanguage,t,r]),r}},533921:(e,t,r)=>{r.d(t,{Tv:()=>n,V8:()=>d,W6:()=>a,Xo:()=>c,Z0:()=>l,_8:()=>s,z1:()=>o});var i=r(969442);const n=(e,t)=>{const r={...e};for(const e in r){const i=r[e];r[e]="string"==typeof i?t(i):n(i,t)}return r},o=(e,t)=>n(e,(e=>e.length>=40?e.split(/\s+/).map(t).join(" "):t(e))),s=e=>e.split(/(<\d>)|(<\/\d>)/).filter((e=>!!e)).map((e=>/<?\d>/.test(e)?e:new Array(e.length).fill("█").join(""))).join(""),a=e=>e.split(/(<\d>)|(<\/\d>)/).filter((e=>!!e)).map((e=>/<?\d>/.test(e)?e:new Array(Math.ceil(e.length/2)).fill("█").join(""))).join(""),c=()=>i.Ay.language;function l(){return i.Ay.resolvedLanguage}function d(){return"rtl"===i.Ay.dir()}},116980:(e,t,r)=>{r.d(t,{q:()=>s});var i=r(56352);const n={...i.$w};for(const e in n){const t=e.toLowerCase(),r=!(t.includes("hover")||t.includes("pressed")||t.includes("selected"));t.includes("alpha")?n[e]="#FF00FF":t.includes("background")?t.includes("1")?n[e]=r?"#0062FF":"#00E5FF":t.includes("2")?n[e]=r?"#0000FF":"#00C8DF":t.includes("3")?n[e]=r?"#0000CC":"#00ABBF":t.includes("4")?n[e]=r?"#000099":"#0095A6":n[e]=r?"#000080":"#007785":t.includes("foreground")||t.includes("stroke")||t.includes("border")?n[e]=r?"#FF0000":"#FF7300":t.includes("color")&&(n[e]="#00FF00")}const o=n,s=[{id:"clipchamp-light",label:"Clipchamp Light",theme:i.vg},{id:"clipchamp-dark",label:"Clipchamp Dark",theme:i.$w},{id:"clipchamp-debug",label:"Clipchamp Debug",theme:o}]},380467:(e,t,r)=>{r.d(t,{$:()=>p});var i=r(73268),n=r(223567),o=r(44376),s=r(382518),a=r(427179),c=r(26985),l=r(56352);const d=(0,i.n)({acrylic:{backdropFilter:"blur(10px)",backgroundColor:l.It.colorNeutralAlphaInverted70,color:l.It.colorNeutralForeground1,...n.Pt.borderColor("transparent"),":hover":{backgroundColor:l.It.colorNeutralAlphaInverted90,color:l.It.colorNeutralForeground1,...n.Pt.borderColor("transparent")},":hover:active":{backgroundColor:l.It.colorNeutralAlphaInverted60,color:l.It.colorNeutralForeground1,...n.Pt.borderColor("transparent")}},acrylicDisabled:{backdropFilter:"blur(10px)",backgroundColor:l.It.colorNeutralAlphaInverted40,color:l.It.colorNeutralAlpha50,...n.Pt.borderColor("transparent"),":hover":{backgroundColor:l.It.colorNeutralAlphaInverted40,color:l.It.colorNeutralAlpha50,...n.Pt.borderColor("transparent")},":hover:active":{backgroundColor:l.It.colorNeutralAlphaInverted40,color:l.It.colorNeutralAlpha50,...n.Pt.borderColor("transparent")}}});var u=r(277277);const h=(0,i.n)({base:{transitionProperty:"all",transitionDuration:l.It.durationFaster,transitionTimingFunction:"ease-in-out"},outline:{...n.Pt.borderColor(l.It.colorNeutralStroke1),":disabled, &:disabled:hover, &:disabled:hover:active":{backgroundColor:"transparent",...n.Pt.borderColor(l.It.colorNeutralStrokeDisabled)}},transparent:{color:l.It.colorNeutralForeground2,":disabled, &:disabled:hover, &:disabled:hover:active":{backgroundColor:"transparent",...n.Pt.borderColor("transparent")}},secondary:{backgroundColor:l.It.colorNeutralAlpha5,...n.Pt.borderColor("transparent"),":hover":{backgroundColor:l.It.colorNeutralAlpha10,...n.Pt.borderColor("transparent")},":hover:active":{backgroundColor:l.It.colorNeutralAlpha20,...n.Pt.borderColor("transparent")}},primary:{"@media (forced-colors: active)":{"&[data-fui-focus-visible]":{boxShadow:"0px 0px 0px 2px ButtonBorder"}}},subtle:{":hover":{[`& .${o.h.icon}`]:{color:"inherit"}},":hover:active":{[`& .${o.h.icon}`]:{color:"inherit"}},":disabled, &:disabled:hover, &:disabled:hover:active":{backgroundColor:"transparent",...n.Pt.borderColor("transparent"),[`& .${o.h.icon}`]:{color:"inherit"}}},destructive:{backgroundColor:l.It.colorDestructiveBackground1,color:l.It.colorDestructiveForeground1,...n.Pt.border(l.It.strokeWidthThin,"solid",l.It.colorDestructiveBackground1),":hover":{backgroundColor:l.It.colorDestructiveBackground1Hover,color:l.It.colorDestructiveForeground1,...n.Pt.borderColor(l.It.colorDestructiveBackground1Hover)},":hover:active":{backgroundColor:l.It.colorDestructiveBackground1Pressed,color:l.It.colorDestructiveForeground1,...n.Pt.borderColor(l.It.colorDestructiveBackground1Pressed)}},success:{backgroundColor:l.It.colorSuccessBackground1,color:l.It.colorSuccessForeground1,...n.Pt.border(l.It.strokeWidthThin,"solid",l.It.colorSuccessBackground1),":hover":{backgroundColor:l.It.colorSuccessBackground1Hover,color:l.It.colorSuccessForeground1,...n.Pt.borderColor(l.It.colorSuccessBackground1Hover)},":hover:active":{backgroundColor:l.It.colorSuccessBackground1Pressed,color:l.It.colorSuccessForeground1,...n.Pt.borderColor(l.It.colorSuccessBackground1Pressed)}},disabled:{backgroundColor:l.It.colorNeutralBackgroundDisabled,...n.Pt.borderColor(l.It.colorNeutralBackgroundDisabled),color:l.It.colorNeutralForegroundDisabled,":hover":{backgroundColor:l.It.colorNeutralBackgroundDisabled,...n.Pt.borderColor(l.It.colorNeutralBackgroundDisabled),color:l.It.colorNeutralForegroundDisabled},":hover:active":{backgroundColor:l.It.colorNeutralBackgroundDisabled,...n.Pt.borderColor(l.It.colorNeutralBackgroundDisabled),color:l.It.colorNeutralForegroundDisabled}},fullWidth:{width:"100%"},left:{textAlign:"left",justifyContent:"left"},right:{textAlign:"right",justifyContent:"right"},center:{textAlign:"center",justifyContent:"center"}}),p=(0,c.forwardRef)((({children:e,className:t,appearance:r,size:i,...n},o)=>{const c=h(),l=d(),p=n.fullWidth?c.fullWidth:"",m=n.textPosition?c[n.textPosition]:"",f=n.disabled??!1,g=(0,s.z)(t,"acrylic"===r&&l.acrylic,"acrylic"===r&&f&&l.acrylicDisabled,"acrylic"!==r&&c[r??"secondary"],"acrylic"!==r&&f&&c.disabled,c.base,p,m),A="destructive"===r||"success"===r||"acrylic"===r?"secondary":r;return(0,u.jsx)(a.$,{className:g,ref:o,appearance:A,size:i,...n,children:e})}));p.displayName="Button"},667641:(e,t,r)=>{r.d(t,{lG:()=>h});var i=r(73268),n=r(697872),o=r(382518),s=r(271816),a=r(303879),c=r(56352),l=r(338864),d=r(277277);const u=(0,i.n)({root:{},body:{rowGap:c.It.spacingVerticalM}}),h=({dialogTrigger:e,children:t,onClose:r,size:i,dialogSurface:c=l.El,dialogBody:h=n.R,...p})=>{const m=u(),f=(0,o.z)(m.body);return(0,d.jsxs)(s.l,{onOpenChange:()=>r?.(),...p,children:[(0,d.jsx)(a.z,{disableButtonEnhancement:!0,children:e}),(0,d.jsx)(c,{size:i,"data-testid":"dialog",children:(0,d.jsx)(h,{className:f,children:t})})]})}},397448:(e,t,r)=>{r.d(t,{i:()=>d});var i=r(73268),n=r(382518),o=r(794672),s=r(26985),a=r(56352),c=r(277277);const l=(0,i.n)({root:{},actions:{marginTop:a.It.spacingVerticalXXL}}),d=(0,s.forwardRef)((({children:e,className:t,...r},i)=>{const s=l(),a=(0,n.z)(s.actions,t);return(0,c.jsx)(o.i,{ref:i,fluid:!0,className:a,...r,children:e})}));d.displayName="DialogActions"},338864:(e,t,r)=>{r.d(t,{El:()=>l});var i=r(73268),n=r(382518),o=r(63708),s=r(26985),a=r(277277);const c=(0,i.n)({root:{borderRadius:"16px"},small:{},medium:{maxWidth:"688px"},large:{maxWidth:"840px"},backdrop:{backdropFilter:"blur(10px)"}}),l=(0,s.forwardRef)((({children:e,className:t,size:r="small",...i},s)=>{const l=c(),d=(0,n.z)(l.backdrop),u=(0,n.z)(l.root,l[r],t);return(0,a.jsx)(o.E,{ref:s,className:u,backdrop:{className:d},...i,children:e})}));l.displayName="DialogSurface"},977751:(e,t,r)=>{r.d(t,{L:()=>h});var i=r(73268),n=r(382518),o=r(181484),s=r(303879),a=r(977059),c=r(26985),l=r(380467),d=r(277277);const u=(0,i.n)({root:{paddingBottom:"10px"}}),h=(0,c.forwardRef)((({showCloseButton:e,children:t,...r},i)=>{const c=u(),h=(0,n.z)(c.root);return(0,d.jsx)(o.L,{className:h,ref:i,action:e?(0,d.jsx)(s.z,{action:"close",children:(0,d.jsx)(l.$,{appearance:"subtle",icon:(0,d.jsx)(a.BEt,{}),"aria-label":e})}):null,...r,children:t})}));h.displayName="DialogTitle"},771083:(e,t,r)=>{r.d(t,{z:()=>u});var i=r(346141),n=r(262513),o=r(73268),s=r(382518),a=r(26985),c=r(56352),l=r(277277);const d=(0,o.n)({warning:{[`& .${i.l.bar}`]:{backgroundColor:c.It.colorStatusWarningForeground1}}}),u=(0,a.forwardRef)((({children:e,className:t,...r},i)=>{const o=d(),a=(0,s.z)(t,..."warning"===r.color?[o.warning]:[]);return(0,l.jsx)(n.z,{className:a,ref:i,...r,children:e})}));u.displayName="ProgressBar"},766828:(e,t,r)=>{r.d(t,{S:()=>d,q:()=>u});var i=r(73268),n=r(846568),o=r(382518),s=r(26985),a=r(277277);const c=(0,i.n)({root:{lineHeight:1,textAlign:"start"}}),l=(0,s.createContext)("light");function d(){return(0,s.useContext)(l)}const u=({className:e,...t})=>{const r=c();return(0,a.jsx)(l.Provider,{value:t.theme?.themeName??"light",children:(0,a.jsx)(n.q,{...t,className:(0,o.z)(r.root,e)})})}},674871:(e,t,r)=>{r.d(t,{Bn:()=>p,DV:()=>d,Mu:()=>u,RO:()=>l,VL:()=>o,aM:()=>a,aw:()=>s,j6:()=>h,mb:()=>n,pw:()=>i,vl:()=>c});const i={black:"#000000",white:"#ffffff"},n={name:"Grey",2:"#04040C",4:"#090911",6:"#0E0E16",8:"#13131B",10:"#191922",12:"#1E1E29",14:"#232330",16:"#272836",18:"#2C2D3C",20:"#313242",22:"#363749",24:"#3B3B4F",26:"#404055",28:"#45455B",30:"#4B4B61",32:"#505067",34:"#55556C",36:"#5A5A71",38:"#5F5F77",40:"#64647C",42:"#696981",44:"#6E6E86",46:"#73738B",48:"#787890",50:"#7E7E96",52:"#83839B",54:"#8888A0",56:"#8D8DA4",58:"#9292A9",60:"#9797AE",62:"#9C9CB3",64:"#A1A1B7",66:"#A6A6BC",68:"#ABABC0",70:"#B1B2C4",72:"#B7B7C8",74:"#BCBCCD",76:"#C1C1D1",78:"#C6C6D6",80:"#CBCBDA",82:"#D0D0DD",84:"#D5D5E1",86:"#DADAE5",88:"#DFDFE8",90:"#E5E5ED",92:"#EAEAF1",94:"#F0F0F5",96:"#F5F5FA",98:"#FAFAFF"},o={name:"Purple",10:"#1C003B",20:"#280056",30:"#330072",40:"#3E008D",50:"#5000B0",60:"#6200D5",70:"#7611F0",80:"#892FFF",90:"#974CFF",100:"#A966FF",110:"#BC7FFF",120:"#CA97FF",130:"#D8AFFF",140:"#E4C6FF",150:"#EFDCFF",160:"#F8EFFF"},s={name:"Red",10:"#32011A",20:"#460426",30:"#590830",40:"#700F35",50:"#84173C",60:"#9A2043",70:"#AD2647",80:"#C2344D",90:"#E44F5B",100:"#FD6B6B",110:"#FE827B",120:"#FF948D",130:"#FFACA8",140:"#FFC4C1",150:"#FFD9D7",160:"#FFEEEE"},a={name:"Green",10:"#001A12",20:"#00271F",30:"#01332B",40:"#014038",50:"#0B4E44",60:"#0C5C51",70:"#02685C",80:"#007869",90:"#179382",100:"#2EAC92",110:"#37BA9D",120:"#4AC6A4",130:"#65D5B2",140:"#8BE4BD",150:"#ADF0CC",160:"#D3FCE0"},c={name:"Blue",10:"#150836",20:"#1A114E",30:"#1E1965",40:"#22217C",50:"#242DA0",60:"#273AC1",70:"#2F49DD",80:"#3A5AF4",90:"#546BFF",100:"#6F7FFF",110:"#8893FF",120:"#9FA8FF",130:"#B6BCFF",140:"#CBCFFF",150:"#DEE2FF",160:"#F1F2FF"},l={name:"Yellow",10:"#231200",20:"#361A00",30:"#472300",40:"#5A2D00",50:"#6B3800",60:"#7E4200",70:"#8B4D00",80:"#9D5A00",90:"#C07100",100:"#DD8601",110:"#ED9100",120:"#F3A201",130:"#FCB501",140:"#FFCA69",150:"#FFDEA7",160:"#FFF0D8"},d={name:"Pink",10:"#23002C",20:"#350039",30:"#460046",40:"#580053",50:"#6E006C",60:"#860087",70:"#9E00A4",80:"#B50AC1",90:"#C828DA",100:"#D941F1",110:"#E560FF",120:"#E985FF",130:"#EDA4FF",140:"#F1C0FF",150:"#F6D9FF",160:"#FBEEFF"},u={logo:n[18],audio:c[90],overlay:"#EB0E33",title:o[80],shapeAtom:"#EB0E33"},h={snappingGuide:d[110]},p={backgroundOuter:"#433AC7",ringsInner:"rgba(237, 143, 250, 0.60)"}},56352:(e,t,r)=>{r.d(t,{$w:()=>ge,vg:()=>fe,eN:()=>ve,It:()=>Ae});var i=r(385630),n=r(193309),o=r(23356),s=r(674871);const a="rgba(255, 255, 255, 0.05)",c="rgba(255, 255, 255, 0.1)",l="rgba(255, 255, 255, 0.2)",d="rgba(255, 255, 255, 0.3)",u="rgba(255, 255, 255, 0.4)",h="rgba(255, 255, 255, 0.5)",p="rgba(255, 255, 255, 0.6)",m="rgba(255, 255, 255, 0.7)",f="rgba(255, 255, 255, 0.8)",g="rgba(255, 255, 255, 0.9)",A="rgba(0, 0, 0, 0.1)",v="rgba(0, 0, 0, 0.2)",y="rgba(0, 0, 0, 0.3)",b="rgba(0, 0, 0, 0.4)",w="#3f1011",x="#751d1f",S="#9f282b",T="#bc2f32",C="#d13438",_="#d7494c",k="#e37d80",E="#f1bbbc",I="#f8dadb",R="#fdf6f6",F="#003d20",P="#00723b",L="#009b51",N="#00b85f",M="#00cc6a",B="#19d279",D="#34d889",O="#5ae0a0",j="#a8f0cd",U="#f3fdf8",z="#4d2a00",W="#8f4e00",V="#c26a00",H="#e67e00",G="#ff8c00",q="#ffa83d",Q="#ffba66",K="#ffddb3",X="#fffaf5",Y=(e,t=1)=>{let r=e.replace("#","");return 3===r.length&&(r=`${r[0]}${r[0]}${r[1]}${r[1]}${r[2]}${r[2]}`),t>1&&t<=100&&(t/=100),`rgba(${Number.parseInt(r.slice(0,2),16)},${Number.parseInt(r.slice(2,4),16)},${Number.parseInt(r.slice(4,6),16)},${t})`},Z={colorNeutralAlpha5:Y(s.mb[8],.05),colorNeutralAlpha10:Y(s.mb[8],.1),colorNeutralAlpha20:Y(s.mb[8],.2),colorNeutralAlpha30:Y(s.mb[8],.3),colorNeutralAlpha40:Y(s.mb[8],.4),colorNeutralAlpha50:Y(s.mb[8],.5),colorNeutralAlpha60:Y(s.mb[8],.6),colorNeutralAlpha70:Y(s.mb[8],.7),colorNeutralAlpha80:Y(s.mb[8],.8),colorNeutralAlpha90:Y(s.mb[8],.9),colorNeutralAlphaInverted5:a,colorNeutralAlphaInverted10:c,colorNeutralAlphaInverted20:l,colorNeutralAlphaInverted30:d,colorNeutralAlphaInverted40:u,colorNeutralAlphaInverted50:h,colorNeutralAlphaInverted60:p,colorNeutralAlphaInverted70:m,colorNeutralAlphaInverted80:f,colorNeutralAlphaInverted90:g},J={colorNeutralAlpha5:a,colorNeutralAlpha10:c,colorNeutralAlpha20:l,colorNeutralAlpha30:d,colorNeutralAlpha40:u,colorNeutralAlpha50:h,colorNeutralAlpha60:p,colorNeutralAlpha70:m,colorNeutralAlpha80:f,colorNeutralAlpha90:g,colorNeutralAlphaInverted5:Y(s.mb[8],.05),colorNeutralAlphaInverted10:Y(s.mb[8],.1),colorNeutralAlphaInverted20:Y(s.mb[8],.2),colorNeutralAlphaInverted30:Y(s.mb[8],.3),colorNeutralAlphaInverted40:Y(s.mb[8],.4),colorNeutralAlphaInverted50:Y(s.mb[8],.5),colorNeutralAlphaInverted60:Y(s.mb[8],.6),colorNeutralAlphaInverted70:Y(s.mb[8],.7),colorNeutralAlphaInverted80:Y(s.mb[8],.8),colorNeutralAlphaInverted90:Y(s.mb[8],.9)},$={colorBrandBackground:s.VL[80],colorBrandBackgroundHover:s.VL[60],colorBrandBackgroundPressed:s.VL[50],colorBrandBackgroundSelected:s.VL[70],colorBrandBackground2:s.VL[160],colorBrandBackground2Hover:s.VL[150],colorBrandBackground2Pressed:s.VL[130],colorBrandBackground2Selected:s.VL[140],colorBrandBackground3Static:s.VL[60],colorBrandBackground4Static:s.VL[40],colorCompoundBrandBackground:s.VL[80],colorCompoundBrandBackgroundHover:s.VL[70],colorCompoundBrandBackgroundPressed:s.VL[60],colorBrandBackgroundInverted:s.VL[160],colorBrandBackgroundInvertedHover:s.VL[150],colorBrandBackgroundInvertedPressed:s.VL[140],colorBrandBackgroundInvertedSelected:s.VL[150],colorBrandBackgroundStatic:s.VL[80],colorBrandForeground1:s.VL[80],colorBrandForeground1Hover:s.VL[60],colorBrandForeground1Pressed:s.VL[50],colorBrandForeground1Selected:s.VL[70],colorBrandForeground2:s.VL[70],colorBrandForeground2Hover:s.VL[60],colorBrandForeground2Pressed:s.VL[30],colorBrandForeground2Selected:s.VL[60],colorBrandForegroundLink:s.VL[80],colorBrandForegroundLinkHover:s.VL[60],colorBrandForegroundLinkPressed:s.VL[50],colorBrandForegroundLinkSelected:s.VL[70],colorCompoundBrandForeground1:s.VL[80],colorCompoundBrandForeground1Hover:s.VL[70],colorCompoundBrandForeground1Pressed:s.VL[60],colorCompoundBrandForeground1Selected:s.VL[60],colorBrandForegroundInverted:s.VL[100],colorBrandForegroundInvertedHover:s.VL[110],colorBrandForegroundInvertedPressed:s.VL[100],colorBrandForegroundOnLight:s.VL[80],colorBrandForegroundOnLightHover:s.VL[70],colorBrandForegroundOnLightPressed:s.VL[50],colorBrandForegroundOnLightSelected:s.VL[60],colorBrandStroke1:s.VL[80],colorBrandStroke2:s.VL[140],colorBrandStroke2Hover:s.VL[120],colorBrandStroke2Pressed:s.VL[80],colorBrandStroke2Contrast:s.VL[140],colorCompoundBrandStroke:s.VL[80],colorCompoundBrandStrokeHover:s.VL[70],colorCompoundBrandStrokePressed:s.VL[60]},ee={colorBrandBackground:s.VL[80],colorBrandBackgroundHover:s.VL[60],colorBrandBackgroundPressed:s.VL[50],colorBrandBackgroundSelected:s.VL[70],colorBrandBackground2:s.VL[40],colorBrandBackground2Hover:s.VL[60],colorBrandBackground2Pressed:s.VL[30],colorBrandBackground2Selected:s.VL[50],colorBrandBackground3Static:s.VL[60],colorBrandBackground4Static:s.VL[40],colorCompoundBrandBackground:s.VL[80],colorCompoundBrandBackgroundHover:s.VL[90],colorCompoundBrandBackgroundPressed:s.VL[100],colorBrandBackgroundInverted:s.VL[160],colorBrandBackgroundInvertedHover:s.VL[150],colorBrandBackgroundInvertedPressed:s.VL[140],colorBrandBackgroundInvertedSelected:s.VL[150],colorBrandBackgroundStatic:s.VL[80],colorBrandForeground1:s.VL[80],colorBrandForeground1Hover:s.VL[90],colorBrandForeground1Pressed:s.VL[100],colorBrandForeground1Selected:s.VL[80],colorBrandForeground2:s.VL[100],colorBrandForeground2Hover:s.VL[120],colorBrandForeground2Pressed:s.VL[130],colorBrandForeground2Selected:s.VL[110],colorBrandForegroundLink:s.VL[120],colorBrandForegroundLinkHover:s.VL[130],colorBrandForegroundLinkPressed:s.VL[140],colorBrandForegroundLinkSelected:s.VL[120],colorCompoundBrandForeground1:s.VL[80],colorCompoundBrandForeground1Hover:s.VL[90],colorCompoundBrandForeground1Pressed:s.VL[100],colorCompoundBrandForeground1Selected:s.VL[100],colorBrandForegroundInverted:s.VL[80],colorBrandForegroundInvertedHover:s.VL[70],colorBrandForegroundInvertedPressed:s.VL[60],colorBrandForegroundOnLight:s.VL[80],colorBrandForegroundOnLightHover:s.VL[70],colorBrandForegroundOnLightPressed:s.VL[50],colorBrandForegroundOnLightSelected:s.VL[60],colorBrandStroke1:s.VL[80],colorBrandStroke2:s.VL[60],colorBrandStroke2Hover:s.VL[50],colorBrandStroke2Pressed:s.VL[40],colorBrandStroke2Contrast:s.VL[50],colorCompoundBrandStroke:s.VL[80],colorCompoundBrandStrokeHover:s.VL[90],colorCompoundBrandStrokePressed:s.VL[100]},te={colorNeutralBackground1:s.pw.white,colorNeutralBackground1Hover:s.mb[96],colorNeutralBackground1Pressed:s.mb[88],colorNeutralBackground1Selected:s.mb[92],colorNeutralBackgroundInverted:s.mb[16],colorNeutralBackgroundInvertedDisabled:c,colorNeutralBackground2:s.mb[98],colorNeutralBackground2Hover:s.mb[94],colorNeutralBackground2Pressed:s.mb[86],colorNeutralBackground2Selected:s.mb[90],colorNeutralBackground3:s.mb[96],colorNeutralBackground3Hover:s.mb[92],colorNeutralBackground3Pressed:s.mb[84],colorNeutralBackground3Selected:s.mb[88],colorNeutralBackground4:s.mb[94],colorNeutralBackground4Hover:s.mb[98],colorNeutralBackground4Pressed:s.mb[96],colorNeutralBackground4Selected:s.pw.white,colorNeutralBackground5:s.mb[92],colorNeutralBackground5Hover:s.mb[96],colorNeutralBackground5Pressed:s.mb[94],colorNeutralBackground5Selected:s.mb[98],colorNeutralBackground6:s.mb[90],colorNeutralBackground6Inverted:s.mb[20],colorNeutralBackgroundAlpha:h,colorNeutralBackgroundAlphaInverted:Y(s.mb[10],10),colorNeutralBackgroundAlpha2:f,colorNeutralBackgroundAlpha2Inverted:Y(s.mb[12],20),colorSubtleBackground:"transparent",colorSubtleBackgroundHover:Y(s.mb[22],7),colorSubtleBackgroundPressed:Y(s.mb[22],9),colorSubtleBackgroundSelected:Y(s.mb[22],11),colorSubtleBackgroundLightAlpha:"transparent",colorSubtleBackgroundLightAlphaHover:m,colorSubtleBackgroundLightAlphaPressed:h,colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:A,colorSubtleBackgroundInvertedPressed:y,colorSubtleBackgroundInvertedSelected:v,colorNeutralBackgroundStatic:s.mb[76],colorNeutralStencil1:s.mb[90],colorNeutralStencil1Alpha:Y(s.mb[4],10),colorNeutralStencil2:s.mb[98],colorNeutralStencil2Alpha:Y(s.mb[4],5),colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:s.mb[94],colorBackgroundOverlay:b,colorScrollbarOverlay:b,colorScrollbarOverlayHover:"rgba(0, 0, 0, 0.6)"},re={colorNeutralBackground1:s.mb[16],colorNeutralBackground1Hover:s.mb[24],colorNeutralBackground1Pressed:s.mb[12],colorNeutralBackground1Selected:s.mb[22],colorNeutralBackgroundInverted:s.pw.white,colorNeutralBackgroundInvertedDisabled:c,colorNeutralBackground2:s.mb[12],colorNeutralBackground2Hover:s.mb[20],colorNeutralBackground2Pressed:s.mb[8],colorNeutralBackground2Selected:s.mb[18],colorNeutralBackground3:s.mb[8],colorNeutralBackground3Hover:s.mb[16],colorNeutralBackground3Pressed:s.mb[4],colorNeutralBackground3Selected:s.mb[14],colorNeutralBackground4:s.mb[4],colorNeutralBackground4Hover:s.mb[12],colorNeutralBackground4Pressed:s.pw.black,colorNeutralBackground4Selected:s.mb[10],colorNeutralBackground5:s.pw.black,colorNeutralBackground5Hover:s.mb[8],colorNeutralBackground5Pressed:s.mb[2],colorNeutralBackground5Selected:s.mb[6],colorNeutralBackground6:s.mb[20],colorNeutralBackground6Inverted:s.mb[90],colorNeutralBackgroundAlpha:Y(s.mb[10],50),colorNeutralBackgroundAlphaInverted:c,colorNeutralBackgroundAlpha2:Y(s.mb[12],70),colorNeutralBackgroundAlpha2Inverted:l,colorSubtleBackground:"transparent",colorSubtleBackgroundHover:Y(s.mb[96],9),colorSubtleBackgroundPressed:Y(s.mb[96],11),colorSubtleBackgroundSelected:Y(s.mb[96],13),colorSubtleBackgroundLightAlpha:"transparent",colorSubtleBackgroundLightAlphaHover:m,colorSubtleBackgroundLightAlphaPressed:h,colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:A,colorSubtleBackgroundInvertedPressed:y,colorSubtleBackgroundInvertedSelected:v,colorNeutralBackgroundStatic:s.mb[24],colorNeutralStencil1:s.mb[34],colorNeutralStencil1Alpha:c,colorNeutralStencil2:s.mb[20],colorNeutralStencil2Alpha:a,colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:s.mb[16],colorBackgroundOverlay:"rgba(0, 0, 0, 0.5)",colorScrollbarOverlay:u,colorScrollbarOverlayHover:p},ie={colorNeutralForeground1:s.mb[14],colorNeutralForeground1Hover:s.mb[14],colorNeutralForeground1Pressed:s.mb[14],colorNeutralForeground1Selected:s.mb[14],colorNeutralForeground2:s.mb[26],colorNeutralForeground2Hover:s.mb[14],colorNeutralForeground2Pressed:s.mb[14],colorNeutralForeground2Selected:s.mb[14],colorNeutralForeground2Brand:s.VL[80],colorNeutralForeground2BrandHover:s.VL[80],colorNeutralForeground2BrandPressed:s.VL[70],colorNeutralForeground2BrandSelected:s.VL[80],colorNeutralForeground2Link:s.mb[26],colorNeutralForeground2LinkHover:s.mb[14],colorNeutralForeground2LinkPressed:s.mb[14],colorNeutralForeground2LinkSelected:s.mb[14],colorNeutralForeground3:s.mb[38],colorNeutralForeground3Hover:s.mb[26],colorNeutralForeground3Pressed:s.mb[26],colorNeutralForeground3Selected:s.mb[26],colorNeutralForeground3Brand:s.VL[80],colorNeutralForeground3BrandHover:s.VL[70],colorNeutralForeground3BrandPressed:s.VL[60],colorNeutralForeground3BrandSelected:s.VL[80],colorNeutralForeground4:s.mb[44],colorNeutralForegroundInverted:s.pw.white,colorNeutralForegroundInvertedHover:s.pw.white,colorNeutralForegroundInvertedPressed:s.pw.white,colorNeutralForegroundInvertedSelected:s.pw.white,colorNeutralForegroundInverted2:s.pw.white,colorNeutralForegroundInvertedLink:s.pw.white,colorNeutralForegroundInvertedLinkHover:s.pw.white,colorNeutralForegroundInvertedLinkPressed:s.pw.white,colorNeutralForegroundInvertedLinkSelected:s.pw.white,colorNeutralForegroundInvertedDisabled:u,colorNeutralForegroundOnBrand:s.pw.white,colorNeutralForegroundDisabled:s.mb[74],colorNeutralForeground1Static:s.mb[14],colorNeutralForegroundStaticInverted:s.pw.white,colorNeutralForegroundOnColor:s.pw.white},ne={colorNeutralForeground1:s.pw.white,colorNeutralForeground1Hover:s.pw.white,colorNeutralForeground1Pressed:s.pw.white,colorNeutralForeground1Selected:s.pw.white,colorNeutralForeground2:s.mb[84],colorNeutralForeground2Hover:s.pw.white,colorNeutralForeground2Pressed:s.pw.white,colorNeutralForeground2Selected:s.pw.white,colorNeutralForeground2Brand:s.VL[100],colorNeutralForeground2BrandHover:s.VL[100],colorNeutralForeground2BrandPressed:s.VL[90],colorNeutralForeground2BrandSelected:s.VL[100],colorNeutralForeground2Link:s.mb[84],colorNeutralForeground2LinkHover:s.pw.white,colorNeutralForeground2LinkPressed:s.pw.white,colorNeutralForeground2LinkSelected:s.pw.white,colorNeutralForeground3:s.mb[68],colorNeutralForeground3Hover:s.mb[84],colorNeutralForeground3Pressed:s.mb[84],colorNeutralForeground3Selected:s.mb[84],colorNeutralForeground3Brand:s.VL[110],colorNeutralForeground3BrandHover:s.VL[120],colorNeutralForeground3BrandPressed:s.VL[130],colorNeutralForeground3BrandSelected:s.VL[110],colorNeutralForeground4:s.mb[60],colorNeutralForegroundInverted:s.mb[14],colorNeutralForegroundInvertedHover:s.mb[14],colorNeutralForegroundInvertedPressed:s.mb[14],colorNeutralForegroundInvertedSelected:s.mb[14],colorNeutralForegroundInverted2:s.mb[14],colorNeutralForegroundInvertedLink:s.pw.white,colorNeutralForegroundInvertedLinkHover:s.pw.white,colorNeutralForegroundInvertedLinkPressed:s.pw.white,colorNeutralForegroundInvertedLinkSelected:s.pw.white,colorNeutralForegroundInvertedDisabled:u,colorNeutralForegroundOnBrand:s.pw.white,colorNeutralForegroundDisabled:s.mb[36],colorNeutralForeground1Static:s.mb[14],colorNeutralForegroundStaticInverted:s.pw.white,colorNeutralForegroundOnColor:s.pw.white},oe={colorNeutralStroke1:s.mb[82],colorNeutralStroke1Hover:s.mb[78],colorNeutralStroke1Pressed:s.mb[70],colorNeutralStroke1Selected:s.mb[14],colorNeutralStroke2:s.mb[88],colorNeutralStroke3:s.mb[96],colorNeutralStrokeAccessible:s.mb[38],colorNeutralStrokeAccessibleHover:s.mb[34],colorNeutralStrokeAccessiblePressed:s.mb[30],colorNeutralStrokeAccessibleSelected:s.VL[80],colorNeutralStrokeOnBrand:s.pw.white,colorNeutralStrokeOnBrand2:s.pw.white,colorNeutralStrokeOnBrand2Hover:s.pw.white,colorNeutralStrokeOnBrand2Pressed:s.pw.white,colorNeutralStrokeOnBrand2Selected:s.pw.white,colorNeutralStrokeSubtle:s.mb[88],colorStrokeFocus1:s.pw.white,colorStrokeFocus2:s.pw.black,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeDisabled:s.mb[88],colorNeutralStrokeInvertedDisabled:u,colorNeutralStrokeAlpha:Y(s.mb[8],10),colorNeutralStrokeAlpha2:Y(s.mb[8],20)},se={colorNeutralStroke1:s.mb[40],colorNeutralStroke1Hover:s.mb[46],colorNeutralStroke1Pressed:s.mb[42],colorNeutralStroke1Selected:s.mb[86],colorNeutralStroke2:s.mb[32],colorNeutralStroke3:s.mb[20],colorNeutralStrokeAccessible:s.mb[68],colorNeutralStrokeAccessibleHover:s.mb[74],colorNeutralStrokeAccessiblePressed:s.mb[70],colorNeutralStrokeAccessibleSelected:s.VL[100],colorNeutralStrokeOnBrand:s.mb[16],colorNeutralStrokeOnBrand2:s.pw.white,colorNeutralStrokeOnBrand2Hover:s.pw.white,colorNeutralStrokeOnBrand2Pressed:s.pw.white,colorNeutralStrokeOnBrand2Selected:s.pw.white,colorNeutralStrokeSubtle:s.mb[4],colorStrokeFocus1:s.pw.black,colorStrokeFocus2:s.pw.white,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeDisabled:s.mb[26],colorNeutralStrokeInvertedDisabled:u,colorNeutralStrokeAlpha:c,colorNeutralStrokeAlpha2:l},ae={colorNeutralCardBackground:s.mb[98],colorNeutralCardBackgroundHover:s.pw.white,colorNeutralCardBackgroundPressed:s.mb[96],colorNeutralCardBackgroundSelected:s.mb[92],colorNeutralCardBackgroundDisabled:s.mb[94]},ce={colorNeutralCardBackground:s.mb[20],colorNeutralCardBackgroundHover:s.mb[24],colorNeutralCardBackgroundPressed:s.mb[28],colorNeutralCardBackgroundSelected:s.mb[22],colorNeutralCardBackgroundDisabled:s.mb[8]},le={colorStatusDangerBackground1:R,colorStatusDangerBackground1Hover:I,colorStatusDangerBackground1Pressed:E,colorStatusDangerBackground1Selected:R,colorStatusDangerBackground2:C,colorStatusDangerBackground2Hover:T,colorStatusDangerBackground2Pressed:S,colorStatusDangerBackground2Selected:C,colorStatusDangerBackground3:C,colorStatusDangerBackground3Hover:T,colorStatusDangerBackground3Pressed:S,colorStatusDangerBackground3Selected:C,colorStatusDangerForeground1:C,colorStatusDangerForeground1Hover:T,colorStatusDangerForeground1Pressed:S,colorStatusDangerForeground1Selected:C,colorStatusDangerForeground2:_,colorStatusDangerForeground3:S,colorStatusDangerForegroundInverted:E,colorStatusDangerBorder1:"#dc5e62",colorStatusDangerBorder2:E,colorStatusDangerBorderActive:C,colorStatusSuccessBackground1:U,colorStatusSuccessBackground1Hover:"#cff7e4",colorStatusSuccessBackground1Pressed:j,colorStatusSuccessBackground1Selected:U,colorStatusSuccessBackground2:M,colorStatusSuccessBackground2Hover:N,colorStatusSuccessBackground2Pressed:L,colorStatusSuccessBackground2Selected:M,colorStatusSuccessBackground3:M,colorStatusSuccessBackground3Hover:N,colorStatusSuccessBackground3Pressed:L,colorStatusSuccessBackground3Selected:M,colorStatusSuccessForeground1:M,colorStatusSuccessForeground1Hover:N,colorStatusSuccessForeground1Pressed:L,colorStatusSuccessForeground1Selected:M,colorStatusSuccessForeground2:B,colorStatusSuccessForeground3:L,colorStatusSuccessForegroundInverted:j,colorStatusSuccessBorder1:D,colorStatusSuccessBorder2:j,colorStatusSuccessBorderActive:M,colorStatusWarningBackground1:X,colorStatusWarningBackground1Hover:"#ffedd6",colorStatusWarningBackground1Pressed:K,colorStatusWarningBackground1Selected:X,colorStatusWarningBackground2:G,colorStatusWarningBackground2Hover:H,colorStatusWarningBackground2Pressed:V,colorStatusWarningBackground2Selected:G,colorStatusWarningBackground3:G,colorStatusWarningBackground3Hover:H,colorStatusWarningBackground3Pressed:V,colorStatusWarningBackground3Selected:G,colorStatusWarningForeground1:G,colorStatusWarningForeground1Hover:H,colorStatusWarningForeground1Pressed:V,colorStatusWarningForeground1Selected:G,colorStatusWarningForeground2:"#ff9a1f",colorStatusWarningForeground3:G,colorStatusWarningForegroundInverted:K,colorStatusWarningBorder1:q,colorStatusWarningBorder2:K,colorStatusWarningBorderActive:G},de={colorStatusDangerBackground1:w,colorStatusDangerBackground1Hover:x,colorStatusDangerBackground1Pressed:S,colorStatusDangerBackground1Selected:w,colorStatusDangerBackground2:S,colorStatusDangerBackground2Hover:T,colorStatusDangerBackground2Pressed:C,colorStatusDangerBackground2Selected:S,colorStatusDangerBackground3:C,colorStatusDangerBackground3Hover:T,colorStatusDangerBackground3Pressed:S,colorStatusDangerBackground3Selected:C,colorStatusDangerForeground1:k,colorStatusDangerForeground1Hover:E,colorStatusDangerForeground1Pressed:I,colorStatusDangerForeground1Selected:k,colorStatusDangerForeground2:E,colorStatusDangerForeground3:_,colorStatusDangerForegroundInverted:x,colorStatusDangerBorder1:S,colorStatusDangerBorder2:w,colorStatusDangerBorderActive:k,colorStatusSuccessBackground1:F,colorStatusSuccessBackground1Hover:P,colorStatusSuccessBackground1Pressed:L,colorStatusSuccessBackground1Selected:F,colorStatusSuccessBackground2:L,colorStatusSuccessBackground2Hover:N,colorStatusSuccessBackground2Pressed:M,colorStatusSuccessBackground2Selected:L,colorStatusSuccessBackground3:M,colorStatusSuccessBackground3Hover:N,colorStatusSuccessBackground3Pressed:L,colorStatusSuccessBackground3Selected:M,colorStatusSuccessForeground1:D,colorStatusSuccessForeground1Hover:O,colorStatusSuccessForeground1Pressed:j,colorStatusSuccessForeground1Selected:D,colorStatusSuccessForeground2:j,colorStatusSuccessForeground3:B,colorStatusSuccessForegroundInverted:P,colorStatusSuccessBorder1:L,colorStatusSuccessBorder2:F,colorStatusSuccessBorderActive:O,colorStatusWarningBackground1:z,colorStatusWarningBackground1Hover:W,colorStatusWarningBackground1Pressed:V,colorStatusWarningBackground1Selected:z,colorStatusWarningBackground2:V,colorStatusWarningBackground2Hover:H,colorStatusWarningBackground2Pressed:G,colorStatusWarningBackground2Selected:V,colorStatusWarningBackground3:G,colorStatusWarningBackground3Hover:H,colorStatusWarningBackground3Pressed:V,colorStatusWarningBackground3Selected:G,colorStatusWarningForeground1:q,colorStatusWarningForeground1Hover:Q,colorStatusWarningForeground1Pressed:K,colorStatusWarningForeground1Selected:q,colorStatusWarningForeground2:K,colorStatusWarningForeground3:G,colorStatusWarningForegroundInverted:W,colorStatusWarningBorder1:V,colorStatusWarningBorder2:z,colorStatusWarningBorderActive:Q},ue={...(0,i.a)(s.VL),...te,...ie,...oe,...ae,...$,...le,colorPaletteRedBackground3:s.aw[80]},he={...(0,n.W)(s.VL),...re,...ne,...se,...ce,...ee,...de,colorPaletteRedBackground3:s.aw[70]},pe={colorDestructiveForeground1:s.pw.white,colorDestructiveBackground1:s.aw[80],colorDestructiveBackground1Hover:s.aw[70],colorDestructiveBackground1Pressed:s.aw[50],colorDestructiveBackground1Selected:s.aw[80]},me={colorSuccessForeground1:s.pw.black,colorSuccessBackground1:s.aM[110],colorSuccessBackground1Hover:s.aM[90],colorSuccessBackground1Pressed:s.aM[80],colorSuccessBackground1Selected:s.aM[100]},fe={...ue,...Z,...pe,...me,colorToolbarBackground1:s.mb[88],colorTagFilledBackground1:s.mb[96],colorInteractionTagFilledBackground1:s.mb[96],colorInteractionTagFilledBackground1Hover:s.mb[92],colorInteractionTagFilledBackground1Active:s.mb[84],themeName:"light"},ge={...he,...J,...pe,...me,colorToolbarBackground1:s.mb[18],colorTagFilledBackground1:s.mb[22],colorInteractionTagFilledBackground1:s.mb[24],colorInteractionTagFilledBackground1Hover:s.mb[28],colorInteractionTagFilledBackground1Active:s.mb[22],themeName:"dark"},Ae=(0,o.Q)(fe),ve={background:Ae.colorNeutralBackground2,foreground:"#d8d8d8",skeleton:{start:Ae.colorNeutralBackground1,end:Ae.colorNeutralBackground3},header:{background:Ae.colorNeutralBackground2,backgroundHover:Ae.colorNeutralBackground2Hover,border:Ae.colorNeutralStroke1,borderActive:Ae.colorBrandStroke1,borderBottom:Ae.colorNeutralStroke3,borderError:Ae.colorStatusDangerBorder1,dialogBackground:Ae.colorNeutralBackground1,text:Ae.colorNeutralForeground1,textDisabled:Ae.colorNeutralForegroundDisabled},sidebar:{menu:{foreground:Ae.colorNeutralForeground3,foregroundDisabled:Ae.colorNeutralForeground3,background:Ae.colorNeutralBackground2,backgroundActive:Ae.colorNeutralBackground1},stickyHeader:{stroke:Ae.colorNeutralStroke3},background:Ae.colorNeutralBackground1,backgroundHighlight:Ae.colorNeutralAlpha20,foreground:Ae.colorNeutralForeground3,stroke:Ae.colorNeutralBackground1},timeline:{track:{background:Ae.colorNeutralBackground2,logo:s.mb[18],audio:s.vl[90],overlay:"#EB0E33",title:s.VL[80],emptyTrack:{fontColor:Ae.colorNeutralForeground4,border:Ae.colorNeutralAlpha10,backgroundHover:Ae.colorNeutralAlpha10,backgroundIsHovering:Ae.colorNeutralBackground2,borderHover:Ae.colorNeutralStrokeAccessibleSelected,hideButtonFontColor:Ae.colorNeutralForeground4},missing:{background:Ae.colorStatusDangerBackground1,backgroundHover:Ae.colorNeutralBackground1,border:Ae.colorStatusDangerBorder1,borderHover:Ae.colorBrandStroke1,text:Ae.colorStatusDangerForeground1,textHover:Ae.colorBrandForeground2}},background:Ae.colorNeutralBackground3,empty:{fakeTrackBackground:Ae.colorNeutralBackground2,fakeThumbnailBackground:Ae.colorNeutralBackground2,fakeThumbnailText:Ae.colorNeutralForegroundDisabled,fakeThumbnailBorder:Ae.colorNeutralStroke2}},stage:{background:Ae.colorNeutralBackground2}}},191025:(e,t,r)=>{r.d(t,{h:()=>i});const i=1e6},806983:(e,t,r)=>{r.d(t,{M:()=>n});var i=r(674871);const n=r(140169).I.a`
    font-weight: 600;
    color: ${i.VL[80]};
    :hover {
        cursor: pointer;
    }
`},571531:(e,t,r)=>{r.d(t,{A:()=>n});var i=r(674871);const n=r(140169).I.button`
    text-align: inherit;
    padding: 0;
    border: none;
    display: inline;
    font: inherit;
    color: ${i.VL[80]};
    font-weight: 600;
    background-color: transparent;
    cursor: pointer;
    :hover {
        text-decoration: underline;
    }
    :disabled {
        color: ${i.VL[110]};
        cursor: not-allowed;
        text-decoration: unset;
    }
`},981991:(e,t,r)=>{r.d(t,{$:()=>c});var i=r(674871),n=r(450348),o=r(140169),s=r(759935),a=r(698055);const c=(0,o.I)(a.v)`
    font-style: normal;
    font-weight: 600;
    font-size: ${(0,n.D)("16px")};
    color: ${i.VL[80]};
    background: rgba(255, 255, 255, 0.0001);
    border: ${(0,n.D)("2px")} solid ${i.VL[80]};
    border-radius: 6px;
    padding: ${(0,n.D)("9px")} ${(0,n.D)("16px")};
    display: flex;
    justify-content: center;
    align-items: center;

    ${s.I} {
        height: 13px;
        width: 13px;
        margin-right: 8px;
    }
`},999657:(e,t,r)=>{r.d(t,{$:()=>c});var i=r(450348),n=r(140169),o=r(148405),s=r(759935),a=r(698055);const c=(0,n.I)(a.v)`
    font-style: normal;
    font-weight: 600;
    font-size: ${(0,i.D)("16px")};
    color: white;
    background: ${(0,o.yW)("normal","primary")};
    border-radius: 6px;
    padding: 0.5rem 1rem;
    min-height: 2.5rem;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: 100ms ease-in-out all;

    ${s.I} {
        transition: 100ms ease-in-out opacity;
        height: 1rem;
        width: 1rem;
        margin-right: 0.5rem;
    }

    :disabled {
        opacity: 0.4;
        border-color: initial;
        cursor: not-allowed;

        :hover,
        :active {
            background: ${(0,o.yW)("normal","primary")};
        }
    }

    :hover {
        background: ${(0,o.yW)(70,"primary")};
    }

    :active {
        background: ${(0,o.yW)("light","primary")};
    }

    :focus {
        outline-offset: 3px;
    }
`},187981:(e,t,r)=>{r.d(t,{n:()=>a});var i=r(674871),n=r(140169),o=r(148405),s=r(999657);const a=(0,n.I)(s.$)`
    background: ${({theme:e})=>"Dark"===e.themeName?i.mb[18]:i.mb[96]};
    color: ${(0,o.yW)("normal","text")};

    :hover {
        background: ${({theme:e})=>"Dark"===e.themeName?i.mb[24]:i.mb[90]};
    }

    :active {
        background: ${({theme:e})=>"Dark"===e.themeName?i.mb[30]:i.mb[84]};
    }

    :disabled {
        :hover,
        :active {
            background: ${(0,o.yW)("normal","background")};
        }
    }
`},698055:(e,t,r)=>{r.d(t,{v:()=>i});const i=r(140169).I.button`
    text-align: inherit;
    padding: 0;
    border: none;
    font: inherit;
    color: inherit;
    background-color: transparent;
    cursor: pointer;
    > * {
        cursor: inherit;
    }
    display: flex;
    justify-content: center;
    align-items: center;
`},301557:(e,t,r)=>{r.d(t,{l:()=>b}),r(379321);var i=r(26985),n=r(804185),o=r(191025),s=r(140169),a=r(362933),c=r(449467),l=r(659636),d=r(953823),u=r(178560),h=r(180208),p=r(265845),m=r(457521),f=r(809202),g=r(612723),A=r(277277);const v=(0,s.I)(d.e).attrs({"data-testid":"dialog-container"})`
    position: fixed;
    top: 0;
    left: 0;
    z-index: ${o.h};
    width: 100%;
    height: 100%;
    display: flex;
    overflow: auto;
`;const y=({children:e,disableBackdropClick:t,disableEscapeKeyDown:r,disableFocusTrap:n,allowKeyboardShortcuts:o=!1,returnFocusTo:s,onBackdropClick:a,onClose:c,...l})=>{(0,p.o)("Escape",(()=>!r&&c&&c())),(0,m.w)();const d=(0,i.useRef)(null);var f;return(0,u.r)(d,{disabled:n,setReturnFocus:s||void 0}),f=d,(0,i.useEffect)((()=>f.current?function(e){const t=Array.from(document.body.children),r=[],i=[];return t.forEach((t=>{if(!t.contains(e)){const e=t.getAttribute("aria-hidden");if(null!==e&&"false"!==e)return;r.push(e),i.push(t),t.setAttribute("aria-hidden","true")}})),()=>{i.forEach(((e,t)=>{const i=r[t];null===i?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",i)}))}}(f.current):void 0),[f]),(0,i.useEffect)((()=>{if(o)return;const e=(0,h.vw)();return(0,h.TG)("dialog"),()=>{(0,h.TG)(e)}}),[o]),(0,A.jsx)(v,{ref:d,onPointerDown:e=>{e.target===d.current&&(!t&&c&&c(),a&&a())},...l,children:e})},b=({children:e,className:t,content:r=f.Cf,container:o,disableBackdropClick:s=!1,disableEscapeKeyDown:d=!1,disableFocusTrap:u=!1,returnFocusTo:h,onBackdropClick:p,onClose:m,open:v,style:b,transition:w=l.z,transitionDuration:x=c.$,theme:S=a.qW,...T})=>{const[C,_]=(0,i.useState)(!1),k={hasDialogOnTop:C,setDialogOnTop:_};return(0,A.jsx)(g.Zg,{value:k,children:(0,A.jsx)(n.NP,{theme:S,children:(0,A.jsx)(c.h,{container:o,open:v,transitionDuration:x,...T,children:(0,A.jsx)(y,{enter:v,className:t,style:b,duration:x,transition:w,disableBackdropClick:s||k.hasDialogOnTop,disableEscapeKeyDown:d||k.hasDialogOnTop,disableFocusTrap:u||!v||k.hasDialogOnTop,returnFocusTo:h,onBackdropClick:p,onClose:m,children:(0,A.jsx)(r,{children:e})})})})})}},109492:(e,t,r)=>{r.d(t,{i:()=>i});const i=r(140169).I.div`
    display: flex;
    align-items: center;
    margin-top: 2rem;
    flex-wrap: wrap;
    row-gap: 12px;
    column-gap: 16px;

    > * {
        margin: 0;
    }
`},145481:(e,t,r)=>{r.d(t,{H:()=>l});var i=r(123398),n=r(26985),o=r(140169),s=r(698055),a=r(277277);const c=(0,o.I)(s.v)`
    position: absolute;
    top: 1.875rem;
    inset-inline-end: 1.875rem;
    color: ${({theme:e})=>e.palette.text.lighter};
    z-index: 1;
`,l=(0,n.forwardRef)((({children:e,onClose:t,...r},n)=>(0,a.jsxs)(c,{...r,ref:n,onClick:t,children:[(0,a.jsx)(i.LMj,{"aria-hidden":!0})," ",e]})));l.displayName="DialogClose"},809202:(e,t,r)=>{r.d(t,{Cf:()=>s,G4:()=>a,VN:()=>n});var i=r(140169);const n=i.I.div.attrs({role:"dialog","data-testid":"dialog","aria-modal":"true"})``,o=(0,i.I)(n)`
    position: relative;
    background: ${({theme:e})=>e.background.light};
    line-height: 0;
    font-weight: normal;
    overflow: hidden;
    margin: auto;
    border-radius: 0.5rem;
`,s=(0,i.I)(o)`
    line-height: 140%;
    padding: 2.5rem;
    font-size: 1rem;
    color: ${({theme:e})=>e.palette.text.normal};
    p {
        margin: 0 0 1.25rem;
    }
    > * {
        max-width: 35rem;
    }
    box-shadow: ${({theme:e})=>e.shadows.dark};
`,a=(0,i.I)(s)`
    padding-right: 20.75rem;
`},612723:(e,t,r)=>{r.d(t,{Zg:()=>o,hL:()=>s});var i=r(26985);const n=(0,i.createContext)(void 0),o=n.Provider,s=()=>(0,i.useContext)(n)},682523:(e,t,r)=>{r.d(t,{L:()=>i});const i=r(140169).I.h1`
    font-size: 1.5rem;
    font-weight: 600;
    line-height: 120%;
    margin: 0.875rem 0;
`},14332:(e,t,r)=>{r.d(t,{h:()=>o,j:()=>n});var i=r(804185);const n=(0,i.i7)(["from{opacity:0;transform:translateY(100px);}to{opacity:1;transform:translateY(0);}"]),o=(0,i.i7)(["from{opacity:1;}to{opacity:0;}"])},641580:(e,t,r)=>{r.d(t,{Co:()=>h,Vp:()=>d,sp:()=>u});var i=r(26985),n=r(540076),o=r(847269),s=r(277277);const a=(e,t)=>"open"===t.type?{...e,[t.id]:{open:!0,props:t.props}}:"close"===t.type?{...e,[t.id]:{open:!1,props:void 0}}:void(0,n.xb)(t),c=(0,i.createContext)(void 0),l=(0,i.createContext)(void 0),d=e=>{const t=(0,o.sw)((0,i.useContext)(l),"Expected DialogDispatchContext to be provided");return[(0,i.useCallback)(((r=void 0)=>{t({type:"open",id:e,props:r})}),[t,e]),(0,i.useCallback)((()=>{t({type:"close",id:e})}),[t,e])]},u=e=>{const t=(0,o.sw)((0,i.useContext)(c),"Expected DialogStateContext to be provided"),[r,n]=d(e);return{isOpen:t[e]?.open??!1,props:t[e]?.props,openDialog:r,closeDialog:n}},h=({children:e})=>{const[t,r]=(0,i.useReducer)(a,{});return(0,s.jsx)(c.Provider,{value:t,children:(0,s.jsx)(l.Provider,{value:r,children:e})})}},759935:(e,t,r)=>{r.d(t,{I:()=>i});const i=r(140169).I.div`
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: row;
    align-items: center;
`},588215:(e,t,r)=>{r.d(t,{j:()=>s});var i=r(967108),n=r(674871),o=r(277277);const s=e=>{const t=(0,i.B)(),r=(0,i.B)();return(0,o.jsxs)("svg",{viewBox:"0 0 22 23",...e,children:[(0,o.jsx)("path",{d:"M18.524.903 1.219 4.9A1.57 1.57 0 0 0 .043 6.78L.46 8.594A1.57 1.57 0 0 0 2.344 9.77l17.305-3.995a1.57 1.57 0 0 0 1.176-1.883l-.418-1.812A1.57 1.57 0 0 0 18.524.903Z",fill:`url(#${t})`}),(0,o.jsx)("path",{d:"M0 18h22v3c0 1.1-.9 2-2 2H2c-1.1 0-2-.9-2-2v-3Z",fill:n.VL[80]}),(0,o.jsx)("path",{d:"M22 13H7v5h15v-5Z",fill:"#885EDE"}),(0,o.jsx)("path",{d:"M15 8H0v5h15V8Z",fill:"#C689E6"}),(0,o.jsx)("path",{d:"M7 13H0v5h7v-5Zm8-5h5c1.1 0 2 .9 2 2v3h-7V8Z",fill:"#AA72E1"}),(0,o.jsx)("path",{d:"M0 16.43V18h1.57C.7 18 0 17.3 0 16.43Z",fill:n.VL[80]}),(0,o.jsx)("path",{d:"M0 11.43V13h1.57C.7 13 0 12.3 0 11.43Z",fill:"#AA72E1"}),(0,o.jsx)("path",{d:"M0 6.43V8h1.57C.7 8 0 7.3 0 6.43Z",fill:"#C689E6"}),(0,o.jsx)("path",{style:{mixBlendMode:"soft-light"},d:"M20 8H1.57C.7 8 0 7.29 0 6.43V21c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2Z",fill:`url(#${r})`}),(0,o.jsxs)("defs",{children:[(0,o.jsxs)("linearGradient",{id:t,x1:"-.311",y1:"5.252",x2:"12.418",y2:"15.897",gradientUnits:"userSpaceOnUse",children:[(0,o.jsx)("stop",{stopColor:n.VL[80]}),(0,o.jsx)("stop",{offset:"1",stopColor:n.DV[80]})]}),(0,o.jsxs)("linearGradient",{id:r,x1:"0",y1:"6.43",x2:"24.617",y2:"16.771",gradientUnits:"userSpaceOnUse",children:[(0,o.jsx)("stop",{stopColor:n.DV[150]}),(0,o.jsx)("stop",{offset:"1",stopColor:n.VL[80]})]})]})]})}},268861:(e,t,r)=>{r.d(t,{z:()=>n});var i=r(277277);const n=e=>(0,i.jsxs)("svg",{viewBox:"0 0 40 40",fill:"none",...e,children:[(0,i.jsx)("path",{d:"M20 7.73333C23.7556 7.73333 26.2889 9.35556 27.7333 10.7111L33.3778 5.2C29.9111 1.97778 25.4 0 20 0C12.1778 0 5.42224 4.48889 2.13335 11.0222L8.60001 16.0444C10.2222 11.2222 14.7111 7.73333 20 7.73333Z",fill:"#EA4335"}),(0,i.jsx)("path",{d:"M39.2 20.4444C39.2 18.8 39.0667 17.6 38.7778 16.3556H20V23.7778H31.0222C30.8 25.6222 29.6 28.4 26.9333 30.2667L33.2444 35.1556C37.0222 31.6667 39.2 26.5333 39.2 20.4444Z",fill:"#4285F4"}),(0,i.jsx)("path",{d:"M8.62222 23.9556C8.18524 22.6824 7.96003 21.3461 7.95556 20C7.95556 18.6222 8.2 17.2889 8.6 16.0445L2.13333 11.0222C0.732753 13.8078 0.0022342 16.8821 0 20C0 23.2222 0.777778 26.2667 2.13333 28.9778L8.62222 23.9556Z",fill:"#FBBC05"}),(0,i.jsx)("path",{d:"M20 40C25.4 40 29.9333 38.2222 33.2444 35.1556L26.9333 30.2667C25.2444 31.4444 22.9778 32.2667 20 32.2667C14.7111 32.2667 10.2222 28.7778 8.62223 23.9556L2.15556 28.9778C5.44445 35.5111 12.1778 40 20 40Z",fill:"#34A853"})]})},261946:(e,t,r)=>{r.d(t,{Y:()=>n});var i=r(277277);const n=e=>(0,i.jsxs)("svg",{id:"social--microsoft",viewBox:"0 0 40 40",fill:"none",...e,children:[(0,i.jsx)("path",{fill:"#f35325",d:"M2 2h17v17H2z"}),(0,i.jsx)("path",{fill:"#81bc06",d:"M21 2h17v17H21z"}),(0,i.jsx)("path",{fill:"#05a6f0",d:"M2 21h17v17H2z"}),(0,i.jsx)("path",{fill:"#ffba08",d:"M21 21h17v17H21z"})]})},449467:(e,t,r)=>{r.d(t,{$:()=>a,h:()=>c});var i=r(26985),n=r(453001),o=r(239545),s=r(277277);const a={enter:400,exit:400},c=({backdrop:e=o.D,children:t,container:r,mountNode:c,disablePortal:l,hideBackdrop:d,open:u,transitionDuration:h=a,...p})=>{const[m,f,g]=function(e,t,{onEnter:r,onExit:n,onExited:o,...s}){const[a,c]=(0,i.useState)(!0),l=function(e){return!!e&&"enter"in e.props}(t),d=!e&&(a||!l),u=!e&&!a,h=e&&a;(0,i.useEffect)((()=>{h&&(r&&r(),c(!1)),u&&n&&n()}),[h,u,n,r]);const p=l?function(e,t){return{onExited:e,...t}}((()=>{c(!0),o&&o()}),s):{};return[d,l,p]}(u,t,p);return m?null:(0,s.jsxs)(n.Z,{container:r,mountNode:c,disablePortal:l,children:[d?null:(0,s.jsx)(e,{animate:f,open:u,duration:h}),(0,i.cloneElement)(t,g)]})}},239545:(e,t,r)=>{r.d(t,{D:()=>s});var i=r(191025),n=r(140169),o=r(659636);const s=n.I.div.attrs({"aria-hidden":!0,"data-testid":"overlay-backdrop"})`
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: ${i.h};
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(10px);
    animation-name: ${({open:e})=>e?o.z.enter:o.z.exit};
    animation-duration: ${({open:e,duration:t})=>e?t.enter:t.exit}ms;
    animation-iteration-count: ${({animate:e})=>e?1:0};
    animation-fill-mode: forwards;
`},453001:(e,t,r)=>{r.d(t,{Z:()=>s});var i=r(126968),n=r(26985);const o="references",s=({children:e,container:t,mountNode:r,disablePortal:s})=>{const a=(e=>{const t=e?function(e){const t=document.getElementById(e);if(t)return t;const r=document.createElement("div");return r.setAttribute("id",e),r.setAttribute(o,"0"),r.setAttribute("data-testid","portal-outlet"),document.body.appendChild(r),r}(`portal-outlet-${e}`):document.body;return(0,n.useEffect)((()=>{if(e)return(e=>{const t=Number(e.getAttribute(o)||0)+1;e.setAttribute(o,String(t))})(t),()=>{(e=>{const t=Math.max(0,Number(e.getAttribute(o)||1)-1);t<=0?e.remove():e.setAttribute(o,String(t))})(t)}}),[e]),t})(t);return s?e:(0,i.createPortal)(e,r||a)}},674303:(e,t,r)=>{r.d(t,{y:()=>u});var i=r(804185),n=r(674871),o=r(140169),s=r(148405),a=r(277277);const c=(0,i.i7)(["0%{stroke-dashoffset:116;transform:rotate(50deg);}50%{stroke-dashoffset:276;transform:rotate(630deg);}100%{stroke-dashoffset:116;transform:rotate(1130deg);}"]),l=o.I.div`
    display: block;
    object-fit: contain;
    stroke-dasharray: 276.32;
    stroke-dashoffset: 0;
    animation: ${c} 2.5s ease-in-out infinite;
    transform-origin: center;
    width: 100%;
    height: 100%;
`,d=o.I.svg`
    display: flex;
`,u=({className:e,gradientEnd:t,gradientStart:r,strokeWidth:i=16})=>{const o=(0,s.CY)();return r=r||o?.palette?.primary?.normal||n.VL[80],t=t||o?.palette?.primary?.dark||n.VL[60],(0,a.jsx)(l,{className:e,children:(0,a.jsxs)(d,{width:"100%",height:"100%",viewBox:"0 0 88 88",children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"linear",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,a.jsx)("stop",{offset:"0%",stopColor:r}),(0,a.jsx)("stop",{offset:"100%",stopColor:t})]})}),(0,a.jsx)("circle",{fill:"none",strokeWidth:i,strokeLinecap:"round",stroke:"url(#linear)",cx:"44",cy:"44",r:"36"})]})})}},656284:(e,t,r)=>{r.d(t,{H:()=>p});var i=r(123398),n=r(26985),o=r(804185),s=r(652213),a=r(422226),c=r(140169),l=r(148405),d=r(277277);const u=c.I.button`
    display: flex;
    justify-content: center;
    align-items: center;
    width: 1.375rem;
    height: 1.375rem;
    padding: 0;
    border: none;
    border-radius: 100%;
    color: ${({color:e})=>(0,l.yW)(70,e)};
    background: ${({color:e,backgroundPalette:t})=>t?t.color:(0,l.yW)(140,e)};
    transition: all linear 150ms;
    cursor: pointer;

    &:hover,
    &:active {
        background: ${({color:e,backgroundPalette:t})=>t?t.hoverColor:(0,l.yW)(130,e)};
    }
`,h=c.I.div`
    display: flex;
    justify-content: center;
    align-items: center;
    width: 1.625rem;
    height: 1.625rem;
    border-radius: 100%;
    margin-left: 0.625rem;
`,p=({color:e,backgroundPalette:t,timeout:r,onClose:c})=>{const l=(0,n.useContext)(o.Dx),[p,m]=(0,n.useState)(0),f=(0,s.q)(),g=(0,a.Z)((()=>{c?.()})),A=t?t.color:l.palette[e][140];return(0,n.useEffect)((()=>{!function(e,t,r,i){let n,o=null;const s=a=>{o||(o=a);const c=(a-o)/e;t.current&&r(360*c),c<1?n=requestAnimationFrame(s):void 0!==i&&i()};requestAnimationFrame(s)}(r,f,m,g)}),[r,f,g]),(0,d.jsx)(h,{style:{background:`conic-gradient(\n        ${A} 0,\n        ${A} ${p}deg,\n        ${l.palette[e][70]} ${p}deg\n    )`},children:(0,d.jsx)(u,{color:e,backgroundPalette:t,onClick:c,children:(0,d.jsx)(i.ojm,{"aria-hidden":!0})})})}},676653:(e,t,r)=>{r.d(t,{t:()=>F,d:()=>P});var i=r(26985),n=r(422226),o=r(191025),s=r(449467),a=r(659636),c=r(953823),l=r(533547),d=r.n(l),u=r(674871),h=r(140169),p=r(148405),m=r(178560),f=r(656284),g=r(277277);const A=h.I.div`
    display: flex;
    min-width: 18.75rem;
    padding: 0.875rem 1rem;
    background: ${({color:e})=>(0,p.yW)(140,e)};
    border: 1px solid ${({color:e})=>(0,p.yW)(130,e)};
    box-shadow: 0 0.25rem 0.625rem rgba(28, 28, 40, 0.3);
    border-radius: 0.3125rem;
    width: fit-content;
    align-items: center;

    &.visuallyHidden {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
    }
`,v=h.I.div`
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: space-around;
`,y=h.I.div`
    font-style: normal;
    font-weight: 600;
    font-size: 0.875rem;
    line-height: 120%;
    color: ${u.mb[24]};
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    word-break: break-all;
`,b=h.I.div`
    color: ${u.mb[24]};
    font-style: normal;
    font-weight: normal;
    font-size: 0.875rem;
    line-height: 1.25rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    word-break: normal;
`,w=h.I.button`
    background: ${({color:e})=>(0,p.yW)(160,e)};
    border: none;
    border-radius: 0.25rem;
    padding: 0.125rem 0.5rem;
    color: ${u.mb[24]};
    font-style: normal;
    font-weight: 600;
    font-size: 0.875rem;
    cursor: pointer;
    transition: all linear 150ms;
    white-space: nowrap;
    outline: none !important; // Chrome
    margin-left: 0.625rem;
    &:hover {
        background: ${({color:e})=>(0,p.yW)(160,e)};
    }
    &:active {
        background: ${({color:e})=>(0,p.yW)(130,e)};
    }
`,x=({title:e,message:t,category:r="primary",buttonText:n,onClick:o,timeout:s,onClose:a,disableFocusTrap:c,srOnly:l,assertive:u,...h})=>{"default"===r&&(r="primary");const p=(0,i.useRef)(null);return(0,m.r)(p,{disabled:c}),(0,g.jsxs)(A,{color:r,className:d()({visuallyHidden:l}),ref:p,...h,children:[(0,g.jsxs)(v,{"aria-live":"error"===r||u?"assertive":"polite",role:"error"===r||u?"alert":"status",children:[!!e&&(0,g.jsx)(y,{children:e}),!!t&&(0,g.jsx)(b,{children:t})]}),!!n&&o&&(0,g.jsx)(w,{color:r,onClick:()=>o(),children:n}),!!s&&a&&(0,g.jsx)(f.H,{color:r,timeout:s,onClose:a})]})},S={horizontal:"start",vertical:"end"};let T=0;const C={showing:[],toasts:[]};function _(e,t){switch(t.type){case"show":return{showing:[...e.showing,t.config.id],toasts:[...e.toasts,t.config]};case"hide":return{...e,showing:e.showing.filter((e=>e!==t.id))};case"hideAll":return{...e,showing:[]};case"remove":return{...e,toasts:e.toasts.filter((e=>e.id!==t.id))};default:return e}}const k=(0,i.createContext)(void 0);function E(e){const t="number"==typeof e.horizontal?{left:e.horizontal}:"start"===e.horizontal?{left:"1.25rem"}:"center"===e.horizontal?{left:"50%",transform:"translateX(-50%)"}:{right:"1.25rem"},r="number"==typeof e.vertical?{top:e.vertical}:"start"===e.vertical?{top:"1.25rem"}:"center"===e.vertical?{top:"50%",transform:t.transform?"translate(-50%, -50%)":"translateY(-50%)"}:{bottom:"1.25rem"};return{position:"fixed",zIndex:o.h,...t,...r}}const I=({children:e,position:t,...r})=>(0,g.jsx)("div",{style:E(t),children:(0,g.jsx)(c.e,{...r,children:e})}),R=({open:e,transition:t=a.z,transitionDuration:r=s.$,position:i=S,onExited:n,...o})=>(0,g.jsx)(s.h,{open:e,transitionDuration:r,hideBackdrop:!0,onExited:n,children:(0,g.jsx)(I,{position:i,enter:e,duration:r,transition:t,children:(0,g.jsx)(x,{...o})})}),F=({children:e})=>{const[t,r]=(0,i.useReducer)(_,C),n=(e,t)=>()=>{r({type:"hide",id:e}),t&&t()},o=e=>()=>r({type:"remove",id:e});return(0,g.jsxs)(k.Provider,{value:r,children:[e,t.toasts.map((({id:e,...r})=>(0,g.jsx)(R,{open:t.showing.includes(e),disableFocusTrap:!0,onExited:o(e),...r,onClose:n(e,r.onClose)},e)))]})};function P(){const e=(0,i.useContext)(k);if(!e)throw new Error("No toast provider");const t=(0,n.Z)((t=>{const r="toast-"+T++;return e({type:"show",config:{id:r,...t}}),r})),r=(0,n.Z)((t=>e({type:"hide",id:t})));return[t,r,(0,n.Z)((()=>e({type:"hideAll"})))]}},659636:(e,t,r)=>{r.d(t,{z:()=>n});var i=r(804185);const n={enter:(0,i.i7)(["from{opacity:0;}to{opacity:1;}"]),exit:(0,i.i7)(["from{opacity:1;}to{opacity:0;}"])}},953823:(e,t,r)=>{r.d(t,{e:()=>c});var i=r(26985),n=r(140169),o=r(277277);const s=n.I.div.attrs({role:"presentation"})`
    animation-name: ${({enter:e,transition:t})=>e?t.enter:t.exit};
    animation-duration: ${({enter:e,duration:t})=>e?t.enter:t.exit}ms;
    // this to prevent blinking on the end of exit animation
    animation-fill-mode: ${({enter:e})=>e?"none":"forwards"};
`,a=(e,t,r,i)=>n=>n.animationName===e?r&&r():n.animationName===t?i&&i():void 0,c=(0,i.forwardRef)((({children:e,onEntering:t,onEntered:r,onExiting:i,onExited:n,...c},l)=>{const d=a(c.transition.enter.getName(),c.transition.exit.getName(),t,i),u=a(c.transition.enter.getName(),c.transition.exit.getName(),r,n);return(0,o.jsx)(s,{...c,onAnimationStart:d,onAnimationEnd:u,ref:l,children:e})}));c.displayName="Transition"},356735:(e,t,r)=>{r.d(t,{o:()=>c});var i=r(26985),n=r(804185);const o={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",body:"p",label:"span",semibold:"p"},s={h1:[],h2:[],h3:[],h4:[],h5:[],body:["smallest","smaller","small","normal","large"],label:["small","normal","large"],semibold:["smallest","smaller","small","normal","large"]},a=({variant:e="body",size:t="normal",color:r,palette:a="text",component:c,children:l,style:d,className:u,...h},p)=>{const m=(0,i.useContext)(n.Dx);let f;return f=t&&s[e].includes("normal")?{...m.typography[e][t]}:{...m.typography[e]},r&&(f.color=m.palette[a][r]),d&&(f={...f,...d}),(0,i.createElement)(c??o[e],{style:f,ref:p,className:u,...h},l)},c=(0,i.forwardRef)(a)},178560:(e,t,r)=>{r.d(t,{r:()=>s});var i=r(547838),n=r(26985),o=r(422226);function s(e,t={}){const r=(0,n.useRef)(void 0),s=(0,n.useRef)(document.activeElement),a=(0,o.Z)((()=>{r.current?.deactivate({returnFocus:t.returnFocusOnDestroy})}));(0,n.useEffect)((()=>{const{current:n}=e;if(n&&!0!==t.disabled){const{disabled:e,...o}=t,c=i.K(n,{...o,setReturnFocus:t.setReturnFocus||s.current,fallbackFocus:n});return r.current=c,c.activate(),a}}),[]),(0,n.useEffect)((()=>{t.disabled?r.current?.pause():r.current?.unpause()}),[t.disabled])}},180208:(e,t,r)=>{r.d(t,{TG:()=>a,Y8:()=>o,vC:()=>s,vw:()=>c});var i=r(154258),n=r(26985);const o=["all","dialog","editor","fullscreen stage","crop","media preview dialog"],s=({keys:e,scope:t},r)=>{(0,n.useEffect)((()=>((0,i.A)(e,{scope:t},r),()=>i.A.unbind(e,t,r))),[e,t,r])},a=e=>{i.A.setScope(e)},c=()=>{const e=i.A.getScope();if((e=>o.includes(e))(e))return e;throw new Error("Invalid hotkey scope")}},265845:(e,t,r)=>{r.d(t,{o:()=>n});var i=r(26985);function n(e,t,r=[]){(0,i.useEffect)((()=>{const r=r=>{r.code===e&&t(r)};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)}),[e,t,...r])}},457521:(e,t,r)=>{r.d(t,{w:()=>s});var i=r(26985);const n="undefined"!=typeof document?document.body:void 0,o={current:0};function s(e=n){const t=(0,i.useRef)({overflow:"auto",paddingRight:null});(0,i.useLayoutEffect)((()=>{if(e){if(!o.current){const{overflow:r,paddingRight:i}=window.getComputedStyle(e);t.current={overflow:r,paddingRight:i}}o.current++;const r=function(e){return window.innerWidth-e.clientWidth}(e);return e.style.overflow="hidden",e.style.paddingRight=0===r?e.style.paddingRight:`${r}px`,()=>{o.current--,o.current||(e.style.overflow=t.current.overflow,e.style.paddingRight=t.current.paddingRight??"")}}}),[e])}},450348:(e,t,r)=>{r.d(t,{D:()=>o});var i=r(396259);const n=16;function o(e){return(0,i.D0)(e,n)}},140169:(e,t,r)=>{r.d(t,{I:()=>i});const i=r(804185).Ay},362933:(e,t,r)=>{r.d(t,{aj:()=>a,qW:()=>c,zv:()=>s});var i=r(396259),n=r(674871),o=r(450348);const s={themeName:"Base theme",palette:{text:{darker:n.mb[44],dark:n.mb[84],normal:n.pw.white,light:n.pw.white,lighter:n.pw.white},primary:{...n.VL,darker:n.VL[40],dark:n.VL[60],normal:n.VL[80],light:n.VL[90],lighter:n.VL[110]},secondary:{...n.aM,darker:n.aM[80],dark:n.aM[90],normal:n.aM[130],light:n.aM[140],lighter:n.aM[150]},accent:{...n.aw,darker:n.aw[50],dark:n.aw[80],normal:n.aw[100],light:n.aw[110],lighter:n.aw[140]},success:{...n.aM,darker:n.aM[80],dark:n.aM[90],normal:n.aM[130],light:n.aM[140],lighter:n.aM[150]},error:{...n.aw,darker:n.aw[50],dark:n.aw[80],normal:n.aw[100],light:n.aw[110],lighter:n.aw[140]}},borderRounding:"5px",shadows:{lighter:"0px 4px 8px rgba(28, 28, 40, 0.1), 0px 0px 2px rgba(28, 28, 40, 0.1)",light:"0px 8px 16px rgba(28, 28, 40, 0.15), 0px 0px 2px rgba(28, 28, 40, 0.15)",normal:"0px 8px 16px rgba(28, 28, 40, 0.25), 0px 0px 2px rgba(28, 28, 40, 0.2)",dark:"0px 16px 32px rgba(28, 28, 40, 0.1), 0px 2px 4px rgba(28, 28, 40, 0.05)",darker:"0px 2px 4px rgba(28, 28, 40, 0.1), 0px 16px 32px rgba(28, 28, 40, 0.2)",darkest:"0px 16px 32px rgba(28, 28, 40, 0.25), 0px 2px 4px rgba(28, 28, 40, 0.15)"},background:{dark:"#17171E",normal:"#1C1C26",light:"#272731"},scrollbar:n.mb[36],typography:{h1:{fontSize:(0,o.D)("36px"),lineHeight:"120%",fontWeight:600,textTransform:"none"},h2:{fontSize:(0,o.D)("32px"),lineHeight:"120%",fontWeight:600,textTransform:"none"},h3:{fontSize:(0,o.D)("28px"),lineHeight:"120%",fontWeight:600,textTransform:"none"},h4:{fontSize:(0,o.D)("24px"),lineHeight:"120%",fontWeight:600,textTransform:"none"},h5:{fontSize:(0,o.D)("20px"),lineHeight:"120%",fontWeight:600,textTransform:"none"},body:{smallest:{fontSize:(0,o.D)("10px"),lineHeight:"120%",textTransform:"none"},smaller:{fontSize:(0,o.D)("12px"),lineHeight:"120%",textTransform:"none"},small:{fontSize:(0,o.D)("14px"),lineHeight:"120%",textTransform:"none"},normal:{fontSize:(0,o.D)("16px"),lineHeight:"120%",textTransform:"none"},large:{fontSize:(0,o.D)("18px"),lineHeight:"120%",textTransform:"none"}},label:{small:{fontSize:(0,o.D)("10px"),lineHeight:"120%",fontWeight:600,textTransform:"uppercase"},normal:{fontSize:(0,o.D)("12px"),lineHeight:"120%",fontWeight:600,textTransform:"uppercase"},large:{fontSize:(0,o.D)("14px"),lineHeight:"120%",fontWeight:600,textTransform:"uppercase"}},semibold:{smallest:{fontSize:(0,o.D)("10px"),lineHeight:"120%",fontWeight:600,textTransform:"none"},smaller:{fontSize:(0,o.D)("12px"),lineHeight:"120%",fontWeight:600,textTransform:"none"},small:{fontSize:(0,o.D)("14px"),lineHeight:"120%",fontWeight:600,textTransform:"none"},normal:{fontSize:(0,o.D)("16px"),lineHeight:"120%",fontWeight:600,textTransform:"none"},large:{fontSize:(0,o.D)("18px"),lineHeight:"120%",fontWeight:600,textTransform:"none"}}},overrides:{skeleton:{start:n.mb[16],end:n.mb[12]},slider:{track:{baseBackground:n.mb[24],filledBackground:n.VL[90]}}}},a={...s,themeName:"Dark",overrides:{...s.overrides,select:{backgroundActive:"#2B2947",border:n.mb[36],borderHover:n.mb[68],optionsBackground:n.mb[12],optionsBackgroundHover:n.mb[24],placeholder:n.mb[68],searchPlaceholder:n.pw.white,searchPlaceholderActive:n.mb[44]},textInput:{placeholder:n.mb[68],placeholderActive:n.mb[36],border:n.mb[36],borderHover:n.mb[68]},tabs:{divider:n.mb[30]},acrylicSurface:{background:(0,i.B3)(n.pw.black,.26),tintBackground:(0,i.B3)(n.mb[18],.8),border:(0,i.B3)(n.pw.black,.2),hoverBackground:(0,i.B3)(n.pw.white,.06),text:n.pw.white,textDisabled:(0,i.B3)(n.pw.white,.36),textHint:(0,i.B3)(n.pw.white,.76)}}},c={...s,themeName:"Light",palette:{...s.palette,text:{darker:n.mb[12],dark:n.mb[12],normal:n.mb[24],light:n.mb[30],lighter:n.mb[36]}},background:{dark:n.mb[76],normal:n.mb[96],light:n.pw.white},scrollbar:n.mb[68],overrides:{...s.overrides,skeleton:{start:n.mb[90],end:n.mb[96]},slider:{track:{baseBackground:n.mb[90],filledBackground:n.VL[80]}},select:{backgroundActive:n.mb[96],border:n.mb[84],borderHover:n.mb[44],optionsBackground:n.pw.white,optionsBackgroundHover:n.mb[96],placeholder:n.mb[36],searchPlaceholder:n.mb[36],searchPlaceholderActive:n.mb[44]},textInput:{border:n.mb[44],borderHover:n.mb[24],placeholder:n.mb[30],placeholderActive:n.mb[30]},acrylicSurface:{background:(0,i.B3)(n.pw.white,.3),tintBackground:(0,i.B3)(n.pw.white,.45),border:(0,i.B3)(n.pw.black,.06),hoverBackground:(0,i.B3)(n.pw.black,.04),text:n.pw.black,textDisabled:(0,i.B3)(n.pw.black,.36),textHint:(0,i.B3)(n.pw.black,.6)}},typography:{...s.typography}}},148405:(e,t,r)=>{r.d(t,{CY:()=>d,mt:()=>l,yW:()=>c});var i=r(100571),n=r.n(i),o=r(396259),s=r(26985),a=r(804185);const c=(e="normal",t="primary",r)=>i=>{const n="background"===t?i.theme.background[e]:i.theme.palette[t][e];return void 0!==r?(0,o.B3)(n,r):n},l=e=>t=>n()(t.theme.overrides,e,"")??"";function d(){return(0,s.useContext)(a.Dx)||{}}},540076:(e,t,r)=>{r.d(t,{vA:()=>o,xb:()=>s});var i=r(650882);class n extends Error{constructor(e){super(e?`AssertionError: ${e}`:"AssertionError: Assertion failed")}}function o(e,t){if(!e){const e=new n(t);throw(0,i.JQ)(e),e}}function s(e,t="Unexpected value. Should have been never."){const r=new n(t);throw(0,i.JQ)(r),r}},871287:(e,t,r)=>{r.d(t,{FG:()=>c,gm:()=>a,wr:()=>s});var i=r(696267);const n=65536,o=204800;async function s(e){if(e.size<o)return(0,i.d)(await a(e));const t=Math.floor(e.size/2)-n/2,r=e.slice(0,n),s=e.slice(t,t+n),c=e.slice(-n),l=new Blob([r,s,c]),d=await a(l);return(0,i.d)(d)}function a(e){return"function"==typeof e.arrayBuffer?e.arrayBuffer():new Promise(((t,r)=>{const i=new FileReader;i.onload=()=>{t(i.result)},i.onerror=t=>{console.error(`Error reading ${e.size}-byte blob`,t),r(new Error("Error reading blob"))},i.onabort=t=>{console.error(`Reading ${e.size}-byte blob was aborted`,t),r(new Error("Reading blob aborted"))},i.readAsArrayBuffer(e)}))}function c(e){return"function"==typeof e.text?e.text():new Promise(((t,r)=>{const i=new FileReader;i.onload=()=>{t(i.result)},i.onerror=()=>r(new Error(`Failed to read blob as text. Blob size: ${e.size}`)),i.onabort=()=>r(new Error("Aborted reading blob as text")),i.readAsText(e)}))}},696267:(e,t,r)=>{async function i(e){return async function(e){const t=await crypto.subtle.digest("SHA-256",e);return[...new Uint8Array(t)].map((e=>e.toString(16).padStart(2,"0"))).join("")}(new Uint8Array(e))}r.d(t,{d:()=>i}),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218)},847269:(e,t,r)=>{r.d(t,{T9:()=>u,iY:()=>l,sw:()=>d,wT:()=>c});var i=r(540076),n=r(650882),o=r(776016);let s="ignore",a=console.error;function c(e,t){s=e,a=t}function l(e,t){try{(0,i.vA)((0,o.O9)(e),t)}catch(e){throw e instanceof Error&&(0,n.JQ)(e),e}}function d(e,t){try{return l(e,t),e}catch(e){throw e instanceof Error&&(0,n.JQ)(e),e}}function u(e,t){if("ignore"===s)return e;try{return l(e,t),e}catch(t){if(t instanceof Error&&(0,n.JQ)(t),"throw"===s)throw t;return"log"===s&&a(t),e}}},770202:(e,t,r)=>{r.d(t,{h:()=>n});const i=.001;function n(e,t,r=i){return Math.abs(e-t)<=r}},650882:(e,t,r)=>{r.d(t,{A3:()=>a,JQ:()=>l,Op:()=>d,eP:()=>u,g9:()=>s,xM:()=>c});var i=r(324586),n=r(776016),o=r(7089);class s extends Error{static fromUnknownError(e,t,r,i){if(e instanceof s){if(void 0===r)return e;const t=new s(e.message,{...e.context,...r});return d(t,e),t}if(e instanceof Error){const t=new s(e.message,r);return d(t,e),t}let o;if((0,n.Kg)(e))o=e;else try{o=JSON.stringify(e)}catch{o=String(e)}return new s(t,{...r,originalError:o},i)}static fromSerialized(e){const t=new s(e.message,e.context,e.safeToLog);return t.stack=e.stack,t}constructor(e,t,r){super(e),(0,i.A)(this,"correlationId",void 0),this.context=t,this.safeToLog=r,this.correlationId=(0,o.u)()}toEventProperties(){const e={};for(const[t,r]of Object.entries(this.context??{}))((0,n.Kg)(r)||(0,n.Et)(r))&&(e[t]=r);return e}serialize(){return{message:this.message,stack:this.stack,context:this.toEventProperties(),safeToLog:this.safeToLog}}get errorCode(){return this.context?.errorCode}get errorMessage(){return this.message}get errorContext(){}}function a(e){return e instanceof s}function c(e,t){return e instanceof Error?e:s.fromUnknownError(e,t)}function l(e){if(e.stack){const[t,,...r]=e.stack.split("\n");e.stack=[t,...r].join("\n")}}function d(e,t){if(void 0===e.stack)e.stack=t.stack;else if(void 0!==t.stack){const[r]=e.stack.split("\n"),[,...i]=t.stack.split("\n");e.stack=[r,...i].join("\n")}}class u extends TypeError{constructor(e){super(e)}}},776016:(e,t,r)=>{r.d(t,{$H:()=>S,Et:()=>d,GB:()=>m,Gv:()=>s,H7:()=>g,K0:()=>f,Kg:()=>a,Lm:()=>u,O9:()=>c,RI:()=>_,Sd:()=>T,T:()=>A,VA:()=>w,_j:()=>b,cy:()=>h,eB:()=>x,ey:()=>y,gH:()=>v,t9:()=>C,u:()=>l,wW:()=>p}),r(379321);var i=r(897868);function n(e,t){return(0,i.c)(t)?t.push(e):void 0}function o(e){if("object"==typeof e){if(Array.isArray(e))return"array";if(null==e)return`${e}`;if(e instanceof Date)return"date";if(e instanceof RegExp)return"RegExp"}return typeof e}function s(e,t){const r=c(e)&&"object"==typeof e&&!Array.isArray(e);return!r&&(0,i.c)(t)&&t.fail("object",o(e)),r}function a(e,t){const r="string"==typeof e;return!r&&(0,i.c)(t)&&t.fail("string",o(e)),r}function c(e,t){const r=null!=e;return!r&&(0,i.c)(t)&&t.fail("to be defined",`${e}`),r}function l(...e){return(t,r)=>{const n=e.includes(t);if(!n&&(0,i.c)(r)){const i=["string","boolean","number"].includes(typeof t)?`${t}`:o(t);r.fail(`one of ${e.join(",")}`,`(${o(t)}) ${i}`)}return n}}function d(e,t){const r="number"==typeof e;return!r&&(0,i.c)(t)&&t.fail("number",o(e)),r}function u(e,t){const r="boolean"==typeof e;return!r&&(0,i.c)(t)&&t.fail("boolean",o(e)),r}function h(e,t){const r=Array.isArray(e);return!r&&(0,i.c)(t)&&t.fail("array",o(e)),r}function p(e){return!0}function m(e){return!0}function f(e,t,r){if(!s(e))return(0,i.c)(r)&&r.fail("object",o(e)),!1;let a=!0;for(const o in t){const s=t[o],c=n(o,r);if(s&&!s(e[o],c)){if(!(0,i.c)(r))return!1;a=!1}}return a}function g(e){return(t,r)=>void 0===t||e(t,r)}function A(e){return(t,r)=>null==t||e(t,r)}function v(e){return(t,r)=>null===t||e(t,r)}function y(...e){return(t,r)=>{for(const r of e)if(r(t))return!0;return(0,i.c)(r)&&e.forEach(((e,i)=>{const n=r.push(`UnionGuard.${i}`);e(t,n)})),!1}}function b(e){return(t,r)=>Array.isArray(t)&&t.every(((t,i)=>{const o=n(i,r);return e(t,o)}))}function w(e,t){return(r,i)=>Array.isArray(r)&&r.length===t&&r.every(((t,r)=>{const o=n(r,i);return e(t,o)}))}function x(e){return(t,r)=>s(t)&&Object.keys(t).every((i=>{const o=n(i,r);return e(t[i],o)}))}function S(e,t){return(r,i)=>r instanceof Map&&[...r].every((([r,o])=>{const s=n(r,i);return e(r)&&t(o,s)}))}function T(e,t){return(r,i)=>r instanceof Object&&Object.entries(r).every((([r,o])=>{const s=n(r,i);return e(r)&&t(o,s)}))}function C(e){return(t,r)=>f(t,e,r)}function _(e){return s(e)&&0===Object.keys(e).length}},956074:(e,t,r)=>{r.d(t,{V:()=>o});const i=3,n=1500;function o(e,t=i,r=n){return async function n(){try{return await e()}catch(e){if(!t--)throw e;return await function(e){return new Promise((t=>{setTimeout(t,e)}))}((o=r,s=i-t,o*s*s)),n()}var o,s}}},615101:(e,t,r)=>{r.d(t,{N7:()=>a,aK:()=>c,vU:()=>s});var i=r(650882);const n="<safe>",o="</safe>";function s(e){return e instanceof i.g9?!0===e.safeToLog?s(e.message):e.message:`${n}${e}${o}`}function a(e){return!(e.length<n.length+o.length)&&e.slice(0,Math.max(0,n.length))===n&&e.slice(Math.max(0,e.length-o.length))===o}function c(e){return a(e)?e.substring(n.length,e.length-o.length):e}},637519:(e,t,r)=>{function i(e,t){const r=Object.assign({},e);return Array.isArray(t)?t.forEach((e=>{delete r[e]})):delete r[t],r}r.d(t,{c:()=>i})},885935:(e,t,r)=>{r.d(t,{Y:()=>s});var i=r(324586);async function n(e,t,r){try{return(await e.batchPromise)[r]}catch(t){if(1===e.associatedRequests.length)throw console.error("Only one job was included in batch, failing the batch job",t),t}return await async function(e,t){try{return(await e([t.executionArgument],t.progressCallback))[0]}catch(e){throw console.error("Error running individual job of batch",t.executionArgument,e),e}}(e.executionFunction,t)}r(379321);var o=r(563696);class s{constructor(e,t){(0,i.A)(this,"queuedBatches",[]),(0,i.A)(this,"leaderFollower",new o.$),this.executionFunction=e,this.maxJobsLimitOverride=t}enqueueForBatchExecution(e,t){const r={executionArgument:e,progressCallback:t},i=function(e,t,r){const i=e.at(-1);if(void 0!==i&&i.associatedRequests.length<(r??5)){const e=i.associatedRequests.length;return i.associatedRequests.push(t),n(i,t,e)}}(this.queuedBatches,r,this.maxJobsLimitOverride);return i||function(e,t,r,i){const o={executionFunction:i,associatedRequests:[t],batchPromise:new Promise((()=>{}))};return e.push(o),o.batchPromise=r.enqueuePromise((async()=>{e.splice(e.indexOf(o),1);try{return await i(o.associatedRequests.map((e=>e.executionArgument)),((e,t)=>o.associatedRequests.forEach((r=>r.progressCallback(e,t)))))}catch(e){throw console.warn(`Error while running batch job of ${o.associatedRequests.length} jobs, now running jobs individually instead`,e),e}})),n(o,t,0)}(this.queuedBatches,r,this.leaderFollower,this.executionFunction)}discardBatches(){this.leaderFollower.discardQueued(),this.queuedBatches.splice(0,this.queuedBatches.length)}}},128041:(e,t,r)=>{r.d(t,{o:()=>n});var i=r(324586);r(379321);class n{constructor(){(0,i.A)(this,"queue",[])}enqueue(e){this.queue.push(e)}dequeue(){return this.queue.shift()}dequeueAll(){return this.queue.splice(0,this.queue.length)}length(){return this.queue.length}}},563696:(e,t,r)=>{r.d(t,{$:()=>n});var i=r(324586);r(379321);class n{constructor(){(0,i.A)(this,"functionIdSequence",0),(0,i.A)(this,"queue",[]),(0,i.A)(this,"runningFunctionMetadata",void 0)}createTimedPromise(e,t=5e3,r){return new Promise(((i,n)=>{this.enqueueFunction((async o=>{const s=t>0?setTimeout((()=>{o(),n(new Error(r||`Queued promise timed out after ${t} millis`))}),t):void 0;try{i(await new Promise(e))}catch(e){n(e)}finally{s&&clearTimeout(s),o()}}))}))}enqueuePromise(e){return this.createTimedPromise(((t,r)=>{e().then(t).catch(r)}),0)}discardQueued(){this.queue.splice(0,this.queue.length)}enqueueFunction(e){const t={id:this.functionIdSequence++,func:e};this.isIdle()?this.runFunction(t):this.queue.push(t)}getEnqueuedFunctions(){return this.queue.map((e=>e.func))}isIdle(){return!this.runningFunctionMetadata}unwindQueueRecursively(e){const t=this.queue.shift();void 0!==t?this.runFunction(t,e):this.runningFunctionMetadata=void 0}processQueueNext(e){e>10?setTimeout((()=>{this.unwindQueueRecursively(0)})):this.unwindQueueRecursively(e+1)}runFunction(e,t=0){let r=!1;this.runningFunctionMetadata=e,this.runningFunctionMetadata.func((()=>{r?console.warn(`Function ${e.id} (${e.func.name}) has already signalled completion before`):(r=!0,this.processQueueNext(t))}))}}},897868:(e,t,r)=>{r.d(t,{c:()=>o,q:()=>n});var i=r(324586);r(379321);class n{constructor(e,t=[]){(0,i.A)(this,"failures",[]),this.path=e,this.children=t}push(e){const t=new n(`${this.path}.${e}`);return this.children.push(t),t}errors(){return[...this.failures.map((e=>`${e.path}: expected ${e.expected} received ${e.received}`)),...this.children.flatMap((e=>e.errors()))]}fail(e,t){this.failures.push({path:`${this.path}`,expected:e,received:t})}}function o(e){return e instanceof n}},118221:(e,t,r)=>{r.d(t,{h:()=>n});var i=r(776016);function n(e,t){if(Object.is(e,t))return!0;if(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every(((e,r)=>e===t[r])))return!0;if((0,i.Gv)(e)&&(0,i.Gv)(t)){for(const r in e)if(!Object.prototype.hasOwnProperty.call(t,r))return!1;for(const r in t)if(!Object.prototype.hasOwnProperty.call(e,r)||!Object.is(e[r],t[r]))return!1;return!0}return!1}},491457:(e,t,r)=>{function i(e,t,r){const i=performance.now();let n;try{n=e()}catch(e){throw r?.(performance.now()-i,e),e}return o=n,Boolean(o&&"function"==typeof o.then)?n.then((e=>(t(performance.now()-i,e),e))).catch((e=>{throw r?.(performance.now()-i,e),e})):(t(performance.now()-i,n),n);var o}function n(e,t){return(...r)=>i((()=>e(...r)),((e,i)=>{t.runOnFulfilled?.(e,r,i)}),((e,i)=>{t.runOnRejected?.(e,r,i)}))}r.d(t,{AR:()=>o,h0:()=>n});const o=e=>(t,r,n)=>{const o=n.value;if(!o)throw new Error("Decorated method is undefined");return n.value=function(...t){return i((()=>o.apply(this,t)),((r,i)=>{e.runOnFulfilled?.(r,t,i)}),((r,i)=>{e.runOnRejected?.(r,t,i)}))},n}},450139:(e,t,r)=>{function i(e,t,r){let i;const n=new Promise(((e,n)=>{i=self.setTimeout((()=>{n(new Error(r||`Promise timed out after ${t} millis`))}),t)}));return Promise.race([new Promise(e),n]).finally((()=>{i&&self.clearTimeout(i)}))}r.d(t,{d:()=>i})},360747:(e,t,r)=>{r.d(t,{w:()=>n});var i=r(776016);function n(e){return(t,r,n)=>{const o=n.value;if(!o)throw new Error("Decorated method is undefined");return n.value=function(...t){if((0,i.O9)(e.bypassTimer)&&e.bypassTimer())return o.apply(this,t);const r=e.timeoutS(t);let n;const s=new Promise(((i,o)=>{n=setTimeout((()=>{o(e.makeError(r,t))}),1e3*r)}));return Promise.race([s,o.apply(this,t)]).finally((()=>clearTimeout(n)))},n}}},53338:(e,t,r)=>{r.d(t,{r:()=>i});const i=(...e)=>e},7089:(e,t,r)=>{r.d(t,{O:()=>a,u:()=>s});var i=r(711417),n=r(113589),o=r(356931);function s(){return(0,i.A)()}function a(e){return(0,n.A)(e)&&4===(0,o.A)(e)}},85759:(e,t,r)=>{function i(e,t){return new Promise((r=>{setTimeout((()=>r(t)),e)}))}r.d(t,{u:()=>i})},387427:(e,t,r)=>{r.d(t,{Aq:()=>o,BP:()=>l,D8:()=>i,HJ:()=>c,Pn:()=>n,lf:()=>a,sQ:()=>s}),r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);const i=1024,n=10,o=.05,s=44100,a=-80,c=-10,l=new Uint8Array(i)},104455:(e,t,r)=>{r.d(t,{aW:()=>o,qL:()=>n});var i=r(387427);function n(e){return t=function(e){return e/255*(i.HJ-i.lf)+i.lf}(e),Math.pow(10,t/20);var t}function o(e){return function(e){const t=(e-i.lf)/(i.HJ-i.lf)*255;return t<0?0:t>255?255:Math.floor(t)}(function(e){return 20*Math.log10(e)}(e))}},374380:(e,t,r)=>{r.d(t,{N:()=>n});var i=r(387427);function n(){return{waitForDataAt:()=>Promise.resolve(),trySampleDataAt:()=>i.BP}}},652870:(e,t,r)=>{r.d(t,{H:()=>o});var i=r(860784);const n=5e3;function o(e){return e.play()||(()=>{const t=new i.z,r=setTimeout((()=>{o(),t.reject(new Error(`Timeout while trying to play back media ${e.src}`))}),n);function o(){e.removeEventListener("playing",s),e.removeEventListener("error",a),e.removeEventListener("abort",c),clearTimeout(r)}function s(){o(),t.resolve()}function a(e){o(),t.reject(e?.error??new Error("Failed to play media element"))}function c(){o(),t.reject(new Error("Media playback was aborted"))}return e.addEventListener("playing",s),e.addEventListener("error",a),e.addEventListener("abort",c),t.promise})()}},632670:(e,t,r)=>{r.d(t,{m:()=>o});var i=r(324586);class n{get audioOut(){return this.gainNode}constructor(e,t,r){(0,i.A)(this,"gainNode",void 0),(0,i.A)(this,"sourceNode",void 0),this.domElement=e,this.volume=r,this.sourceNode=t.createMediaElementSource(e),this.gainNode=t.createGain(),this.sourceNode.connect(this.gainNode),this.volumeChanged()}destroy(){this.gainNode.disconnect(),this.sourceNode.disconnect()}volumeChanged(){this.gainNode.gain.setValueAtTime(this.volume,0)}}class o{get domElement(){return this.baseElement.domElement}get isLoaded(){return this.baseElement.isLoaded}get isStalled(){return this.baseElement.isStalled}get isSeeking(){return this.baseElement.isSeeking}get load(){return this.baseElement.load}get onStalledChanged(){return this.baseElement.onStalledChanged}set playbackRate(e){this.baseElement.playbackRate=e}get playbackRate(){return this.baseElement.playbackRate}set volume(e){this.audio.volume=e,this.audio.volumeChanged()}get volume(){return this.audio.volume}constructor(e,t,r,i=new n(e.domElement,r,t)){this.baseElement=e,this.audio=i}connect(e){this.audio.audioOut.connect(e)}destroy(){this.audio.destroy(),this.baseElement.destroy()}disconnect(e){this.audio.audioOut.disconnect(e)}pause(){this.baseElement.pause()}play(){return this.baseElement.play()}seek(e){return this.baseElement.seek(e)}}},702335:(e,t,r)=>{r.d(t,{_:()=>u,O:()=>h});var i=r(324586),n=r(162036),o=r(37135),s=r(652870),a=r(815731),c=r(396159);class l{setIsStalled(e){this._onStalledChanged.next(e)}constructor(e){(0,i.A)(this,"_onStalledChanged",new a.t(!0)),(0,i.A)(this,"onStalledChanged",this._onStalledChanged.pipe((0,c.F)())),(0,i.A)(this,"onCanplay",(()=>{this.setIsStalled(!1)})),(0,i.A)(this,"onWaiting",(()=>{this.domElement.seeking||this.setIsStalled(!0)})),this.domElement=e,this.domElement.onwaiting=this.onWaiting,this.domElement.oncanplay=this.onCanplay}get isStalled(){return this._onStalledChanged.getValue()}destroy(){this._onStalledChanged.complete(),this.domElement.onwaiting=null,this.domElement.oncanplay=null}}var d=r(835552);const u={};class h{get isLoaded(){return this._isLoaded}get isStalled(){return this.staller.isStalled}get isSeeking(){return this.seeker.isSeeking}set playbackRate(e){this.mediaElement.playbackRate=e,this.mediaElement.defaultPlaybackRate=e}get playbackRate(){return this.mediaElement.playbackRate}set volume(e){}get volume(){return 0}constructor(e,t,r,o,s=new d.gU(r,t),a=new l(r)){(0,i.A)(this,"load",void 0),(0,i.A)(this,"onStalledChanged",void 0),(0,i.A)(this,"_isDestroyed",!1),(0,i.A)(this,"_isLoaded",!1),this.cachedFile=e,this.metadata=t,this.mediaElement=r,this.seeker=s,this.staller=a,this.onStalledChanged=this.staller.onStalledChanged,this.mediaElement.defaultPlaybackRate=o,this.mediaElement.setAttribute("src",e.permanentUrl),this.mediaElement.setAttribute("preload","auto"),this.mediaElement.setAttribute("crossorigin","anonymous"),this.mediaElement.setAttribute("webkit-playsinline",""),this.mediaElement.setAttribute("playsinline",""),this.mediaElement.setAttribute("loop","true"),this.load=new Promise(((e,t)=>{this.onStalledChanged.pipe((0,n.$)((e=>!e))).subscribe((()=>{const r=()=>{if(this._isDestroyed)return clearInterval(i),void t(new Error("Load cancelled due to unload"));!this.isStalled&&this.hasData()&&(clearInterval(i),e())},i=setInterval(r,h.LOAD_POLL_MILLIS);r()}),t)})).then((()=>{this._isLoaded=!0,this.mediaElement instanceof HTMLVideoElement&&this.registerVideoElement(this.mediaElement)})).catch((e=>{console.warn("SaneMediaElement load failed:",e)}))}get domElement(){return this.mediaElement}connect(e){}destroy(){this.mediaElement instanceof HTMLVideoElement&&this.deregisterVideoElement(this.mediaElement),this._isDestroyed=!0,this.mediaElement.pause(),this.mediaElement.src="",this.staller.destroy(),this.seeker.destroy()}disconnect(e){}hasData(e=o.hW){const t=e(this.mediaElement.seekable);return t||console.warn("MediaElement does not have any seekable ranges: "+this.cachedFile.permanentUrl),t}pause(){this.mediaElement.pause()}play(){return(0,s.H)(this.mediaElement)}seek(e){return this.seeker.seek(e%this.mediaElement.duration)}updateVideoElementRegister(e,t){const r=e.videoWidth,i=e.videoHeight;if(0!==r&&0!==i){const e=`${r}x${i}`;e in u||(u[e]={width:r,height:i,count:0}),u[e].count=Math.max(u[e].count+t,0)}}registerVideoElement(e){this.updateVideoElementRegister(e,1)}deregisterVideoElement(e){this.updateVideoElementRegister(e,-1)}}(0,i.A)(h,"LOAD_POLL_MILLIS",200)},835552:(e,t,r)=>{r.d(t,{gU:()=>a});var i=r(324586),n=r(860784);class o extends Error{}const s=1/120;class a{get isSeeking(){return void 0!==this.currentSeekOperation}constructor(e,t){(0,i.A)(this,"mediaStartSecs",void 0),(0,i.A)(this,"onSeekedCallback",void 0),(0,i.A)(this,"onErrorCallback",void 0),(0,i.A)(this,"currentSeekOperation",void 0),this.mediaElement=e,this.metadata=t,this.mediaStartSecs=void 0===t.format.start_time?0:Number.parseFloat(t.format.start_time),this.onSeekedCallback=()=>{this.resolveSeek()},this.onErrorCallback=()=>{this.rejectSeek(new o("Seek failed due to video error"))},e.addEventListener("seeked",this.onSeekedCallback),e.addEventListener("error",this.onErrorCallback)}destroy(){this.mediaElement.removeEventListener("seeked",this.onSeekedCallback),this.mediaElement.removeEventListener("error",this.onErrorCallback),this.rejectSeek(new o("Seek cancelled by destructor"))}seek(e){this.rejectSeek(new o("Previous seek cancelled by re-seek")),Number.isFinite(e)||(e=0);const t=this.mediaElement.seekable;let r,i;1===t.length?(r=Math.max(this.mediaStartSecs,t.start(0)),i=t.end(0)):(r=this.mediaStartSecs,i=this.mediaElement.duration||Number.MAX_VALUE);const a=Math.min(Math.max(e,r),i);if(Math.abs(a-this.mediaElement.currentTime)<s)return Promise.resolve();const c=new n.z,l=setTimeout((()=>{this.rejectSeek(new o("Seek timed out"))}),1e4);return this.currentSeekOperation={lifecycle:c,timeout:l},this.mediaElement.currentTime=a,c.promise}resolveSeek(){this.currentSeekOperation&&(this.currentSeekOperation.lifecycle.resolve(),clearTimeout(this.currentSeekOperation.timeout),this.currentSeekOperation=void 0)}rejectSeek(e){this.currentSeekOperation&&(this.currentSeekOperation.lifecycle.reject(e),clearTimeout(this.currentSeekOperation.timeout),this.currentSeekOperation=void 0)}}},37135:(e,t,r)=>{r.d(t,{J5:()=>n,hW:()=>o});const i=new WeakMap;function n(e){const t=i.get(e);if(t)return t;const r=e.getAttribute("src");if(r){e.setAttribute("src","");const t=new Promise((t=>{setTimeout((()=>{i.delete(e),e.setAttribute("src",r),t()}))}));return i.set(e,t),t}return Promise.reject(new Error("DOM element did not have a source URL"))}function o(e){if(e)for(let t=0,r=e.length;t<r;++t)if(e.end(t)>e.start(t))return!0;return!1}},64349:(e,t,r)=>{r.d(t,{K:()=>d});var i=r(324586),n=r(217563),o=r(343314),s=r(204411),a=r(735625);class c{static create(e){return new c({value:e,refCount:1})}constructor(e){(0,i.A)(this,"_shared",void 0),this._shared=e}get value(){if(this._shared)return this._shared.value.value;throw new Error("Trying to read an Rc value after the destructor has already been run")}free(){if(!this._shared)throw new Error("Trying to free an Rc after the destructor has already been run");this._shared.refCount--,0===this._shared.refCount&&this._shared.value.free(),delete this._shared}ref(){if(!this._shared)throw new Error("Trying to reference an Rc value after the destructor has already been run");return this._shared.refCount++,new c(this._shared)}}var l=r(341657);class d extends l.e{get rotWidth(){return this.textureSize?.width??0}get rotHeight(){return this.textureSize?.height??0}constructor(e,t,r,s,a,c,l){super(e,t.resourceManager),(0,i.A)(this,"_destroyedSubject",new n.B),(0,i.A)(this,"bitmapSrc",void 0),(0,i.A)(this,"texture",void 0),(0,i.A)(this,"targetSize",void 0),(0,i.A)(this,"textureSize",void 0),(0,i.A)(this,"isUpdateQueued",!1),(0,i.A)(this,"videoTransform",void 0),this.graphContext=t,this.cachedFile=r,this.isSvg=s,this.rotation=a,this.basisWidth=c,this.basisHeight=l,this.root.ctx.contextRestored.pipe((0,o.Q)(this._destroyedSubject)).subscribe((()=>{this.targetSize=void 0}))}destroy(){this._destroyedSubject.next(),this._destroyedSubject.complete(),super.destroy()}isStalled(){return!1}pause(){return Promise.resolve()}play(){return Promise.resolve()}seek(){return"waiting"===this.state?this.load():"loading"===this.state&&this.loadPromise?.promise||Promise.resolve()}update(e,t,r){if(super.update(e,t,r),this.isActive(e)){const e=this.targetSize;if(this.targetSize=this.getTargetSize(),this.isUpdateQueued||u(e,this.targetSize)||!this.bitmapSrc)return;this.isUpdateQueued=!0,requestIdleCallback((()=>{this.isUpdateQueued=!1,this.updateTexture().then((()=>this.graphContext.requestRender(this))).catch((e=>this.root.ctx.logError(e)))}))}}render(e){this.texture&&e.value.copy(this.texture.ref())}resetPlayback(){}async runJob(){if(this.isSvg){const e=document.createElementNS("http://www.w3.org/2000/svg","image");e.setAttribute("href",this.cachedFile.permanentUrl),await new Promise(((t,r)=>{e.onload=()=>t(),e.onerror=()=>r(new Error("Failed to load image"))})),this.bitmapSrc=e}else{const e=await fetch(this.cachedFile.permanentUrl);this.bitmapSrc=await e.blob()}this.targetSize=this.getTargetSize(),await this.updateTexture()}unload(){super.unload(),this.texture?.free(),this.bitmapSrc=void 0,this.texture=void 0,this.targetSize=void 0,this.textureSize=void 0}getTargetSize(){const e=this.basisWidth/this.basisHeight,t=this.root.gl.canvas.width/this.root.gl.canvas.height,r=(0,s.v)(this.videoTransform??a.DR,e,t);return{width:Math.floor(this.root.gl.canvas.width*Math.abs(r.bounds.right-r.bounds.left)),height:Math.floor(this.root.gl.canvas.height*Math.abs(r.bounds.top-r.bounds.bottom))}}async updateTexture(){if(!this.bitmapSrc||!this.targetSize)return;const e=this.targetSize;if(0===e.width||0===e.height)return this.texture?.free(),this.texture=void 0,void(this.textureSize=void 0);const t=await createImageBitmap(this.bitmapSrc,{imageOrientation:"flipY",premultiplyAlpha:"premultiply",resizeWidth:e.width,resizeHeight:e.height,resizeQuality:"medium"});u(e,this.targetSize)?(this.texture=this.texture??c.create(this.root.allocCopyImage()),this.texture.value.upload(t,{isAlreadyPremult:!0,yFlipped:!1,generateMipmap:!1}),this.textureSize={width:t.width,height:t.height},t.close()):t.close()}}function u(e,t){return e?.width===t?.width&&e?.height===t?.height}},333358:(e,t,r)=>{r.d(t,{o:()=>s});var i=r(324586),n=(r(379321),r(847269));class o{constructor(e){(0,i.A)(this,"currentTimeSecs",0),(0,i.A)(this,"isPlaying",!1),(0,i.A)(this,"state","unloaded"),(0,i.A)(this,"lastSeekedTime",0),this.media=e}getState(){return this.state}getCurrentTimeSecs(){return this.currentTimeSecs}update(e,t){this.currentTimeSecs=e,this.isPlaying=t,this.pollForUpdates()}setDeferredState(e){this.state=e,this.pollForUpdates()}pollForUpdates(){let e;do{e=this.state,this.state=this.updateState()}while(e!==this.state)}updateState(){if(!this.media.isLoaded(this.currentTimeSecs))return"unloaded";switch(this.state){case"unloaded":return"data-available";case"data-available":return this.updateDataAvailableState();case"preparing":return"preparing";case"ready":return this.updateReadyState();case"active":return this.updateActiveState()}}updateDataAvailableState(){return this.media.isAfterActive(this.currentTimeSecs)?"data-available":this.media.isActive(this.currentTimeSecs)?(this.seekMediaTo(this.currentTimeSecs).catch((e=>console.warn("ManagedLifecycle seek failed:",e))).then((()=>{this.media.isLoaded(this.currentTimeSecs)&&this.media.isActive(this.currentTimeSecs)?this.setDeferredState(this.handleOnActive()):this.setDeferredState("data-available")})),"preparing"):(this.seekMediaTo(this.media.getVideoStartTime()).catch((e=>console.warn("ManagedLifecycle prepare failed:",e))).then((()=>this.setDeferredState("ready"))),"preparing")}updateReadyState(){return this.media.isActive(this.currentTimeSecs)?this.handleOnActive():this.lastSeekedTime!==this.media.getVideoStartTime()?"data-available":"ready"}updateActiveState(){return this.media.isActive(this.currentTimeSecs)?"active":(this.media.pause(),"data-available")}handleOnActive(){return this.isPlaying&&this.media.play().catch((e=>console.warn("ManagedLifecycle play failed:",e))),"active"}seekMediaTo(e){return this.lastSeekedTime=e,this.media.seek(e)}}class s{set playbackRate(e){void 0!==e&&(this._playbackRate=e,this.currentElement&&(this.currentElement.playbackRate=e))}get playbackRate(){return this._playbackRate}set volume(e){this._volume=e,this.currentElement&&(this.currentElement.volume=e)}get volume(){return this._volume}constructor(e,t,r){(0,i.A)(this,"currentElement",void 0),(0,i.A)(this,"resourceHandle",void 0),(0,i.A)(this,"managedLifecycle",void 0),(0,i.A)(this,"_playbackRate",1),(0,i.A)(this,"_volume",1),(0,i.A)(this,"start",0),(0,i.A)(this,"duration",0),(0,i.A)(this,"offset",0),this.root=e,this.resourceHandle=t.resourceManager.createHandle({loader:r,getStartSecs:()=>this.start,getDurationSecs:()=>this.duration,onDataChanged:e=>{if(this.currentElement?.destroy(),e){const t=this.createMediaElement(e);t.onStalledChanged.subscribe((e=>{!e&&t.isStalled&&this.root.requestUnstall(this)})),this.currentElement=t,t.load.then((()=>this.root.requestUnstall(this))).catch((()=>console.warn("New media element cannot be loaded"))),setTimeout((()=>this.root.requestUnstall(this)))}else this.currentElement=void 0},renderDebugOverlay:(e,t)=>{const i=t.x+200,n=t.width-200,o=i+5,s=t.y+t.height/2+5;e.fillStyle="rgba(0, 0, 0, 0.5)",e.fillRect(t.x,t.y,200,t.height);const a=e.measureText(r.cacheKey).width;e.fillStyle="white",e.fillText(r.cacheKey,i-5-a,s);const c=this.currentElement?.domElement;if(void 0===c)return e.fillStyle="rgba(255, 255, 255, 0.5)",e.fillRect(i,t.y,n,t.height),e.fillStyle="black",void e.fillText("OFFLINE",o,s);e.fillStyle="rgb(102, 187, 106)",e.fillRect(i,t.y,n,t.height),e.fillStyle="rgb(165, 214, 167)";for(let r=0;r<c.buffered.length;r++){const o=c.buffered.start(r)/c.duration,s=c.buffered.end(r)/c.duration;e.fillRect(i+n*o,t.y,n*(s-o),t.height)}const l=this.localToPlaybackTime(0)/c.duration,d=this.localToPlaybackTime(this.duration)/c.duration;e.fillStyle="rgba(0, 0, 0, 0.5)",e.fillRect(i,t.y,n*l,t.height),e.fillRect(i+d*n,t.y,n*(1-d),t.height);const u=this.localToPlaybackTime(Math.max(0,Math.min(this.duration,this.worldToLocalTime(this.managedLifecycle.getCurrentTimeSecs()))))/c.duration;e.strokeStyle="white",e.lineWidth=2,e.beginPath(),e.moveTo(i+n*u,t.y),e.lineTo(i+n*u,t.y+t.height),e.stroke();const h=c.currentTime/c.duration;e.strokeStyle="rgb(0, 0, 255)",e.lineWidth=2,e.beginPath(),e.moveTo(i+n*h,t.y),e.lineTo(i+n*h,t.y+t.height),e.stroke();const p=[];switch(this.managedLifecycle.getState()){case"unloaded":p.push("UNLOADED");break;case"data-available":p.push("DATA_AVAILABLE");break;case"preparing":p.push("PREPARING");break;case"ready":p.push("READY");break;case"active":p.push("ACTIVE")}switch(c.readyState){case 0:p.push("HAVE_NOTHING");break;case 1:p.push("HAVE_METADATA");break;case 2:p.push("HAVE_CURRENT_DATA");break;case 3:p.push("HAVE_FUTURE_DATA");break;case 4:p.push("HAVE_ENOUGH_DATA")}c.seeking&&p.push("seeking"),c.paused&&p.push("paused"),c.ended&&p.push("ended"),c.error&&p.push("error"),e.fillStyle="black",e.fillText(p.join(", "),o,s)}}),this.managedLifecycle=new o({isLoaded:()=>void 0!==this.currentElement&&this.currentElement.isLoaded,isActive:e=>this.isActive(e),isAfterActive:e=>e>=this.start+this.duration,getVideoStartTime:()=>this.start,seek:e=>this.seek(e,!0),play:()=>this.play(),pause:()=>this.getDefinedElement().pause()})}destroy(){this.resourceHandle.unlink()}hasLoaded(){return!!this.currentElement&&this.currentElement.isLoaded&&!this.currentElement.isSeeking}isActive(e){return e>=this.start&&e<this.start+this.duration}isStalled(){return this.currentElement?.isStalled??!1}async load(){await(this.currentElement?.load)}async pause(e,t){const r=this.getDefinedElement();await r.load,r.isStalled&&!t||r.pause()}async play(){const e=this.getDefinedElement();await e.load,await e.play()}reduceItems(){return[{start:this.start,duration:this.duration,offset:this.offset,fadeInSeconds:0,fadeOutSeconds:0}]}async seek(e,t){const r=this.getDefinedElement();if(await r.load,r.isStalled&&!t)return;const i=this.worldToLocalTime(e),n=this.localToPlaybackTime(i);await r.seek(n)}update(e,t,r){"managed"===r&&this.managedLifecycle.update(e,t)}worldToLocalTime(e){return e-this.start}localToPlaybackTime(e){return e*this._playbackRate+this.offset}getDefinedElement(){return(0,n.sw)(this.currentElement,"Resource handle is not ready - make sure ResourceManager.at is called before this frame.")}}},209858:(e,t,r)=>{r.d(t,{q:()=>C});var i=r(324586),n=r(217563),o=r(463716),s=r(471189),a=r(214015),c=r(207510),l=r(932808),d=r(346392),u=r(847269),h=r(945596),p=r(979820);class m extends h.A{constructor(e,t){const r=e.createShader(WebGLRenderingContext.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\n\nuniform sampler2D audioSampler;\nuniform vec2 viewportSize;\nuniform float time;\nvarying vec2 texCoords;\n\n// Analyser-related properties\nuniform float bucketCount;\nuniform float sampleRate;\nuniform vec2 decibelRange;\n\n// Configuration properties\nuniform vec2 freqHzRange;\nuniform vec4 outsideColor;\nuniform vec4 insideColor;\nuniform vec4 rect;\nuniform int mode;\n\n// Must match the values in AudioVisualiserMode!\nconst int MODE_HORIZONTAL_BARS = 1;\nconst int MODE_HORIZONTAL_LINES = 2;\n\nvec2 rectViewportSize() {\n    return viewportSize * rect.zw;\n}\n\nfloat xToFreq(float x) {\n    return mix(freqHzRange.x, freqHzRange.y, x);\n}\n\nfloat freqToSampleCoord(float freq) {\n    // FFT texture is in range [0, sampleRate/2]\n    return clamp(freq * 2. / sampleRate, 0., 1.);\n}\n\nfloat xToSampleCoord(float x) {\n    return freqToSampleCoord(xToFreq(x));\n}\n\nfloat sampleVoltage(float x) {\n    float normalizedDb = texture2D(audioSampler, vec2(x, 0.)).x;\n    if (normalizedDb == 0.) return 0.;\n    float db = mix(decibelRange.x, decibelRange.y, normalizedDb);\n    float voltage = pow(10., db / 20.);\n    return pow(voltage, 0.8);\n}\n\nfloat sampleSmoothedVoltage(float x) {\n    // Sample voltage with a gaussian blur\n    // from https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/13.glsl\n    float smoothedVal = 0.;\n    float off1 = 1.411764705882353 * 0.2;\n    float off2 = 3.2941176470588234 * 0.2;\n    float off3 = 5.176470588235294 * 0.2;\n    smoothedVal += sampleVoltage(x) * 0.1964825501511404;\n    smoothedVal += sampleVoltage(x + off1 / bucketCount) * 0.2969069646728344;\n    smoothedVal += sampleVoltage(x - off1 / bucketCount) * 0.2969069646728344;\n    smoothedVal += sampleVoltage(x + off2 / bucketCount) * 0.09447039785044732;\n    smoothedVal += sampleVoltage(x - off2 / bucketCount) * 0.09447039785044732;\n    smoothedVal += sampleVoltage(x + off3 / bucketCount) * 0.010381362401148057;\n    smoothedVal += sampleVoltage(x - off3 / bucketCount) * 0.010381362401148057;\n    return smoothedVal;\n}\n\n// Equivalent to step, but returns in-between values across the boundary based on pixelSize.\n// When q < edge returns 0, when q > edge returns 1\nfloat aaStep(float edge, float q, float pixelSize) {\n    float edgeMin = edge - pixelSize / 2.;\n    return clamp((q - edgeMin) / pixelSize, 0., 1.);\n}\n\nfloat aaStepX(float edge, float x) {\n    return aaStep(edge, x, 1. / rectViewportSize().x);\n}\n\nfloat aaStepY(float edge, float y) {\n    return aaStep(edge, y, 1. / rectViewportSize().y);\n}\n\nconst int BAR_COUNT = 120;\n\nvec4 horizontalBarVisualiser(vec2 normalizedCoords) {\n    int barCount = int(rect.z * 100.);\n    float normalizedBarWidth = 1. / float(barCount) / 4.;\n    float normalizedSpaceWidth = 1. / float(barCount) / 4.;\n\n    float totalBarWidth = normalizedBarWidth + normalizedSpaceWidth;\n    float barLeft = floor(normalizedCoords.x / totalBarWidth) * totalBarWidth;\n    float barLocalX = normalizedCoords.x - barLeft;\n\n    float filledLeft = barLeft + normalizedBarWidth / 2.;\n    float filledRight = filledLeft + normalizedBarWidth;\n\n    float voltage = sampleVoltage(xToSampleCoord(barLeft + totalBarWidth * 0.5)) * 4.;\n    float barHeight = max(voltage, 1. / rectViewportSize().y); // ensure the bar has a height\n\n    float filledAA =\n        aaStepX(filledLeft, normalizedCoords.x)\n        * aaStepX(normalizedCoords.x, filledRight)\n        * aaStepY(abs(normalizedCoords.y - 0.5), barHeight);\n\n    float colorFade = abs(normalizedCoords.x - 0.5) * 2.;\n    vec4 barColor = mix(insideColor, outsideColor, colorFade);\n\n    return filledAA * barColor;\n}\n\nconst float LINE_THICKNESS = 0.0025;\n\nvec4 horizontalLineVisualiser(vec2 normalizedCoords) {\n    float voltage = sampleSmoothedVoltage(xToSampleCoord(normalizedCoords.x)) * 4.;\n    float lineHeight = voltage;\n\n    float mirroredY = abs(normalizedCoords.y - 0.5);\n    float adjustedThickness = LINE_THICKNESS / rect.w;\n\n    // todo(webgl2):\n    //   use screenspace derivatives to fix near-vertical lines\n    float filledAA =\n        aaStepY(voltage - adjustedThickness, mirroredY) * aaStepY(mirroredY, voltage + adjustedThickness);\n\n    float colorFade = abs(normalizedCoords.x - 0.5) * 2.;\n    vec4 barColor = mix(insideColor, outsideColor, colorFade);\n\n    return filledAA * barColor;\n}\n\nvoid main() {\n    vec2 normalizedCoords = (texCoords - rect.xy) / rect.zw;\n\n    // Don't render outside bounds\n    if (normalizedCoords.x < 0. || normalizedCoords.x > 1.) {\n        discard;\n        return;\n    }\n\n    if (mode == MODE_HORIZONTAL_BARS) {\n        gl_FragColor = horizontalBarVisualiser(normalizedCoords);\n    } else if (mode == MODE_HORIZONTAL_LINES) {\n        gl_FragColor = horizontalLineVisualiser(normalizedCoords);\n    }\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"audioSampler",void 0),(0,i.A)(this,"time",void 0),(0,i.A)(this,"bucketCount",void 0),(0,i.A)(this,"sampleRate",void 0),(0,i.A)(this,"decibelRange",void 0),(0,i.A)(this,"freqHzRange",void 0),(0,i.A)(this,"outsideColor",void 0),(0,i.A)(this,"insideColor",void 0),(0,i.A)(this,"rect",void 0),(0,i.A)(this,"mode",void 0),this.audioSampler=this.sampler("audioSampler"),this.viewportSizeUniform=this.uniform("viewportSize",p.A.FLOAT_ARRAY_2),this.time=this.uniform("time",p.A.FLOAT),this.bucketCount=this.uniform("bucketCount",p.A.FLOAT),this.sampleRate=this.uniform("sampleRate",p.A.FLOAT),this.decibelRange=this.uniform("decibelRange",p.A.FLOAT_ARRAY_2),this.freqHzRange=this.uniform("freqHzRange",p.A.FLOAT_ARRAY_2),this.outsideColor=this.uniform("outsideColor",p.A.FLOAT_ARRAY_4),this.insideColor=this.uniform("insideColor",p.A.FLOAT_ARRAY_4),this.rect=this.uniform("rect",p.A.FLOAT_ARRAY_4),this.mode=this.uniform("mode",p.A.INTEGER)}}var f=r(326180),g=r(987089),A=r(387427);const v=.5,y={"horizontal-bars":1,"horizontal-lines":2};class b{constructor(e,t){(0,i.A)(this,"outerColor",[1,1,1,1]),(0,i.A)(this,"innerColor",[1,1,1,.5]),(0,i.A)(this,"position",[.5,.5]),(0,i.A)(this,"freqHzRange",[0,2e3]),(0,i.A)(this,"size",.7),(0,i.A)(this,"mode","horizontal-bars"),(0,i.A)(this,"audioCache",void 0),this.root=e,this.audioCache=t.createAudioHandle()}destroy(){this.audioCache.free()}waitForReady(e,t,r){return this.audioCache.value.getSource(t,r).waitForDataAt(e)}render(e,t,r,i){const n=this.root.ctx.renderers.get(m);(0,f.Ww)(this.root.allocCopyImage())((o=>{o.value.uploadBuffer(this.audioCache.value.getSource(r,i).trySampleDataAt(t),A.D8,1,{isAlreadyPremult:!0,yFlipped:!1,imageFormat:g._L,bufferFormat:g.VG}),n.audioSampler.set(o.value.bindSampler(0)),n.time.setFloat(t),n.bucketCount.setFloat(A.D8),n.sampleRate.setFloat(A.sQ),n.decibelRange.setFloatArray2([A.lf,A.HJ]),n.freqHzRange.setFloatArray2(this.freqHzRange),n.outsideColor.setFloatArray4(this.outerColor),n.insideColor.setFloatArray4(this.innerColor),n.mode.setInteger(y[this.mode]);const{x:s,y:a,width:c,height:l}=function(e,t){let r,i,n,o;return n=e[0]===v?t:.5*t,o=e[1]===v?.5*t:.3*t,r=e[0]<v?.02+.02*(1-t):e[0]>v?1-n-.02-.02*(1-t):.5-n/2,i=e[1]>v?.01+.04*(1-t):e[1]<v?1-o-.01-.04*(1-t):.5-o/2,{x:r,y:i,width:n,height:o}}(this.position,this.size);n.rect.setFloatArray4([s,a,c,l]),n.renderTo(e)}))}}var w=r(304760),x=r(394050);function S(e){return!!e.isFreehandSupported}function T(e){return"getEntryDuration"in e&&"getExitDuration"in e}class C{get baseHeight(){return this.root.gl.canvas.height}get baseWidth(){return this.root.gl.canvas.width}get dimensions(){return o.d.scale(this.baseWidth,this.baseHeight)}get fields(){return this._fields}get rotHeight(){return this.root.gl.canvas.height}get rotWidth(){return this.root.gl.canvas.width}get pluginReady(){return this._pluginReady}get entryDuration(){return this.instance&&T(this.instance)?this.instance.getEntryDuration()??void 0:void 0}get exitDuration(){return this.instance&&T(this.instance)?this.instance.getExitDuration()??void 0:void 0}constructor(e,t,r,o,s){(0,i.A)(this,"rotation",0),(0,i.A)(this,"start",0),(0,i.A)(this,"duration",0),(0,i.A)(this,"lastUpdateTime",1/0),(0,i.A)(this,"_fields",{}),(0,i.A)(this,"canvas",document.createElement("canvas")),(0,i.A)(this,"destroyed",new n.B),(0,i.A)(this,"instance",void 0),(0,i.A)(this,"originalFields",{}),(0,i.A)(this,"pluginLoaded",void 0),(0,i.A)(this,"_pluginReady",void 0),(0,i.A)(this,"audioVisualiserNode",void 0),(0,i.A)(this,"currentFreehandPosition",void 0),(0,i.A)(this,"graphContext",void 0),(0,i.A)(this,"_isLoaded",!1),this.root=e,this.assetLoader=r,this.options=o,this.fetchAsset=s,this.audioVisualiserNode=new b(e,t),this.pluginLoaded=this.loadPlugin(),this._pluginReady=this.pluginLoaded,this.graphContext=t}destroy(){this.audioVisualiserNode.destroy(),this.canvas.remove(),this.unloadPlugin(),this.destroyed.next(),this.destroyed.complete()}getExportStream(e,t,r){return(0,s._y)(this.setFields({...this.originalFields},this.currentFreehandPosition).then((()=>(0,a.R6)(e,t,r,(async(e,t)=>{await this.seek(e).catch((e=>{console.warn("Error while seeking in export stream:",e)})),this.options.data&&this.options.data.audioVisualiser&&await this.audioVisualiserNode.waitForReady(e,this.start,this.duration),await t()}),(()=>{})))))}isStalled(){return!1}pause(){return Promise.resolve()}play(){return Promise.resolve()}async setFields(e,t){await this.updateFields(e,t),this.instance&&await this.instance.render(this.lastUpdateTime,this.duration).catch((()=>{}))}updateFields(e,t){return this.originalFields=e,this.currentFreehandPosition=t,this._pluginReady=this._pluginReady.then((async()=>{try{this._fields=await(0,w.ES)(e,this.options,Math.min(this.baseWidth,this.baseHeight),this.fetchAsset),this.instance&&S(this.instance)&&(this.instance.position=t),this.instance&&await this.instance.update((0,w.BI)(this.fields,this.options.fields))}catch(e){console.error(e)}})),this._pluginReady}render(e,t){if(!this.instance)return;if(this.options.data.audioVisualiser){const r=this.root.allocImage(!0,1,1);return r.value.clear(),this.audioVisualiser(r,t),void e.value.copy(r)}const r=this.root.allocCopyImage();r.value.upload(this.canvas,{isAlreadyPremult:!1,yFlipped:!1});let i=r;if(this.options.data.glitch){const e=this.root.allocImage(!0,1,1);this.glitch(e,i,t),i.free(),i=e}if(this.options.data.smoke){const e=this.root.allocImage(!0,1,1);this.smoke(e,i,t),i.free(),i=e}e.value.copy(i)}renderHot(e,t){return this.canvas.width=e,this.canvas.height=t,this.canvas.toDataURL()}isActive(e){return e>=this.start&&e<this.start+this.duration}async seek(e){const t=this.timelineToLocalTime(e);this.lastUpdateTime=t,await this.pluginLoaded,await this.resize(),await(0,u.sw)(this.instance,"Instance should have been created on load but was not").render(t,this.duration).catch((()=>{}))}update(e){const t=this.timelineToLocalTime(e);if((t!==this.lastUpdateTime||this.canvas.width!==this.baseWidth||this.canvas.height!==this.baseHeight)&&(this.lastUpdateTime=t,this.instance)){const e=this.instance;this.resize().then((()=>e.render(t,this.duration))).then((()=>this.graphContext.requestRender(this))).catch((()=>{}))}}isFreehandSupported(){return void 0!==this.instance&&S(this.instance)}async getBoundingBox(e){if(this.instance&&S(this.instance)){await this.resize();const t=await this.instance.getBoundingBox(e).catch(console.error);if(void 0===t)return;return{top:1-t.top/this.baseHeight,left:t.left/this.baseWidth,right:(t.left+t.width)/this.baseWidth,bottom:1-(t.top+t.height)/this.baseHeight}}}async getNeutralBoundingBox(e){if(this.instance&&S(this.instance)){await this.resize();const t=await this.instance.getUnscaledBoundingBox(e);if(void 0===t)return;return{top:1-t.top/this.baseHeight,left:t.left/this.baseWidth,right:(t.left+t.width)/this.baseWidth,bottom:1-(t.top+t.height)/this.baseHeight}}}sanitiseFields(e){return(0,x.h)(e,this.options.fields)}glitch(e,t,r){if(this.options.data&&this.options.data.glitch){const i=()=>{if("fields"===this.options.data.glitch){const e=(0,w.BI)(this.fields,this.options.fields);return[e.amount,e.speed]}return this.options.data.glitch},[n,o]=i();(0,c.Q)(this.root,n,o).render(e,t,{time:r,start:this.start,duration:this.duration})}}audioVisualiser(e,t){if(this.options.data&&this.options.data.audioVisualiser){const r=()=>{if("fields"===this.options.data.audioVisualiser){const e=(0,w.BI)(this.fields,this.options.fields);return[e.outerColor,e.innerColor,e.position,e.size,e.showBars]}return this.options.data.audioVisualiser},[i,n,o,s,a]=r();this.audioVisualiserNode.outerColor=(0,l.sc)(i),this.audioVisualiserNode.innerColor=(0,l.sc)(n),this.audioVisualiserNode.position=o,this.audioVisualiserNode.size=s,this.audioVisualiserNode.mode=a?"horizontal-bars":"horizontal-lines",this.audioVisualiserNode.render(e,t,this.start,this.duration)}}async loadPlugin(){await this.resize();const e=await this.graphContext.getPluginManager().load(this.options.pluginSrc);this.instance=new e(this.canvas,this.options.data,(0,w.BI)(this.fields,this.options.fields),this.assetLoader),await this.instance.init(),this._isLoaded=!0}async resize(){this.canvas.width===this.baseWidth&&this.canvas.height===this.baseHeight||(this.canvas.width=this.baseWidth,this.canvas.height=this.baseHeight,this.instance&&await this.updateFields(this.originalFields,this.currentFreehandPosition))}smoke(e,t,r){this.options.data.smoke&&(0,d.y)(this.root,!0).render(e,t,{time:r,start:this.start,duration:this.duration})}timelineToLocalTime(e){return Math.min(this.duration,Math.max(0,e-this.start))}unloadPlugin(){}hasLoaded(){return this._isLoaded}load(){return this.pluginLoaded}reduceItems(){return[]}}},686781:(e,t,r)=>{function i(e,t){return{type:e,cacheKey:t,load:()=>{const t=document.createElement(e);return{data:t,unload:()=>{t.src="",t.srcObject=null,t.remove()}}}}}r.d(t,{M:()=>i})},341657:(e,t,r)=>{r.d(t,{e:()=>c});var i=r(324586),n=r(517934),o=r(471189),s=r(214015),a=r(860784);class c{get priority(){return n.A.PLAYBACK+(e=this.start-this.lastUpdateTime,1-Math.pow(1.001,-e));var e}get isDestroyed(){return void 0!==this._destroyed}constructor(e,t,r){(0,i.A)(this,"cooldownTime",0),(0,i.A)(this,"duration",0),(0,i.A)(this,"offset",0),(0,i.A)(this,"start",0),(0,i.A)(this,"state","waiting"),(0,i.A)(this,"warmupTime",1),(0,i.A)(this,"lastUpdateTime",0),(0,i.A)(this,"loadPromise",void 0),(0,i.A)(this,"_destroyed",void 0),this.root=e,this.resourceManager=t,this.metadata=r}destroy(){this._destroyed=new Error,this.unload()}getExportStream(e,t,r){return(0,o._y)(this.load().then((()=>(0,s.fE)(e,r))))}hasLoaded(){return"ready"===this.state||"playing"===this.state}inHotRegion(e){return e>=this.start-this.warmupTime&&e<this.start+this.duration+this.cooldownTime}isActive(e){return e>=this.start&&e<this.start+this.duration}load(){if(this._destroyed)return Promise.reject(new Error("Cannot load SourceNode that's been destroyed, destroy stack is: "+this._destroyed.stack));if("waiting"===this.state){this.state="loading";const e=this.runJob();this.loadPromise=a.z.from(e.then((()=>{this.state="ready",setTimeout((()=>{this.root.requestUnstall(this)}))})))}return this.loadPromise?this.loadPromise.promise:Promise.resolve()}reduceItems(){return[{start:this.start,duration:this.duration,offset:this.offset,fadeInSeconds:0,fadeOutSeconds:0}]}unload(){"loading"===this.state&&console.warn("Source node loading cancelled from unload"),this.state="waiting",this.loadPromise&&(this.loadPromise.resolve(),delete this.loadPromise)}update(e,t,r){if(this.lastUpdateTime=e,"managed"===r)switch(this.state){case"waiting":this.updateWaitingState(e);break;case"ready":this.updateReadyState(e,t);break;case"playing":this.updatePlayingState(e)}}updatePlayingState(e){this.inHotRegion(e)?this.isActive(e)||(this.resetPlayback(),this.state="ready"):this.unload()}updateReadyState(e,t){this.inHotRegion(e)?this.isActive(e)&&(this.state="playing",t&&this.play(e).catch((e=>{console.warn("An error occurred when playing media",e)}))):this.unload()}updateWaitingState(e){this.inHotRegion(e)&&this.load().then((()=>this.seek(Math.max(this.lastUpdateTime,this.start),!0))).catch((e=>{console.warn(`SourceNode load cancelled: ${e?e.message:"no reason given"}`)}))}}},304760:(e,t,r)=>{r.d(t,{BI:()=>c,ES:()=>a,tE:()=>l});const i={},n=720,o=150;async function s(e,t,r=.5){return new Promise(((i,n)=>{const o=new Image;o.onload=()=>{const e=document.createElement("canvas"),s=t?t/Math.max(o.naturalWidth,o.naturalHeight):1;e.width=o.naturalWidth*s,e.height=o.naturalHeight*s;const a=e.getContext("2d");a?(a.scale(s,s),a.drawImage(o,0,0),i(e.toDataURL("image/png",r))):n(new Error("Failed to compress")),e.remove()},o.onerror=()=>{n(new Error("Failed to compress"))},o.src=e}))}async function a(e,t,r,a){const l=t.fields.filter((e=>"logo"===e.type)).map((e=>e.id));if(0===l.length)return e;const d=r>=n?r:o;for(const o of l){const l=c(e,t.fields)[o];if(u=l,u?.id)if(i[l.id+d])e={...e,[o]:i[l.id+d]};else{const{permanentUrl:t}=await a(l),c=await s(t,d,r>=n?1:void 0);i[l.id+d]=c,e={...e,[o]:c}}else a()}var u;return e}function c(e,t){return t.reduce(((t,r)=>{let i=e?e[r.id]:void 0;return"string"==typeof i&&(i=function(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;","#":"%23"};return e.replaceAll(/[#&<>]/g,(e=>t[e]))}(i)),{...t,[r.id]:void 0!==i?i:r.defaultValue}}),{})}function l(e,t){for(const r of t){const t=e?e[r.id]:void 0;if("text"===r.type||"textMulti"===r.type)return t||r.defaultValue}}},852601:(e,t,r)=>{r.d(t,{CB:()=>u,oD:()=>s,oz:()=>c,y6:()=>l}),r(379321);var i=r(882252),n=r.n(i);function o(e=[]){for(const[t,r]of e.entries()){const e=r.segments;for(const[r,i]of e.entries())if("com.clipchamp.text"===i.type&&(i.properties.content??[]).map((e=>e.text?.trim())).join(" ").length>0)return{entityIdx:t,segmentIdx:r}}}function s(e=[],t){let r=n()(e);const i=o(e);if(i){const{entityIdx:n,segmentIdx:o}=i,s={...e[n].segments[o]};if("com.clipchamp.text"===s.type){const e={...s?.properties?.content?.[0]};e.text=t,r=[...r.slice(0,n),{...r[n],segments:[...r[n].segments.slice(0,o),{...s,properties:{...s.properties,content:[e]}},...r[n].segments.slice(o+1)]},...r.slice(n+1)]}}return r}function a(e=[],t=[]){const r=[];for(const[i,n]of e.entries()){const e=t[i],o=t[0];e?r.push({...e,text:n.text}):r.push({...o,text:n.text})}return r}function c(e=[],t=[]){let r=n()(e);const i=o(e);if(i){const{entityIdx:n,segmentIdx:o}=i,s={...e[n].segments[o]};"com.clipchamp.text"===s.type&&(r=[...r.slice(0,n),{...r[n],segments:[...r[n].segments.slice(0,o),{...s,properties:{...s.properties,content:a(t,s.properties.content)}},...r[n].segments.slice(o+1)]},...r.slice(n+1)])}return r}function l(e=[]){const t=o(e);if(!t)return;const r=e[t.entityIdx].segments[t.segmentIdx];if("com.clipchamp.text"===r.type){const e=r.properties.content??[];if(e.map((e=>e.text?.trim())).join(" ").length>0)return e}}function d(e=[]){const t=l(e);if(!t)return;const r=t.map((e=>e.text??"")).join("").replaceAll(/\s+/g," ").trim();return r.length>0?r:void 0}function u(e=[],t=[]){return d(e)||d(t)}},394050:(e,t,r)=>{r.d(t,{h:()=>o});var i=r(540076);function n(e,t){switch(t){case"text":case"textMulti":case"font":case"select":return"string"==typeof e;case"alignment":case"range":case"angle":case"number":case"scale":return"number"==typeof e;case"color":return Array.isArray(e)&&4===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]&&"number"==typeof e[3];case"toggle":return"boolean"==typeof e;case"grid":return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1];case"logo":return null===e||"string"==typeof e||"object"==typeof e;case"logoUpload":case"hidden":return!0;default:(0,i.xb)(t)}}function o(e,t){const r={...e};for(const i of t){const t=e[i.id];i.id in e&&(n(t,i.type)||(r[i.id]=i.defaultValue))}return r}Error},304669:(e,t,r)=>{r.d(t,{E:()=>A});var i=r(324586),n=r(471189),o=r(214015),s=r(313311);class a{constructor(e,t=0){this.runJob=e,this.priority=t}}var c=r(37135);const l=5e3,d="canplaythrough",u=new Map;var h=r(815731),p=r(632670),m=r(702335),f=r(341657);class g extends f.e{set playbackRate(e){if(void 0===e)return;this._playbackRate=e;const t=this.element.getValue();t&&(t.playbackRate=e)}get playbackRate(){return this._playbackRate}set volume(e){this._volume=e;const t=this.element.getValue();t&&(t.volume=e)}get volume(){return this._volume}constructor(e,t,r,n,o){super(e,t,n),(0,i.A)(this,"element",new h.t(void 0)),(0,i.A)(this,"_playbackRate",1),(0,i.A)(this,"_volume",1),this.cachedFile=r,this.metadata=n,this.audioOut=o}createMediaElement(e){const t=new m.O(this.cachedFile,this.metadata,e,this._playbackRate);if(this.audioOut){const e=new p.m(t,this._volume,this.audioOut.context);return e.connect(this.audioOut),e}return t}isStalled(){const e=this.element.getValue();return!!e&&e.isStalled}hasLoaded(){return super.hasLoaded()&&!this.element.getValue()?.isSeeking}localToPlaybackTime(e){return e*this._playbackRate+this.offset}localToWorldTime(e){return e+this.start}pause(e,t){return this.isStalled()&&!t?Promise.resolve():this.load().then((()=>{const e=this.element.getValue();if(!e)throw new Error("No element after load for pause");e.pause()}))}play(){return this.load().then((()=>{const e=this.element.getValue();if(e)return e.play();throw new Error("No element after load for play")}))}runJob(){return new Promise(((e,t)=>{this.createDomElement((r=>{const i=this.createMediaElement(r);i.onStalledChanged.subscribe((e=>{!e&&i.isLoaded&&this.root.requestUnstall(this)})),i.load.then((()=>{this.element.next(i),e()}),t)}))}))}seek(e,t){return this.lastUpdateTime=e,this.isStalled()&&!t?Promise.resolve():this.load().then((()=>{const e=this.element.getValue();if(e){const t=this.worldToLocalTime(this.lastUpdateTime),r=this.localToPlaybackTime(t);return e.seek(r)}throw new Error("No element after load for seek")}))}unload(){if("waiting"!==this.state){super.unload();const e=this.element.getValue();e&&(e.destroy(),this.element.next(void 0))}return Promise.resolve()}worldToLocalTime(e){return e-this.start}resetPlayback(){const e=this.element.getValue();e&&(e.pause(),e.seek(this.localToPlaybackTime(0)).catch((e=>{console.warn("MediaNode reset cancelled: "+e.message)})))}}class A extends g{constructor(e,t,r,n,o,s,a,c){super(e,t,r,a,c),(0,i.A)(this,"yFlipped",!1),this.rotation=n,this.rotWidth=o,this.rotHeight=s}getExportStream(e,t,r){return(0,n._y)(this.load().then((()=>(0,o.R6)(e,t,r,(async(e,t)=>{await this.seek(e,!0).catch((e=>{console.warn("Error while seeking in export stream:",e)})),await t()}),(()=>this.unload())))))}render(e){const t=this.element.getValue();if(t&&(r=t.domElement).readyState>=1&&r.videoWidth>0&&r.videoHeight>0){const r=t.domElement;e.value.upload(r,{isAlreadyPremult:!1,yFlipped:this.yFlipped})}else console.warn("No element loaded to render video frame at "+this.cachedFile.permanentUrl);var r}createDomElement(e){var t;t=e,function(e,t){let r=u.get(e);r||(r=new s.r,u.set(e,r)),r.queue(new a((()=>{const r=document.createElement("video");return r.setAttribute("src",e),t(r),(i=r,new Promise(((e,t)=>{let r,n=!0;i.addEventListener(d,(function t(o){i.removeEventListener(d,t),window.clearTimeout(r),n=!1,e()})),r=window.setTimeout((function e(){(0,c.J5)(i).then((()=>{n&&(r=window.setTimeout(e,l))})).catch(t)}),l)}))).then((()=>function(e){return new Promise(((t,r)=>{!function i(){(0,c.hW)(e.seekable)?t():(0,c.J5)(e).then((()=>{setTimeout(i,l)})).catch(r)}()}))}(r)));var i}))).catch((t=>{console.warn(`Video ${e} failed to load or produce seekable range(s)`,t)}))}(this.cachedFile.permanentUrl,t)}}},299848:(e,t,r)=>{r.d(t,{z:()=>o});var i=r(324586);class n{constructor(e,t,r){(0,i.A)(this,"rendererState",void 0),(0,i.A)(this,"mixerState",void 0),this.reader=e,this.clock=t,this.options=r}getVideoStreamForTrackItem(e){return this.rendererState?.getStreamForTrackItem(e)}getAudioStreamForTrackItem(e){return this.mixerState?.getStreamForTrackItem(e)}setRenderState(e){this.rendererState=e}setMixerState(e){this.options.enableMixer&&(this.mixerState=e)}updatePlayback(){}destroy(){}}function o(e,t){return r=>new n(r,e,t)}},481973:(e,t,r)=>{r.d(t,{MC:()=>s,jR:()=>a});var i=r(999270),n=r(650882);class o extends n.g9{constructor(e){super("Failed to fetch fallback font",e)}}class s{getFallbackTypeface(e){const t=(0,i.d)(e);if(void 0!==t)return{id:`url:${t}`,async fetch(){const e=await fetch(t);if(!e.ok)throw new o({fontUrl:t,statusCode:e.status,statusText:e.statusText});return e.arrayBuffer()}}}}const a="fontResolver"},241210:(e,t,r)=>{r.d(t,{M:()=>l,s:()=>s});var i=r(650882),n=r(615101);const o={providerId:"builtin",path:"DM Sans"};function s(e){const t=e.indexOf(":");return-1===t?{path:e}:{providerId:e.slice(0,Math.max(0,t)),path:e.slice(Math.max(0,t+1))}}function a(e,t){return void 0===t.providerId?e.acceptAsDefault:e.id===t.providerId}async function c(e,t){for(const r of t){if(!a(r,e))continue;const t=await r.resolve(e.path);if(t)return t}}async function l(e,t){const r=s(e),a=await c(r,t);if(a)return a;const l=await c(o,t);if(!l)throw new i.g9((0,n.vU)("Could not find fallback font in any given provider"),{fallbackProvider:o.providerId,fallbackPath:o.path});return l}},488510:(e,t,r)=>{r.d(t,{mP:()=>Z});var i=r(324586),n=(r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(825702)),o=r(562229),s=r(138615),a=r(573340),c=(r(34456),r(159129),r(940233),r(270818),r(513173),r(205218),r(815731)),l=r(217563),d=r(321450),u=r(453916);class h{constructor(e,t){(0,i.A)(this,"cache",new Map),this.ctx=e,this.identityVert=t}destroy(){for(const e of this.cache.values())e.destroy()}get(e){const t=this.cache.get(e);if(t)return t;const r=new e(this.ctx,this.identityVert);return this.cache.set(e,r),r}}class p{constructor(e,t,r){(0,i.A)(this,"contextRestored",void 0),(0,i.A)(this,"gl",void 0),(0,i.A)(this,"gl2",void 0),(0,i.A)(this,"debugInfo",void 0),(0,i.A)(this,"renderers",void 0),(0,i.A)(this,"webGlContextLost",new c.t(!1)),(0,i.A)(this,"_contextRestored",new l.B),(0,i.A)(this,"_identityVertexShader",void 0),(0,i.A)(this,"_quadBuffer",void 0),(0,i.A)(this,"boundProgram",void 0),(0,i.A)(this,"hasWebGLContext",!0),(0,i.A)(this,"webGLContextTimeout",void 0),this.name=e,this.features=t,this.analytics=r,this.contextRestored=this._contextRestored.asObservable();const n=document.createElement("canvas");let o;n.style.width="100%",n.style.height="100%";const s=function(e){return{depth:!1,stencil:!1,antialias:!1,alpha:e.alphaInOutput,premultipliedAlpha:!0,preserveDrawingBuffer:!0}}(t);if("prefer-webgl2"===t.level&&(this.gl2=n.getContext("webgl2",s)||void 0,o=this.gl2),o||(o=n.getContext("webgl",s)||void 0),!o)throw new Error("Failed to create WebGL context.");this.gl=o;const a=this.gl.getExtension("WEBGL_debug_renderer_info");this.debugInfo=a?{rendererName:this.gl.getParameter(a.UNMASKED_RENDERER_WEBGL),vendorName:this.gl.getParameter(a.UNMASKED_VENDOR_WEBGL)}:{rendererName:"unknown",vendorName:"unknown"},n.addEventListener("webglcontextlost",(t=>{this.hasWebGLContext=!1,t.preventDefault();const i=t.statusMessage;console.warn(`Lost WebGL context: ${i}`),r?.logContextLost(e),this.webGLContextTimeout=window.setTimeout((()=>{this.hasWebGLContext||this.webGlContextLost.next(!0)}),5e3)}),!1),n.addEventListener("webglcontextrestored",(()=>{console.warn("Restored WebGL context"),this.hasWebGLContext=!0,this.webGLContextTimeout&&clearTimeout(this.webGLContextTimeout),n.width=n.width-1,n.width=n.width+1,r?.logContextRestored(e),this.setupState(),this.renderers=new h(this,this._identityVertexShader),this._contextRestored.next(),this.webGlContextLost.next(!1)})),this.setupState(),this.renderers=new h(this,this._identityVertexShader)}contextPromise(){return this.hasWebGLContext?Promise.resolve():(0,d._)(this.contextRestored)}createProgram(e,t){return function(e,t,r){const i=e.createProgram();if(null===i)return i;if(null!==t&&e.attachShader(i,t),null!==r&&e.attachShader(i,r),e.bindAttribLocation(i,0,"vertexPos"),e.bindAttribLocation(i,1,"vertexUV"),e.linkProgram(i),!e.getProgramParameter(i,WebGLRenderingContext.LINK_STATUS))throw new Error("Could not link program: "+e.getProgramInfoLog(i));return i}(this.gl,e,t)}createShader(e,t){return function(e,t,r){const i=e.createShader(t);if(null===i)return i;if(e.shaderSource(i,r),e.compileShader(i),!e.getShaderParameter(i,WebGLRenderingContext.COMPILE_STATUS))throw new Error(`Could not compile shader code '${r}': ${e.getShaderInfoLog(i)}`);return i}(this.gl,e,t)}logError(e){this.analytics?.logError(e,"warning")}destroy(){this._contextRestored.complete(),this.gl.deleteBuffer(this._quadBuffer),this.gl.deleteShader(this._identityVertexShader),this.renderers.destroy()}isContextLost(){return!this.hasWebGLContext}renderQuad(){this.gl.drawArrays(WebGLRenderingContext.TRIANGLES,0,6)}useProgram(e){e!==this.boundProgram&&(this.gl.useProgram(e),this.boundProgram=e)}setupState(){this.gl.enable(WebGLRenderingContext.BLEND),this.gl.blendEquation(WebGLRenderingContext.FUNC_ADD),this.gl.blendFunc(WebGLRenderingContext.ONE,WebGLRenderingContext.ONE_MINUS_SRC_ALPHA);const e=new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,-1,1,0,1,1,-1,1,0,1,1,1,1]),t=this.gl.createBuffer();if(!t)throw new Error("Failed to create vertex buffer");this._quadBuffer=t,this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,this._quadBuffer),this.gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER,e,WebGLRenderingContext.STATIC_DRAW),this.gl.vertexAttribPointer(0,2,WebGLRenderingContext.FLOAT,!1,16,0),this.gl.vertexAttribPointer(1,2,WebGLRenderingContext.FLOAT,!1,16,8),this.gl.enableVertexAttribArray(0),this.gl.enableVertexAttribArray(1),this._identityVertexShader=this.createShader(WebGLRenderingContext.VERTEX_SHADER,u)}}var m=r(313311),f=(r(379321),r(396159)),g=r(343314),A=r(773395),v=r(150919),y=r(987089),b=r(847269),w=r(326180),x=r(835908),S=r(439921);const T={minFilter:"linear",magFilter:"linear"};function C(e){switch(e){case"nearest":return WebGLRenderingContext.NEAREST;case"linear":return WebGLRenderingContext.LINEAR;case"prefer-mipmap":return WebGLRenderingContext.LINEAR_MIPMAP_NEAREST}}function _(e){switch(e){case"nearest":return WebGLRenderingContext.NEAREST;case"linear":return WebGLRenderingContext.LINEAR}}class k{get fb(){return this._fb}get gl(){return this.root.gl}get pixelHeight(){return this.relativeHeight*(this.relative?this.gl.canvas.height:1)}get pixelWidth(){return this.relativeWidth*(this.relative?this.gl.canvas.width:1)}get tex(){return this._tex}get format(){return this._format}get hasValidMipmap(){return this._hasValidMipmap}static create(e,t,r,i,n){const o=new k(e,t,r,i,n);return{value:o,free(){o.destroy()}}}constructor(e,t,r,n,o){(0,i.A)(this,"_fb",void 0),(0,i.A)(this,"_lastHeight",0),(0,i.A)(this,"_lastWidth",0),(0,i.A)(this,"_tex",void 0),(0,i.A)(this,"_destroyed",!1),(0,i.A)(this,"_currentSafeSampleMode",T),(0,i.A)(this,"_format",void 0),(0,i.A)(this,"_hasValidMipmap",!1),this.root=e,this.relative=t,this.relativeWidth=r,this.relativeHeight=n,this._format=o,this.reinitializeResources()}bindFb(){if(this._lastWidth<=0||this._lastHeight<=0)throw new Error("Attempting to render to a 0-sized texture");this._throwIfDestroyed(),this.gl.disable(WebGLRenderingContext.BLEND),this.gl.viewport(0,0,this.pixelWidth,this.pixelHeight),this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,this._fb),this._hasValidMipmap=!1}bindSampler(e,t=T){this.gl.activeTexture(WebGLRenderingContext.TEXTURE0+e),this.bindToActiveTextureUnit();const r=this.getSafeSampleMode(t);return r.minFilter!==this._currentSafeSampleMode.minFilter&&this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MIN_FILTER,C(r.minFilter)),r.magFilter!==this._currentSafeSampleMode.magFilter&&this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MAG_FILTER,_(r.magFilter)),this._currentSafeSampleMode=r,e}clear(e=x.FU){this.bindFb(),this.gl.clearColor(...(0,x.qX)(e)),this.gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this._hasValidMipmap=!1}copy(e){(0,w.Ww)(e)((e=>{(0,S.u)(this.root,e,(0,w.Ar)(this))}))}downloadBuffer(e,t){return this.root.performance.markTextureDownloadStart(),this.bindToActiveTextureUnit(),this.root.gl.pixelStorei(WebGLRenderingContext.PACK_ALIGNMENT,1),this.bindFb(),this.gl.readPixels(0,0,this.pixelWidth,this.pixelHeight,t.channels,t.type,e),this.root.performance.markTextureDownloadEnd(),Promise.resolve()}downloadWebGL2Buffer(e,t){const r=(0,b.sw)(this.root.ctx.gl2,"WebGL2 is required for downloading to a GL buffer");this.bindToActiveTextureUnit(),r.pixelStorei(WebGLRenderingContext.PACK_ALIGNMENT,1),this.bindFb(),r.readPixels(0,0,this.pixelWidth,this.pixelHeight,t.channels,t.type,e)}reinitializeResources(){this._throwIfDestroyed();const e=this.root.gl;this._tex=e.createTexture(),this.initializeTexture(this.pixelWidth,this.pixelHeight),e.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,1),e.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MIN_FILTER,C(this._currentSafeSampleMode.minFilter)),e.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MAG_FILTER,_(this._currentSafeSampleMode.magFilter)),e.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_WRAP_S,WebGLRenderingContext.CLAMP_TO_EDGE),e.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_WRAP_T,WebGLRenderingContext.CLAMP_TO_EDGE),this._fb=e.createFramebuffer(),e.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,this._fb),e.framebufferTexture2D(WebGLRenderingContext.FRAMEBUFFER,WebGLRenderingContext.COLOR_ATTACHMENT0,WebGLRenderingContext.TEXTURE_2D,this._tex,0)}unwrap(){return(0,w.Ar)(this)}updateSize(){const e=this.pixelWidth,t=this.pixelHeight;e===this._lastWidth&&t===this._lastHeight||this.initializeTexture(e,t)}upload(e,t){const r=(i=e)instanceof HTMLImageElement?{width:i.naturalWidth,height:i.naturalHeight}:i instanceof HTMLVideoElement?{width:i.videoWidth,height:i.videoHeight}:i instanceof VideoFrame?{width:i.displayWidth,height:i.displayHeight}:{width:i.width,height:i.height};var i;0!==r.width&&0!==r.height?(0===this.relativeWidth&&0===this.relativeHeight||this.root.ctx.logError(new Error("Uploading texture to non-upload-buffer - this is deprecated!")),this.root.performance.markTextureUploadStart(),this.bindToActiveTextureUnit(),this.gl.pixelStorei(WebGLRenderingContext.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.isAlreadyPremult?0:1),this.gl.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,t.yFlipped?0:1),this.root.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,e),this.root.performance.markTextureUploadEnd(),t.generateMipmap&&void 0!==this.root.ctx.gl2?(this.root.ctx.gl2.generateMipmap(WebGL2RenderingContext.TEXTURE_2D),this._hasValidMipmap=!0):this._hasValidMipmap=!1,this._format={internalFormat:WebGLRenderingContext.RGBA}):this.root.ctx.logError(new Error("Attempting to upload a 0x0 image"))}uploadBuffer(e,t,r,i){this.root.performance.markTextureUploadStart(),this.bindToActiveTextureUnit(),this.root.gl.pixelStorei(WebGLRenderingContext.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.isAlreadyPremult?0:1),this.root.gl.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,i.yFlipped?0:1),this.root.gl.pixelStorei(WebGLRenderingContext.UNPACK_ALIGNMENT,1),this.root.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,i.imageFormat.internalFormat,t,r,0,i.bufferFormat.channels,i.bufferFormat.type,e),this.root.performance.markTextureUploadEnd(),i.generateMipmap&&void 0!==this.root.ctx.gl2?(this.root.ctx.gl2.generateMipmap(WebGL2RenderingContext.TEXTURE_2D),this._hasValidMipmap=!0):this._hasValidMipmap=!1,this._format=i.imageFormat}_throwIfDestroyed(){if(this._destroyed)throw new Error("Texture already destroyed")}bindToActiveTextureUnit(){this._throwIfDestroyed(),this.root.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,this._tex)}destroy(){this.gl.deleteFramebuffer(this._fb),this.gl.deleteTexture(this._tex),this._destroyed=!0}initializeTexture(e,t){if(this.bindToActiveTextureUnit(),e>0&&t>0){const r=(0,y.YI)(this._format);this.root.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,this._format.internalFormat,e,t,0,r.channels,r.type,null)}this._lastWidth=e,this._lastHeight=t,this._hasValidMipmap=!1}getSafeMinFilter(e){return"nearest"===e||"linear"===e?e:this._hasValidMipmap?"prefer-mipmap":"linear"}getSafeSampleMode(e){return{minFilter:this.getSafeMinFilter(e.minFilter),magFilter:e.magFilter}}}var E=r(942552),I=r(926562);class R{get ctx(){return this._ctx}get defaultTarget(){return this._defaultTarget}get gl(){return this._ctx.gl}get jobManager(){return this._jobManager}get loaded(){return this._loadChange.getValue()}get stalled(){return this._stallChange.getValue()}get allocatedTextureCount(){return this._textures.length}get allocatedTextureApproximateSizeBytes(){let e=0;for(const t of this._textures){const r=(0,y.j7)((0,y.YI)(t.image.value.format));e+=t.image.value.pixelWidth*t.image.value.pixelHeight*r}return e}static makeBufferOwnedValue(e,t){return{value:e,free(){t.isDestroyed&&console.error("Attempting to double-free an image"),t.isDestroyed=!0}}}constructor(e,t,r,n){(0,i.A)(this,"loadChange",void 0),(0,i.A)(this,"stallChange",void 0),(0,i.A)(this,"unstallRequest",void 0),(0,i.A)(this,"loadState",void 0),(0,i.A)(this,"db",new A.f(0)),(0,i.A)(this,"_defaultTarget",void 0),(0,i.A)(this,"_destroyed",!1),(0,i.A)(this,"_destroyedSubject",new l.B),(0,i.A)(this,"_loadChange",new c.t(!1)),(0,i.A)(this,"_outputBuffer",void 0),(0,i.A)(this,"_stallChange",new c.t(!1)),(0,i.A)(this,"_textures",[]),(0,i.A)(this,"_unstallRequest",new l.B),(0,i.A)(this,"_loadState",new c.t("loading")),this._ctx=e,this._jobManager=t,this.performance=r,this.debugOverlayRenderer=n,this.loadChange=this._loadChange.pipe((0,f.F)()),this.stallChange=this._stallChange.pipe((0,f.F)()),this.unstallRequest=this._unstallRequest.asObservable(),this.loadState=this._loadState.pipe((0,f.F)()),this._defaultTarget=new E.O(this,e.gl.canvas.width,e.gl.canvas.height),this._outputBuffer=k.create(this,!0,1,1,y.bj),this._ctx.contextRestored.pipe((0,g.Q)(this._destroyedSubject)).subscribe((()=>{this._outputBuffer.value.reinitializeResources();for(const e of this._textures)e.image.value.reinitializeResources()}))}allocCopyImage(){return this.findAvailableBuffer((e=>0===e.relativeWidth&&0===e.relativeHeight),(()=>k.create(this,!1,0,0,y.bj)))}allocImage(e=!0,t=1,r=1,i=y.bj){return this.findAvailableBuffer((n=>n.relative===e&&n.relativeWidth===t&&n.relativeHeight===r&&n.format.internalFormat===i.internalFormat),(()=>k.create(this,e,t,r,i)))}cloneImage(e){return this.allocImage(e.value.relative,e.value.relativeWidth,e.value.relativeHeight,e.value.format)}destroy(){this._destroyed=!0,this._destroyedSubject.next(),this._destroyedSubject.complete(),this._loadChange.complete(),this._stallChange.complete(),this._unstallRequest.complete(),this._outputBuffer.free();for(const e of this._textures)e.image.free();this.db.clear()}render(e,t,r,i,n){if(this._destroyed)throw new Error("Attempting to render to destroyed RootNode");if(0===e.width||0===e.height)return this._outputBuffer;if(this.ctx.isContextLost())return this._outputBuffer;this.performance.markFrameStart();try{e.bind(),this.cleanupTextures(),this.renderGenerator(t,r,i,n),this.renderDebugOverlays(),this.displayGenerator()}finally{this.performance.markFrameEnd()}return this._outputBuffer}requestUnstall(e){this._unstallRequest.next(e)}setLoadState(e){this._loadState.next(e)}reset(){this._loadChange.next(!1),this._stallChange.next(!1)}cleanupTextures(){this._outputBuffer.value.updateSize();for(let e=0;e<this._textures.length;e++){const t=this._textures[e];!t.frameUse&&t.isDestroyed?(t.image.free(),this._textures.splice(e,1),e--):(t.frameUse=!1,t.image.value.updateSize())}}display(e){this.ctx.gl.viewport(0,0,this.ctx.gl.canvas.width,this.ctx.gl.canvas.height),this.ctx.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null);const t=this.ctx.features.alphaInOutput?0:1;this.ctx.gl.clearColor(0,0,0,t),this.ctx.gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT);const r=this.ctx.renderers.get(I.n);r.renderSampler.set(e.value.bindSampler(0)),r.renderToCurrent()}displayGenerator(){this.display(this._outputBuffer)}findAvailableBuffer(e,t){for(const t of this._textures){const r=t.image.value;if(t.isDestroyed&&e(r))return t.isDestroyed=!1,t.frameUse=!0,R.makeBufferOwnedValue(r,t)}const r=t(),i={image:r,isDestroyed:!1,frameUse:!0};return this._textures.push(i),this._textures.length>50&&(console.warn(`Texture memory leak detected: ${this._textures.length} textures are allocated in ${this.ctx.name}`),this.ctx.features.reportTextureLeaks&&this.ctx.logError(new Error("A texture memory leak occurred"))),R.makeBufferOwnedValue(r.value,i)}renderGenerator(e,t,r,i){e.update(t,r,i),this._loadChange.next(e.hasLoaded(t)),this._stallChange.next(e.isStalled(t)),e.render(this._outputBuffer,t)}renderDebugOverlays(){this.debugOverlayRenderer?.render(this,v.T.wrap(this._outputBuffer))}}var F=r(650882),P=r(615101);class L{constructor(){(0,i.A)(this,"_context",void 0),(0,i.A)(this,"_overlays",[])}setOverlays(e){this._overlays=[...e]}render(e,t){if(0===this._overlays.length)return void(this._context=void 0);if(!this._context){const e=document.createElement("canvas").getContext("2d");if(!e)throw new Error("Failed to create debug overlay surface");this._context=e}const r=t.value.pixelWidth,i=t.value.pixelHeight;this._context.canvas.width=r,this._context.canvas.height=i;for(const e of this._overlays)this._context.save(),e.render(this._context,{x:0,y:0,width:r,height:i}),this._context.restore();const n=e.allocCopyImage();n.value.upload(this._context.canvas,{isAlreadyPremult:!1,yFlipped:!1}),t.value.copy(n)}}class N{constructor(e,t){(0,i.A)(this,"timeElapsedQuery",void 0),(0,i.A)(this,"isRunning",!1),this.gl=e,this.disjointQuery=t,this.timeElapsedQuery=t.createQueryEXT()}markStart(){this.isRunning&&this.markEnd(),this.isRunning=!0,this.disjointQuery.beginQueryEXT(this.disjointQuery.TIME_ELAPSED_EXT,this.timeElapsedQuery)}markEnd(){this.isRunning&&(this.disjointQuery.endQueryEXT(this.disjointQuery.TIME_ELAPSED_EXT),this.isRunning=!1)}readMs(){if(this.disjointQuery.getQueryObjectEXT(this.timeElapsedQuery,this.disjointQuery.QUERY_RESULT_AVAILABLE_EXT)&&!this.gl.getParameter(this.disjointQuery.GPU_DISJOINT_EXT))return this.disjointQuery.getQueryObjectEXT(this.timeElapsedQuery,this.disjointQuery.QUERY_RESULT_EXT)/1e6}}class M{constructor(e,t){(0,i.A)(this,"timeElapsedQuery",void 0),(0,i.A)(this,"isRunning",!1),this.gl=e,this.disjointQuery=t;const r=e.createQuery();if(!r)throw new Error("Failed to create WebGL timer query");this.timeElapsedQuery=r}markStart(){this.isRunning&&this.markEnd(),this.isRunning=!0,this.gl.beginQuery(this.disjointQuery.TIME_ELAPSED_EXT,this.timeElapsedQuery)}markEnd(){this.isRunning&&(this.gl.endQuery(this.disjointQuery.TIME_ELAPSED_EXT),this.isRunning=!1)}readMs(){if(this.gl.getQueryParameter(this.timeElapsedQuery,WebGL2RenderingContext.QUERY_RESULT_AVAILABLE)&&!this.gl.getParameter(this.disjointQuery.GPU_DISJOINT_EXT))return this.gl.getQueryParameter(this.timeElapsedQuery,WebGL2RenderingContext.QUERY_RESULT)/1e6}}var B=r(709134);function D(e){return{min:e,max:e,sum:e,count:1}}function O(e,t){return{min:Math.min(e.min,t),max:Math.max(e.max,t),sum:e.sum+t,count:e.count+1}}function j(e,t){return void 0===t?e:void 0===e?D(t):O(e,t)}function U(e){return{min:e.min,max:e.max,avg:e.sum/e.count}}function z(e,t){return void 0===e?void 0:t(e)}class W{constructor(e){(0,i.A)(this,"hasFirstFrame",!1),(0,i.A)(this,"isInFrame",!1),(0,i.A)(this,"hasTextureUpload",!1),(0,i.A)(this,"hasTextureDownload",!1),(0,i.A)(this,"hasCheckError",!1),(0,i.A)(this,"hasCheckFramebuffer",!1),(0,i.A)(this,"frameTimer",new B.U),(0,i.A)(this,"textureUploadTimer",new B.U),(0,i.A)(this,"textureDownloadTimer",new B.U),(0,i.A)(this,"checkErrorTimer",new B.U),(0,i.A)(this,"checkFramebufferTimer",new B.U),(0,i.A)(this,"gpuTimer",void 0),(0,i.A)(this,"lastFrameTimes",void 0),(0,i.A)(this,"currentStats",void 0),this.ctx=e,this.initialize(),e.contextRestored.subscribe((()=>this.initialize()))}initialize(){if(this.ctx.gl2){const e=this.ctx.gl2.getExtension("EXT_disjoint_timer_query_webgl2");e&&(this.gpuTimer=new M(this.ctx.gl2,e))}else{const e=this.ctx.gl.getExtension("EXT_disjoint_timer_query");e&&(this.gpuTimer=new N(this.ctx.gl,e))}}collectTimers(){const e=this.frameTimer.currentMs,t=this.textureUploadTimer.currentMs,r=this.textureDownloadTimer.currentMs,i=this.checkErrorTimer.currentMs,n=this.checkFramebufferTimer.currentMs,o=e+t+r+i+n;return{lastFrameGpuMs:this.gpuTimer?this.gpuTimer.readMs():void 0,frameMs:e,textureUploadMs:t,textureDownloadMs:r,checkErrorMs:i,checkFramebufferMs:n,totalMs:o}}makeAccumuleStats(e){return{frameCpuDurationMs:D(e.frameMs),frameGpuDurationMs:z(e.lastFrameGpuMs,D),frameCpuTextureUploadMs:this.hasTextureUpload?D(e.textureUploadMs):void 0,frameCpuTextureDownloadMs:this.hasTextureDownload?D(e.textureDownloadMs):void 0,frameCpuCheckErrorMs:this.hasCheckError?D(e.checkErrorMs):void 0,frameCpuCheckFramebufferMs:this.hasCheckFramebuffer?D(e.checkFramebufferMs):void 0,frameCpuTotalMs:D(e.totalMs)}}deriveAccumulateStats(e,t){return{frameCpuDurationMs:O(e.frameCpuDurationMs,t.frameMs),frameGpuDurationMs:j(e.frameGpuDurationMs,t.lastFrameGpuMs),frameCpuTextureUploadMs:j(e.frameCpuTextureUploadMs,this.hasTextureUpload?t.textureUploadMs:void 0),frameCpuTextureDownloadMs:j(e.frameCpuTextureDownloadMs,this.hasTextureDownload?t.textureDownloadMs:void 0),frameCpuCheckErrorMs:j(e.frameCpuCheckErrorMs,this.hasCheckError?t.checkErrorMs:void 0),frameCpuCheckFramebufferMs:j(e.frameCpuCheckFramebufferMs,this.hasCheckFramebuffer?t.checkFramebufferMs:void 0),frameCpuTotalMs:O(e.frameCpuTotalMs,t.totalMs)}}pushFrame(){const e=this.collectTimers();this.lastFrameTimes=e,void 0===this.currentStats?this.currentStats=this.makeAccumuleStats(e):this.currentStats=this.deriveAccumulateStats(this.currentStats,e)}collect(){if(void 0===this.currentStats)return;const e=this.currentStats;return this.currentStats=void 0,{frameCpuDurationMs:U(e.frameCpuDurationMs),frameGpuDurationMs:z(e.frameGpuDurationMs,U),frameCpuTextureUploadMs:z(e.frameCpuTextureUploadMs,U),frameCpuTextureDownloadMs:z(e.frameCpuTextureDownloadMs,U),frameCpuCheckErrorMs:z(e.frameCpuCheckErrorMs,U),frameCpuCheckFramebufferMs:z(e.frameCpuCheckFramebufferMs,U),frameCpuTotalMs:U(e.frameCpuTotalMs)}}markFrameStart(){this.hasFirstFrame&&this.pushFrame(),this.gpuTimer&&this.gpuTimer.markStart(),this.hasTextureUpload=!1,this.hasTextureDownload=!1,this.hasCheckError=!1,this.hasCheckFramebuffer=!1,this.hasFirstFrame=!0,this.isInFrame=!0,this.frameTimer.clear(),this.textureUploadTimer.clear(),this.textureDownloadTimer.clear(),this.checkErrorTimer.clear(),this.checkFramebufferTimer.clear(),this.frameTimer.start()}markFrameEnd(){this.gpuTimer&&this.gpuTimer.markEnd(),this.frameTimer.stop(),this.isInFrame=!1}markTextureUploadStart(){this.hasTextureUpload=!0,this.textureUploadTimer.start(),this.isInFrame&&this.frameTimer.stop()}markTextureUploadEnd(){this.textureUploadTimer.stop(),this.isInFrame&&this.frameTimer.start()}markTextureDownloadStart(){this.hasTextureDownload=!0,this.textureDownloadTimer.start(),this.isInFrame&&this.frameTimer.stop()}markTextureDownloadEnd(){this.textureDownloadTimer.stop(),this.isInFrame&&this.frameTimer.start()}markCheckErrorStart(){this.hasCheckError=!0,this.checkErrorTimer.start(),this.isInFrame&&this.frameTimer.stop()}markCheckErrorEnd(){this.checkErrorTimer.stop(),this.isInFrame&&this.frameTimer.start()}markCheckFramebufferStart(){this.hasCheckFramebuffer=!0,this.checkFramebufferTimer.start(),this.isInFrame&&this.frameTimer.stop()}markCheckFramebufferEnd(){this.checkFramebufferTimer.stop(),this.isInFrame&&this.frameTimer.start()}getFrameCpuMs(){return this.lastFrameTimes?.totalMs}getFrameGpuMs(){return this.lastFrameTimes?.lastFrameGpuMs}}const V={markFrameStart(){},markFrameEnd(){},markTextureUploadStart(){},markTextureUploadEnd(){},markTextureDownloadStart(){},markTextureDownloadEnd(){},markCheckErrorStart(){},markCheckErrorEnd(){},markCheckFramebufferStart(){},markCheckFramebufferEnd(){}};var H;const G="GlobalCtxInitializing",q="GlobalCtxReady",Q=`${G}${q}Delta`;function K(e){const t=new Set;return(r,i)=>{t.has(r.message)||(t.add(r.message),e(r,i))}}const X=["global","background","thumbnail"];function Y(e){if(!X.includes(e))throw new F.g9((0,P.vU)("Superfill context has an invalid name"),{name:e})}let Z=(0,n.Gr)()(H=Reflect.metadata("design:type",Function)(H=Reflect.metadata("design:paramtypes",[])(H=class{constructor(){(0,i.A)(this,"backgroundCtx",void 0),(0,i.A)(this,"backgroundRoot",void 0),(0,i.A)(this,"globalCtx",void 0),(0,i.A)(this,"globalRoot",void 0),(0,i.A)(this,"globalPerf",void 0),(0,i.A)(this,"initSuccessful",!1),(0,i.A)(this,"jobManager",void 0),(0,i.A)(this,"thumbnailCtx",void 0),(0,i.A)(this,"thumbnailRoot",void 0),(0,i.A)(this,"debugOverlay",new L),(0,i.A)(this,"features",{level:"prefer-webgl2",reportTextureLeaks:(0,s.G7)("texture_leak_error"),alphaInOutput:!1}),(0,i.A)(this,"_exportRenderCtx",void 0),(0,i.A)(this,"eventLogger",{logContextLost:e=>this.logContextLost(e),logContextRestored:e=>this.logContextRestored(e),logError:K(((e,t)=>{switch(t){case"warning":this.logSuperfillWarning(e);break;case"fatal":throw e}}))});const e=this.tryInitialize();switch(e.status){case"success":this.globalCtx=e.globalCtx,this.globalRoot=e.globalRoot,this.globalPerf=e.globalPerf,this.jobManager=e.jobManager,this.thumbnailCtx=e.thumbnailCtx,this.thumbnailRoot=e.thumbnailRoot,this.backgroundCtx=e.backgroundCtx,this.backgroundRoot=e.backgroundRoot,this.initSuccessful=!0;break;case"failure":this.initSuccessful=!1}}get exportRenderCtx(){return this._exportRenderCtx||(this._exportRenderCtx=new p("babylon-export",{...this.features},this.eventLogger)),this._exportRenderCtx}tryInitialize(){try{performance.mark(G);const e=this.features,t=this.eventLogger,r=new p("global",e,t),i=new p("background",e,t),n=new p("thumbnail",{...e,alphaInOutput:!0},t),o=new m.r,s=new W(r),a=new R(r,o,s,this.debugOverlay),c=new R(i,o,V,void 0),l=new R(n,o,V,void 0);performance.mark(q);const d=performance.measure(Q,G,q),u=r.gl.getExtension("WEBGL_debug_renderer_info");return this.logCompositorReady(d,void 0!==r.gl2,r.gl.getParameter(u?.UNMASKED_RENDERER_WEBGL??WebGLRenderingContext.RENDERER),r.gl.getParameter(u?.UNMASKED_VENDOR_WEBGL??WebGLRenderingContext.VENDOR)),function(e,t,r,i,n,o,s,a){return{status:"success",globalCtx:e,globalRoot:t,globalPerf:r,jobManager:i,thumbnailCtx:n,thumbnailRoot:o,backgroundCtx:s,backgroundRoot:a}}(r,a,s,o,n,l,i,c)}catch(e){return this.logCompositorInitializeError(e),function(e){return{status:"failure",error:e}}(e)}}logCompositorReady(e,t,r,i){const n={supportsWebGL2:t,glRenderer:r,glVendor:i};o.z.setUserProperties(n),a.Vy.setExtraContext(n),o.z.logAppLogicEvent("CompositorReady",{startTimeMs:e.startTime,durationMs:e.duration,supportsWebgl2:t,webglRendererName:r,webglVendorName:i})}logCompositorInitializeError(e){const t=e instanceof Error?e.name:`${e}`,r=e instanceof Error?e.message:void 0;o.z.logEvent("Error - Hardware Rejection",{kind:"WebGL",stack:t,message:r}),a.Vy.setExtraContext({initializeError:e}),a.Vy.error("Error initializing RenderContext"),o.z.logErrorEvent("CompositorInitializeError",{errorAlertType:"Fatal",stack:t,message:r})}logContextLost(e){Y(e),o.z.logEvent("WebGL - Context Lost",{renderContext:e}),o.z.logErrorEvent("CompositorContextLost",{contextName:e})}logContextRestored(e){Y(e),o.z.logEvent("WebGL - Context Restored",{renderContext:e}),o.z.logAppLogicEvent("CompositorContextRestored",{contextName:e})}logSuperfillWarning(e){a.Vy.error(e),(0,s.G7)("editor__performance_metrics")&&(0,s.G7)("webgl_error_analytics")&&o.z.logEvent("Error - Frame render failed",{message:e.message}),o.z.logWarningEvent("CompositorRenderWarning",{errorAlertType:"Warning",stack:e.stack,message:e.message})}})||H)||H)||H},528864:(e,t,r)=>{r.d(t,{g:()=>se,J:()=>oe});var i=r(324586),n=r(825702),o=r(776303),s=r(701724),a=r(571056),c=r(529616),l=r(16885),d=r(972070),u=r(650882),h=r(615101),p=r(847269),m=r(776016);function f(e,t){return new Promise(((r,i)=>{const n=document.createElement("script");n.id=t,n.async=!0,n.onload=()=>{r(clipchampPlugin.default)},n.onerror=t=>{n.remove(),i(new u.g9((0,h.vU)("Could not load plugin script."),{src:e,error:t}))},n.src=e,document.body.appendChild(n)}))}async function g(e,t){for(let r=0;r<4;r++)try{return await f(e,t)}catch(t){console.warn(`Failed to load plugin from ${e}, retrying (${r+1}/5)`),await new Promise((e=>setTimeout(e,1e3)))}return f(e,t)}class A{constructor(){(0,i.A)(this,"match",/(https:\/\/[.a-z\-]+\.clipchamp\.com\/)|((static|clipchamp-assets)\/content\/plugins\/)/i)}async load(e){const t=e.split("/").pop();return(0,p.iY)(t,"Expected plugin id to be defined"),g(e,t.substring(4,t.length-3).toLocaleLowerCase())}}class v{constructor(){(0,i.A)(this,"match",new RegExp("^cloudstore:[0-9a-f]{32}$","i"))}async load(e){const t=e.split(":").pop();if(!t)throw new u.g9((0,h.vU)("Invalid src for brand kit plugin source"),{src:e});const r=await d.E.get(`storage/brand/${t}/download`),{download_url:i}=await r.json((0,m.t9)({download_url:m.Kg}));return g(i,t)}}class y{constructor(...e){(0,i.A)(this,"cachedPlugins",{}),(0,i.A)(this,"sources",void 0),this.sources=e}async load(e){for(const t of this.sources)if(e.match(t.match)){if(e in this.cachedPlugins)return this.cachedPlugins[e];const r=t.load(e);return r.catch((()=>{delete this.cachedPlugins[e]})),this.cachedPlugins[e]=r,r}return Promise.reject(new u.g9((0,h.vU)("Refused to load plugin script. No plugin source defined for url schema."),{src:e}))}}let b;function w(){return b||(b=new y(new v,new A),b)}const x=new Map,S={loadLutImage:function(e,t){let r,i=!1;const n=function(e){const t=x.get(e);if(void 0!==t)return t;const r=new Promise(((t,r)=>{const i=document.createElement("img");i.onload=()=>t(i),i.onerror=()=>r(new Error("Failed to load LUT image")),i.crossOrigin="anonymous",i.src=e}));return x.set(e,r),r}(t).then((t=>{if(i)return new Promise((()=>{}));if(0===t.width||0===t.height)return;const n=e.allocCopyImage();return n.value.upload(t,{isAlreadyPremult:!0,yFlipped:!0}),r=n,n.value}));return{value:n,free(){if(i)throw new Error("Attempting to destroy a LUT that has already been destroyed");i=!0,r&&r.free()}}}};var T=r(374380);function C(){return{value:{getSource:()=>(0,T.N)()},free:()=>{}}}var _,k=r(573340);class E extends Error{constructor(){super("Font cache has been destroyed")}}class I{constructor(e,t,r){(0,i.A)(this,"_primaryProvider",void 0),(0,i.A)(this,"fontCollection",void 0),(0,i.A)(this,"_destroyed",!1),this._primaryProvider=e.TypefaceFontProvider.Make(),this.fontCollection=e.FontCollection.Make(),this.fontCollection.setDefaultFontManager(this._primaryProvider);for(const e of t)this._primaryProvider.registerFont(e.buffer,e.alias);for(const e of r)this._primaryProvider.registerFallbackFont(e.buffer)}getMissingGlyphs(){return[...this.fontCollection.getMissingGlyphs()]}destroy(){this._assertNotDestroyed(),this._destroyed=!0,this._primaryProvider.delete(),this.fontCollection.delete()}_assertNotDestroyed(){if(this._destroyed)throw new E}}class R extends Error{constructor(){super("Could not create a CanvasKit surface")}}class F extends Error{constructor(){super("Surface has been destroyed")}}class P extends Error{constructor(){super("Could not resize surface")}}class L{get canvasElement(){return this._canvas}get surface(){return this._surface}constructor(e,t,r){(0,i.A)(this,"_destroyed",!1),(0,i.A)(this,"_canvas",void 0),(0,i.A)(this,"_surface",void 0),this.canvaskit=e,this._canvas=document.createElement("canvas"),this._canvas.width=t,this._canvas.height=r;const n=e.MakeWebGLCanvasSurface(this._canvas,void 0);if(!n)throw new R;this._surface=n}clear(){this._assertNotDestroyed(),this._surface.getCanvas().clear(this.canvaskit.TRANSPARENT)}flush(){this._assertNotDestroyed(),this._surface.flush()}setSize(e,t){if(this._assertNotDestroyed(),e===this._canvas.width&&t===this._canvas.height)return;if(e<=0||t<=0)throw new P;this._canvas.width=e,this._canvas.height=t,this._surface?.delete();const r=this.canvaskit.MakeWebGLCanvasSurface(this._canvas,void 0);r&&(this._surface=r)}destroy(){this._assertNotDestroyed(),this._destroyed=!0,this._surface.delete(),this._canvas.remove()}_assertNotDestroyed(){if(this._destroyed)throw new F}}class N{constructor(e){(0,i.A)(this,"_surface",void 0),this.canvaskit=e,this._surface=new L(this.canvaskit,0,0)}get surface(){return this._surface}createFontCache(e,t){return new I(this.canvaskit,e,t)}}class M{constructor(){(0,i.A)(this,"_modulePromise",void 0),(0,i.A)(this,"_module",void 0)}async load(){if(!this._modulePromise){this._modulePromise=async function(){const e=(await Promise.resolve().then(r.t.bind(r,293413,17))).default,t=await Promise.all([r.e(84893),r.e(85697)]).then(r.t.bind(r,484893,23)),i=await t.default({locateFile:t=>{if("canvaskit.wasm"===t)return e}});return new N(i)}();try{this._module=await this._modulePromise}catch(e){k.Vy.error(e)}}return this._modulePromise}get module(){return this._module}}let B=(0,n.Gr)()(_=class{constructor(){(0,i.A)(this,"integration",new M)}})||_;r(379321),r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997);var D=r(241472),O=r(673101),j=r(815731),U=r(953734),z=r(943873),W=r(342455);function V(e,t){return{value:e.value,free:()=>setTimeout(e.free,t)}}var H,G=r(540076),q=r(481973),Q=r(488510);let K=(0,n.Gr)()(H=function(e){return(0,n.WQ)(q.jR)(e,void 0,0)}(H=function(e){return(0,n.WQ)(B)(e,void 0,1)}((X=H=Reflect.metadata("design:type",Function)(H=Reflect.metadata("design:paramtypes",[void 0===q.MC?Object:q.MC,void 0===B?Object:B,void 0===Q.mP?Object:Q.mP])(H=class{constructor(e,t,r){(0,i.A)(this,"hasQueuedFontCacheUpdate",!1),(0,i.A)(this,"hasQueuedScanMissingGlyphs",!1),(0,i.A)(this,"fontCache",void 0),(0,i.A)(this,"fontCacheChanged$",void 0),(0,i.A)(this,"currentCachedKeys",new Set),(0,i.A)(this,"currentDocumentFonts",new Map),(0,i.A)(this,"files",W.w.create()),(0,i.A)(this,"fonts",W.w.create()),(0,i.A)(this,"fallbackTypefaces",new Map),(0,i.A)(this,"seenMissingGlyphs",new Set),this.fontResolver=e,this.canvaskitService=t,this.fontCache=new Y(r.globalRoot),this.fontCacheChanged$=this.fontCache.cache$.pipe((0,D.i)(1),(0,O.T)((()=>{})))}getFontCache(){return this.fontCache.cache$.value}queueScanMissingGlyphs(){this.hasQueuedScanMissingGlyphs||(this.hasQueuedScanMissingGlyphs=!0,queueMicrotask((()=>{this.hasQueuedScanMissingGlyphs=!1,this.scanMissingGlyphs()})))}scanMissingGlyphs(){const e=this.getFontCache();if(void 0===e)return;const t=e.getMissingGlyphs();for(const e of t){if(this.seenMissingGlyphs.has(e))continue;this.seenMissingGlyphs.add(e);const t=this.fontResolver.getFallbackTypeface(e);void 0!==t&&(this.fallbackTypefaces.has(t.id)||this.fallbackTypefaces.set(t.id,this.getTypeface(t,{weight:400,style:"normal"})))}}ensureFontCollection(){void 0===this.getFontCollection()&&this.fontCache.next(this.canvaskitService.integration.load().then((e=>e.createFontCache([],[]))))}getFontCollection(){return this.fontCache.cache$.value?.fontCollection}async getTypefaceLoader(e){const t=await this.fontResolver.resolveFont(e.fontId),r=(0,U.Z)(e.fontWeight,t.variants,e.isItalic?"italic":void 0);(0,p.iY)(r,"Variant should always be defined");const i=t.getFile(r),n=`"${e.fontId}"-"${i.id}"`;return{type:"font",cacheKey:n,load:()=>{const t=this.fonts.value.get(n,(()=>this.createFontIdFileMapping(e.fontId,i,{weight:r.weight,style:r.feature??"normal"})));return{data:(o=t.value.typeface,{isLoaded:()=>o.value.hasLoaded,wait:()=>o.value.promise}),unload:()=>{t.free()}};var o}}}createFontIdFileMapping(e,t,r){const i=this.getTypeface(t,r);return this.queueUpdateFontCache(),{value:{fontId:e,typeface:i},free:()=>i.free()}}getTypeface(e,t){let r;const i=this.files.value.get(e.id,(()=>{const[i,n]=this.createTypeface(e,t);return r=n,i}));return void 0!==r&&r(i.ref()),V(i,6e4)}createTypeface(e,t){let r;const i={fileId:e.id,variant:t,hasLoaded:!1,buffer:void 0,promise:e.fetch().then((e=>{i.buffer=e,i.hasLoaded=!0,this.queueUpdateFontCache()})).catch((t=>{i.hasLoaded=!0,k.Vy.error(u.g9.fromUnknownError(t,"Could not load font file",{fileId:e.id}))})).finally((()=>{r?.free()}))};return[{value:i,free:()=>{(0,G.vA)(i.hasLoaded,"should not be able to free a typeface before it has loaded")}},e=>{r=e}]}queueUpdateFontCache(){this.hasQueuedFontCacheUpdate||(this.hasQueuedFontCacheUpdate=!0,queueMicrotask((()=>{this.hasQueuedFontCacheUpdate=!1,this.updateFontCache(),this.updateDocumentFonts()})))}updateFontCache(){let e=!1;const t=new Set,r=[],i=[],n=this.fonts.value.entryRefs();for(const[i,o]of n)void 0!==o.typeface.value.buffer&&(this.currentCachedKeys.has(i)||(e=!0),t.add(i),r.push({alias:o.fontId,buffer:o.typeface.value.buffer}));for(const[,r]of this.fallbackTypefaces){if(void 0===r.value.buffer)continue;const n=`"fallback"-"${r.value.fileId}"`;this.currentCachedKeys.has(n)||(e=!0),t.add(n),i.push({alias:n,buffer:r.value.buffer})}e&&(this.currentCachedKeys=t,this.fontCache.next(this.canvaskitService.integration.load().then((e=>e.createFontCache(r,i)))))}updateDocumentFonts(){const e=this.fonts.value.entryRefs().map((([e,t])=>({key:e,mapping:t}))),t=new Set;for(const{key:r,mapping:i}of e)if(void 0!==i.typeface.value.buffer&&(t.add(r),!this.currentDocumentFonts.has(r)))try{const e=new FontFace(`content:${i.fontId}`,i.typeface.value.buffer,{weight:i.typeface.value.variant.weight.toString(),style:i.typeface.value.variant.style});this.currentDocumentFonts.set(r,e),document.fonts.add(e)}catch(e){k.Vy.error(u.g9.fromUnknownError(e,"Failed to laod font file to document")),i.typeface.value.buffer=void 0}for(const[e,r]of this.currentDocumentFonts)t.has(e)||(this.currentDocumentFonts.delete(e),document.fonts.delete(r))}})||H)||H,H=(0,n.WQ)(Q.mP)(X,void 0,2)||H))||H)||H)||H;var X;class Y{constructor(e){(0,i.A)(this,"generation",0),(0,i.A)(this,"nextGeneration",1),(0,i.A)(this,"cache$",new j.t(void 0)),this.root=e}next(e){const t=this.nextGeneration++;e.then((e=>{this.generation>t?e.destroy():(this.root.db.set(z.Qk,void 0),this.root.db.set(z.Qk,e.fontCollection),this.cache$.value?.destroy(),this.cache$.next(e),this.generation=t)})).catch((e=>{k.Vy.error(u.g9.fromUnknownError(e,"Could not create font cache"))}))}}var Z,J=r(645375),$=r(402850);let ee=(0,n.Gr)()(Z=class{constructor(){(0,i.A)(this,"integration",new J.X(void 0,$))}})||Z;var te;let re=(0,n.Gr)()(te=function(e){return(0,n.WQ)(q.jR)(e,void 0,0)}(te=function(e){return(0,n.WQ)(ee)(e,void 0,1)}(te=Reflect.metadata("design:type",Function)(te=Reflect.metadata("design:paramtypes",[void 0===q.MC?Object:q.MC,void 0===ee?Object:ee])(te=class{constructor(e,t){(0,i.A)(this,"hasQueuedFontCacheUpdate",!1),(0,i.A)(this,"hasQueuedScanMissingGlyphs",!1),(0,i.A)(this,"fontCache",new ie),(0,i.A)(this,"fontCacheChanged$",this.fontCache.cache$.pipe((0,D.i)(1),(0,O.T)((()=>{})))),(0,i.A)(this,"currentCachedKeys",new Set),(0,i.A)(this,"currentDocumentFonts",new Map),(0,i.A)(this,"files",W.w.create()),(0,i.A)(this,"fonts",W.w.create()),(0,i.A)(this,"fallbackTypefaces",new Map),(0,i.A)(this,"seenMissingGlyphs",new Set),this.fontResolver=e,this.libverse=t}getFontCache(){return this.fontCache.cache$.value}async getTypefaceLoader(e){const t=await this.fontResolver.resolveFont(e.fontId),r=(0,U.Z)(e.fontWeight,t.variants,e.isItalic?"italic":void 0);(0,p.iY)(r,"Variant should always be defined");const i=t.getFile(r),n=`"${e.fontId}"-"${i.id}"`;return{type:"font",cacheKey:n,load:()=>{const t=this.fonts.value.get(n,(()=>this.createFontIdFileMapping(e.fontId,i,{weight:r.weight,style:r.feature??"normal"})));return{data:(o=t.value.typeface,{isLoaded:()=>o.value.hasLoaded,wait:()=>o.value.promise}),unload:()=>{t.free()}};var o}}}queueScanMissingGlyphs(){this.hasQueuedScanMissingGlyphs||(this.hasQueuedScanMissingGlyphs=!0,queueMicrotask((()=>{this.hasQueuedScanMissingGlyphs=!1,this.scanMissingGlyphs()})))}waitForFallbacks(){const e=[];for(const t of this.fallbackTypefaces.values())e.push(t.value.promise);return Promise.all(e).then((()=>{}))}scanMissingGlyphs(){const e=this.getFontCache();if(void 0===e)return;const t=e.getMissingGlyphs();for(let e=0;e<t.length;e++){const r=t[e];if(this.seenMissingGlyphs.has(r))continue;this.seenMissingGlyphs.add(r);const i=this.fontResolver.getFallbackTypeface(r);void 0!==i&&(this.fallbackTypefaces.has(i.id)||this.fallbackTypefaces.set(i.id,this.getTypeface(i,{weight:400,style:"normal"})))}}createFontIdFileMapping(e,t,r){const i=this.getTypeface(t,r);return this.queueUpdateFontCache(),{value:{fontId:e,typeface:i},free:()=>i.free()}}getTypeface(e,t){let r;const i=this.files.value.get(e.id,(()=>{const[i,n]=this.createTypeface(e,t);return r=n,i}));return void 0!==r&&r(i.ref()),V(i,6e4)}createTypeface(e,t){let r;const i={fileId:e.id,variant:t,hasLoaded:!1,buffer:void 0,typeface:void 0,promise:e.fetch().then((async e=>{i.buffer=e;const t=await this.libverse.integration.getModule(),r=t.createDataFromBuffer(e);try{i.typeface=t.parseTypeface(r),i.hasLoaded=!0,this.queueUpdateFontCache()}finally{r.destroy()}})).catch((t=>{i.typeface=void 0,i.hasLoaded=!0,k.Vy.error(u.g9.fromUnknownError(t,"Could not load font file",{fileId:e.id}))})).finally((()=>{r?.free()}))};return[{value:i,free:()=>{(0,G.vA)(i.hasLoaded,"should not be able to free a typeface before it has loaded"),i.typeface?.destroy()}},e=>{r=e}]}queueUpdateFontCache(){this.hasQueuedFontCacheUpdate||(this.hasQueuedFontCacheUpdate=!0,queueMicrotask((()=>{this.hasQueuedFontCacheUpdate=!1,this.updateFontCache(),this.updateDocumentFonts()})))}updateFontCache(){let e=!1;const t=new Set,r=[],i=[],n=this.fonts.value.entryRefs();for(const[i,o]of n)void 0!==o.typeface.value.typeface&&(this.currentCachedKeys.has(i)||(e=!0),t.add(i),r.push({alias:o.fontId,typeface:o.typeface.value.typeface}));for(const[,r]of this.fallbackTypefaces){if(void 0===r.value.typeface)continue;const n=`"fallback"-"${r.value.fileId}"`;this.currentCachedKeys.has(n)||(e=!0),t.add(n),i.push(r.value.typeface)}e&&(this.currentCachedKeys=t,this.fontCache.next(this.libverse.integration.getModule().then((e=>e.createFontCache(r,i)))))}updateDocumentFonts(){const e=this.fonts.value.entryRefs().map((([e,t])=>({key:e,mapping:t})));for(const[,t]of this.fallbackTypefaces){const r=`"fallback"-"${t.value.fileId}"`;e.push({key:r,mapping:{fontId:"fallback",typeface:t}})}const t=new Set;for(const{key:r,mapping:i}of e)if(void 0!==i.typeface.value.buffer&&(t.add(r),!this.currentDocumentFonts.has(r)))try{const e=new FontFace(`content:${i.fontId}`,i.typeface.value.buffer,{weight:i.typeface.value.variant.weight.toString(),style:i.typeface.value.variant.style});this.currentDocumentFonts.set(r,e),document.fonts.add(e)}catch(e){k.Vy.error(u.g9.fromUnknownError(e,"Failed to laod font file to document")),i.typeface.value.buffer=void 0}for(const[e,r]of this.currentDocumentFonts)t.has(e)||(this.currentDocumentFonts.delete(e),document.fonts.delete(r))}})||te)||te)||te)||te)||te;class ie{constructor(){(0,i.A)(this,"generation",0),(0,i.A)(this,"nextGeneration",1),(0,i.A)(this,"cache$",new j.t(void 0))}next(e){const t=this.nextGeneration++;e.then((e=>{this.generation>t?e.destroy():(this.cache$.value?.destroy(),this.cache$.next(e),this.generation=t)})).catch((e=>{k.Vy.error(u.g9.fromUnknownError(e,"Could not create font cache"))}))}}var ne;let oe=(0,n.Gr)()(ne=function(e){return(0,n.WQ)(a.e)(e,void 0,0)}(ne=function(e){return(0,n.WQ)(o.h)(e,void 0,1)}(ne=function(e){return(0,n.WQ)(q.jR)(e,void 0,2)}(ne=function(e){return(0,n.WQ)(re)(e,void 0,3)}(ne=function(e){return(0,n.WQ)(ee)(e,void 0,4)}(ne=function(e){return(0,n.WQ)(B)(e,void 0,5)}(ne=function(e){return(0,n.WQ)(K)(e,void 0,6)}(ne=Reflect.metadata("design:type",Function)(ne=Reflect.metadata("design:paramtypes",[void 0===s.qI?Object:s.qI,void 0===o.h?Object:o.h,void 0===q.MC?Object:q.MC,void 0===re?Object:re,void 0===ee?Object:ee,void 0===B?Object:B,void 0===K?Object:K])(ne=class{constructor(e,t,r,n,o,s,a){(0,i.A)(this,"clipPreloadSecs",5),(0,i.A)(this,"defaultFeatures",{useManagedMediaNodes:!1}),this.assetResolver=e,this.assetCaching=t,this.fontResolver=r,this.fontCache=n,this.libverse=o,this.canvaskit=s,this.canvaskitFontCache=a}createGraphContext(e,t,r,i,n,o,s){return{features:{...this.defaultFeatures,...e},root:t,profile:r,createAudioHandle:i,assetResolver:this.assetResolver,assetCaching:this.assetCaching,fontCache:new c.w,getPluginFontProviders:()=>this.fontResolver.getFontProviders(),getPluginManager:w,clipPreloadSecs:this.clipPreloadSecs,audioOut:n,resourceManager:new l.Q,fontCacheHandle:this.fontCache,requestRender:o,compatDevice:s,lutLoader:S,libverse:this.libverse.integration,canvaskit:this.canvaskit.integration,canvaskitFontCacheHandle:this.canvaskitFontCache}}createTempContext(e){return this.createGraphContext(this.defaultFeatures,e,{type:"preview"},C,void 0,(()=>{}),void 0)}})||ne)||ne)||ne)||ne)||ne)||ne)||ne)||ne)||ne)||ne;const se="graphContextFactoryService"},822829:(e,t,r)=>{r.d(t,{D:()=>s});const i=6e4;function n(e){return e}function o(e,t,r){const i=e.collect();i&&t.setUserProperties(r(i))}function s(e,t,r=n){const s=setInterval((()=>{o(e,t,r)}),i);return()=>{o(e,t,r),clearInterval(s)}}},82979:(e,t,r)=>{function i(e){return"video"===e.type||"audio"===e.type}r.d(t,{e:()=>v,Q:()=>A}),r(379321);var n=r(74987),o=r(932808),s=r(324586),a=r(989263),c=(r(34456),r(159129),r(940233),r(270818),r(513173),r(205218),r(387427)),l=r(104455);const d=new Float32Array(c.D8);class u{constructor(e){this.getSources=e}waitForDataAt(e){const t=this.getSources(e).map((e=>e.source.waitForDataAt(e.timeSecs)));return Promise.all(t).then((()=>{}))}trySampleDataAt(e){return function(e){d.fill(0);for(const t of e)for(let e=0;e<c.D8;e++)d[e]+=(0,l.qL)(t.buckets[e])*t.volume;const t=new Uint8Array(c.D8);for(let e=0;e<c.D8;e++)t[e]=(0,l.aW)(d[e]);return t}(this.getSources(e).map((e=>({buckets:e.source.trySampleDataAt(e.timeSecs),volume:e.volume}))))}}class h{constructor(e,t){(0,s.A)(this,"dependencies",a.A.create()),this.getDependencies=e,this.getActive=t}destroy(){this.dependencies.free()}getSource(e,t){const r=this.getDependencies(e,t).map((e=>this.dependencies.value.get(e.cacheKey,e.createSource)));this.dependencies.value.collectGarbage();for(const e of r)e.free();return new u((r=>this.getActive(r).map((i=>{const n=this.dependencies.value.tryGetRef(i.cacheKey);if(void 0===n)throw new Error(`Active source at ${r}s was not provided in dependency list for range ${e}s-${e+t}s`);return{source:n,volume:i.volume,timeSecs:i.timeSecs}}))))}}function p(e){return 0===e.volume||1!==e.speed}function m(e){const t=[];for(const r of e)if(i(r))for(const e of r.items)(0,n.j)(e)&&!p(e)&&t.push(e);return t}function f(e){let t=0,r=0;const i=e.fadeInOut;i&&(t=i.fadeInSeconds,r=i.fadeOutSeconds);const n=e;return n.transitionIn&&(t=n.transitionIn.durationInS),n.transitionOut&&(r=n.transitionOut.durationInS),{fadeInSeconds:t,fadeOutSeconds:r}}function g(e,t,r){const i=e.fadeInSeconds,n=t-e.fadeOutSeconds;let o=1;return r<0?o=0:r<i&&(o*=r/e.fadeInSeconds),r>=t?o=0:r>=n&&(o*=1-(r-n)/e.fadeOutSeconds),o}function A(e,t){return function(){const r=new h(((r,i)=>function(e,t,r,i){const n=e+t,s=m(r),a=[];for(const t of s){const r=t.startTime+t.duration;(0,o.Su)(e,n,t.startTime,r)&&a.push({cacheKey:t.asset.id,createSource:()=>i.getSource(t.asset)})}return a}(r,i,e.tracks,t)),(t=>function(e,t){const r=m(t),i=[];for(const t of r){const r=t.startTime+t.duration;if(!(0,o.Qq)(e,t.startTime,r))continue;const n=e-t.startTime,s=f(t),a=t.volume;let c=void 0===a?1:a;c*=g(s,t.duration,n),i.push({cacheKey:t.asset.id,volume:c,timeSecs:n+t.trim.from})}return i}(t,e.tracks)));return{value:r,free(){r.destroy()}}}()}class v{constructor(e,t){this.assetCache=e,this.tracks=t}createAudioCache(){return A(this,this.assetCache)}}},835592:(e,t,r)=>{r.d(t,{R:()=>o}),r(379321);var i=r(468910);function n(e,t){for(let r=e.length-1;r>=0;r--){const i=e[r];if(t(i))return i}}const o={async updateTracks(e,t){let r=i.e;const o=[];e.setNumTracks(t.length);for(let r=t.length-1;r>=0;r--){const i=t[r],s=i.items,a=i.transitions,c=e.items[r];c.setNumItems(s.length),c.setNumTransitions(a.length),c.hidden=!!i.hidden;for(let e=0;e<s.length;e++){const t=s[e],r=c.trackItems[e].updateItem(t);o.push(r)}for(let e=0;e<a.length;e++){const t=a[e],r=c.transitions[e],i=n(s,(e=>e.id===t.fromId));void 0!==i&&r.updateItem(t,i.startTime+i.duration-t.durationInS)}c.fitDuration()}e.fitDuration();const s=await Promise.all(o);for(const e of s)r=(0,i.D)(r,e);return r}}},782668:(e,t,r)=>{r.d(t,{M:()=>_e});var i=r(324586),n=(r(379321),r(650882)),o=r(615101);function s(e){return{status:"fulfilled",value:e}}function a(e){return{status:"rejected",error:e}}function c(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.error;default:throw new n.eP((0,o.vU)("Invalid reflection status"))}}function l(e){return e.then(s,a)}function d(e){return Promise.all(e).then((e=>e.map(c)))}var u=r(471189);function h(e,t){t.clear();for(const r of e){const e=r.cont();e.catch((()=>{})),t.set(r.item,{next:e,cleanup:r.cleanup})}}async function p(e,t,r,i,n){const o=e.filter((e=>{if(r>=e.start&&r<e.start+e.duration)return!0;{const t=n.get(e);return t&&t.cleanup(),!1}})).map((e=>{let o=n.get(e);if(!o){const n=r-e.start,s=e.duration-n;o=e.getExportStream(t,r,Math.min(s,i)),o.next.catch((()=>{}))}return{item:e,promise:o.next,cleanup:o.cleanup}})),s=[];for(const e of o){const t=await e.promise;t.finished||s.push({item:e.item,cont:t.continue,cleanup:e.cleanup})}return s}class m{constructor(){(0,i.A)(this,"duration",0),(0,i.A)(this,"start",0)}destroy(){this.items.forEach((e=>e.destroy()))}fitDuration(){return this.duration=this.items.reduce(((e,t)=>Math.max(e,t.start+t.duration)),0),this.duration}getExportStream(e,t,r){return function(e,t,r,i){const n=new Map;return(0,u.tk)((async o=>{const s=i*t;for(let a=0;a<s;a++){const s=a/t,c=await p(e.items,t,r+s,i-s,n);await o(),h(c,n)}}),(()=>{for(const e of n.values())e.cleanup()}))}(this,e,this.remapTime(t),r)}hasLoaded(e){const t=this.remapTime(e);for(const e of this.items)if(e.isActive(t)&&!e.hasLoaded(t))return!1;return!0}isActive(e){const t=this.remapTime(e);if(t<0||t>=this.duration)return!1;for(const e of this.items)if(e.isActive(t))return!0;return!1}isStalled(e){const t=this.remapTime(e);for(const e of this.items)if(e.isActive(t)&&e.isStalled(t))return!0;return!1}load(e){return d(this.items.map((t=>l(t.load(e))))).then((()=>{}))}loadAt(e){const t=this.remapTime(e);return d(this.items.filter((e=>e.isActive(t))).map((e=>l(e.load(!0))))).then((()=>{}))}pause(e,t){const r=this.remapTime(e);return d(this.getActive(e).map((e=>l(e.pause(r,t))))).then((()=>{}))}play(e){const t=this.remapTime(e);return d(this.getActive(e).map((e=>l(e.play(t))))).then((()=>{}))}reduceItems(){return this.items.reduce(((e,t)=>[...e,...t.reduceItems()]),[]).map((e=>({...e,start:e.start+this.start})))}seek(e,t){const r=this.remapTime(e);return d(this.getActive(e).map((e=>l(e.seek(r,t))))).then((()=>{}))}update(e,t,r){const i=this.remapTime(e);for(const e of this.items)e.update(i,t,r)}getActive(e){const t=this.remapTime(e);return this.items.filter((e=>e.isActive(t)))}remapTime(e){return e-this.start}}var f=r(150919),g=r(835908),A=r(142056),v=r(214015);class y{constructor(e){(0,i.A)(this,"duration",0),(0,i.A)(this,"offset",0),(0,i.A)(this,"playbackRate",0),(0,i.A)(this,"start",0),(0,i.A)(this,"volume",0),this.root=e}destroy(){}getExportStream(e,t,r){return(0,v.fE)(e,r)}hasLoaded(e){return!1}isActive(e){return e>=this.start&&e<this.start+this.duration}isStalled(e){return!0}load(e){return Promise.resolve()}pause(e){return Promise.resolve()}play(e){return Promise.resolve()}reduceItems(){return[{start:this.start,duration:this.duration,offset:this.offset,fadeInSeconds:0,fadeOutSeconds:0}]}render(e,t){}seek(e){return Promise.resolve()}update(e,t,r){}}var b=r(88443),w=r(468910);class x extends A.E{get itemId(){return this.item?.id}get itemStartTime(){return this.item?.startTime}get itemTrim(){return this.item?.trim}constructor(e){super(e.root,new y(e.root)),(0,i.A)(this,"item",void 0),(0,i.A)(this,"videoStreamId",void 0),(0,i.A)(this,"audioStreamId",void 0),this.graphContext=e}render(e,t){void 0!==this.item&&"needs-reload"===this.getLoadState(t)&&(console.warn("Reloading track item..."),this.updateItem(this.item,!0).catch((e=>console.error("Error when reloading track-item:",e)))),this.generator.render(e,t)}destroy(){this.generator.destroy()}findNodeForTrackitem(e){if(this.item?.id===e&&this.generator instanceof b.N)return this.generator}getEditorElements(e){return[]}getLoadState(e){return this.generator instanceof b.N?this.generator.getLoadState(e):"hydrating"}async updateItem(e,t=!1){if(!t&&e===this.item)return w.e;const r=this.graphContext.compatDevice?.getVideoStreamForTrackItem(e.id),i=this.graphContext.compatDevice?.getAudioStreamForTrackItem(e.id);return(t||this.item?.asset?.id!==e.asset.id||this.videoStreamId!==r?.id||this.audioStreamId!==i?.id)&&(this.generator.destroy(),this.generator=new b.N(e.asset,r,i,this.graphContext)),this.item=e,this.videoStreamId=r?.id,this.audioStreamId=i?.id,this.generator instanceof b.N?await this.generator.updateItem(e):w.e}}const S=new Map([["cc_xce95530e",{transitionType:"crossBlur"}],["cc_xc65ad3d9",{transitionType:"fadeThrough",fields:[{name:"color",label:"Color",description:"",defaultValue:[0,0,0]}]}],["cc_xef70f480",{transitionType:"fadeThrough",fields:[{name:"color",label:"Color",description:"",defaultValue:[1,1,1]}]}],["cc_x9474b156",{transitionType:"push",fields:[{name:"direction",label:"Direction",description:"",defaultValue:[0,1]}]}],["cc_x8649e3cb",{transitionType:"push",fields:[{name:"direction",label:"Direction",description:"",defaultValue:[0,-1]}]}],["cc_x2622f698",{transitionType:"push",fields:[{name:"direction",label:"Direction",description:"",defaultValue:[1,0]}]}],["cc_x8eb3f51d",{transitionType:"push",fields:[{name:"direction",label:"Direction",description:"",defaultValue:[-1,0]}]}],["cc_xda43df4",{transitionType:"zoom",fields:[{name:"reversed",label:"Reversed",description:"",defaultValue:!1}]}],["cc_xab94c28",{transitionType:"zoom",fields:[{name:"reversed",label:"Reversed",description:"",defaultValue:!0}]}],["cc_x3f7e9ce5",{transitionType:"glitch"}],["cc_x1c5df64f",{transitionType:"spin"}],["cc_xf4e3711f",{transitionType:"blinds"}],["cc_x29a79b07",{transitionType:"pageTurn"}],["cc_xf700ce43",{transitionType:"collage"}],["cc_x3e9ce7b1",{transitionType:"burn"}],["cc_xda200b9a",{transitionType:"pixelate"}],["cc_xdb8b63d9",{transitionType:"bloom"}],["cc_x1acc89ec",{transitionType:"horizontalBanding"}],["cc_x585f5767",{transitionType:"diamondVertical"}],["cc_xce0f4c5c",{transitionType:"diamondHorizontal"}],["cc_x670515ac",{transitionType:"diagonalSoftWipe"}],["cc_xbf2957dc",{transitionType:"cube"}],["cc_xb9c7f34c",{transitionType:"reveal"}],["cc_x7a00a63e",{transitionType:"hardWipeUp"}],["cc_xdaf989a5",{transitionType:"hardWipeDown"}],["cc_x1178a40c",{transitionType:"hardWipeLeft"}],["cc_x240797d5",{transitionType:"hardWipeRight"}],["cc_x8beca04f",{transitionType:"exchange"}],["cc_x58bfb8c0",{transitionType:"flicker"}]]);var T=r(355185),C=r(547285),_=r(126990);function k(e,t,r,i,n){e.bottomSampler.set(i.value.bindSampler(0)),e.topSampler.set(r.value.bindSampler(1)),e.mixUniform.setFloat(n),e.renderTo(t)}class E{constructor(e,t,r,i){this.root=e,this.startTime=t,this.duration=r,this.options=i}isActive(e){return e>=this.startTime&&e<this.startTime+this.duration}getInnerGenerator(){}destroy(){}getMixAtTime(e){return 0===this.duration?0:Math.max(0,Math.min((e-this.startTime)/this.duration,1))}}var I=r(326180),R=r(945596),F=r(979820);class P extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D s_a;\nuniform sampler2D s_b;\nuniform sampler2D s_mask;\nuniform float u_mix;\nvarying vec2 texCoords;\n\nvec4 unmultAlpha(vec4 color) {\n    if (color.a == 0.) return vec4(0.);\n    return vec4(color.rgb / color.a, color.a);\n}\n\nvec4 multAlpha(vec4 color) {\n    return vec4(color.rgb * color.a, color.a);\n}\n\nvoid main() {\n    float maskVal = texture2D(s_mask, texCoords).r;\n    vec4 colorA = unmultAlpha(texture2D(s_a, texCoords));\n    vec4 colorB = unmultAlpha(texture2D(s_b, texCoords));\n    gl_FragColor = multAlpha(mix(colorA, colorB, maskVal));\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"maskSampler",void 0),(0,i.A)(this,"mixUniform",void 0),this.topSampler=this.sampler("s_a"),this.bottomSampler=this.sampler("s_b"),this.maskSampler=this.sampler("s_mask"),this.mixUniform=this.uniform("u_mix",F.A.FLOAT)}}class L extends E{constructor(e,t,r,i){super(e,t,r),this.maskVideo=i}getInnerGenerator(){return this.maskVideo}render(e,t,r,i){(0,I.Ww)(_.G.create(this.root))((n=>{this.maskVideo.render(n,i);const o=this.root.ctx.renderers.get(P);o.maskSampler.set(n.value.bindSampler(2)),k(o,e,t,r,this.getMixAtTime(i))})),t.free(),r.free()}destroy(){this.maskVideo.destroy()}}var N=r(879205),M=r(467379),B=r(171957);class D extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nvarying vec2 texCoords;\nvoid main() {\n    vec4 colorA = texture2D(aTex, texCoords);\n    vec4 colorB = texture2D(bTex, texCoords);\n    gl_FragColor = mix(colorA, colorB, mixVal);\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"topSampler",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",F.A.FLOAT)}}class O extends E{constructor(e,t,r){super(e,t,r)}render(e,t,r,i){const n=this.root.ctx.renderers.get(D),o=this.getMixAtTime(i),s=this.root.cloneImage(t);(0,B.N)(this.root,s,t,5*o),t.free();const a=this.root.cloneImage(r);(0,B.N)(this.root,a,r,5*(1-o)),r.free(),k(n,e,s,a,o),s.free(),a.free()}}class j extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform vec3 fadeColor;\nvarying vec2 texCoords;\nvoid main() {\n    if (mixVal < 0.5) gl_FragColor = mix(texture2D(aTex, texCoords), vec4(fadeColor, 1), mixVal*2.);\n    else gl_FragColor = mix(vec4(fadeColor, 1), texture2D(bTex, texCoords), mixVal*2.-1.);\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"colorUniform",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"topSampler",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",F.A.FLOAT),this.colorUniform=this.uniform("fadeColor",F.A.FLOAT_ARRAY_3)}}const U=[0,0,0];class z extends E{get color(){return this.options&&this.options.color?this.options.color:U}render(e,t,r,i){(0,I.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(j);n.colorUniform.setFloatArray3(this.color),k(n,e,t,r,this.getMixAtTime(i))}))}}class W extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nvarying vec2 texCoords;\n\nconst float INTENSITY = 0.3;\n\n// Based on https://github.com/akella/webGLImageTransitions/blob/master/js/demo5.js\nvoid main() {\n    vec4 baseA = texture2D(aTex, texCoords);\n    vec4 baseB = texture2D(bTex, texCoords);\n\n    float displaceA = (baseA.r + baseA.g + baseA.b) * 0.33;\n    float displaceB = (baseB.r + baseB.g + baseB.b) * 0.33;\n\n    vec2 offsetCoordA = vec2(texCoords.x, texCoords.y + mixVal * displaceB * INTENSITY);\n    vec4 colorA = texture2D(aTex, offsetCoordA);\n\n    vec2 offsetCoordB = vec2(texCoords.x, texCoords.y + (1. - mixVal) * displaceA * INTENSITY);\n    vec4 colorB = texture2D(bTex, offsetCoordB);\n\n    gl_FragColor = mix(colorA, colorB, mixVal);\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",F.A.FLOAT)}}var V=r(127168);class H extends E{render(e,t,r,i){(0,I.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(W),o=this.getMixAtTime(i),s=(0,V.vF)(o);k(n,e,t,r,s)}))}}class G extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform float angle;\nuniform float size;\nvarying vec2 texCoords;\n\nvoid main() {\n    vec4 colorA = texture2D(aTex, texCoords);\n    vec4 colorB = texture2D(bTex, texCoords);\n\n    // rotate around the center to get a remapped point\n    vec2 centerPos = vec2(0.5);\n    vec2 deltaP = texCoords - centerPos;\n    vec2 rotatedP = vec2(\n        centerPos.x + deltaP.x * cos(angle) - deltaP.y * sin(angle),\n        centerPos.y + deltaP.x * sin(angle) + deltaP.y * cos(angle)\n    );\n\n    gl_FragColor = mix(colorA, colorB, clamp((rotatedP.y - mixVal) / (size + 0.001) + 0.5, 0., 1.));\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"angleUniform",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"sizeUniform",void 0),(0,i.A)(this,"topSampler",void 0),this.topSampler=this.sampler("bTex"),this.bottomSampler=this.sampler("aTex"),this.mixUniform=this.uniform("mixVal",F.A.FLOAT),this.angleUniform=this.uniform("angle",F.A.FLOAT),this.sizeUniform=this.uniform("size",F.A.FLOAT)}}class q extends E{get angle(){return this.options&&this.options.angle?this.options.angle:0}get size(){return this.options&&this.options.size?this.options.size:.1}render(e,t,r,i){(0,I.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(G);n.angleUniform.setFloat(this.angle),n.sizeUniform.setFloat(this.size),k(n,e,t,r,this.getMixAtTime(i))}))}}class Q extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform float lastMixVal;\nuniform vec2 direction;\nvarying vec2 texCoords;\n\nvec4 sampleAtTime(float time) {\n    vec2 p = texCoords + time * direction;\n    vec2 f = fract(p);\n    return p == f\n        ? texture2D(aTex, f)\n        : texture2D(bTex, f);\n}\n\nconst int SAMPLE_COUNT = 10;\n\nvoid main() {\n    vec4 accum = vec4(0.);\n    for (int sampleIndex = 0; sampleIndex < SAMPLE_COUNT; sampleIndex++) {\n        float currentMixVal = mix(lastMixVal, mixVal, float(sampleIndex) / float(SAMPLE_COUNT));\n        accum += sampleAtTime(currentMixVal) / float(SAMPLE_COUNT);\n    }\n    gl_FragColor = accum;\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"directionUniform",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"lastMixUniform",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.directionUniform=this.uniform("direction",F.A.FLOAT_ARRAY_2),this.mixUniform=this.uniform("mixVal",F.A.FLOAT),this.lastMixUniform=this.uniform("lastMixVal",F.A.FLOAT)}}const K=[1,0],X=1/120;class Y extends E{get direction(){return this.options&&this.options.direction?this.options.direction:K}render(e,t,r,i){(0,I.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(Q);n.directionUniform.setFloatArray2(this.direction);const o=this.getMixAtTime(i-X),s=(0,V.vF)(o,4);n.lastMixUniform.setFloat(s);const a=this.getMixAtTime(i),c=(0,V.vF)(a,4);k(n,e,t,r,c)}))}}class Z extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform vec2 squaresMin;\nuniform int steps;\nvarying vec2 texCoords;\n\nvoid main() {\n\tfloat d = min(mixVal, 1.0 - mixVal);\n\tfloat dist = steps > 0 ? ceil(d * float(steps)) / float(steps) : d;\n\tvec2 squareSize = 2.0 * dist / vec2(squaresMin);\n\tvec2 p = dist>0.0 ? (floor(texCoords / squareSize) + 0.5) * squareSize : texCoords;\n    vec4 colorA = texture2D(aTex, p);\n    vec4 colorB = texture2D(bTex, p);\n\tgl_FragColor = mix(colorA, colorB, mixVal);\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"squaresMinUniform",void 0),(0,i.A)(this,"stepsUniform",void 0),(0,i.A)(this,"topSampler",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.squaresMinUniform=this.uniform("squaresMin",F.A.FLOAT_ARRAY_2),this.stepsUniform=this.uniform("steps",F.A.FLOAT),this.mixUniform=this.uniform("mixVal",F.A.FLOAT)}}const J=[20,10];class $ extends E{render(e,t,r,i){(0,I.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(Z);n.stepsUniform.setFloat(20),n.squaresMinUniform.setFloatArray2(J),k(n,e,t,r,this.getMixAtTime(i))}))}}var ee=r(463716);class te extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nvarying vec2 texCoords;\n\nuniform float fadeAmt;\nuniform mat3 aLastTransform;\nuniform mat3 aTransform;\nuniform mat3 bLastTransform;\nuniform mat3 bTransform;\n\nvec4 sampleAtTime(mat3 transform, sampler2D sampler) {\n    vec2 transformed = (transform * vec3(texCoords, 1)).xy;\n    return texture2D(sampler, transformed);\n}\n\nconst int SAMPLE_COUNT = 10;\n\nmat3 mixMatrix(mat3 a, mat3 b, float t) {\n    return a * (1. - t) + b * t;\n}\n\nvec4 sampleBlurred(mat3 lastTransform, mat3 transform, sampler2D sampler) {\n    vec4 res = vec4(0.);\n    for (int sampleIndex = 0; sampleIndex < SAMPLE_COUNT; sampleIndex++) {\n        mat3 m = mixMatrix(lastTransform, transform, float(sampleIndex) / float(SAMPLE_COUNT));\n        res += sampleAtTime(m, sampler) / float(SAMPLE_COUNT);\n    }\n    return res;\n}\n\nvoid main() {\n    // Most of the transition only shows one texture, so only sample from one if we can\n    if (fadeAmt == 0.) gl_FragColor = sampleBlurred(aLastTransform, aTransform, aTex);\n    else if (fadeAmt == 1.) gl_FragColor = sampleBlurred(bLastTransform, bTransform, bTex);\n    else {\n        gl_FragColor = mix(\n            sampleBlurred(aLastTransform, aTransform, aTex),\n            sampleBlurred(bLastTransform, bTransform, bTex),\n            fadeAmt\n        );\n    }\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"fadeAmtUniform",void 0),(0,i.A)(this,"topLastTransformUniform",void 0),(0,i.A)(this,"topTransformUniform",void 0),(0,i.A)(this,"bottomLastTransformUniform",void 0),(0,i.A)(this,"bottomTransformUniform",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",F.A.FLOAT),this.fadeAmtUniform=this.uniform("fadeAmt",F.A.FLOAT),this.topLastTransformUniform=this.uniform("aLastTransform",F.A.MATRIX_3),this.topTransformUniform=this.uniform("aTransform",F.A.MATRIX_3),this.bottomLastTransformUniform=this.uniform("bLastTransform",F.A.MATRIX_3),this.bottomTransformUniform=this.uniform("bTransform",F.A.MATRIX_3)}}function re(e,t,r,i){const n=function(e,t){const r=t*Math.abs(Math.cos(e))+Math.abs(Math.sin(e)),i=t*Math.abs(Math.sin(e))+Math.abs(Math.cos(e));return Math.min(t/r,1/i)}(e,i);return t.multiply(ee.d.rotate(e)).multiply(ee.d.scale(n,n)).multiply(r)}function ie(e){return e*-Math.PI*.5}function ne(e){return e*-Math.PI*.5-1.5*Math.PI}const oe=1/120;class se extends E{render(e,t,r,i){const n=this.root.ctx.renderers.get(te),o=e.value.pixelWidth/e.value.pixelHeight,s=ee.d.identity.multiply(ee.d.translate(-.5,-.5)).multiply(ee.d.scale(o,1)),a=ee.d.identity.multiply(ee.d.scale(1/o,1)).multiply(ee.d.translate(.5,.5)),c=this.getMixAtTime(i-oe),l=(0,V.vF)(c,4);n.topLastTransformUniform.setMatrix3(re(ie(l),s,a,o)),n.bottomLastTransformUniform.setMatrix3(re(ne(l),s,a,o));const d=this.getMixAtTime(i),u=(0,V.vF)(d,4);n.topTransformUniform.setMatrix3(re(ie(u),s,a,o)),n.bottomTransformUniform.setMatrix3(re(ne(u),s,a,o));const h=Math.min(1,Math.max(0,(d-.5)/.05+.5));n.fadeAmtUniform.setFloat(h),(0,I.Ww)(t,r)(((t,r)=>{k(n,e,t,r,u)}))}}class ae extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nuniform vec2 tileCount;\nvarying vec2 texCoords;\n\nfloat random(vec2 pos) {\n    return fract(sin(dot(pos.xy, vec2(12.9898, 78.233))) * 43758.5453123);\n}\n\nconst float TILE_FADE_LENGTH = 0.5;\n\nvoid main() {\n    vec2 tileIndex = floor(texCoords * tileCount);\n    float tileOffset = random(tileIndex);\n\n    // With offset=0, mask should be 0 at time=0 and 1 at time=FADE_LENGTH\n    // With offset=1, mask should be 0 at time=(1-FADE_LENGTH) and 1 at time=1\n    float tileMask = clamp((mixVal - tileOffset * (1. - TILE_FADE_LENGTH)) / TILE_FADE_LENGTH, 0., 1.);\n\n    vec4 colorA = texture2D(aTex, texCoords);\n    vec4 colorB = texture2D(bTex, texCoords);\n    gl_FragColor = mix(colorA, colorB, tileMask);\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"tileCountUniform",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",F.A.FLOAT),this.tileCountUniform=this.uniform("tileCount",F.A.FLOAT_ARRAY_2)}}class ce extends E{render(e,t,r,i){const n=e.value.pixelWidth*e.value.pixelHeight/35,o=Math.sqrt(n),s=Math.floor(e.value.pixelWidth/o),a=Math.ceil(e.value.pixelHeight/o);(0,I.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(ae);n.tileCountUniform.setFloatArray2([s,a]),k(n,e,t,r,this.getMixAtTime(i))}))}}class le extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float mixVal;\nvarying vec2 texCoords;\n\nvec4 getColorAtProgress(float progress) {\n    float smoothedProgress = progress * progress * progress;\n    float zoom = 1. + smoothedProgress * 3.;\n    return texture2D(aTex, (texCoords - vec2(0.5)) / zoom + vec2(0.5));\n}\n\nconst int sampleCount = 20;\nconst float blurAmount = 0.2;\n\nvoid main() {\n    vec4 accumulatedColor = vec4(0.);\n    float accumulateCount = 0.;\n    for (int i = 0; i < sampleCount; i++) {\n        float sampleIndex = float(i) / float(sampleCount);\n        float progressNeg = sampleIndex * blurAmount;\n        float progress = max(0., mixVal - progressNeg);\n        float mult = max(0., 1. - abs(2. * sampleIndex - 1.));\n        accumulatedColor += getColorAtProgress(progress) * mult;\n        accumulateCount += mult;\n    }\n\n    vec4 aColor = accumulatedColor / accumulateCount;\n    vec4 bColor = texture2D(bTex, texCoords);\n\n    float mixAmount = smoothstep(0.8, 1., mixVal);\n    gl_FragColor = mix(aColor, bColor, mixAmount);\n}\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),(0,i.A)(this,"topSampler",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("mixVal",F.A.FLOAT)}}class de extends E{get reversed(){return!!this.options&&!!this.options.reversed}render(e,t,r,i){(0,I.Ww)(t,r)(((t,r)=>{const n=this.root.ctx.renderers.get(le);this.reversed?k(n,e,r,t,1-this.getMixAtTime(i)):k(n,e,t,r,this.getMixAtTime(i))}))}}class ue extends E{render(e,t,r,i){(0,I.Ww)(t,r)(((t,r)=>{k(this.root.ctx.renderers.get(D),e,t,r,this.getMixAtTime(i))}))}}var he=r(453916);class pe extends R.A{constructor(e,t,r){const n=e.createShader(e.gl.FRAGMENT_SHADER,(e=>`\n\nprecision mediump float;\nuniform sampler2D aTex;\nuniform sampler2D bTex;\nuniform float progress;\nuniform vec2 viewportSize;\nvarying vec2 texCoords;\n\nfloat ratio = viewportSize.x / viewportSize.y;\n\nvec4 getFromColor(vec2 p) {\n    return texture2D(aTex, p);\n}\n\nvec4 getToColor(vec2 p) {\n    return texture2D(bTex, p);\n}\n\n${e}\n\nvoid main(){\n    gl_FragColor = transition(texCoords);\n}\n`)(r||"\nvec4 transition (vec2 uv) {\n    return mix(getFromColor(uv), getToColor(uv), progress);\n}\n")),o=t||e.createShader(e.gl.VERTEX_SHADER,he),s=e.createProgram(o,n);e.gl.deleteShader(n),super(e,s),(0,i.A)(this,"topSampler",void 0),(0,i.A)(this,"bottomSampler",void 0),(0,i.A)(this,"mixUniform",void 0),this.topSampler=this.sampler("aTex"),this.bottomSampler=this.sampler("bTex"),this.mixUniform=this.uniform("progress",F.A.FLOAT),this.viewportSizeUniform=this.uniform("viewportSize",F.A.FLOAT_ARRAY_2)}}const me={pageTurn:["const float blurStrength = 0.004;\nconst int blurSamples=24;\nconst float MIN_AMOUNT = -0.16;\nconst float MAX_AMOUNT = 1.5;\nfloat amount = progress * (MAX_AMOUNT - MIN_AMOUNT) + MIN_AMOUNT;\nconst float PI = 3.141592653589793;\nconst float scale = 512.0;\nconst float sharpness = 3.0;\nfloat cylinderCenter = amount;\n// 360 degrees * amount\nfloat cylinderAngle = 2.0 * PI * amount;\nconst float cylinderRadius = 1.0 / PI / 2.0;\n\nvec3 hitPoint(float hitAngle, float yc, vec3 point, mat3 rrotation) {\n    float hitPoint = hitAngle / (2.0 * PI);\n    point.y = hitPoint;\n    return rrotation * point;\n}\n\nvec4 antiAlias(vec4 color1, vec4 color2, float distanc) {\n    distanc *= scale;\n    if(distanc < 0.0)\n        return color2;\n    if(distanc > 2.0)\n        return color1;\n    float dd = pow(1.0 - distanc / 2.0, sharpness);\n    return ((color2 - color1) * dd) + color1;\n}\n\nfloat distanceToEdge(vec3 point) {\n    float dx = abs(point.x > 0.5 ? 1.0 - point.x : point.x);\n    float dy = abs(point.y > 0.5 ? 1.0 - point.y : point.y);\n    if(point.x < 0.0)\n        dx = -point.x;\n    if(point.x > 1.0)\n        dx = point.x - 1.0;\n    if(point.y < 0.0)\n        dy = -point.y;\n    if(point.y > 1.0)\n        dy = point.y - 1.0;\n    if((point.x < 0.0 || point.x > 1.0) && (point.y < 0.0 || point.y > 1.0))\n        return sqrt(dx * dx + dy * dy);\n    return min(dx, dy);\n}\n\nvec4 seeThrough(float yc, vec2 p, mat3 rotation, mat3 rrotation) {\n    float hitAngle = PI - (acos(yc / cylinderRadius) - cylinderAngle);\n    vec3 point = hitPoint(hitAngle, yc, rotation * vec3(p, 1.0), rrotation);\n    if(yc <= 0.0 && (point.x < 0.0 || point.y < 0.0 || point.x > 1.0 || point.y > 1.0)) {\n        return getToColor(p);\n    }\n\n    if(yc > 0.0)\n        return getFromColor(p);\n\n    vec4 color = getFromColor(point.xy);\n    vec4 tcolor = vec4(0.0);\n\n    return antiAlias(color, tcolor, distanceToEdge(point));\n}\n\nvec4 seeThroughWithShadow(float yc, vec2 p, vec3 point, mat3 rotation, mat3 rrotation) {\n    float shadow = distanceToEdge(point) * 30.0;\n    shadow = (1.0 - shadow) / 3.0;\n\n    if(shadow < 0.0)\n        shadow = 0.0;\n    else\n        shadow *= amount;\n\n    vec4 shadowColor = seeThrough(yc, p, rotation, rrotation);\n    shadowColor.r -= shadow;\n    shadowColor.g -= shadow;\n    shadowColor.b -= shadow;\n\n    return shadowColor;\n}\n\nvec4 backside(float yc, vec3 point) {\n    vec4 color = getFromColor(point.xy);\n    float gray = (color.r + color.b + color.g) / 15.0;\n    gray += (8.0 / 10.0) * (pow(1.0 - abs(yc / cylinderRadius), 2.0 / 10.0) / 2.0 + (5.0 / 10.0));\n    color.rgb = vec3(gray);\n    return color;\n}\n\nvec4 behindSurface(vec2 p, float yc, vec3 point, mat3 rrotation) {\n    float shado = (1.0 - ((-cylinderRadius - yc) / amount * 7.0)) / 6.0;\n    shado *= 1.0 - abs(point.x - 0.5);\n\n    yc = (-cylinderRadius - cylinderRadius - yc);\n\n    float hitAngle = (acos(yc / cylinderRadius) + cylinderAngle) - PI;\n    point = hitPoint(hitAngle, yc, point, rrotation);\n\n    if(yc < 0.0 && point.x >= 0.0 && point.y >= 0.0 && point.x <= 1.0 && point.y <= 1.0 && (hitAngle < PI || amount > 0.5)) {\n        shado = 1.0 - (sqrt(pow(point.x - 0.5, 2.0) + pow(point.y - 0.5, 2.0)) / (71.0 / 100.0));\n        shado *= pow(-yc / cylinderRadius, 3.0);\n        shado *= 0.5;\n    } else {\n        shado = 0.0;\n    }\n    return vec4(getToColor(p).rgb - shado, 1.0);\n}\n\nvec4 sampleTransition(vec2 p, float sampleProgress) {\n    float sampleAmount = sampleProgress * (MAX_AMOUNT - MIN_AMOUNT) + MIN_AMOUNT;\n    float sampleCylinderCenter = sampleAmount;\n    float sampleCylinderAngle = 2.0 * PI * sampleAmount;\n\n    const float angle = 100.0 * PI / 180.0;\n    float c = cos(-angle);\n    float s = sin(-angle);\n\n    mat3 rotation = mat3( c, s, 0,\n                         -s, c, 0,\n                         -0.801, 0.8900, 1\n                       );\n    c = cos(angle);\n    s = sin(angle);\n\n    mat3 rrotation = mat3(\tc, s, 0,\n                           -s, c, 0,\n                            0.98500, 0.985, 1\n                          );\n\n    vec3 point = rotation * vec3(p, 1.0);\n\n    float yc = point.y - sampleCylinderCenter;\n\n    if (yc < -cylinderRadius)\n    {\n        // Behind surface\n        return behindSurface(p, yc, point, rrotation);\n    }\n\n    if (yc > cylinderRadius)\n    {\n        // Flat surface\n        return getFromColor(p);\n    }\n\n    float hitAngle = (acos(yc / cylinderRadius) + sampleCylinderAngle) - PI;\n\n    float hitAngleMod = mod(hitAngle, 2.0 * PI);\n    if ((hitAngleMod > PI && sampleAmount < 0.5) || (hitAngleMod > PI/2.0 && sampleAmount < 0.0))\n    {\n        return seeThrough(yc, p, rotation, rrotation);\n    }\n\n    point = hitPoint(hitAngle, yc, point, rrotation);\n\n    if (point.x < 0.0 || point.y < 0.0 || point.x > 1.0 || point.y > 1.0)\n    {\n        return seeThroughWithShadow(yc, p, point, rotation, rrotation);\n    }\n\n    vec4 color = backside(yc, point);\n\n    vec4 otherColor;\n    if (yc < 0.0)\n    {\n        float shado = 1.0 - (sqrt(pow(point.x - 0.5, 2.0) + pow(point.y - 0.5, 2.0)) / 0.71);\n        shado *= pow(-yc / cylinderRadius, 3.0);\n        shado *= 0.5;\n        otherColor = vec4(0.0, 0.0, 0.0, shado);\n    }\n    else\n    {\n        otherColor = getFromColor(p);\n    }\n\n    color = antiAlias(color, otherColor, cylinderRadius - abs(yc));\n\n    vec4 cl = seeThroughWithShadow(yc, p, point, rotation, rrotation);\n    float dist = distanceToEdge(point);\n\n    return antiAlias(color, cl, dist);\n}\nvec4 transition(vec2 p) {\n    vec4 blurredColor = vec4(0.0);\n\n    for (int i = 0; i < blurSamples; i++) {\n        float t = float(i) / float(blurSamples - 1);\n        float sampleProgress = progress - blurStrength * (1.0 - t);\n        blurredColor += sampleTransition(p, clamp(sampleProgress, 0.0, 1.0));\n    }\n\n    return blurredColor / float(blurSamples);\n}"],collage:["#define PI 3.14159265358979323\n#define POW2(X) X*X\n#define POW3(X) X*X*X\n\nconst int endx = 2;\nconst int endy = -1;\n\nfloat Rand(vec2 v) {\n    return fract(sin(dot(v.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvec2 Rotate180(vec2 v) {\n    return vec2(1.0) - v;\n}\n\nfloat CosInterpolation(float x) {\n    return -cos(x * PI) / 2. + .5;\n}\n\nvec4 transition(vec2 uv) {\n  vec2 p = uv.xy / vec2(1.0).xy - .5;\n  vec2 rp = p;\n  float rpr = (progress*2.-1.);\n  float z = -(rpr*rpr*2.) + 3.;\n  float az = abs(z);\n  rp *= az;\n  rp += mix(vec2(.5, .5), vec2(float(endx) + .5, float(endy) + .5), POW2(CosInterpolation(progress)));\n  vec2 mrp = mod(rp, 1.);\n  vec2 crp = rp;\n  bool onEnd = int(floor(crp.x))==endx&&int(floor(crp.y))==endy;\n  if(!onEnd) {\n    bool shouldRotate = Rand(floor(crp)) > 0.5;\n    if (shouldRotate) {\n        mrp = Rotate180(mrp);\n    }\n\n  }\n  if(onEnd || Rand(floor(crp))>.5) {\n    return getToColor(mrp);\n  } else {\n    return getFromColor(mrp);\n  }\n}\n",V.$Z],horizontalBanding:["vec4 transition(vec2 uv) {\n    float t = progress;\n\n    if(mod(floor(uv.y * 100. * progress), 2.) == 0.)\n        t *= 2. - .5;\n\n    return mix(getFromColor(uv), getToColor(uv), mix(t, progress, smoothstep(0.8, 1.0, progress)));\n\n}\n"],burn:["vec3 color = vec3(0.9, 0.4, 0.2);\nvec4 transition(vec2 uv) {\n    return mix(getFromColor(uv) + vec4(progress * color, 1.0), getToColor(uv) + vec4((1.0 - progress) * color, 1.0), progress);\n}\n",V.HQ],blinds:["const float count = 10.0;\nconst float smoothness = 0.5;\n\nvec4 transition(vec2 p) {\n    float pr = smoothstep(-smoothness, 0.0, p.x - progress * (1.0 + smoothness));\n    float s = step(pr, fract(count * p.x));\n    return mix(getFromColor(p), getToColor(p), s);\n}\n",V.HQ],diamondVertical:["float check(vec2 p1, vec2 p2, vec2 p3) {\n    return (p1.x - p3.x) * (p2.y - p3.y) - (p2.x - p3.x) * (p1.y - p3.y);\n}\n\nbool PointInTriangle(vec2 pt, vec2 p1, vec2 p2, vec2 p3) {\n    bool b1, b2, b3;\n    b1 = check(pt, p1, p2) < 0.0;\n    b2 = check(pt, p2, p3) < 0.0;\n    b3 = check(pt, p3, p1) < 0.0;\n    return ((b1 == b2) && (b2 == b3));\n}\n\nbool in_top_triangle(vec2 p) {\n    vec2 vertex1, vertex2, vertex3;\n    vertex1 = vec2(0.5, progress);\n    vertex2 = vec2(0.5 - progress, 0.0);\n    vertex3 = vec2(0.5 + progress, 0.0);\n    if(PointInTriangle(p, vertex1, vertex2, vertex3)) {\n        return true;\n    }\n    return false;\n}\n\nbool in_bottom_triangle(vec2 p) {\n    vec2 vertex1, vertex2, vertex3;\n    vertex1 = vec2(0.5, 1.0 - progress);\n    vertex2 = vec2(0.5 - progress, 1.0);\n    vertex3 = vec2(0.5 + progress, 1.0);\n    if(PointInTriangle(p, vertex1, vertex2, vertex3)) {\n        return true;\n    }\n    return false;\n}\n\nfloat blur_edge(vec2 bot1, vec2 bot2, vec2 top, vec2 testPt) {\n    vec2 lineDir = bot1 - top;\n    vec2 perpDir = vec2(lineDir.y, -lineDir.x);\n    vec2 dirToPt1 = bot1 - testPt;\n    float dist1 = abs(dot(normalize(perpDir), dirToPt1));\n\n    lineDir = bot2 - top;\n    perpDir = vec2(lineDir.y, -lineDir.x);\n    dirToPt1 = bot2 - testPt;\n    float min_dist = min(abs(dot(normalize(perpDir), dirToPt1)), dist1);\n\n    if(min_dist < 0.005) {\n        return min_dist / 0.005;\n    } else {\n        return 1.0;\n    };\n}\n\nvec4 transition(vec2 uv) {\n    if(in_top_triangle(uv)) {\n        if(progress < 0.1) {\n            return getFromColor(uv);\n        }\n        if(uv.y < 0.5) {\n            vec2 vertex1 = vec2(0.5, progress);\n            vec2 vertex2 = vec2(0.5 - progress, 0.0);\n            vec2 vertex3 = vec2(0.5 + progress, 0.0);\n            return mix(getFromColor(uv), getToColor(uv), blur_edge(vertex2, vertex3, vertex1, uv));\n        } else {\n            if(progress > 0.0) {\n                return getToColor(uv);\n            } else {\n                return getFromColor(uv);\n            }\n        }\n    } else if(in_bottom_triangle(uv)) {\n        if(uv.y >= 0.5) {\n            vec2 vertex1 = vec2(0.5, 1.0 - progress);\n            vec2 vertex2 = vec2(0.5 - progress, 1.0);\n            vec2 vertex3 = vec2(0.5 + progress, 1.0);\n            return mix(getFromColor(uv), getToColor(uv), blur_edge(vertex2, vertex3, vertex1, uv));\n        } else {\n            return getFromColor(uv);\n        }\n    } else {\n        return getFromColor(uv);\n    }\n}",V.$Z],diamondHorizontal:["vec2 bottom_left = vec2(0.0, 1.0);\nvec2 bottom_right = vec2(1.0, 1.0);\nvec2 top_left = vec2(0.0, 0.0);\nvec2 top_right = vec2(1.0, 0.0);\nvec2 center = vec2(0.5, 0.5);\n\nfloat check(vec2 p1, vec2 p2, vec2 p3) {\n    return (p1.x - p3.x) * (p2.y - p3.y) - (p2.x - p3.x) * (p1.y - p3.y);\n}\n\nbool PointInTriangle(vec2 pt, vec2 p1, vec2 p2, vec2 p3) {\n    bool b1, b2, b3;\n    b1 = check(pt, p1, p2) < 0.0;\n    b2 = check(pt, p2, p3) < 0.0;\n    b3 = check(pt, p3, p1) < 0.0;\n    return ((b1 == b2) && (b2 == b3));\n}\n\nbool in_left_triangle(vec2 p) {\n    vec2 vertex1, vertex2, vertex3;\n    vertex1 = vec2(progress, 0.5);\n    vertex2 = vec2(0.0, 0.5 - progress);\n    vertex3 = vec2(0.0, 0.5 + progress);\n    if(PointInTriangle(p, vertex1, vertex2, vertex3)) {\n        return true;\n    }\n    return false;\n}\n\nbool in_right_triangle(vec2 p) {\n    vec2 vertex1, vertex2, vertex3;\n    vertex1 = vec2(1.0 - progress, 0.5);\n    vertex2 = vec2(1.0, 0.5 - progress);\n    vertex3 = vec2(1.0, 0.5 + progress);\n    if(PointInTriangle(p, vertex1, vertex2, vertex3)) {\n        return true;\n    }\n    return false;\n}\n\nfloat blur_edge(vec2 bot1, vec2 bot2, vec2 top, vec2 testPt) {\n    vec2 lineDir = bot1 - top;\n    vec2 perpDir = vec2(lineDir.y, -lineDir.x);\n    vec2 dirToPt1 = bot1 - testPt;\n    float dist1 = abs(dot(normalize(perpDir), dirToPt1));\n\n    lineDir = bot2 - top;\n    perpDir = vec2(lineDir.y, -lineDir.x);\n    dirToPt1 = bot2 - testPt;\n    float min_dist = min(abs(dot(normalize(perpDir), dirToPt1)), dist1);\n\n    if(min_dist < 0.005) {\n        return min_dist / 0.005;\n    } else {\n        return 1.0;\n    };\n}\n\nvec4 vmix(vec4 v1, vec4 v2, float a) {\n    return v1 * (1.0 - a) + v2 * a;\n}\n\nvec4 transition(vec2 uv) {\n    if(in_left_triangle(uv)) {\n        if(progress < 0.1) {\n            return getFromColor(uv);\n        }\n        if(uv.x < 0.5) {\n            vec2 vertex1 = vec2(progress, 0.5);\n            vec2 vertex2 = vec2(0.0, 0.5 - progress);\n            vec2 vertex3 = vec2(0.0, 0.5 + progress);\n            return vmix(getFromColor(uv), getToColor(uv), blur_edge(vertex2, vertex3, vertex1, uv));\n        } else {\n            if(progress > 0.0) {\n                return getToColor(uv);\n            } else {\n                return getFromColor(uv);\n            }\n        }\n    } else if(in_right_triangle(uv)) {\n        if(uv.x >= 0.5) {\n            vec2 vertex1 = vec2(1.0 - progress, 0.5);\n            vec2 vertex2 = vec2(1.0, 0.5 - progress);\n            vec2 vertex3 = vec2(1.0, 0.5 + progress);\n            return vmix(getFromColor(uv), getToColor(uv), blur_edge(vertex2, vertex3, vertex1, uv));\n        } else {\n            return getFromColor(uv);\n        }\n    } else {\n        return getFromColor(uv);\n    }\n}",V.$Z],diagonalSoftWipe:["// Author: gre\n// License: MIT\n\nvec2 direction = vec2(1.0, -1.0);\nfloat smoothness = 0.5;\n\nconst vec2 center = vec2(0.5, 0.5);\n\nvec4 transition(vec2 uv) {\n    vec2 v = normalize(direction);\n    v /= abs(v.x) + abs(v.y);\n    float d = v.x * center.x + v.y * center.y;\n    float m = (1.0 - step(progress, 0.0)) * // there is something wrong with our formula that makes m not equals 0.0 with progress is 0.0\n        (1.0 - smoothstep(-smoothness, 0.0, v.x * uv.x + v.y * uv.y - (d - 0.5 + progress * (1. + smoothness))));\n    return mix(getFromColor(uv), getToColor(uv), m);\n}",V.$Z],bloom:["#define DEG2RAD 0.03926990816987241548078304229099 // 1/180*PI\n\n// In degrees\nconst float rotation = 6.0;\n// Multiplier\nconst float scale = 1.2;\n\nvec4 transition(vec2 uv) {\n  // Massage parameters\n  float phase = progress < 0.5 ? progress * 2.0 : (progress - 0.5) * 2.0;\n  float angleOffset = progress < 0.5 ? mix(0.0, rotation * DEG2RAD, phase) : mix(-rotation * DEG2RAD, 0.0, phase);\n  float newScale = progress < 0.5 ? mix(1.0, scale, phase) : mix(scale, 1.0, phase);\n\n  vec2 center = vec2(0, 0);\n\n  // Calculate the source point\n  vec2 assumedCenter = vec2(0.5, 0.5);\n  vec2 p = (uv.xy - vec2(0.5, 0.5)) / newScale * vec2(ratio, 1.0);\n\n  // This can probably be optimized (with distance())\n  float angle = atan(p.y, p.x) + angleOffset;\n  float dist = distance(center, p);\n  p.x = cos(angle) * dist / ratio + 0.5;\n  p.y = sin(angle) * dist + 0.5;\n  vec4 c = progress < 0.5 ? getFromColor(p) : getToColor(p);\n\n  // Finally, apply the color\n  return c + (progress < 0.5 ? mix(0.0, 1.0, phase) : mix(1.0, 0.0, phase));\n}\n",V.HQ],cube:["// Author: gre\n// License: MIT\nfloat persp = 0.7;\nfloat unzoom = 0.3;\nfloat reflection = 0.4;\nfloat floating = 3.0;\n\nvec2 project(vec2 p) {\n    return p * vec2(1.0, -1.2) + vec2(0.0, -floating / 100.);\n}\n\nbool inBounds(vec2 p) {\n    return all(lessThan(vec2(0.0), p)) && all(lessThan(p, vec2(1.0)));\n}\n\nvec4 bgColor(vec2 p, vec2 pfr, vec2 pto) {\n    vec4 c = vec4(0.0, 0.0, 0.0, 1.0);\n    pfr = project(pfr);\n  // FIXME avoid branching might help perf!\n    if(inBounds(pfr)) {\n        c += mix(vec4(0.0), getFromColor(pfr), reflection * mix(1.0, 0.0, pfr.y));\n    }\n    pto = project(pto);\n    if(inBounds(pto)) {\n        c += mix(vec4(0.0), getToColor(pto), reflection * mix(1.0, 0.0, pto.y));\n    }\n    return c;\n}\n\n// p : the position\n// persp : the perspective in [ 0, 1 ]\n// center : the xcenter in [0, 1] \\ 0.5 excluded\nvec2 xskew(vec2 p, float persp, float center) {\n    float x = mix(p.x, 1.0 - p.x, center);\n    return ((vec2(x, (p.y - 0.5 * (1.0 - persp) * x) / (1.0 + (persp - 1.0) * x)) - vec2(0.5 - distance(center, 0.5), 0.0)) * vec2(0.5 / distance(center, 0.5) * (center < 0.5 ? 1.0 : -1.0), 1.0) + vec2(center < 0.5 ? 0.0 : 1.0, 0.0));\n}\n\nvec4 transition(vec2 op) {\n    float uz = unzoom * 2.0 * (0.5 - distance(0.5, progress));\n    vec2 p = -uz * 0.5 + (1.0 + uz) * op;\n    vec2 fromP = xskew((p - vec2(progress, 0.0)) / vec2(1.0 - progress, 1.0), 1.0 - mix(progress, 0.0, persp), 0.0);\n    vec2 toP = xskew(p / vec2(progress, 1.0), mix(pow(progress, 2.0), 1.0, persp), 1.0);\n  // FIXME avoid branching might help perf!\n    if(inBounds(fromP)) {\n        return getFromColor(fromP);\n    } else if(inBounds(toP)) {\n        return getToColor(toP);\n    }\n    return bgColor(op, fromP, toP);\n}",V.$Z],reveal:["const float reflection = 0.4;\nconst float perspective = 0.4;\nconst float depth = 3.0;\nconst float blurStrength = 0.004;\nconst int blurSamples = 24;\n\nconst vec4 black = vec4(0.0, 0.0, 0.0, 1.0);\nconst vec2 boundMin = vec2(0.0, 0.0);\nconst vec2 boundMax = vec2(1.0, 1.0);\n\nbool inBounds (vec2 p) {\n  return all(lessThan(boundMin, p)) && all(lessThan(p, boundMax));\n}\n\nvec2 project (vec2 p) {\n  return p * vec2(1.0, -1.2) + vec2(0.0, -0.02);\n}\n\nvec4 bgColor (vec2 p, vec2 pto) {\n  vec4 c = black;\n  pto = project(pto);\n  if (inBounds(pto)) {\n    c += mix(black, getToColor(pto), reflection * mix(1.0, 0.0, pto.y));\n  }\n  return c;\n}\n\nvec4 getColor(vec2 p, bool isFrom) {\n  if (inBounds(p)) {\n    return isFrom ? getFromColor(p) : getToColor(p);\n  }\n  return vec4(0.0);\n}\n\nvec4 sampleWithBlur(vec2 p, float blurAmount, bool isFrom) {\n  vec4 color = vec4(0.0);\n\n  for (int i = 0; i < blurSamples; i++) {\n    float t = float(i) / float(blurSamples - 1);\n    vec2 offset = vec2(cos(t * 6.28318), sin(t * 6.28318)) * blurAmount;\n    color += getColor(p + offset, isFrom);\n  }\n\n  return color / float(blurSamples);\n}\n\nvec4 transition (vec2 p) {\n  vec2 pfr = vec2(-1.), pto = vec2(-1.);\n  float middleSlit = 2.0 * abs(p.x-0.5) - progress;\n  if (middleSlit > 0.0) {\n    pfr = p + (p.x > 0.5 ? -1.0 : 1.0) * vec2(0.5*progress, 0.0);\n    float d = 1.0/(1.0+perspective*progress*(1.0-middleSlit));\n    pfr.y -= d/2.;\n    pfr.y *= d;\n    pfr.y += d/2.;\n  }\n  float size = mix(1.0, depth, 1.-progress);\n  pto = (p + vec2(-0.5, -0.5)) * vec2(size, size) + vec2(0.5, 0.5);\n\n  // Calculate blur amount based on transition progress\n  float fromBlur = blurStrength * progress;\n  float toBlur = blurStrength * (1.0 - progress);\n\n  if (inBounds(pfr)) {\n    return sampleWithBlur(pfr, fromBlur, true);\n  }\n  else if (inBounds(pto)) {\n    return sampleWithBlur(pto, toBlur, false);\n  }\n  else {\n    return bgColor(p, pto);\n  }\n}",V.HQ],hardWipeUp:["// Author: Jake Nelson\n// License: MIT\n\nvec4 transition(vec2 uv) {\n    vec2 p = uv.xy / vec2(1.0).xy;\n    vec4 a = getFromColor(p);\n    vec4 b = getToColor(p);\n    return mix(a, b, step(0.0 + p.y, progress));\n}"],hardWipeDown:["// Author: Jake Nelson\n// License: MIT\n\nvec4 transition(vec2 uv) {\n    vec2 p = uv.xy / vec2(1.0).xy;\n    vec4 a = getFromColor(p);\n    vec4 b = getToColor(p);\n    return mix(a, b, step(1.0 - p.y, progress));\n}"],hardWipeLeft:["// Author: Jake Nelson\n// License: MIT\n\nvec4 transition(vec2 uv) {\n    vec2 p = uv.xy / vec2(1.0).xy;\n    vec4 a = getFromColor(p);\n    vec4 b = getToColor(p);\n    return mix(a, b, step(1.0 - p.x, progress));\n}"],hardWipeRight:["// Author: Jake Nelson\n// License: MIT\n\nvec4 transition(vec2 uv) {\n    vec2 p = uv.xy / vec2(1.0).xy;\n    vec4 a = getFromColor(p);\n    vec4 b = getToColor(p);\n    return mix(a, b, step(0.0 + p.x, progress));\n}"],exchange:["const float reflection = 0.4;\nconst float perspective = 0.2;\nconst float depth = 3.0;\nconst float blurStrength = 0.004;\nconst int blurSamples = 24;\n\nconst vec4 black = vec4(0.0, 0.0, 0.0, 1.0);\nconst vec2 boundMin = vec2(0.0, 0.0);\nconst vec2 boundMax = vec2(1.0, 1.0);\n\nbool inBounds (vec2 p) {\n  return all(lessThan(boundMin, p)) && all(lessThan(p, boundMax));\n}\n\nvec2 project (vec2 p) {\n  return p * vec2(1.0, -1.2) + vec2(0.0, -0.02);\n}\n\nvec4 bgColor (vec2 p, vec2 pfr, vec2 pto) {\n  vec4 c = black;\n  pfr = project(pfr);\n  if (inBounds(pfr)) {\n    c += mix(black, getFromColor(pfr), reflection * mix(1.0, 0.0, pfr.y));\n  }\n  pto = project(pto);\n  if (inBounds(pto)) {\n    c += mix(black, getToColor(pto), reflection * mix(1.0, 0.0, pto.y));\n  }\n  return c;\n}\n\nvec4 getColor(vec2 p, bool isFrom) {\n  if (inBounds(p)) {\n    return isFrom ? getFromColor(p) : getToColor(p);\n  }\n  return vec4(0.0);\n}\n\nvec4 sampleWithBlur(vec2 p, float blurAmount, bool isFrom) {\n  vec4 color = vec4(0.0);\n\n  for (int i = 0; i < blurSamples; i++) {\n    float t = float(i) / float(blurSamples - 1);\n    vec2 offset = vec2(cos(t * 6.28318), sin(t * 6.28318)) * blurAmount;\n    color += getColor(p + offset, isFrom);\n  }\n\n  return color / float(blurSamples);\n}\n\nvec4 transition(vec2 p) {\n  vec2 pfr, pto = vec2(-1.);\n\n  float size = mix(1.0, depth, progress);\n  float persp = perspective * progress;\n  pfr = (p + vec2(-0.0, -0.5)) * vec2(size/(1.0-perspective*progress), size/(1.0-size*persp*p.x)) + vec2(0.0, 0.5);\n\n  size = mix(1.0, depth, 1.-progress);\n  persp = perspective * (1.-progress);\n  pto = (p + vec2(-1.0, -0.5)) * vec2(size/(1.0-perspective*(1.0-progress)), size/(1.0-size*persp*(0.5-p.x))) + vec2(1.0, 0.5);\n\n  // Calculate blur amount based on transition progress and perspective\n  float fromBlur = blurStrength * progress * (1.0 + persp * abs(p.x - 0.5));\n  float toBlur = blurStrength * (1.0 - progress) * (1.0 + persp * abs(p.x - 0.5));\n\n  if (progress < 0.5) {\n    if (inBounds(pfr)) {\n      return sampleWithBlur(pfr, fromBlur, true);\n    }\n    if (inBounds(pto)) {\n      return sampleWithBlur(pto, toBlur, false);\n    }\n  }\n  if (inBounds(pto)) {\n    return sampleWithBlur(pto, toBlur, false);\n  }\n  if (inBounds(pfr)) {\n    return sampleWithBlur(pfr, fromBlur, true);\n  }\n  return bgColor(p, pfr, pto);\n}",V.HQ]};class fe extends E{constructor(e,t,r,n){super(e,t,r),(0,i.A)(this,"frag",void 0),(0,i.A)(this,"easingFunction",void 0),(0,i.A)(this,"pass",void 0);const[o,s]=me[n];this.frag=o,this.pass=new pe(this.root.ctx,null,this.frag),this.easingFunction=s}render(e,t,r,i){(0,I.Ww)(t,r)(((t,r)=>{const n=this.getMixAtTime(i),o=this.easingFunction?this.easingFunction(n):n;k(this.pass,e,t,r,o)}))}}var ge=r(835346),Ae=r(72704);const ve=new Map,ye=new Map;class be extends A.E{updateMask(){let e;if(this.currentAspectRatio={width:this.root.defaultTarget.width,height:this.root.defaultTarget.height},this.options.maskSources){const t=function(e,t){let r;for(const i of e){if(void 0===r){r=i;continue}const e=M.l8[i],n=M.l8[r];Math.abs(e-t)<Math.abs(n-t)&&(r=i)}return r}(Object.keys(this.options.maskSources),this.root.defaultTarget.width/this.root.defaultTarget.height);void 0!==t&&(e=this.options.maskSources[t])}e!==this.currentMaskSrc&&(this.generator.destroy(),this.generator=e?function(e,t,r,i,n){const[o,s]=(0,ge.u)(n);(async function(e,t){let r=ve.get(e);if(!r){const i=ye.get(e);if(i)try{return await(0,N.Ak)(i.cachedFile.permanentUrl),i}catch{ye.delete(e)}const n=await fetch(e),o=await n.blob(),s={id:e,name:e,hidden:!0},a=new File([o],e,{type:o.type,lastModified:Date.now()});r=t.assetCaching.cacheFile(s,a,"transition",(()=>{})),ve.set(e,r),r.then((t=>{ve.delete(e),ye.set(e,t)}),(()=>{ve.delete(e)}))}return r})(t,n).then((e=>{const t=e.asset,{cachedFile:o}=e,a=t.metadata.duration/i,c=(0,Ae.Q)(t,n,o);c.start=r,c.duration=i,c.playbackRate=a,s(c)})).catch((t=>{console.warn(t),e.ctx.logError(t)}));const a={...o,reduceItems:()=>[{id:n.transitionId,start:r,offset:0,duration:i,fadeInSeconds:0,fadeOutSeconds:0}]};return a.start=r,a.duration=i,a}(this.root,e,this.transitionStartTime,this.transitionDuration,this.graphContext):new y(this.root),this.currentMaskSrc=e)}constructor(e,t,r,n,o){super(e,new y(e)),(0,i.A)(this,"currentAspectRatio",{width:0,height:0}),(0,i.A)(this,"currentMaskSrc",void 0),this.transitionStartTime=t,this.transitionDuration=r,this.options=n,this.graphContext=o,this.updateMask()}update(e,t,r){this.root.defaultTarget.width===this.currentAspectRatio.width&&this.root.defaultTarget.height===this.currentAspectRatio.height||this.updateMask(),super.update(e,t,r)}render(e,t){this.generator.render(e,t)}destroy(){this.generator.destroy()}}function we(e,t,r,i,n){return new L(e,t,r,new be(e,t,r,i,n))}function xe(e){return(...t)=>new e(...t)}class Se{constructor(e,t){(0,i.A)(this,"currentState",void 0),(0,i.A)(this,"videoStreamId",void 0),this.root=e,this.graphContext=t}isActive(e){return void 0!==this.currentState&&this.currentState.node.isActive(e)}getInnerGenerator(){return void 0===this.currentState?void 0:this.currentState.node.getInnerGenerator()}render(e,t,r,i){if(void 0===this.currentState)return t.free(),void r.free();this.currentState.node.render(e,t,r,i)}updateItem(e,t){const r=this.graphContext.compatDevice?.getVideoStreamForTrackItem(e.id);let i,n=t,o=e.durationInS;if(this.graphContext.compatDevice){const e=this.graphContext.compatDevice.clock,t=e.mediaSecondsToTicks(n),r=e.mediaSecondsToTicks(n+o);n=e.ticksToSeconds(t),o=e.ticksToSeconds(r)-n}if(void 0===this.currentState||e.asset.id!==this.currentState.assetId||o!==this.currentState.durationSecs||n!==this.currentState.startSecs||r!==this.videoStreamId){if(void 0!==this.currentState&&this.currentState.node.destroy(),void 0!==this.graphContext.compatDevice&&void 0!==r){const e=new C.s(this.root,this.graphContext,this.graphContext.compatDevice.reader,this.graphContext.compatDevice.clock,r,void 0,void 0);e.start=n,e.duration=o,i=new L(this.root,n,o,e)}else{const t=(0,T.QO)(e.asset.id),r=(0,T.YQ)({...t,locale:"en"}),a=S.get(r)??e.asset,c=function(e){switch(e){case"crossBlur":return xe(O);case"fadeThrough":return xe(z);case"glitch":return xe(H);case"wipe":return xe(q);case"push":return xe(Y);case"pixelate":return xe($);case"spin":return xe(se);case"tile":return xe(ce);case"zoom":return xe(de);case"mask":return we;case"pageTurn":case"collage":case"horizontalBanding":case"burn":case"diamondVertical":case"diamondHorizontal":case"diagonalSoftWipe":case"blinds":case"bloom":case"cube":case"reveal":case"hardWipeUp":case"hardWipeDown":case"hardWipeLeft":case"hardWipeRight":case"exchange":return t=e,(e,r,i,n)=>new fe(e,r,i,t);default:return xe(ue)}var t}(a.transitionType),l=(s=a.fields||[],Object.fromEntries(s.map((e=>[e.name,e.defaultValue]))));i=c(this.root,n,o,l,{...this.graphContext,transitionId:e.id})}var s;this.currentState={assetId:e.asset.id,startSecs:n,durationSecs:o,node:i}}}destroy(){void 0!==this.currentState&&(this.currentState.node.destroy(),this.currentState=void 0)}}class Te extends m{get root(){return this._root}set root(e){}get items(){return 0===this.transitions.length?this.trackItems:[...this.trackItems,...this.transitions.map((e=>e.getInnerGenerator())).filter((e=>void 0!==e))]}set items(e){}constructor(e,t){super(),(0,i.A)(this,"hidden",!1),(0,i.A)(this,"trackItems",[]),(0,i.A)(this,"transitions",[]),this._root=e,this._graphContext=t}destroy(){for(const e of this.transitions)e.destroy();super.destroy()}findNodeForTrackitem(e){for(const t of this.trackItems){const r=t.findNodeForTrackitem(e);if(void 0!==r)return r}}getAllItemElements(e){const t=this.remapTime(e),r=[];for(const e of this.trackItems){if(!e.isActive(t))continue;const i=e.itemId;void 0!==i&&r.push({itemId:i,elements:e.getEditorElements(t)})}return r}getItemElements(e,t){const r=this.remapTime(e);for(const i of this.trackItems)if(i.itemId===t&&i.isActive(r))return i.getEditorElements(e)}isHydrated(){return!0}getLoadState(e){const t=this.remapTime(e);let r="loaded";for(const e of this.trackItems){if(!e.isActive(t))continue;const i=e.getLoadState(t);("loaded"===r||"hydrating"===i&&"loading"===r)&&(r=i)}return r}render(e,t){const r=this.remapTime(t),i=this.findActiveTransition(r),n=[];for(const t of this.trackItems)if(t.isActive(r)){if(!i)return void t.render(e,r);const o=this.root.cloneImage(e);if(t.render(o,r),n.push(o),n.length>=2)return void i.render(e,n[0],n[1],r)}for(const e of n)e.free()}setNumItems(e){if(this.trackItems.length!==e){for(;e>this.trackItems.length;)this.trackItems.push(new x(this._graphContext));for(;e<this.trackItems.length;){const e=this.trackItems.pop();e&&e.destroy()}}}setNumTransitions(e){if(this.transitions.length!==e){for(;e>this.transitions.length;)this.transitions.push(new Se(this._root,this._graphContext));for(;e<this.transitions.length;){const e=this.transitions.pop();e&&e.destroy()}}}findActiveTransition(e){for(const t of this.transitions)if(t.isActive(e))return t}}const Ce={updatesLoadState:!0};class _e extends m{constructor(e,t,r=Ce){super(),(0,i.A)(this,"items",[]),this.root=e,this.graphContext=t,this.options=r}findNodeForTrackitem(e){for(const t of this.items){const r=t.findNodeForTrackitem(e);if(void 0!==r)return r}}getAllItemElements(e){const t=[];for(const r of this.items)t.push(...r.getAllItemElements(e));return t}getItemElements(e,t){for(const r of this.items){const i=r.getItemElements(e,t);if(void 0!==i)return i}}fitDuration(){return this.duration=this.items.reduce(((e,t)=>t.hidden?e:Math.max(e,t.start+t.duration)),0),this.duration}isHydrated(e){const t=this.remapTime(e);for(const e of this.items)if(e.isActive(t)&&!e.isHydrated())return!1;return!0}getLoadState(e){const t=this.remapTime(e);let r="loaded";for(const e of this.items){if(!e.isActive(t))continue;const i=e.getLoadState(t);("loaded"===r||"hydrating"===i&&"loading"===r)&&(r=i)}return r}render(e,t){const r=this.remapTime(t),i=f.T.wrap(e);e.value.clear(g.wj);for(let e=this.items.length-1;e>=0;e--){const t=this.items[e];t.isActive(r)&&t.render(i,r)}}setNumTracks(e){if(this.items.length!==e){for(;this.items.length<e;)this.items.push(new Te(this.root,this.graphContext));for(;this.items.length>e;){const e=this.items.shift();e&&e.destroy()}}}update(e,t,r){this.options.updatesLoadState&&this.root.setLoadState(this.getLoadState(e)),super.update(e,t,r)}get baseHeight(){return this.root.gl.canvas.height}get baseWidth(){return this.root.gl.canvas.width}get rotHeight(){return this.root.gl.canvas.height}get rotWidth(){return this.root.gl.canvas.width}get rotation(){return 0}}},835346:(e,t,r)=>{r.d(t,{u:()=>o});var i=r(471189),n=r(860784);function o(e){let t;const r=new n.z,o={start:0,duration:0,offset:void 0,playbackRate:void 0,volume:void 0},s=()=>t??o;return[{root:e.root,get start(){return s().start},set start(e){s().start=e},get duration(){return s().duration},set duration(e){s().duration=e},get offset(){return s().offset},set offset(e){s().offset=e},get playbackRate(){return s().playbackRate},set playbackRate(e){s().playbackRate=e},get volume(){return s().volume},set volume(e){s().volume=e},destroy(){r.promise.then((e=>e.destroy())).catch((e=>console.warn("Uncaught error in destructor",e)))},getExportStream:(e,t,n)=>(0,i._y)(r.promise.then((r=>r.getExportStream(e,t,n)))),hasLoaded:e=>!!t&&t.hasLoaded(e),isActive:e=>!t||t.isActive(e),isStalled:e=>!t||t.isStalled(e),load:e=>r.promise.then((t=>t.load(e))),pause:(e,r)=>t?t.pause(e,r):Promise.resolve(),play:e=>t?t.play(e):Promise.resolve(),reduceItems:()=>t?t.reduceItems():[],render(e,r){t&&t.render(e,r)},seek:(e,r)=>t?t.seek(e,r):Promise.resolve(),update(e,r,i){t&&t.update(e,r,i)}},i=>{if(void 0!==t)throw new Error("Can only set the inner generator of a DeferredNode once");t=i,r.resolve(i),e.requestRender(i)}]}},706936:(e,t,r)=>{r.d(t,{e:()=>s});var i=r(324586),n=(r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(953734)),o=r(241210);class s{constructor(e){(0,i.A)(this,"cachedState",void 0),this.graphContext=e}async getFontStyles(e,t){const r=this.graphContext.getPluginFontProviders(),i=await Promise.all(e.map((async({fontName:e,idealWeight:t})=>({familyName:e,font:await(0,o.M)(e,r),idealWeight:t})))),s=(0,n.s)(i),a=`${s.map((e=>`"${e.familyName}"-${e.weight}-"${e.file.id}"`)).join(",")},${function(e){const t=new Set(e.split(""));return t.delete(" "),[...t]}(t)}`;if(this.cachedState&&this.cachedState.key===a)return this.cachedState.fontData;const c=this.graphContext.fontCache.getFontStyles(s,t);return this.cachedState={key:a,fontData:c},c}}},88443:(e,t,r)=>{r.d(t,{N:()=>we});var i=r(324586),n=r(142056),o=r(650882),s=r(615101),a=r(573340),c=r(547285),l=r(214015),d=r(632670),u=r(702335),h=r(333358),p=r(686781);class m extends h.o{constructor(e,t,r,i,n){super(e,t,(0,p.M)("audio",r.permanentUrl)),this.cachedFile=r,this.metadata=i,this.audioOut=n}createMediaElement(e){const t=new u.O(this.cachedFile,this.metadata,e,this.playbackRate);return t.onStalledChanged.subscribe((e=>{!e&&t.isLoaded&&this.root.requestUnstall(this)})),this.audioOut?new d.m(t,this.volume,this.audioOut.context):t}getExportStream(e,t,r){return(0,l.fE)(e,r)}render(e,t){}}var f=r(835346),g=(r(379321),r(922557));class A{constructor(e,t){(0,i.A)(this,"_keyframes",[]),(0,i.A)(this,"_playing",!1),(0,i.A)(this,"_playContextTime",0),(0,i.A)(this,"_timelineTime",0),this._context=e,this._param=t}pause(e){this._playing=!1,this._timelineTime=e,this.pushCurrentKeyframe()}play(e){this._playing=!0,this._playContextTime=this._context.currentTime,this._timelineTime=e,this.pushKeyframes()}seek(e){this._playing?this.play(e):(this._timelineTime=e,this.pushCurrentKeyframe())}setKeyframes(e){this._keyframes=[...e],this._keyframes.sort(((e,t)=>e.seconds-t.seconds)),this._playing?this.pushKeyframes():this.pushCurrentKeyframe()}pushKeyframes(){this._param.cancelScheduledValues(this._context.currentTime);const e=this._context.currentTime-this._playContextTime+this._timelineTime;this._param.setValueAtTime(this.getValueAtTime(e),this._context.currentTime);for(const t of this._keyframes)t.seconds<=e||this._param.linearRampToValueAtTime(t.value,this._context.currentTime+t.seconds-e)}pushCurrentKeyframe(){this._param.cancelScheduledValues(this._context.currentTime);const e=this.getValueAtTime(this._timelineTime);this._param.setValueAtTime(Math.max(0,Math.min(1,e)),this._context.currentTime)}getValueAtTime(e){if(0===this._keyframes.length)return 0;for(let t=0;t<this._keyframes.length;t++){const r=this._keyframes[t];if(e>r.seconds)continue;if(0===t||e===r.seconds)return r.value;const i=this._keyframes[t-1],n=(e-i.seconds)/(r.seconds-i.seconds);return i.value+n*(r.value-i.value)}return this._keyframes.at(-1).value}}var v=r(468910);class y{constructor(e){(0,i.A)(this,"fadeGain",void 0),(0,i.A)(this,"lastDuration",0),(0,i.A)(this,"lastFadeInSeconds",0),(0,i.A)(this,"lastFadeOutSeconds",0),(0,i.A)(this,"timeline",void 0),(0,i.A)(this,"audioIn",void 0),this.fadeGain=e.context.createGain(),this.fadeGain.connect(e),this.timeline=new A(e.context,this.fadeGain.gain),this.audioIn=this.fadeGain}update(e,t){let r=1,i=e.fadeInOut?.fadeInSeconds??0,n=e.fadeInOut?.fadeOutSeconds??0;if((0,g.n)(e)&&(i=Math.max(i,e.transitionIn?.durationInS??0),n=Math.max(n,e.transitionOut?.durationInS??0)),t===this.lastDuration&&i===this.lastFadeInSeconds&&n===this.lastFadeOutSeconds)return v.e;this.lastDuration=t,this.lastFadeInSeconds=i,this.lastFadeOutSeconds=n;let o=i,s=t-n;if(i+n>t){const e=i*t/(i+n);o=e,s=e,r*=i>0?e/i:(t-e)/n}const a=[];return o>0?a.push({seconds:0,value:0},{seconds:o,value:r}):a.push({seconds:0,value:r}),s<t&&(s!==o&&a.push({seconds:s,value:r}),a.push({seconds:t,value:0})),this.timeline.setKeyframes(a),v.e}destroy(){this.fadeGain.disconnect()}}class b extends n.E{constructor(e,t,r){super(e,t),(0,i.A)(this,"wasPlaying",!1),this.audioTimeline=r}seek(e,t){return this.audioTimeline.seek(e-this.start),this.generator.seek(e,t)}update(e,t,r){this.generator.update(e,t,r),this.wasPlaying!==t&&(this.wasPlaying=t,t?this.audioTimeline.play(e-this.start):this.audioTimeline.pause(e-this.start))}destroy(){this.generator.destroy()}render(e,t){this.generator.render(e,t)}}var w=r(403643);function x(e,t,r){let i=t.startTime,n=t.duration;if(r.compatDevice){const e=r.compatDevice.clock,o=e.mediaSecondsToTicks(t.startTime),s=e.mediaSecondsToTicks(t.startTime+t.duration);i=e.ticksToSeconds(o),n=e.ticksToSeconds(s)-i}return e.start===i&&e.duration===n&&e.offset===t.trim.from&&e.playbackRate===t.speed?v.e:(e.start=i,e.duration=n,e.offset=t.trim.from,e.playbackRate=t.speed,{seek:!0})}function S(e,t){return e.updateFilters(t),e.colorBalance=t.colorBalance??{exposure:0,saturation:0,temperature:0,contrast:0},e.blendMode=t.blendMode??"normal",(0,g.n)(t)&&(e.videoTransform={...w.DR,...t.transform}),v.e}function T(e,t,r){const i=t.alpha??1,n=C(r,t);e.alpha=i*n}function C(e,t){if(!t.fadeInOut)return 1;const r=t.fadeInOut.fadeInSeconds,i=t.fadeInOut.fadeOutSeconds;return(r>0?Math.max(0,Math.min(1,(e-t.startTime)/r)):1)*(i>0?Math.max(0,Math.min(1,(e-t.startTime-t.duration)/i*-1)):1)}function _(e,t){return void 0===e?"hydrating":e.hasLoaded(t)?"loaded":"loading"}function k(e,t,r){return e.volume=t.volume??1,x(e,t,r)}class E{constructor(e,t,r){let n;if((0,i.A)(this,"item",void 0),(0,i.A)(this,"soundNode",void 0),(0,i.A)(this,"timelineMapper",void 0),(0,i.A)(this,"generator",void 0),this.graphContext=r,r.audioOut&&(this.timelineMapper=new y(r.audioOut)),void 0===t||void 0===r.compatDevice){const[t,i]=(0,f.u)(r);r.assetResolver.fetch(e).then((t=>{const n=new m(r.root,r,t,e.metadata.raw,this.timelineMapper?.audioIn);this.item&&k(n,this.item,r),this.soundNode=n,i(n)})).catch((e=>a.Vy.error(e))),n=t}else this.soundNode=new c.s(r.root,r,r.compatDevice.reader,r.compatDevice.clock,void 0,t,this.timelineMapper?.audioIn),n=this.soundNode;this.timelineMapper?this.generator=new b(r.root,n,this.timelineMapper.timeline):this.generator=n}async update(e){this.item=e;let t=this.soundNode?k(this.soundNode,e,this.graphContext):x(this.generator,e,this.graphContext);return this.timelineMapper&&(t=(0,v.D)(t,this.timelineMapper.update(e,this.generator.duration))),t}getLoadState(e){return _(this.soundNode,e)}beforeRender(){}destroy(){this.timelineMapper?.destroy()}}var I=r(71872),R=r(945596),F=r(979820);class P extends R.A{constructor(e,t){const r=e.createShader(e.gl.FRAGMENT_SHADER,"#version 100\nprecision mediump float;\nuniform vec4 color;\nvarying vec2 texCoords;\nvoid main() { gl_FragColor = vec4(color.rgb * color.a, color.a); }\n"),n=e.createProgram(t,r);e.gl.deleteShader(r),super(e,n),(0,i.A)(this,"color",void 0),this.color=this.uniform("color",F.A.FLOAT_ARRAY_4)}}class L{get baseHeight(){return this.root.gl.canvas.height}get baseWidth(){return this.root.gl.canvas.width}get rotHeight(){return this.root.gl.canvas.height}get rotWidth(){return this.root.gl.canvas.width}constructor(e){(0,i.A)(this,"color",[0,0,0,0]),(0,i.A)(this,"duration",0),(0,i.A)(this,"rotation",0),(0,i.A)(this,"start",0),this.root=e}destroy(){}getExportStream(e,t,r){return(0,l.fE)(e,r)}hasLoaded(e){return!0}isActive(e){return e>=this.start&&e<this.start+this.duration}isStalled(e){return!1}load(e){return Promise.resolve()}pause(e,t){return Promise.resolve()}play(e){return Promise.resolve()}reduceItems(){return[{start:this.start,duration:this.duration,offset:0,fadeInSeconds:0,fadeOutSeconds:0}]}render(e,t){const r=this.root.ctx.renderers.get(P);r.color.setFloatArray4(this.color),r.renderTo(e)}seek(e,t){return Promise.resolve()}update(e,t,r){}}class N{constructor(e){(0,i.A)(this,"item",void 0),(0,i.A)(this,"generator",void 0),this.graphContext=e,this.generator=new L(e.root)}async update(e){this.item=e;const t=I.F.toRgb(e.color.hex);return this.generator.color=[t.red/255,t.green/255,t.blue/255,e.color.alpha],x(this.generator,e,this.graphContext)}getLoadState(){return"loaded"}beforeRender(e){const t=this.item?.color.alpha??1,r=this.item?C(e,this.item):1;this.generator.color[3]=t*r}destroy(){}}var M=r(289111),B=r.n(M),D=r(815731),O=r(197761),j=r(396159),U=r(943873),z=r(751203),W=r(602284),V=r(776016),H=r(471189),G=(r(896767),r(244617),r(108900),r(633977),r(769858),r(351913),r(692997),r(321450));class q{constructor(e,t){(0,i.A)(this,"isDestroyed",!1),(0,i.A)(this,"updateGeneration",0),(0,i.A)(this,"nextUpdateGeneration",1),(0,i.A)(this,"fontCacheSubscription",void 0),(0,i.A)(this,"fontHandles",new Map),(0,i.A)(this,"lastLoadPromise",void 0),this.graphContext=e,this.node=t,this.fontCacheSubscription=e.canvaskitFontCacheHandle.fontCacheChanged$.subscribe((()=>{e.requestRender(t)})),this.graphContext.canvaskitFontCacheHandle.ensureFontCollection()}destroy(){this.isDestroyed=!0,this.updateWithLoaders([]),this.fontCacheSubscription.unsubscribe()}async update(e){const t=this.nextUpdateGeneration++,r=this.getAllTypefaces(e).map((e=>this.graphContext.canvaskitFontCacheHandle.getTypefaceLoader(e))),i=Promise.all(r).then((e=>{this.updateGeneration>t||this.isDestroyed||(this.updateGeneration=t,this.updateWithLoaders(e))})).catch((e=>{a.Vy.error(o.g9.fromUnknownError(e,"Failed to create typeface loaders"))})).finally((()=>{this.lastLoadPromise=void 0}));this.lastLoadPromise=i,await i}hasLoaded(){if(void 0!==this.lastLoadPromise)return!1;for(const e of this.fontHandles.values()){const t=Q(e);if(void 0===t||!t.isLoaded())return!1}return!0}async wait(){this.lastLoadPromise&&await this.lastLoadPromise,await Promise.all([...this.fontHandles.values()].map((async e=>{const t=await function(e){return(0,G._)(e.file.pipe((0,O.p)(V.O9)))}(e);await t.wait()})))}getAllTypefaces(e){return this.node.root.db.read(z.q5,e)}updateWithLoaders(e){const t=new Set;for(const r of e){if(t.add(r.cacheKey),this.fontHandles.has(r.cacheKey))continue;const e=new D.t(void 0),i={file:e,resource:this.createResourceHandle(r,e)};this.fontHandles.set(r.cacheKey,i)}for(const[e,r]of this.fontHandles)t.has(e)||(r.resource.unlink(),this.fontHandles.delete(e))}createResourceHandle(e,t){return this.graphContext.resourceManager.createHandle({loader:e,getStartSecs:()=>this.node.start,getDurationSecs:()=>this.node.duration,onDataChanged:e=>{t.next(e)},renderDebugOverlay:(r,i)=>{const n=100,o=i.x+5,s=i.y+i.height/2+5,a=t.value;void 0===a?(r.fillStyle="rgba(244, 67, 54, 1)",r.fillRect(i.x,i.y,n,i.height),r.fillStyle="white",r.fillText("OFFLINE",o,s,90)):a.isLoaded()?(r.fillStyle="rgb(165, 214, 167)",r.fillRect(i.x,i.y,n,i.height),r.fillStyle="black",r.fillText("READY",o,s,90)):(r.fillStyle="rgb(102, 187, 106)",r.fillRect(i.x,i.y,n,i.height),r.fillStyle="black",r.fillText("LOADING",o,s,90)),r.fillStyle="rgba(0, 0, 0, 0.5)",r.fillRect(i.x+n,i.y,i.width-n,i.height),r.fillStyle="white",r.fillText(e.cacheKey,i.x+n+5,s)}})}}function Q(e){return e.file.value}class K{constructor(e,t){(0,i.A)(this,"start",0),(0,i.A)(this,"duration",0),(0,i.A)(this,"videoTransform",void 0),(0,i.A)(this,"offset",void 0),(0,i.A)(this,"playbackRate",void 0),(0,i.A)(this,"volume",void 0),(0,i.A)(this,"rootEntityId",void 0),(0,i.A)(this,"isDestroyed",!1),(0,i.A)(this,"assets",void 0),(0,i.A)(this,"componentSizeSubject",void 0),(0,i.A)(this,"componentSize$",void 0),(0,i.A)(this,"lastRenderFontCache",void 0),(0,i.A)(this,"entityWasSetSinceLastRender",!1),this.root=e,this.graphContext=t,t.canvaskit.load().then((t=>{const r=e.db.read(U.FQ);this.isDestroyed||r||e.db.set(U.FQ,t.canvaskit)})),this.assets=new q(t,this),this.componentSizeSubject=new D.t({width:0,height:0}),this.componentSize$=this.componentSizeSubject.pipe((0,O.p)(V.O9))}get rotation(){return this.videoTransform?.rotation??0}get rotWidth(){return this.root.gl.canvas.width}get rotHeight(){return this.root.gl.canvas.height}async setEntity(e){this.rootEntityId=e,await this.assets.update(e),this.entityWasSetSinceLastRender=!0}destroy(){this.isDestroyed=!0,this.assets.destroy()}getExportStream(e,t,r){return(0,H._y)(this.assets.wait().then((()=>(0,l.fE)(e,r))))}hasLoaded(){const e=this.assets.hasLoaded(),t=void 0!==this.graphContext.canvaskit.module?.surface,r=void 0!==this.root.db.read(U.Qk);return e&&t&&r}isActive(e){return e>=this.start&&e<this.start+this.duration}isStalled(){return!1}load(){return this.assets.wait()}pause(){return Promise.resolve()}play(){return Promise.resolve()}seek(){return Promise.resolve()}update(){}reduceItems(){return[{duration:this.duration,fadeInSeconds:0,fadeOutSeconds:0,offset:0,start:this.start}]}render(e){const{root:t,rootEntityId:r}=this,{db:i}=t,n=this.graphContext.canvaskit.module?.surface,o=i.read(U.Qk);if(!n||!r||!o)return void e.value.clear();const{width:s,height:a}=t.gl.canvas,c=Math.min(s,a);i.set(z.B0,{width:s/c,height:a/c}),i.set(U.H5,c),n.setSize(s,a),n.clear();const l=n.surface.getCanvas();l.save(),l.scale(c,c);const d=i.read(W.zJ,r);this.componentSizeSubject.next({width:d.width*c,height:d.height*c}),i.read(U.eY,r).value(l);const u=this.graphContext.canvaskitFontCacheHandle,h=u.getFontCache();(this.entityWasSetSinceLastRender||h!==this.lastRenderFontCache)&&(this.lastRenderFontCache=h,u.queueScanMissingGlyphs()),this.entityWasSetSinceLastRender=!1,l.restore(),n.flush(),e.value.upload(n.canvasElement,{isAlreadyPremult:!1,yFlipped:!1,generateMipmap:!1})}observe(e){return this.componentSize$.pipe((0,j.F)(B())).subscribe({next:e,error:console.log})}}var X=r(663393);class Y{constructor(e){(0,i.A)(this,"item",void 0),(0,i.A)(this,"visualNode",void 0),(0,i.A)(this,"componentNode",void 0),(0,i.A)(this,"generator",void 0),this.graphContext=e,this.componentNode=new K(e.root,e),this.generator=this.visualNode=new X.X(e.root,e,this.componentNode,e.compatDevice)}async update(e){this.item=e;const t=(0,v.D)(x(this.generator,e,this.graphContext),S(this.visualNode,e));return await this.componentNode.setEntity(e.rootEntity),t}getLoadState(e){return _(this.generator,e)}beforeRender(e){this.item&&T(this.visualNode,this.item,e)}destroy(){}}var Z=r(279541),J=r(932808),$=r(64349);function ee(e,t,r){return(0,v.D)(x(e,t,r),S(e,t))}class te{constructor(e,t,r){let n;if((0,i.A)(this,"item",void 0),(0,i.A)(this,"visualNode",void 0),(0,i.A)(this,"generator",void 0),this.graphContext=r,void 0===t||void 0===r.compatDevice){const[t,i]=(0,f.u)(r);r.assetResolver.fetch(e).then((t=>{const n=this.item?.asset?.metadata??e.metadata,[o,s]=(0,Z.Dc)(n),a=-(0,J.tR)(n.rotation),c=new $.K(r.root,r,t,(0,Z.JZ)(n),a,o,s),l=new X.X(r.root,r,c,r.compatDevice);this.item&&ee(l,this.item,r),this.visualNode=l,i(l)})).catch((e=>a.Vy.error(e))),n=t}else{const e=new c.s(r.root,r,r.compatDevice.reader,r.compatDevice.clock,t,void 0,void 0);this.visualNode=new X.X(r.root,r,e,r.compatDevice),n=this.visualNode}this.generator=n}async update(e){return this.item=e,this.visualNode?ee(this.visualNode,e,this.graphContext):x(this.generator,e,this.graphContext)}getLoadState(e){return _(this.visualNode,e)}beforeRender(e){if(this.item&&this.visualNode){const t=this.item.alpha??1,r=C(e,this.item);this.visualNode.alpha=t*r}}destroy(){}setCropping(e){this.visualNode&&(this.visualNode.cropping=e)}}var re=r(118221);class ie{constructor(e,t){(0,i.A)(this,"isDestroyed",!1),(0,i.A)(this,"updateGeneration",0),(0,i.A)(this,"nextUpdateGeneration",1),(0,i.A)(this,"fontCacheSubscription",void 0),(0,i.A)(this,"fontHandles",new Map),(0,i.A)(this,"lastLoadPromise",void 0),this.graphContext=e,this.node=t,this.fontCacheSubscription=e.fontCacheHandle.fontCacheChanged$.subscribe((()=>{e.requestRender(t)}))}destroy(){this.isDestroyed=!0,this.updateWithLoaders([]),this.fontCacheSubscription.unsubscribe()}async update(e){const t=this.nextUpdateGeneration++,r=this.getAllTypefaces(e).map((e=>this.graphContext.fontCacheHandle.getTypefaceLoader(e))),i=Promise.all(r).then((e=>{this.updateGeneration>t||this.isDestroyed||(this.updateGeneration=t,this.updateWithLoaders(e))})).catch((e=>{a.Vy.error(o.g9.fromUnknownError(e,"Failed to create typeface loaders"))})).finally((()=>{this.lastLoadPromise=void 0}));this.lastLoadPromise=i,await i}hasLoaded(){if(void 0!==this.lastLoadPromise)return!1;for(const e of this.fontHandles.values()){const t=ne(e);if(void 0===t||!t.isLoaded())return!1}return!0}async wait(){this.lastLoadPromise&&await this.lastLoadPromise,await Promise.all([...this.fontHandles.values()].map((async e=>{const t=await function(e){return(0,G._)(e.file.pipe((0,O.p)(V.O9)))}(e);await t.wait()})))}getAllTypefaces(e){const t=[],r=new Set;for(const i of e.entities)for(const e of i.segments)if("com.clipchamp.text"===e.type&&void 0!==e.properties.content)for(const i of e.properties.content){const e={fontId:i.fontId??"",fontWeight:i.fontWeight??400,isItalic:i.isItalic??!1},n=oe(e);r.has(n)||(t.push(e),r.add(n))}return t}updateWithLoaders(e){const t=new Set;for(const r of e){if(t.add(r.cacheKey),this.fontHandles.has(r.cacheKey))continue;const e=new D.t(void 0),i={file:e,resource:this.createResourceHandle(r,e)};this.fontHandles.set(r.cacheKey,i)}for(const[e,r]of this.fontHandles)t.has(e)||(r.resource.unlink(),this.fontHandles.delete(e))}createResourceHandle(e,t){return this.graphContext.resourceManager.createHandle({loader:e,getStartSecs:()=>this.node.start,getDurationSecs:()=>this.node.duration,onDataChanged:e=>{t.next(e)},renderDebugOverlay:(r,i)=>{const n=100,o=i.x+5,s=i.y+i.height/2+5,a=t.value;void 0===a?(r.fillStyle="rgba(244, 67, 54, 1)",r.fillRect(i.x,i.y,n,i.height),r.fillStyle="white",r.fillText("OFFLINE",o,s,90)):a.isLoaded()?(r.fillStyle="rgb(165, 214, 167)",r.fillRect(i.x,i.y,n,i.height),r.fillStyle="black",r.fillText("READY",o,s,90)):(r.fillStyle="rgb(102, 187, 106)",r.fillRect(i.x,i.y,n,i.height),r.fillStyle="black",r.fillText("LOADING",o,s,90)),r.fillStyle="rgba(0, 0, 0, 0.5)",r.fillRect(i.x+n,i.y,i.width-n,i.height),r.fillStyle="white",r.fillText(e.cacheKey,i.x+n+5,s)}})}}function ne(e){return e.file.value}function oe(e){return`"${e.fontId}"-${e.fontWeight}-${e.isItalic}`}class se{constructor(e){(0,i.A)(this,"created",!1),(0,i.A)(this,"_value",void 0),this.create=e}get value(){return this._value}ref(e,t){this.created||(this.created=!0,this.create(e,t).then((e=>this._value=e)).catch((t=>e.ctx.logError(t))))}}const ae=new se(((e,t)=>t.libverse.getModule().then((t=>t.createSurface(e.gl.canvas.width,e.gl.canvas.height))))),ce=new se(((e,t)=>t.libverse.getModule().then((e=>e.createFontCache([],[])))));class le{constructor(e,t){(0,i.A)(this,"start",0),(0,i.A)(this,"duration",0),(0,i.A)(this,"isDestroyed",!1),(0,i.A)(this,"lastUpdateTime",0),(0,i.A)(this,"verseDocument",{entities:[]}),(0,i.A)(this,"runtimeDocument",void 0),(0,i.A)(this,"runtimeDocumentPromise",void 0),(0,i.A)(this,"frameSubject",void 0),(0,i.A)(this,"frame$",void 0),(0,i.A)(this,"assets",void 0),(0,i.A)(this,"editingEntities",[]),(0,i.A)(this,"hasChangedSinceRender",!1),(0,i.A)(this,"lastRenderFontCache",void 0),(0,i.A)(this,"videoTransform",void 0),(0,i.A)(this,"offset",void 0),(0,i.A)(this,"playbackRate",void 0),(0,i.A)(this,"volume",void 0),this.root=e,this.graphContext=t,this.assets=new ie(t,this),this.frameSubject=new D.t(void 0),this.frame$=this.frameSubject.pipe((0,O.p)(V.O9)),ae.ref(e,t),ce.ref(e,t),this.runtimeDocumentPromise=t.libverse.getModule().then((e=>{this.isDestroyed||(this.runtimeDocument=e.createDocument())})).catch((t=>e.ctx.logError(t)))}get rotation(){return this.videoTransform?.rotation??0}get rotWidth(){return this.root.gl.canvas.width}get rotHeight(){return this.root.gl.canvas.height}setDocument(e){return(0,re.h)(e,this.verseDocument)?Promise.resolve():(this.verseDocument=e,this.runtimeDocumentPromise.then((async()=>{if(this.runtimeDocument&&this.verseDocument===e)try{this.runtimeDocument.update(e),this.hasChangedSinceRender=!0,await this.assets.update(e);const t=Math.max(0,this.lastUpdateTime-this.start),r=this.prepareFrame(t);r&&this.frameSubject.next(r)}catch(e){this.root.ctx.logError(o.g9.fromUnknownError(e,"Failed to update document"))}})))}requestRender(){this.graphContext.requestRender(this)}getDocument(){return this.verseDocument}getLastBounds(e){return this.frameSubject.value?.getBounds(e)}getAssetsLoaded(){return this.assets.hasLoaded()}setEditing(e,t){const r=this.editingEntities.indexOf(e);t&&-1===r&&this.editingEntities.push(e),t||-1===r||this.editingEntities.splice(r,1),this.requestRender()}destroy(){this.isDestroyed=!0,this.assets.destroy(),this.runtimeDocument?.destroy()}getExportStream(e,t,r){return(0,H._y)(this.waitForFullLoad().then((()=>(0,l.fE)(e,r))))}async waitForFullLoad(){await this.runtimeDocumentPromise,await this.assets.wait()}hasLoaded(){return!!this.verseDocument&&!!ae.value}isActive(e){return e>=this.start&&e<this.start+this.duration}isStalled(){return!1}load(){return this.assets.wait()}pause(){return this.assets.wait()}play(){return this.assets.wait()}seek(){return this.assets.wait()}reduceItems(){return[{duration:this.duration,fadeInSeconds:0,fadeOutSeconds:0,offset:0,start:this.start}]}update(e){this.lastUpdateTime=e}render(e,t){const r=ae.value;if(!r)return void e.value.clear();const i=this.prepareFrame(t-this.start);void 0!==i?(this.frameSubject.next(i),r.setSize(this.root.gl.canvas.width,this.root.gl.canvas.height),r.clear(),i.render(r),r.flush(),e.value.upload(r.getCanvas(),{isAlreadyPremult:!1,yFlipped:!1,generateMipmap:!1})):e.value.clear()}prepareFrame(e){const t=this.graphContext.fontCacheHandle.getFontCache()??ce.value;if(!this.runtimeDocument||!t)return;const r=this.runtimeDocument.nextFrame({fontCache:t,localTimeSecs:e,durationSecs:this.duration,frameWidth:this.root.gl.canvas.width,frameHeight:this.root.gl.canvas.height,editingEntities:this.editingEntities});return(this.hasChangedSinceRender||t!==this.lastRenderFontCache)&&(this.hasChangedSinceRender=!1,this.lastRenderFontCache=t,this.graphContext.fontCacheHandle.queueScanMissingGlyphs()),r}}class de{constructor(e){(0,i.A)(this,"item",void 0),(0,i.A)(this,"visualNode",void 0),(0,i.A)(this,"verseNode",void 0),(0,i.A)(this,"generator",void 0),this.graphContext=e,this.verseNode=new le(e.root,e),this.generator=this.visualNode=new X.X(e.root,e,this.verseNode,e.compatDevice)}async update(e){this.item=e;const t=(0,v.D)(x(this.generator,e,this.graphContext),S(this.visualNode,e));return await this.verseNode.setDocument({entities:e.entities}),t}getLoadState(e){return _(this.generator,e)}beforeRender(e){this.item&&T(this.visualNode,this.item,e)}destroy(){}}var ue=r(171957),he=r(383989);class pe extends he._{constructor(e,t,r){super(e,t),this.options=r}destroy(){this.generator.destroy()}render(e,t){this.options.data.blur&&this.blur(e,t),this.generator.render(e,t)}blur(e,t){if(this.options.data&&this.options.data.blur){const r=t-this.start,[i,n]=this.options.data.blur,o=r<i?r/i:r>this.duration-n?1-(r-this.duration+n)/n:1;(0,ue.N)(this.root,e.value.unwrap(),e,2*o)}}}var me=r(209858),fe=r(706936);class ge{constructor(e,t){(0,i.A)(this,"item",void 0),(0,i.A)(this,"visualNode",void 0),(0,i.A)(this,"pluginNode",void 0),(0,i.A)(this,"generator",void 0),this.graphContext=t,this.pluginNode=new me.q(t.root,t,new fe.e(t),e.options,(e=>e?t.assetResolver.fetch(e):Promise.resolve({permanentUrl:""}))),this.visualNode=new X.X(t.root,t,this.pluginNode,t.compatDevice),this.generator=new pe(t.root,this.visualNode,e.options)}async update(e){this.item=e;const t=(0,v.D)(x(this.generator,e,this.graphContext),S(this.visualNode,e)),r=this.pluginNode.sanitiseFields(e.fields);if(e.bounds){const t=r.alignment??.5,i=.5;let n=r.scale??1;r.scaleIsInBounds&&(n=await async function(e,t,r){await e.setFields(r,void 0);const i=await e.getNeutralBoundingBox();return i?(t.top-t.bottom)/(i.top-i.bottom):1}(this.pluginNode,e.bounds,r)),await this.pluginNode.setFields(r,{originX:t,originY:i,posX:e.bounds.left*(1-t)+e.bounds.right*t,posY:1-(e.bounds.top*(1-i)+e.bounds.bottom*i),scale:n})}else await this.pluginNode.setFields(r,void 0);return t}getLoadState(e){return _(this.generator,e)}beforeRender(e){this.item&&T(this.visualNode,this.item,e)}destroy(){}}var Ae=r(72704);function ve(e,t,r){return e.volume=t.volume??1,(0,v.D)(x(e,t,r),S(e,t))}class ye{constructor(e,t,r,n){let o;if((0,i.A)(this,"item",void 0),(0,i.A)(this,"visualNode",void 0),(0,i.A)(this,"timelineMapper",void 0),(0,i.A)(this,"needsReload",!1),(0,i.A)(this,"generator",void 0),this.graphContext=n,n.audioOut&&(this.timelineMapper=new y(n.audioOut)),void 0===t||void 0===n.compatDevice){const[t,r]=(0,f.u)(n);(0,Ae.C)(e,n).subscribe({next:t=>{if(void 0!==this.visualNode)return void(this.needsReload=!0);const i=(0,Ae.Q)(e,n,t,this.timelineMapper?.audioIn),o=new X.X(n.root,n,i,n.compatDevice);this.item&&ve(o,this.item,n),this.visualNode=o,r(o)},error:e=>a.Vy.error(e)}),o=t}else{const e=new c.s(n.root,n,n.compatDevice.reader,n.compatDevice.clock,t,r,this.timelineMapper?.audioIn);this.visualNode=new X.X(n.root,n,e,n.compatDevice),o=this.visualNode}this.timelineMapper?this.generator=new b(n.root,o,this.timelineMapper.timeline):this.generator=o}async update(e){this.item=e;let t=this.visualNode?ve(this.visualNode,e,this.graphContext):x(this.generator,e,this.graphContext);return this.timelineMapper&&(t=(0,v.D)(t,this.timelineMapper.update(e,this.generator.duration))),t}getLoadState(e){return this.needsReload?"needs-reload":_(this.visualNode,e)}beforeRender(e){this.item&&this.visualNode&&T(this.visualNode,this.item,e)}destroy(){this.timelineMapper?.destroy()}setCropping(e){this.visualNode&&(this.visualNode.cropping=e)}}function be(e,t){return{internal:t,update:r=>{if(!function(e,t){return e.asset.type===t}(r,e))throw new o.g9((0,s.vU)("Expected a TrackItem with a matching asset type, but it changed"),{expectedType:e,actualType:r.asset.type});return t.update(r)}}}class we extends n.E{constructor(e,t,r,n){const a=function(e,t,r,i){switch(e.type){case"video":return be("video",new ye(e,t,r,i));case"audio":return be("audio",new E(e,r,i));case"image":return be("image",new te(e,t,i));case"title":return be("title",new ge(e,i));case"background":return be("background",new N(i));case"procedural":return be("procedural",new de(i));case"component":return be("component",new Y(i));default:throw new o.g9((0,s.vU)("Cannot create a graph node from an unknown asset type"),{assetType:e.type})}}(e,t,r,n);super(n.root,a.internal.generator),(0,i.A)(this,"mapper",void 0),this.mapper=a}getPluginNode(){return this.mapper.internal.pluginNode}getVerseNode(){return this.mapper.internal.verseNode}getComponentNode(){return this.mapper.internal.componentNode}getLoadState(e){return this.mapper.internal.getLoadState(e)}render(e,t){this.mapper.internal.beforeRender(t),this.generator.render(e,t)}destroy(){this.mapper.internal.destroy(),this.generator.destroy()}updateItem(e){return this.mapper.update(e)}setCropping(e){this.mapper.internal.setCropping?.(e)}}},623198:(e,t,r)=>{r.d(t,{Y:()=>M});var i=r(324586),n=r(131512),o=r(966139),s=r(463716),a=r(869211),c=r(393279),l=r(582982),d=r(736766),u=r(129582);const h={name:"AudioVisualiserRenderer",fragmentShader:"precision mediump float;\n\nuniform sampler2D audioSampler;\nuniform vec2 viewportSize;\nuniform float time;\nvarying vec2 texCoords;\n\n// Analyser-related properties\nuniform float bucketCount;\nuniform float sampleRate;\nuniform vec2 decibelRange;\n\n// Configuration properties\nuniform vec2 freqHzRange;\nuniform vec4 outsideColor;\nuniform vec4 insideColor;\nuniform vec4 rect;\nuniform int mode;\n\n// Must match the values in AudioVisualiserMode!\nconst int MODE_HORIZONTAL_BARS = 1;\nconst int MODE_HORIZONTAL_LINES = 2;\n\nvec2 rectViewportSize() {\n    return viewportSize * rect.zw;\n}\n\nfloat xToFreq(float x) {\n    return mix(freqHzRange.x, freqHzRange.y, x);\n}\n\nfloat freqToSampleCoord(float freq) {\n    // FFT texture is in range [0, sampleRate/2]\n    return clamp(freq * 2. / sampleRate, 0., 1.);\n}\n\nfloat xToSampleCoord(float x) {\n    return freqToSampleCoord(xToFreq(x));\n}\n\nfloat sampleVoltage(float x) {\n    float normalizedDb = texture2D(audioSampler, vec2(x, 0.)).x;\n    if (normalizedDb == 0.) return 0.;\n    float db = mix(decibelRange.x, decibelRange.y, normalizedDb);\n    float voltage = pow(10., db / 20.);\n    return pow(voltage, 0.8);\n}\n\nfloat sampleSmoothedVoltage(float x) {\n    // Sample voltage with a gaussian blur\n    // from https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/13.glsl\n    float smoothedVal = 0.;\n    float off1 = 1.411764705882353 * 0.2;\n    float off2 = 3.2941176470588234 * 0.2;\n    float off3 = 5.176470588235294 * 0.2;\n    smoothedVal += sampleVoltage(x) * 0.1964825501511404;\n    smoothedVal += sampleVoltage(x + off1 / bucketCount) * 0.2969069646728344;\n    smoothedVal += sampleVoltage(x - off1 / bucketCount) * 0.2969069646728344;\n    smoothedVal += sampleVoltage(x + off2 / bucketCount) * 0.09447039785044732;\n    smoothedVal += sampleVoltage(x - off2 / bucketCount) * 0.09447039785044732;\n    smoothedVal += sampleVoltage(x + off3 / bucketCount) * 0.010381362401148057;\n    smoothedVal += sampleVoltage(x - off3 / bucketCount) * 0.010381362401148057;\n    return smoothedVal;\n}\n\n// Equivalent to step, but returns in-between values across the boundary based on pixelSize.\n// When q < edge returns 0, when q > edge returns 1\nfloat aaStep(float edge, float q, float pixelSize) {\n    float edgeMin = edge - pixelSize / 2.;\n    return clamp((q - edgeMin) / pixelSize, 0., 1.);\n}\n\nfloat aaStepX(float edge, float x) {\n    return aaStep(edge, x, 1. / rectViewportSize().x);\n}\n\nfloat aaStepY(float edge, float y) {\n    return aaStep(edge, y, 1. / rectViewportSize().y);\n}\n\nconst int BAR_COUNT = 120;\n\nvec4 horizontalBarVisualiser(vec2 normalizedCoords) {\n    int barCount = int(rect.z * 100.);\n    float normalizedBarWidth = 1. / float(barCount) / 4.;\n    float normalizedSpaceWidth = 1. / float(barCount) / 4.;\n\n    float totalBarWidth = normalizedBarWidth + normalizedSpaceWidth;\n    float barLeft = floor(normalizedCoords.x / totalBarWidth) * totalBarWidth;\n    float barLocalX = normalizedCoords.x - barLeft;\n\n    float filledLeft = barLeft + normalizedBarWidth / 2.;\n    float filledRight = filledLeft + normalizedBarWidth;\n\n    float voltage = sampleVoltage(xToSampleCoord(barLeft + totalBarWidth * 0.5)) * 4.;\n    float barHeight = max(voltage, 1. / rectViewportSize().y); // ensure the bar has a height\n\n    float filledAA =\n        aaStepX(filledLeft, normalizedCoords.x)\n        * aaStepX(normalizedCoords.x, filledRight)\n        * aaStepY(abs(normalizedCoords.y - 0.5), barHeight);\n\n    float colorFade = abs(normalizedCoords.x - 0.5) * 2.;\n    vec4 barColor = mix(insideColor, outsideColor, colorFade);\n\n    return filledAA * barColor;\n}\n\nconst float LINE_THICKNESS = 0.0025;\n\nvec4 horizontalLineVisualiser(vec2 normalizedCoords) {\n    float voltage = sampleSmoothedVoltage(xToSampleCoord(normalizedCoords.x)) * 4.;\n    float lineHeight = voltage;\n\n    float mirroredY = abs(normalizedCoords.y - 0.5);\n    float adjustedThickness = LINE_THICKNESS / rect.w;\n\n    // todo(webgl2):\n    //   use screenspace derivatives to fix near-vertical lines\n    float filledAA =\n        aaStepY(voltage - adjustedThickness, mirroredY) * aaStepY(mirroredY, voltage + adjustedThickness);\n\n    float colorFade = abs(normalizedCoords.x - 0.5) * 2.;\n    vec4 barColor = mix(insideColor, outsideColor, colorFade);\n\n    return filledAA * barColor;\n}\n\nvoid main() {\n    vec2 normalizedCoords = (texCoords - rect.xy) / rect.zw;\n\n    // Don't render outside bounds\n    if (normalizedCoords.x < 0. || normalizedCoords.x > 1.) {\n        discard;\n        return;\n    }\n\n    if (mode == MODE_HORIZONTAL_BARS) {\n        gl_FragColor = horizontalBarVisualiser(normalizedCoords);\n    } else if (mode == MODE_HORIZONTAL_LINES) {\n        gl_FragColor = horizontalLineVisualiser(normalizedCoords);\n    }\n}\n",uniformNames:["viewportSize","time","bucketCount","sampleRate","decibelRange","freqHzRange","outsideColor","insideColor","rect","mode"],samplerNames:["audioSampler"]};class p extends d.A{constructor(e){super(e,h),(0,i.A)(this,"audioSampler",void 0),(0,i.A)(this,"viewportSizeUniform",void 0),(0,i.A)(this,"time",void 0),(0,i.A)(this,"bucketCount",void 0),(0,i.A)(this,"sampleRate",void 0),(0,i.A)(this,"decibelRange",void 0),(0,i.A)(this,"freqHzRange",void 0),(0,i.A)(this,"outsideColor",void 0),(0,i.A)(this,"insideColor",void 0),(0,i.A)(this,"rect",void 0),(0,i.A)(this,"mode",void 0),this.audioSampler=this.sampler("audioSampler"),this.viewportSizeUniform=this.uniform("viewportSize",u.A.FLOAT_ARRAY_2),this.time=this.uniform("time",u.A.FLOAT),this.bucketCount=this.uniform("bucketCount",u.A.FLOAT),this.sampleRate=this.uniform("sampleRate",u.A.FLOAT),this.decibelRange=this.uniform("decibelRange",u.A.FLOAT_ARRAY_2),this.freqHzRange=this.uniform("freqHzRange",u.A.FLOAT_ARRAY_2),this.outsideColor=this.uniform("outsideColor",u.A.FLOAT_ARRAY_4),this.insideColor=this.uniform("insideColor",u.A.FLOAT_ARRAY_4),this.rect=this.uniform("rect",u.A.FLOAT_ARRAY_4),this.mode=this.uniform("mode",u.A.INTEGER)}}r(34456),r(159129),r(940233),r(270818),r(513173),r(205218);const m=1024,f=(new Uint8Array(m),.5),g={"horizontal-bars":1,"horizontal-lines":2};class A{constructor(e,t){(0,i.A)(this,"outerColor",[1,1,1,1]),(0,i.A)(this,"innerColor",[1,1,1,.5]),(0,i.A)(this,"position",[.5,.5]),(0,i.A)(this,"freqHzRange",[0,2e3]),(0,i.A)(this,"size",.7),(0,i.A)(this,"mode","horizontal-bars"),this.root=e,this.audioCache=t}waitForReady(e,t,r){return this.audioCache.value.getSource(t,r).waitForDataAt(e)}render(e,t,r,i){const n=this.root.ctx.renderers.get(p);(0,l.Ww)(this.root.allocCopyImage())((o=>{o.value.uploadBuffer(this.audioCache.value.getSource(r,i).trySampleDataAt(t),m,1,{isAlreadyPremult:!0,yFlipped:!1,imageFormat:c._L,bufferFormat:c.VG}),n.audioSampler.set(o.value.bindSampler()),n.time.setFloat(t),n.bucketCount.setFloat(m),n.sampleRate.setFloat(44100),n.decibelRange.setFloatArray2([-80,-10]),n.freqHzRange.setFloatArray2(this.freqHzRange),n.outsideColor.setFloatArray4(this.outerColor),n.insideColor.setFloatArray4(this.innerColor),n.mode.setInteger(g[this.mode]);const{x:s,y:a,width:l,height:d}=function(e,t){let r,i,n,o;return n=e[0]===f?t:.5*t,o=e[1]===f?.5*t:.3*t,r=e[0]<f?.02+.02*(1-t):e[0]>f?1-n-.02-.02*(1-t):.5-n/2,i=e[1]>f?.01+.04*(1-t):e[1]<f?1-o-.01-.04*(1-t):.5-o/2,{x:r,y:i,width:n,height:o}}(this.position,this.size);n.rect.setFloatArray4([s,a,l,d]),n.renderTo(e)}))}}var v=r(350879),y=r(655624),b=r(893910),w=r(930919);class x{constructor(e,t){(0,i.A)(this,"audioVisualiserNode",void 0),(0,i.A)(this,"rotation",0),(0,i.A)(this,"videoTransform",void 0),(0,i.A)(this,"start",0),(0,i.A)(this,"duration",0),this.root=e,this.audioVisualiserNode=new A(e,t)}get rotHeight(){return this.root.ctx.getRenderHeight()}get rotWidth(){return this.root.ctx.getRenderWidth()}isActive(e){return e>=this.start&&e<this.start+this.duration}render(e,t){if(this.audioVisualiser){const r=this.root.allocImage(!0,1,1);return r.value.clear(),this.audioVisualiserEffect(r,t),void e.value.copy(r)}const r=this.root.allocCopyImage();r.value.upload(this.canvas,{isAlreadyPremult:!0,yFlipped:!1});let i=r;if(this.glitch){const e=this.root.allocImage(!0,1,1);this.glitchEffect(e,i,t),i.free(),i=e}if(this.smoke){const e=this.root.allocImage(!0,1,1);this.smokeEffect(e,i,t),i.free(),i=e}e.value.copy(i)}glitchEffect(e,t,r){if(this.glitch){const{amount:i,speed:n}=this.glitch;(0,y.Q)(this.root,i,n).render(e,t,{time:r,start:this.start,duration:this.duration,matrix:s.d.identity})}}smokeEffect(e,t,r){this.smoke&&(0,b.y)(this.root,!0).render(e,t,{time:r,start:this.start,duration:this.duration,matrix:s.d.identity})}audioVisualiserEffect(e,t){if(this.audioVisualiser){const{outerColor:r,innerColor:i,position:n,size:o,showBars:s}=this.audioVisualiser;this.audioVisualiserNode.outerColor=(0,a.sc)(r),this.audioVisualiserNode.innerColor=(0,a.sc)(i),this.audioVisualiserNode.position=n,this.audioVisualiserNode.size=o,this.audioVisualiserNode.mode=s?"horizontal-bars":"horizontal-lines",this.audioVisualiserNode.render(e,t,this.start,this.duration)}}}class S extends w._{constructor(e,t,r){super(e.root,t),this.params=r}destroy(){this.generator.destroy()}render(e,t){this.blur(e,t),this.generator.render(e,t)}blur(e,t){if(this.params){const r=t-this.start,{blurIn:i,blurOut:n}=this.params,o=r<i?r/i:r>this.duration-n?1-(r-this.duration+n)/n:1;(0,v.N)(this.root,e.value.unwrap(),e,2*o)}}}var T=r(148278),C=r(629179);class _{constructor(e){(0,i.A)(this,"item",void 0),(0,i.A)(this,"visualNode",void 0),(0,i.A)(this,"generator",void 0),this.visualNode=new T.X(e.root,e),this.generator=new S(e,this.visualNode,e.blur)}destroy(){}update(e,t){(0,C.EQ)(this.generator.root,this.generator,e),(0,C.OE)(this.visualNode,e,t)}beforeRender(e){this.item&&this.generator&&(0,C.Oz)(this.visualNode,this.item,e)}}r(379321);var k=r(217563),E=r(304760),I=r(394050);function R(e){return!!e.isFreehandSupported}function F(e){return"getEntryDuration"in e&&"getExitDuration"in e}class P extends x{get baseWidth(){return this.rotWidth}get baseHeight(){return this.rotHeight}get glitch(){if(this.options.data&&this.options.data.glitch){const e=()=>{if("fields"===this.options.data.glitch){const e=(0,E.BI)(this.fields,this.options.fields);return[e.amount,e.speed]}return this.options.data.glitch},[t,r]=e();return{amount:t,speed:r}}}get smoke(){return!!this.options.data.smoke}get blur(){if(this.options.data&&this.options.data.blur){const[e,t]=this.options.data.blur;return{blurIn:e,blurOut:t}}}get audioVisualiser(){if(this.options.data&&this.options.data.audioVisualiser){const e=()=>{if("fields"===this.options.data.audioVisualiser){const e=(0,E.BI)(this.fields,this.options.fields);return[e.outerColor,e.innerColor,e.position,e.size,e.showBars]}return this.options.data.audioVisualiser},[t,r,i,n,o]=e();return{outerColor:t,innerColor:r,position:i,size:n,showBars:o}}}get dimensions(){return s.d.scale(this.baseWidth,this.baseHeight)}get fields(){return this._fields}get pluginReady(){return this._pluginReady}get entryDuration(){return this.instance&&F(this.instance)?this.instance.getEntryDuration()??void 0:void 0}get exitDuration(){return this.instance&&F(this.instance)?this.instance.getExitDuration()??void 0:void 0}constructor(e,t,r,n,o,s){const a=r();super(e.rootNode,a),(0,i.A)(this,"isUpdating",!1),(0,i.A)(this,"isSeeking",!1),(0,i.A)(this,"canvas",document.createElement("canvas")),(0,i.A)(this,"lastUpdateTime",1/0),(0,i.A)(this,"_fields",{}),(0,i.A)(this,"destroyed",new k.B),(0,i.A)(this,"instance",void 0),(0,i.A)(this,"originalFields",{}),(0,i.A)(this,"pluginLoaded",void 0),(0,i.A)(this,"_pluginReady",void 0),(0,i.A)(this,"currentFreehandPosition",void 0),(0,i.A)(this,"pluginManager",void 0),(0,i.A)(this,"_isLoaded",!1),(0,i.A)(this,"audioCache",void 0),this.externalGraphContext=e,this.assetLoader=n,this.options=o,this.fetchAsset=s,this.audioCache=a,this.pluginLoaded=this.loadPlugin(),this._pluginReady=this.pluginLoaded,this.pluginManager=t}destroy(){this.canvas.remove(),this.destroyed.next(),this.destroyed.complete(),this.audioCache.free()}render(e,t){this.instance&&super.render(e,t)}isStalled(){return!this._isLoaded||this.isUpdating||this.isExportStalled()}isExportStalled(){return!this.root.clock.isRealtime&&this.isSeeking}async setFields(e,t){await this.updateFields(e,t),this.instance&&await this.instance.render(this.lastUpdateTime,this.duration).catch((()=>{}))}updateFields(e,t){return this.originalFields=e,this.currentFreehandPosition=t,this._pluginReady=this._pluginReady.then((async()=>{try{this._fields=await(0,E.ES)(e,this.options,Math.min(this.baseWidth,this.baseHeight),this.fetchAsset),this.instance&&R(this.instance)&&(this.instance.position=t),this.instance&&await this.instance.update((0,E.BI)(this.fields,this.options.fields))}catch(e){console.error(e)}})),this._pluginReady}update(e){const t=this.timelineToLocalTime(e);if((t!==this.lastUpdateTime||this.canvas.width!==this.baseWidth||this.canvas.height!==this.baseHeight)&&(this.lastUpdateTime=t,this.instance)){const r=this.instance;this.isSeeking=!0;const i=[this.resize()];this.audioVisualiser&&i.push(this.audioCache.value.getSource(this.start,this.duration).waitForDataAt(e)),Promise.all(i).then((()=>r.render(t,this.duration))).catch((()=>{})).finally((()=>{this.isSeeking=!1,this.root.requestRender(this)}))}}isFreehandSupported(){return void 0!==this.instance&&R(this.instance)}async getBoundingBox(e){if(this.instance&&R(this.instance)){await this.resize();const t=await this.instance.getBoundingBox(e).catch(console.error);if(void 0===t)return;return{top:1-t.top/this.baseHeight,left:t.left/this.baseWidth,right:(t.left+t.width)/this.baseWidth,bottom:1-(t.top+t.height)/this.baseHeight}}}async getNeutralBoundingBox(e){if(this.instance&&R(this.instance)){await this.resize();const t=await this.instance.getUnscaledBoundingBox(e);if(void 0===t)return;return{top:1-t.top/this.baseHeight,left:t.left/this.baseWidth,right:(t.left+t.width)/this.baseWidth,bottom:1-(t.top+t.height)/this.baseHeight}}}sanitiseFields(e){return(0,I.h)(e,this.options.fields)}async loadPlugin(){await this.resize();const e=await this.pluginManager.load(this.options.pluginSrc);this.instance=new e(this.canvas,this.options.data,(0,E.BI)(this.fields,this.options.fields),this.assetLoader),await this.instance.init(),this._isLoaded=!0}async resize(){this.canvas.width===this.baseWidth&&this.canvas.height===this.baseHeight||(this.canvas.width=this.baseWidth,this.canvas.height=this.baseHeight,this.instance&&await this.updateFields(this.originalFields,this.currentFreehandPosition))}timelineToLocalTime(e){return Math.min(this.duration,Math.max(0,e-this.start))}}var L=r(706936);class N extends _{constructor(e,t,r,n){const o=new P(r,t.getPluginManager(),t.createAudioHandle,new L.e(t),e.options,(e=>e?t.assetResolver.fetch(e):Promise.resolve({permanentUrl:""})));super(o),(0,i.A)(this,"_item",void 0),(0,i.A)(this,"pluginNode",void 0),this.externalGraphContext=r,this.pluginCache=n,this.pluginNode=o}update(e,t){this._item=e;const r=(0,n.we)(e.id);void 0!==r&&(0,o.p)(r)&&(void 0===this.pluginCache.get(e.id)&&this.pluginCache.set(e.id,this.pluginNode),this.pluginNode.isUpdating=!0,super.update(e,t),this.updateAsync(r).then((()=>{this.externalGraphContext.rootNode.requestRender(this.generator)})).finally((()=>{this.pluginNode.isUpdating=!1})))}async updateAsync(e){const t=this.pluginNode.sanitiseFields(e.fields);if(e.bounds){const r=t.alignment??.5,i=.5;let n=t.scale??1;t.scaleIsInBounds&&(n=await async function(e,t,r){await e.setFields(r,void 0);const i=await e.getNeutralBoundingBox();return i?(t.top-t.bottom)/(i.top-i.bottom):1}(this.pluginNode,e.bounds,t)),await this.pluginNode.setFields(t,{originX:r,originY:i,posX:e.bounds.left*(1-r)+e.bounds.right*r,posY:1-(e.bounds.top*(1-i)+e.bounds.bottom*i),scale:n})}else await this.pluginNode.setFields(t,void 0)}destroy(){super.destroy(),this._item&&this.pluginCache.delete(this._item.id)}}const M=(e,t)=>(r,i)=>{if("title"===r.type)return new N(r,e,i,t)}},468910:(e,t,r)=>{r.d(t,{D:()=>n,e:()=>i});const i={seek:!1};function n(e,t){return{seek:e.seek||t.seek}}},72704:(e,t,r)=>{r.d(t,{Q:()=>C,C:()=>T});var i=r(720291),n=r(279541),o=r(932808),s=r(324586),a=r(471189),c=r(214015),l=r(632670),d=r(702335),u=r(333358),h=r(686781);class p extends u.o{constructor(e,t,r,i,n,o,a,c){super(e,t,(0,h.M)("video",r.permanentUrl)),(0,s.A)(this,"yFlipped",!1),this.cachedFile=r,this.rotation=i,this.rotWidth=n,this.rotHeight=o,this.metadata=a,this.audioOut=c}createMediaElement(e){const t=new d.O(this.cachedFile,this.metadata,e,this.playbackRate);if(t.onStalledChanged.subscribe((e=>{!e&&t.isLoaded&&this.root.requestUnstall(this)})),!this.audioOut)return t;const r=new l.m(t,this.volume,this.audioOut.context);return r.connect(this.audioOut),r}getExportStream(e,t,r){return(0,a._y)(this.load().then((()=>(0,c.R6)(e,t,r,(async(e,t)=>{await this.seek(e,!0).catch((e=>{console.warn("Error while seeking in export stream:",e)})),await t()}),(()=>{})))))}render(e,t){if(!(this.currentElement&&(r=this.currentElement.domElement,r.readyState>=1&&r.videoWidth>0&&r.videoHeight>0)))return;var r;const i=this.currentElement.domElement;e.value.upload(i,{isAlreadyPremult:!1,yFlipped:this.yFlipped})}}var m=r(304669),f=r(133743),g=r(777689),A=r(941750),v=r(152848),y=r(839718),b=r(118545);class w{constructor(e,t,r,i){(0,s.A)(this,"duration",0),(0,s.A)(this,"offset",0),(0,s.A)(this,"playbackRate",1),(0,s.A)(this,"start",0),(0,s.A)(this,"rotation",void 0),(0,s.A)(this,"rotHeight",void 0),(0,s.A)(this,"rotWidth",void 0),(0,s.A)(this,"decoder",void 0),(0,s.A)(this,"frameData",void 0),this.root=e,this.peppermint=t,this.cachedFile=r,this.asset=i,this.rotation=-(0,o.tR)(i.metadata.rotation),[this.rotWidth,this.rotHeight]=(0,n.Dc)(i.metadata)}mapTime(e){const t=e-this.start;return this.offset+t*this.playbackRate}async getExportStreamAsync(e,t){this.decoder=await this.peppermint.createVideoDecoder(this.cachedFile.getTranscoderInputFile()),await this.decoder.seek(this.mapTime(t));let r=0;return(0,a.tk)((async i=>{for(;void 0!==this.decoder;){try{await this.decoder.decodeFrame(this.mapTime(t+r/e))}catch(e){if(!(e instanceof g.DP))throw f.c.fromUnknownError(this.asset,e);console.warn("End of file")}if(r+=1,void 0===this.decoder)break;await i()}}),(()=>{this.decoder?.destroy().catch((e=>console.warn("Failed to destroy decoder:",e))),delete this.decoder,this.frameData?.free(),delete this.frameData}))}destroy(){}getExportStream(e,t){return(0,a._y)(this.getExportStreamAsync(e,t))}hasLoaded(){return!0}isActive(e){return e>=this.start&&e<this.start+this.duration}isStalled(){return!1}load(){return Promise.resolve()}pause(){return Promise.resolve()}play(){return Promise.resolve()}reduceItems(){return[]}renderRaw(e,t){void 0===this.frameData&&(this.frameData=y.m.create(this.root));const r={width:t.width,height:t.height};this.frameData.value.uploadFrame((0,b.v)(t.data,r,t.format===A.Ng.Yuva420P));const i=this.root.allocImage(!1,t.width,t.height),n=this.root.ctx.renderers.get(v.C);this.frameData.value.bindToRenderer(n,{frameResolution:r,verticalOffset:0,trackItemId:"peppermint"}),n.renderTo(i),e.value.copy(i)}renderWebCodec(e,t){e.value.upload(t.data,{isAlreadyPremult:!1,yFlipped:!1})}render(e,t){if(void 0===this.decoder)throw new Error("No decoder available");const r=this.decoder.getFrame(this.mapTime(t));if(void 0===r)throw new Error("No frame available");"raw"===r.type?this.renderRaw(e,r):this.renderWebCodec(e,r)}seek(){return Promise.resolve()}update(){}}var x=r(383989);class S extends x._{constructor(e,t,r){super(e,t),this.loopDurationSecs=r}destroy(){this.generator.destroy()}render(e,t){this.generator.render(e,t)}getExportStream(e,t){const r=this.loopDurationSecs/(this.playbackRate??1),i=t-this.start;let n,o=!0,s=i%r;return(0,a.tk)((async t=>{for(;o;){const i=r-s,o=Math.floor(i*e);n=this.generator.getExportStream(e,this.start+s,i);let a=await n.next;for(let e=0;e<o&&!a.finished;e++)await t(),a=await a.continue();n?.cleanup(),s=0}}),(()=>{o=!1,n?.cleanup()}))}}function T(e,t){return(0,i.H)(t.assetResolver.fetch(e))}function C(e,t,r,i){switch(t.profile.type){case"preview":const[s,a]=(0,n.Dc)(e.metadata);return t.features.useManagedMediaNodes?new p(t.root,t,r,-(0,o.tR)(e.metadata.rotation),s,a,e.metadata.raw,i):new m.E(t.root,t.resourceManager,r,-(0,o.tR)(e.metadata.rotation),s,a,e.metadata.raw,i);case"export:peppermint":const c=new w(t.root,t.profile.manager,r,e);return e.loop?new S(t.root,c,e.metadata.duration):c}}},839718:(e,t,r)=>{r.d(t,{m:()=>o});var i=r(324586),n=r(987089);class o{get frameHeight(){return this._frameHeight}get frameWidth(){return this._frameWidth}get useAlpha(){return this._useAlpha}get uTex(){return this._uTex}get vTex(){return this._vTex}get yTex(){return this._yTex}get aTex(){return this._aTex}static create(e){const t=new o(e);return{value:t,free:()=>t.destroy()}}constructor(e){(0,i.A)(this,"_frameHeight",0),(0,i.A)(this,"_frameWidth",0),(0,i.A)(this,"_useAlpha",!1),(0,i.A)(this,"_uTex",void 0),(0,i.A)(this,"_vTex",void 0),(0,i.A)(this,"_yTex",void 0),(0,i.A)(this,"_aTex",void 0),this.root=e,this._yTex=e.allocCopyImage(),this._uTex=e.allocCopyImage(),this._vTex=e.allocCopyImage()}bindToRenderer(e,t){e.textureStretch.setFloatArray2([t.frameResolution.width/this._frameWidth,t.frameResolution.height/this._frameHeight]),e.textureOffset.setFloatArray2([0,1-(t.verticalOffset+t.frameResolution.height)/this._frameHeight]),e.useAlpha.setFloat(this._useAlpha?1:0),e.ySampler.set(this._yTex.value.bindSampler(0)),e.uSampler.set(this._uTex.value.bindSampler(1)),e.vSampler.set(this._vTex.value.bindSampler(2)),void 0!==this._aTex&&e.aSampler.set(this._aTex.value.bindSampler(3))}uploadFrame(e){const t=e.resolution.width,r=e.resolution.height,i=e.chromaResolution.width,o=e.chromaResolution.height,s={isAlreadyPremult:!0,yFlipped:!1,imageFormat:n._L,bufferFormat:n.VG};this._yTex.value.uploadBuffer(e.yBuffer,t,r,s),this._uTex.value.uploadBuffer(e.uBuffer,i,o,s),this._vTex.value.uploadBuffer(e.vBuffer,i,o,s),void 0!==e.aBuffer?(this._useAlpha=!0,void 0===this._aTex&&(this._aTex=this.root.allocCopyImage()),this._aTex.value.uploadBuffer(e.aBuffer,t,r,s)):this._useAlpha=!1,this._frameWidth=t,this._frameHeight=r}destroy(){this._yTex.free(),this._uTex.free(),this._vTex.free(),this._aTex?.free()}}},118545:(e,t,r)=>{r.d(t,{v:()=>n});const i=2;function n(e,t,r=!1){const n=Math.ceil(t.width/i),o=Math.ceil(t.height/i),s=t.width*t.height,a=s,c=n*o,l=a+c,d=l+c,u={resolution:t,chromaResolution:{width:n,height:o},yBuffer:e.subarray(0,a),uBuffer:e.subarray(a,l),vBuffer:e.subarray(l,d)};if(r){const t=d+s;u.aBuffer=e.subarray(d,t)}return u}},149677:(e,t,r)=>{e.exports=r.p+"static/vqe-worklet-processor.iife.287b4588.js"},453916:e=>{e.exports="#version 100\nattribute vec2 vertexPos;\nattribute vec2 vertexUV;\nvarying vec2 texCoords;\nvoid main() {\n    texCoords = vertexUV;\n    gl_Position = vec4(vertexPos, 0, 1);\n}\n\n"},962165:e=>{e.exports="#version 100\nattribute vec2 vertexPos;\nattribute vec2 vertexUV;\nvarying vec2 texCoords;\nuniform mat3 matrix;\nvoid main() {\n    texCoords = vertexUV;\n    vec2 transformed = (matrix * vec3(vertexPos, 1)).xy;\n    gl_Position = vec4(transformed, 0, 1);\n}\n"},126014:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPwAAAD+CAIAAACRAf87AAAE8UlEQVR4Xu3c7VnjOBQG0JRAB9BB0gHpIHQQOqCEKYESKCElUAIlUAIlaO/aT7JG9hWZMLOAfc7PRJJlntfy9UdYrQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgNlbr9fPf8H19XW9Jfgmbm9vy18g9HxfQj90dXUVf5DHTv0dsyH0IWb78PAQVdnb21s//6enp7oRs7Hw0MfS/vr6Ws9e6Odt4aG/ubmpp94R+jnbbDavTXUcjup27wk9P1WWiVA3/ZmyHRT65coyUYSeucoyUT4R+uuj+ouvkO2g0C9Xlonym6Hvb36/vLxUg8QnEa/1el13ONrtdr8SjV4x7br1URxsw29jVtWUejGxQad/NTbHrHw+9P1rDnXnkcPhMLn2R/e66VEMW7c+igOpbt3pu1x2w2q/39ebYZY+GfqHh4fT454PRcvJYMUqWzc9mmyfzTnG748roaclC1A5I/SNsDaMs5U9PyrdbdOq8Spf5uMI7BsIPS0Xhz4SVnc4z2k9HmrEtMpiVg4NL0wbozUI/VJcFvrolVU1Eb67u7vNZrPdbrMlebJYz644q8V+8vqhelgm9LRcFvoszePcZPkbL/ZR5GQH0mnYbLRquzHU9iiOwLp1Jw6eU5te9BoOwmxdEPqsS5T4ddPO4XComyaNI7t1u85psZ8s/dt33LPZtnsxZ1kmSh76yTpk8oqzd39/X7dOKpxVUr2Ubi3f7Xb1p6PCZizbQaFfriwTJQ/9+AlU6W7D1+2OJmuSqGTqdp3sauG5U386KmzGsh0U+uXKMlGS0EfhW7frROj3iew+T1ZDZ+3HzglutoPn9GWeskyUJPSbzaZud6lGWTJ5Mql8WNj0sh0U+uXKMlGS0E/WKpdpRPacrWy327rblGwHhX65skyULw19mKzsh07PX9uyHRT65coyUb409Oe84DD5ZHcs20GhX64sEyUJfVbTPz8///eS7nmyC9nGlCrZfc+hbDShX64sEyUJfdb+D2Zo8glUVu3sdru6/3v/w4T5YbJMlCT0q6Tazu67/65fSWGTvU0Q283OGL1sB4V+ubJMlDz0T8mLNx9eWUY6Hx8fGxnNJtOXMZMPp0L7f5VlYzaepjFzWSZKHvrsWjYW3Uaxsd/v+1NElrbGW/X9BWu23RBf1cMdZTv4p05N/DxZJkoe+lVSdvfiPBDRX6/XEeII623329mqIvo19bbZ5Cs95X0dkp1kYj7ZCSR7hFy6U0TMMya5717sqXsyV5eFvrHonqlamxsDDu9L3iRv5pTkQOplddHQOTeCmInLQr/KrzjPNKwuGoXN+HKzsd3s3xk0ugxl5wrm5uLQr84O01hEfBjQrGgpUw+wGr81yVbrxkE1pMJZis+EftVdnp6Tp5PIa1WH7JMfjpS8YmkcbNkdpDjGPpxn+y4Q8/HJ0K+6ESJqH0YqluFoVpUQ0Tfr2HiJsrHYN95NiG01Tiklv60Eqc1mc3d3F8vw01GsnRH0+PD7lMsR/eEkv+EMAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYNI/43OWypheU2sAAAAASUVORK5CYII="}};export const runtime=function(e){e.O(0,[38792],(()=>{e.E(99176)}),5)};import e from"./runtime.38b18eba.js";import*as t from"./locale-en-US.c6c976f0.js";e.C(t);import*as r from"./frameworks.118f2d7c.js";e.C(r);import*as i from"./7974.796e74ff.js";e.C(i);import*as n from"./34362.10090565.js";e.C(n);import*as o from"./51945.18fc06e3.js";e.C(o);import*as s from"./62353.432dbf12.js";e.C(s);import*as a from"./65753.32225ac1.js";e.C(a);import*as c from"./65360.0ffc8bac.js";e.C(c);import*as l from"./55521.9c511dbb.js";e.C(l);import*as d from"./1894.96b42ead.js";e.C(d);import*as u from"./48228.4fadfe00.js";e.C(u);import*as h from"./main.097c4b67.js";e.C(h),e(e.s=195918);
//# sourceMappingURL=main.097c4b67.js.map